<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>bugmak&#39;s_blog</title>
  
  <subtitle>Welcome to bugmak&#39;s blog!!!</subtitle>
  <link href="http://bumak.github.io/rss.xml" rel="self"/>
  
  <link href="http://bumak.github.io/"/>
  <updated>2025-07-05T09:57:58.967Z</updated>
  <id>http://bumak.github.io/</id>
  
  <author>
    <name>zhike w</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>åˆè¯†AES</title>
    <link href="http://bumak.github.io/2025/07/05/AES/"/>
    <id>http://bumak.github.io/2025/07/05/AES/</id>
    <published>2025-07-05T09:41:41.000Z</published>
    <updated>2025-07-05T09:57:58.967Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åˆè¯†AES"><a href="#åˆè¯†AES" class="headerlink" title="åˆè¯†AES"></a>åˆè¯†AES</h1><p>â€‹ä½¿ç”¨pythonå®ç°ï¼Œä¸»è¦æ˜¯ç†Ÿæ‚‰åŠ å¯†æµç¨‹ï¼Œå¹¶ä¸”åŠ å¼ºpythonç¼–ç¨‹èƒ½åŠ›ã€‚<a href="https://sxyz.blog/aes-from-scratch/">å‚è€ƒæ–‡ç« 1</a>ï¼Œ<a href="https://blog.csdn.net/qq_28205153/article/details/55798628">å‚è€ƒæ–‡ç« 2</a>ï¼Œå°ç™½å°±æ˜¯å–œæ¬¢è®°å½•å­¦ä¹ è¿‡ç¨‹ï¼Œä¸ºçœæ—¶å°±è¾¹å­¦è¾¹å†™ï¼Œå¾ˆå¤šæƒ³æ³•éƒ½æ˜¯ç¬¬ä¸€ååº”ï¼Œå¦‚æœ‰é”™è¯¯æœ›æŒ‡å‡ºã€‚</p><h2 id="pythonçŸ¥è¯†ç‚¹"><a href="#pythonçŸ¥è¯†ç‚¹" class="headerlink" title="pythonçŸ¥è¯†ç‚¹"></a>pythonçŸ¥è¯†ç‚¹</h2><p>â€‹pythonä¸­çš„å‚æ•°ä¼ é€’ï¼Œåˆ†ä¸ºå¯å˜å¯¹è±¡ä¼ é€’å’Œä¸å¯å˜å¯¹è±¡ä¼ é€’ï¼Œæœ¬è´¨ä¸Šæ˜¯å¼•ç”¨ä¼ é€’ã€‚</p><p>â€‹å¯å˜å¯¹è±¡ä¼ å‚ï¼Œå¦‚listã€dictã€setç­‰ç±»å‹å¯¹è±¡ï¼Œå‚æ•°ä¼ é€’çš„æ˜¯å¯¹è±¡çš„å¼•ç”¨ï¼Œå› æ­¤å‡½æ•°å†…èƒ½å¤Ÿä¿®æ”¹ä¼ å…¥çš„å˜é‡ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">a</span>):<br>    a.append(<span class="hljs-number">10</span>)<br><br>lst = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<br>foo(lst)<br><span class="hljs-built_in">print</span>(lst)  <span class="hljs-comment"># è¾“å‡º: [1, 2, 3, 10]</span><br></code></pre></td></tr></table></figure><p>â€‹ä¸å¯å˜å¯¹è±¡ä¼ å‚ï¼Œå¦‚intã€strã€tupleç­‰ç±»å‹å¯¹è±¡ï¼Œå‡½æ•°å†…éƒ¨ä¿®æ”¹å‚æ•°ï¼Œæ˜¯ä¸ä¼šå½±å“å¤–éƒ¨çš„å˜é‡çš„ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">a</span>):<br>    a = a + <span class="hljs-number">1</span><br><br>x = <span class="hljs-number">5</span><br>foo(x)<br><span class="hljs-built_in">print</span>(x)  <span class="hljs-comment"># è¾“å‡º: 5</span><br><span class="hljs-comment">#a = a + 1 å®é™…æ˜¯é‡æ–°ç»‘å®šäº†å±€éƒ¨å˜é‡ aï¼Œå¤–é¢çš„ x ä¸å—å½±å“ã€‚</span><br></code></pre></td></tr></table></figure><p>â€‹å¦‚æœé‡æ–°ç»‘å®šå‚æ•°åï¼Œæ˜¯ä¸ä¼šå½±å“å¤–éƒ¨å˜é‡çš„ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">a</span>):<br>    a = [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>]  <span class="hljs-comment"># ç»™aé‡æ–°èµ‹å€¼</span><br><br>lst = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<br>foo(lst)<br><span class="hljs-built_in">print</span>(lst)  <span class="hljs-comment"># è¾“å‡º: [1, 2, 3]</span><br></code></pre></td></tr></table></figure><h2 id="AES-128ä½å¯†é’¥-ECBæ¨¡å¼åŠ å¯†"><a href="#AES-128ä½å¯†é’¥-ECBæ¨¡å¼åŠ å¯†" class="headerlink" title="AES 128ä½å¯†é’¥  ECBæ¨¡å¼åŠ å¯†"></a>AES 128ä½å¯†é’¥  ECBæ¨¡å¼åŠ å¯†</h2><p>â€‹AESæ˜¯åˆ†ç»„åŠ å¯†ç®—æ³•ï¼Œæ¯æ¬¡åŠ å¯†çš„è¾“å…¥æ˜¯128ä½ï¼Œä¹Ÿå°±æ˜¯åˆ†å—å¤§å°ã€‚è¾“å‡ºä¹Ÿæ˜¯128ä½ï¼Œ8*16ï¼Œå¯è¡¨ç¤ºä¸º16ä¸ªå­—èŠ‚ã€‚</p><h3 id="1-åŠ å¯†æµç¨‹"><a href="#1-åŠ å¯†æµç¨‹" class="headerlink" title="1. åŠ å¯†æµç¨‹"></a>1. åŠ å¯†æµç¨‹</h3><p>â€‹å…±åè½®åŠ å¯†ï¼Œé™¤å´<strong>å¼€å¤´çš„ä¸€æ¬¡è½®å¯†é’¥åŠ </strong>ï¼ˆä¸ç®—åœ¨åè½®ä¸­ï¼‰å’Œæœ€åä¸€è½®ï¼Œå‰©ä½™9è½®æ“ä½œæ˜¯ä¸€æ ·çš„ã€‚</p><p>â€‹ä¸­é—´çš„9è½®éƒ½æ˜¯è¿›è¡Œ<strong>å­—èŠ‚æ›¿æ¢ã€è¡Œç§»ä½ã€åˆ—æ··æ·†ã€è½®å¯†é’¥</strong>åŠ å››ä¸ªæ“ä½œï¼Œæœ€åä¸€è½®æ²¡æœ‰<strong>åˆ—æ··æ·†</strong>è¿™ä¸€æ­¥éª¤ã€‚</p><p>â€‹åœ¨ä»£ç ä¸­ï¼Œè¾“å…¥stateæ˜¯ä»¥ä¸€ç»´åˆ—è¡¨å½¢å¼å­˜å‚¨çš„ï¼Œkeyä¹Ÿæ˜¯ä»¥ä¸€ç»´åˆ—è¡¨å½¢å¼å­˜å‚¨çš„ï¼Œä½†æ˜¯å…¶è¡¨ç¤ºçš„çŸ©é˜µæ˜¯å¦‚ä¸‹çš„ï¼Œæˆ‘ä»¬ä¹‹åè®¨è®ºçš„æ“ä½œéƒ½æ˜¯åœ¨è¿™ç§æ’åˆ—çš„çŸ©é˜µåŸºç¡€ä¸Šè¿›è¡Œçš„ã€‚</p><p><img src="/pictures/%E5%88%9D%E8%AF%86AES/image-20250705115307045.png" alt="image-20250705115307045"></p><p>â€‹å…¶ä¸­Sç›’æ˜¯ä¸€ä¸ª16*16çš„äºŒç»´åˆ—è¡¨ï¼Œå…¶æ­£å¸¸è¡¨ç¤ºå³<code>S[0][1]</code>è¡¨ç¤ºç¬¬0è¡Œç¬¬1åˆ—çš„å…ƒç´ ã€‚</p><h4 id="å­—èŠ‚æ›¿æ¢"><a href="#å­—èŠ‚æ›¿æ¢" class="headerlink" title="å­—èŠ‚æ›¿æ¢"></a>å­—èŠ‚æ›¿æ¢</h4><p>â€‹æˆ‘ä»¬çŸ¥é“<code>state[i]</code>éƒ½æ˜¯ä¸€ä¸ªå­—èŠ‚å…ƒç´ ï¼Œå–å‰4ä½ä½œä¸ºè¡Œå·ï¼Œå4ä½ä½œä¸ºåˆ—å·ï¼Œç„¶åæŒ‰ç…§è¡Œåˆ—å·å–Sç›’ä¸­çš„å…ƒç´ æ¥æ›¿ä»£state[i]ã€‚</p><p>â€‹è¿™æ˜¯å¯é€†æ“ä½œï¼Œå…¶é€†æ“ä½œå°±æ˜¯æ ¹æ®Sç›’ç®—å‡ºé€†Sç›’ï¼ˆSç›’ç”Ÿæˆå’Œé€†ç›’åŸç†å¯ä»¥è‡ªè¡Œå­¦ä¹ ï¼‰ï¼Œç„¶åè¿›è¡ŒåŒæ ·çš„æ›¿æ¢ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">SubBytes</span>(<span class="hljs-params">self, state, inv=<span class="hljs-literal">False</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    å¯¹è¾“å…¥çš„stateè¿›è¡ŒSç›’ç½®æ¢ã€‚</span><br><span class="hljs-string">    stateæ˜¯ä¸€ä¸ª16ä¸ªå­—èŠ‚å…ƒç´ çš„åˆ—è¡¨ï¼Œä»¥ä¸€ç»´å½¢å¼è®¿é—®</span><br><span class="hljs-string">    è¿”å›å€¼æ˜¯å˜æ¢åçš„äºŒç»´åˆ—è¡¨</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i,v <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(state):<br>        <span class="hljs-keyword">if</span> inv == <span class="hljs-literal">False</span>:<br>            state[i] = <span class="hljs-variable language_">self</span>.S_BOX[v&gt;&gt;<span class="hljs-number">4</span>][v&amp;<span class="hljs-number">0xf</span>]<br>        <span class="hljs-keyword">else</span>:<br>            state[i] = <span class="hljs-variable language_">self</span>.S_BOX_INV[v&gt;&gt;<span class="hljs-number">4</span>][v&amp;<span class="hljs-number">0xf</span>]<br></code></pre></td></tr></table></figure><h4 id="è¡Œç§»ä½"><a href="#è¡Œç§»ä½" class="headerlink" title="è¡Œç§»ä½"></a>è¡Œç§»ä½</h4><p>â€‹é’ˆå¯¹å‰å›¾ä¸­çš„stateçŸ©é˜µï¼Œè¿è¡Œè§„åˆ™æ˜¯ï¼šç¬¬iè¡Œçš„å…ƒç´ å·¦å¾ªç¯ç§»ä½(i-1)ä½ï¼Œè¡Œæ•°ä»1å¼€å§‹ï¼Œä¾‹å¦‚ç¬¬äºŒè¡Œ1ã€5ã€9ã€13å°±ä¼šå˜æˆ5ã€9ã€13ã€1ã€‚</p><p>â€‹å…¶é€†æ“ä½œå°±æ˜¯å¾ªç¯å³ç§»åŒæ ·çš„ä½æ•°ã€‚</p><p>â€‹æˆ‘ä»¬é€šè¿‡åˆ‡ç‰‡æ“ä½œå®ç°ï¼Œ<code>state[i::4]</code>å°±æ˜¯ä»ä¸‹æ ‡iå¼€å§‹ï¼ŒæŒ‰æ­¥é•¿4å–å€¼ï¼Œæ­£å¥½å¾—åˆ°ç¬¬iè¡Œå…ƒç´ ã€‚<code>state[i::4][-i:]</code>è¡¨ç¤ºå–ç¬¬iè¡Œçš„åé¢ï¼ˆi-1ï¼‰ä¸ªå…ƒç´ ï¼Œä¾‹å¦‚å½“i&#x3D;1æ—¶ï¼Œå…¶ä¸ºstate[13]ï¼Œå½“i&#x3D;2æ—¶ï¼Œå…¶ä¸º<code>state[10],state[14]</code>ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">ShiftRows</span>(<span class="hljs-params">self, state, inv=<span class="hljs-literal">False</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    stateæ˜¯ä¸€ä¸ª16ä¸ªå­—èŠ‚å…ƒç´ çš„åˆ—è¡¨ï¼Œä»¥ä¸€ç»´å½¢å¼è®¿é—®</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>        <span class="hljs-keyword">if</span> inv == <span class="hljs-literal">False</span>:<br>            state[i::<span class="hljs-number">4</span>] = state[i::<span class="hljs-number">4</span>][i:] + state[i::<span class="hljs-number">4</span>][:i] <span class="hljs-comment"># å·¦ç§»</span><br>        <span class="hljs-keyword">else</span>:<br>            state[i::<span class="hljs-number">4</span>] = state[i::<span class="hljs-number">4</span>][-i:] + state[i::<span class="hljs-number">4</span>][:-i]   <span class="hljs-comment"># å³ç§»</span><br></code></pre></td></tr></table></figure><p>â€‹</p><h4 id="åˆ—æ··æ·†"><a href="#åˆ—æ··æ·†" class="headerlink" title="åˆ—æ··æ·†"></a>åˆ—æ··æ·†</h4><p>â€‹åˆ—æ··æ·†æ˜¯å¯¹ä¸Šé¢çŸ©é˜µçš„æ¯ä¸€åˆ—ä¸ä¸€ä¸ª<strong>ç‰¹å®šçš„çŸ©é˜µM</strong>ï¼ˆä¸€èˆ¬æ˜¯å›ºå®šçš„ï¼Œå¦‚ä¸‹å›¾ï¼‰åšä¹˜æ³•è¿ç®—ï¼Œå¾—åˆ°æ–°çš„å€¼ï¼Œé’ˆå¯¹çš„è¿˜æ˜¯ä¸Šé¢çš„é‚£ä¸ªçŸ©é˜µã€‚</p><p><img src="/pictures/%E5%88%9D%E8%AF%86AES/image-20250705124744021.png" alt="image-20250705124744021"></p><p>â€‹å› ä¸ºç‰¹å®šçš„çŸ©é˜µå­˜åœ¨ä¸‹é¢çš„æ€§è´¨ï¼Œæ‰€ä»¥è§£å¯†å°±æ˜¯é‡å¤ä¸‰æ¬¡åŠ å¯†ã€‚<br>$$<br><br>M^4 &#x3D; M \cdot M^{-1} &#x3D; E<br>$$<br><img src="/pictures/%E5%88%9D%E8%AF%86AES/image-20250705122301118.png" alt="image-20250705122301118"></p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">MixColumns</span>(<span class="hljs-params">self, state, inv=<span class="hljs-literal">False</span></span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GFmul_by_2</span>(<span class="hljs-params">n</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        è¿™ä¸ªè®¡ç®—æ˜¯æœ‰æ•°å­¦æ„ä¹‰çš„ï¼Œä¸æ˜¯ç®€å•çš„ä¹˜æ³•è¿ç®—ï¼ŒåŸç†å¯è‡ªè¡Œäº†è§£GFåŸŸçš„å®šä¹‰ã€‚</span><br><span class="hljs-string">        :param n:</span><br><span class="hljs-string">        :return:</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        s = (n &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xff</span><br>        <span class="hljs-keyword">if</span> n &amp; <span class="hljs-number">128</span>:<span class="hljs-comment">#æ³¨æ„ï¼Œè¿™é‡Œä¸è¦æŠ„é”™äº†ï¼ï¼ï¼</span><br>            s ^= <span class="hljs-number">0x1b</span><br>        <span class="hljs-keyword">return</span> s<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GFmul_by_3</span>(<span class="hljs-params">n</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        :param n:</span><br><span class="hljs-string">        :return:</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        <span class="hljs-keyword">return</span> n ^ GFmul_by_2(n)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mix_column</span>(<span class="hljs-params">c</span>):<br>        <span class="hljs-keyword">return</span> [<br>            GFmul_by_2(c[<span class="hljs-number">0</span>]) ^ GFmul_by_3(c[<span class="hljs-number">1</span>]) ^ c[<span class="hljs-number">2</span>] ^ c[<span class="hljs-number">3</span>],<br>            GFmul_by_2(c[<span class="hljs-number">1</span>]) ^ GFmul_by_3(c[<span class="hljs-number">2</span>]) ^ c[<span class="hljs-number">3</span>] ^ c[<span class="hljs-number">0</span>],<br>            GFmul_by_2(c[<span class="hljs-number">2</span>]) ^ GFmul_by_3(c[<span class="hljs-number">3</span>]) ^ c[<span class="hljs-number">0</span>] ^ c[<span class="hljs-number">1</span>],<br>            GFmul_by_2(c[<span class="hljs-number">3</span>]) ^ GFmul_by_3(c[<span class="hljs-number">0</span>]) ^ c[<span class="hljs-number">1</span>] ^ c[<span class="hljs-number">2</span>]<br>        ]<br><br>    <span class="hljs-keyword">if</span> inv == <span class="hljs-literal">False</span>:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>, <span class="hljs-number">4</span>):<br>            state[i:i + <span class="hljs-number">4</span>] = mix_column(state[i:i + <span class="hljs-number">4</span>])<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>, <span class="hljs-number">4</span>):<br>                state[i:i + <span class="hljs-number">4</span>] = mix_column(state[i:i + <span class="hljs-number">4</span>])<br></code></pre></td></tr></table></figure><h4 id="è½®å¯†é’¥åŠ "><a href="#è½®å¯†é’¥åŠ " class="headerlink" title="è½®å¯†é’¥åŠ "></a>è½®å¯†é’¥åŠ </h4><p>â€‹å°†å¯¹åº”çš„å¯†é’¥<strong>åˆ—è¡¨</strong>ä¸çŠ¶æ€<strong>åˆ—è¡¨</strong>çš„å…ƒç´ è¿›è¡Œå¼‚æˆ–å³å¯ã€‚</p><p><img src="/pictures/%E5%88%9D%E8%AF%86AES/image-20250705130308252.png" alt="image-20250705130308252"></p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">AddRoundKey</span>(<span class="hljs-params">self, state, key</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        state[i] ^= key[i]<br></code></pre></td></tr></table></figure><h3 id="2-å¯†é’¥æ‰©å±•ç®—æ³•"><a href="#2-å¯†é’¥æ‰©å±•ç®—æ³•" class="headerlink" title="2. å¯†é’¥æ‰©å±•ç®—æ³•"></a>2. å¯†é’¥æ‰©å±•ç®—æ³•</h3><p>â€‹AESç³»åˆ—ç®—æ³•çš„å¯†é’¥å¯èƒ½ä½æ•°ä¸º128ã€192ã€256ï¼Œä»¥128ä¸ºä¾‹ï¼Œ<code>W[i]</code>æ˜¯ç”±<code>K[i:i+4]</code>ç»„æˆçš„32ä½ï¼Œæˆ‘ä»¬ä¼šç”±åˆå§‹çš„<code>W[0:4]</code>è¿™å››ä¸ªå­—é€šè¿‡å¯†é’¥æ‰©å±•å¾—åˆ°åé¢çš„40ä¸ªå­—<code>W[4:44]</code>ï¼Œå…¶ä¸­æ¯ä¸€è½®ä¼šç”¨åˆ°<code>W[i:i+4]</code>å››ä¸ªå­—è¿›è¡Œè½®å¯†é’¥åŠ æ“ä½œã€‚åˆå§‹çš„4ä¸ªå­—æ˜¯ç”¨åœ¨ç¬¬ä¸€è½®å‰çš„è½®å¯†é’¥åŠ çš„ã€‚</p><p><img src="/pictures/%E5%88%9D%E8%AF%86AES/image-20250705125157750.png" alt="image-20250705125157750"></p><p>â€‹å…·ä½“è®¡ç®—è¿‡ç¨‹å°±æ˜¯ï¼Œä»i&#x3D;4å¼€å§‹ï¼ŒğŸ‘å¦‚æœiä¸æ˜¯4çš„å€æ•°ï¼Œé‚£ä¹ˆW[i]å°±æ˜¯W[i-1]^W[i-4]ã€‚ç­‰ä»·æˆå­—èŠ‚æ“ä½œå°±æ˜¯ï¼Œæ¯4ä¸ªkeyä¸€ç»„ï¼Œè‹¥å¯¹åº”çš„W[i]çš„iä¸æ˜¯4çš„å€æ•°ï¼Œé‚£ä¹ˆ<code>key[-16]^r[j]</code>å°±æ˜¯<code>W[i-1]^W[i-4]</code>çš„é€å­—èŠ‚æ“ä½œï¼Œå…¶ä¸­key[-16]å¯¹åº”W[i-4]ä¸­çš„å­—èŠ‚ï¼Œr[i]å¯¹åº”W[i-1]ä¸­çš„å­—èŠ‚ã€‚âœŒï¸å¦‚æœæ˜¯4çš„å€æ•°ï¼Œåˆ™è¦å¯¹æœ€åçš„4å­—èŠ‚è¿›è¡Œä¸€ç³»åˆ—åŠ å¯†ï¼Œ<code>r[1:] + r[:1]</code>å°±æ˜¯å°†råˆ‡ç‰‡å·¦ç§»ä¸€ä½ï¼Œå…¶ä»–ä¹Ÿå¾ˆæ˜¾ç„¶ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè½®å¯†é’¥å¸¸æ•°ä¹Ÿæœ‰å†™æˆ<strong>0x01000000</strong>è¿™ç§å½¢å¼çš„ï¼Œè¿™ç§æ˜¯åœ¨å­—çš„çº§åˆ«è¿›è¡Œæ“ä½œçš„ï¼Œæˆ‘ä»¬æ˜¯åœ¨é€å­—èŠ‚å¤„ç†ï¼Œæ‰€ä»¥è¦é€šè¿‡<code>if j == 0 else 0</code>æ¥è¡¥å……00ã€‚</p><p>â€‹æ³¨æ„ï¼Œå…¶ä¸­<code>r = key[-4:]</code>å¾—åˆ°çš„æ˜¯ä¸€ä¸ªæ–°çš„åˆ‡ç‰‡å¯¹è±¡ï¼Œä¿®æ”¹rä¸ä¼šå½±å“keyä¸­çš„å€¼ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">key_expansion</span>(<span class="hljs-params">self, key</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span> * <span class="hljs-number">4</span>):<br>        r = key[-<span class="hljs-number">4</span>:]<br>        <span class="hljs-keyword">if</span> i % <span class="hljs-number">4</span> == <span class="hljs-number">0</span>:  <span class="hljs-comment"># å¯¹ä¸Šä¸€è½®æœ€å4å­—èŠ‚è‡ªå¾ªç¯ã€S-boxç½®æ¢ã€è½®å¸¸æ•°å¼‚æˆ–ï¼Œä»è€Œè®¡ç®—å‡ºå½“å‰æ–°ä¸€è½®æœ€å‰4å­—èŠ‚</span><br>            <span class="hljs-keyword">for</span> j, v <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(r[<span class="hljs-number">1</span>:] + r[:<span class="hljs-number">1</span>]):<br>                r[j] = <span class="hljs-variable language_">self</span>.S_BOX[v &gt;&gt; <span class="hljs-number">4</span>][v &amp; <span class="hljs-number">0xf</span>] ^ (<span class="hljs-variable language_">self</span>.RCON[i // <span class="hljs-number">4</span>] <span class="hljs-keyword">if</span> j == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>)<br><br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            key.append(key[-<span class="hljs-number">16</span>] ^ r[j])<br><br>    <span class="hljs-keyword">return</span> key<br></code></pre></td></tr></table></figure><h3 id="3-æ•´ä½“åŠ è§£å¯†ä»£ç "><a href="#3-æ•´ä½“åŠ è§£å¯†ä»£ç " class="headerlink" title="3. æ•´ä½“åŠ è§£å¯†ä»£ç "></a>3. æ•´ä½“åŠ è§£å¯†ä»£ç </h3><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AES</span>:<br>    MIX_C = [[<span class="hljs-number">0x2</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x1</span>], [<span class="hljs-number">0x1</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>], [<span class="hljs-number">0x1</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x3</span>], [<span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x2</span>]]<br>    MIX_C_INV = [[<span class="hljs-number">0xe</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0xd</span>, <span class="hljs-number">0x9</span>], [<span class="hljs-number">0x9</span>, <span class="hljs-number">0xe</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0xd</span>], [<span class="hljs-number">0xd</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xe</span>, <span class="hljs-number">0xb</span>], [<span class="hljs-number">0xb</span>, <span class="hljs-number">0xd</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xe</span>]]<br>    RCON= [<span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x36</span> ,<span class="hljs-number">0x6c</span>, <span class="hljs-number">0xd8</span>, <span class="hljs-number">0xab</span>, <span class="hljs-number">0x4d</span>]  <span class="hljs-comment"># å®é™…åªç”¨åˆ°å‰10ä¸ª</span><br>    S_BOX = [[<span class="hljs-number">124</span>, <span class="hljs-number">202</span>, <span class="hljs-number">123</span>, <span class="hljs-number">119</span>, <span class="hljs-number">242</span>, <span class="hljs-number">107</span>, <span class="hljs-number">111</span>, <span class="hljs-number">197</span>, <span class="hljs-number">48</span>, <span class="hljs-number">1</span>, <span class="hljs-number">103</span>, <span class="hljs-number">43</span>, <span class="hljs-number">254</span>, <span class="hljs-number">215</span>, <span class="hljs-number">71</span>, <span class="hljs-number">171</span>],<br>             [<span class="hljs-number">118</span>, <span class="hljs-number">99</span>, <span class="hljs-number">130</span>, <span class="hljs-number">201</span>, <span class="hljs-number">125</span>, <span class="hljs-number">250</span>, <span class="hljs-number">89</span>, <span class="hljs-number">240</span>, <span class="hljs-number">173</span>, <span class="hljs-number">212</span>, <span class="hljs-number">162</span>, <span class="hljs-number">175</span>, <span class="hljs-number">156</span>, <span class="hljs-number">164</span>, <span class="hljs-number">114</span>, <span class="hljs-number">192</span>],<br>             [<span class="hljs-number">183</span>, <span class="hljs-number">253</span>, <span class="hljs-number">147</span>, <span class="hljs-number">38</span>, <span class="hljs-number">54</span>, <span class="hljs-number">63</span>, <span class="hljs-number">247</span>, <span class="hljs-number">204</span>, <span class="hljs-number">52</span>, <span class="hljs-number">165</span>, <span class="hljs-number">229</span>, <span class="hljs-number">241</span>, <span class="hljs-number">113</span>, <span class="hljs-number">216</span>, <span class="hljs-number">49</span>, <span class="hljs-number">21</span>],<br>             [<span class="hljs-number">4</span>, <span class="hljs-number">199</span>, <span class="hljs-number">35</span>, <span class="hljs-number">195</span>, <span class="hljs-number">24</span>, <span class="hljs-number">150</span>, <span class="hljs-number">5</span>, <span class="hljs-number">154</span>, <span class="hljs-number">7</span>, <span class="hljs-number">18</span>, <span class="hljs-number">128</span>, <span class="hljs-number">226</span>, <span class="hljs-number">235</span>, <span class="hljs-number">39</span>, <span class="hljs-number">178</span>, <span class="hljs-number">117</span>],<br>             [<span class="hljs-number">9</span>, <span class="hljs-number">131</span>, <span class="hljs-number">44</span>, <span class="hljs-number">26</span>, <span class="hljs-number">27</span>, <span class="hljs-number">110</span>, <span class="hljs-number">90</span>, <span class="hljs-number">160</span>, <span class="hljs-number">82</span>, <span class="hljs-number">59</span>, <span class="hljs-number">214</span>, <span class="hljs-number">179</span>, <span class="hljs-number">41</span>, <span class="hljs-number">227</span>, <span class="hljs-number">47</span>, <span class="hljs-number">132</span>],<br>             [<span class="hljs-number">83</span>, <span class="hljs-number">209</span>, <span class="hljs-number">0</span>, <span class="hljs-number">237</span>, <span class="hljs-number">32</span>, <span class="hljs-number">252</span>, <span class="hljs-number">177</span>, <span class="hljs-number">91</span>, <span class="hljs-number">106</span>, <span class="hljs-number">203</span>, <span class="hljs-number">190</span>, <span class="hljs-number">57</span>, <span class="hljs-number">74</span>, <span class="hljs-number">76</span>, <span class="hljs-number">88</span>, <span class="hljs-number">207</span>],<br>             [<span class="hljs-number">208</span>, <span class="hljs-number">239</span>, <span class="hljs-number">170</span>, <span class="hljs-number">251</span>, <span class="hljs-number">67</span>, <span class="hljs-number">77</span>, <span class="hljs-number">51</span>, <span class="hljs-number">133</span>, <span class="hljs-number">69</span>, <span class="hljs-number">249</span>, <span class="hljs-number">2</span>, <span class="hljs-number">127</span>, <span class="hljs-number">80</span>, <span class="hljs-number">60</span>, <span class="hljs-number">159</span>, <span class="hljs-number">168</span>],<br>             [<span class="hljs-number">81</span>, <span class="hljs-number">163</span>, <span class="hljs-number">64</span>, <span class="hljs-number">143</span>, <span class="hljs-number">146</span>, <span class="hljs-number">157</span>, <span class="hljs-number">56</span>, <span class="hljs-number">245</span>, <span class="hljs-number">188</span>, <span class="hljs-number">182</span>, <span class="hljs-number">218</span>, <span class="hljs-number">33</span>, <span class="hljs-number">16</span>, <span class="hljs-number">255</span>, <span class="hljs-number">243</span>, <span class="hljs-number">210</span>],<br>             [<span class="hljs-number">151</span>, <span class="hljs-number">205</span>, <span class="hljs-number">12</span>, <span class="hljs-number">19</span>, <span class="hljs-number">236</span>, <span class="hljs-number">95</span>, <span class="hljs-number">68</span>, <span class="hljs-number">23</span>, <span class="hljs-number">196</span>, <span class="hljs-number">167</span>, <span class="hljs-number">126</span>, <span class="hljs-number">61</span>, <span class="hljs-number">100</span>, <span class="hljs-number">93</span>, <span class="hljs-number">25</span>, <span class="hljs-number">115</span>],<br>             [<span class="hljs-number">96</span>, <span class="hljs-number">129</span>, <span class="hljs-number">79</span>, <span class="hljs-number">220</span>, <span class="hljs-number">34</span>, <span class="hljs-number">42</span>, <span class="hljs-number">144</span>, <span class="hljs-number">136</span>, <span class="hljs-number">70</span>, <span class="hljs-number">238</span>, <span class="hljs-number">184</span>, <span class="hljs-number">20</span>, <span class="hljs-number">222</span>, <span class="hljs-number">94</span>, <span class="hljs-number">11</span>, <span class="hljs-number">219</span>],<br>             [<span class="hljs-number">224</span>, <span class="hljs-number">50</span>, <span class="hljs-number">58</span>, <span class="hljs-number">10</span>, <span class="hljs-number">73</span>, <span class="hljs-number">6</span>, <span class="hljs-number">36</span>, <span class="hljs-number">92</span>, <span class="hljs-number">194</span>, <span class="hljs-number">211</span>, <span class="hljs-number">172</span>, <span class="hljs-number">98</span>, <span class="hljs-number">145</span>, <span class="hljs-number">149</span>, <span class="hljs-number">228</span>, <span class="hljs-number">121</span>],<br>             [<span class="hljs-number">231</span>, <span class="hljs-number">200</span>, <span class="hljs-number">55</span>, <span class="hljs-number">109</span>, <span class="hljs-number">141</span>, <span class="hljs-number">213</span>, <span class="hljs-number">78</span>, <span class="hljs-number">169</span>, <span class="hljs-number">108</span>, <span class="hljs-number">86</span>, <span class="hljs-number">244</span>, <span class="hljs-number">234</span>, <span class="hljs-number">101</span>, <span class="hljs-number">122</span>, <span class="hljs-number">174</span>, <span class="hljs-number">8</span>],<br>             [<span class="hljs-number">186</span>, <span class="hljs-number">120</span>, <span class="hljs-number">37</span>, <span class="hljs-number">46</span>, <span class="hljs-number">28</span>, <span class="hljs-number">166</span>, <span class="hljs-number">180</span>, <span class="hljs-number">198</span>, <span class="hljs-number">232</span>, <span class="hljs-number">221</span>, <span class="hljs-number">116</span>, <span class="hljs-number">31</span>, <span class="hljs-number">75</span>, <span class="hljs-number">189</span>, <span class="hljs-number">139</span>, <span class="hljs-number">138</span>],<br>             [<span class="hljs-number">112</span>, <span class="hljs-number">62</span>, <span class="hljs-number">181</span>, <span class="hljs-number">102</span>, <span class="hljs-number">72</span>, <span class="hljs-number">3</span>, <span class="hljs-number">246</span>, <span class="hljs-number">14</span>, <span class="hljs-number">97</span>, <span class="hljs-number">53</span>, <span class="hljs-number">87</span>, <span class="hljs-number">185</span>, <span class="hljs-number">134</span>, <span class="hljs-number">193</span>, <span class="hljs-number">29</span>, <span class="hljs-number">158</span>],<br>             [<span class="hljs-number">225</span>, <span class="hljs-number">248</span>, <span class="hljs-number">152</span>, <span class="hljs-number">17</span>, <span class="hljs-number">105</span>, <span class="hljs-number">217</span>, <span class="hljs-number">142</span>, <span class="hljs-number">148</span>, <span class="hljs-number">155</span>, <span class="hljs-number">30</span>, <span class="hljs-number">233</span>, <span class="hljs-number">206</span>, <span class="hljs-number">85</span>, <span class="hljs-number">40</span>, <span class="hljs-number">223</span>, <span class="hljs-number">140</span>],<br>             [<span class="hljs-number">161</span>, <span class="hljs-number">137</span>, <span class="hljs-number">13</span>, <span class="hljs-number">191</span>, <span class="hljs-number">230</span>, <span class="hljs-number">66</span>, <span class="hljs-number">104</span>, <span class="hljs-number">65</span>, <span class="hljs-number">153</span>, <span class="hljs-number">45</span>, <span class="hljs-number">15</span>, <span class="hljs-number">176</span>, <span class="hljs-number">84</span>, <span class="hljs-number">187</span>, <span class="hljs-number">22</span>, <span class="hljs-number">135</span>]]<br><br>    S_BOX_INV = [[<span class="hljs-number">82</span>, <span class="hljs-number">9</span>, <span class="hljs-number">106</span>, <span class="hljs-number">213</span>, <span class="hljs-number">48</span>, <span class="hljs-number">54</span>, <span class="hljs-number">165</span>, <span class="hljs-number">56</span>, <span class="hljs-number">191</span>, <span class="hljs-number">64</span>, <span class="hljs-number">163</span>, <span class="hljs-number">158</span>, <span class="hljs-number">130</span>, <span class="hljs-number">242</span>, <span class="hljs-number">215</span>, <span class="hljs-number">250</span>],<br>              [<span class="hljs-number">124</span>, <span class="hljs-number">227</span>, <span class="hljs-number">57</span>, <span class="hljs-number">131</span>, <span class="hljs-number">155</span>, <span class="hljs-number">47</span>, <span class="hljs-number">254</span>, <span class="hljs-number">135</span>, <span class="hljs-number">52</span>, <span class="hljs-number">142</span>, <span class="hljs-number">67</span>, <span class="hljs-number">68</span>, <span class="hljs-number">196</span>, <span class="hljs-number">222</span>, <span class="hljs-number">233</span>, <span class="hljs-number">203</span>],<br>              [<span class="hljs-number">84</span>, <span class="hljs-number">123</span>, <span class="hljs-number">148</span>, <span class="hljs-number">50</span>, <span class="hljs-number">166</span>, <span class="hljs-number">194</span>, <span class="hljs-number">35</span>, <span class="hljs-number">61</span>, <span class="hljs-number">237</span>, <span class="hljs-number">76</span>, <span class="hljs-number">149</span>, <span class="hljs-number">11</span>, <span class="hljs-number">66</span>, <span class="hljs-number">249</span>, <span class="hljs-number">195</span>, <span class="hljs-number">78</span>],<br>              [<span class="hljs-number">8</span>, <span class="hljs-number">46</span>, <span class="hljs-number">161</span>, <span class="hljs-number">102</span>, <span class="hljs-number">40</span>, <span class="hljs-number">217</span>, <span class="hljs-number">36</span>, <span class="hljs-number">178</span>, <span class="hljs-number">118</span>, <span class="hljs-number">91</span>, <span class="hljs-number">162</span>, <span class="hljs-number">73</span>, <span class="hljs-number">109</span>, <span class="hljs-number">139</span>, <span class="hljs-number">209</span>, <span class="hljs-number">37</span>],<br>              [<span class="hljs-number">114</span>, <span class="hljs-number">247</span>, <span class="hljs-number">245</span>, <span class="hljs-number">100</span>, <span class="hljs-number">134</span>, <span class="hljs-number">104</span>, <span class="hljs-number">152</span>, <span class="hljs-number">14</span>, <span class="hljs-number">212</span>, <span class="hljs-number">164</span>, <span class="hljs-number">92</span>, <span class="hljs-number">204</span>, <span class="hljs-number">93</span>, <span class="hljs-number">101</span>, <span class="hljs-number">182</span>, <span class="hljs-number">146</span>],<br>              [<span class="hljs-number">108</span>, <span class="hljs-number">112</span>, <span class="hljs-number">72</span>, <span class="hljs-number">80</span>, <span class="hljs-number">252</span>, <span class="hljs-number">236</span>, <span class="hljs-number">185</span>, <span class="hljs-number">218</span>, <span class="hljs-number">94</span>, <span class="hljs-number">22</span>, <span class="hljs-number">70</span>, <span class="hljs-number">87</span>, <span class="hljs-number">167</span>, <span class="hljs-number">141</span>, <span class="hljs-number">157</span>, <span class="hljs-number">133</span>],<br>              [<span class="hljs-number">144</span>, <span class="hljs-number">216</span>, <span class="hljs-number">171</span>, <span class="hljs-number">17</span>, <span class="hljs-number">140</span>, <span class="hljs-number">188</span>, <span class="hljs-number">211</span>, <span class="hljs-number">10</span>, <span class="hljs-number">246</span>, <span class="hljs-number">228</span>, <span class="hljs-number">88</span>, <span class="hljs-number">5</span>, <span class="hljs-number">184</span>, <span class="hljs-number">179</span>, <span class="hljs-number">69</span>, <span class="hljs-number">6</span>],<br>              [<span class="hljs-number">208</span>, <span class="hljs-number">44</span>, <span class="hljs-number">30</span>, <span class="hljs-number">143</span>, <span class="hljs-number">202</span>, <span class="hljs-number">63</span>, <span class="hljs-number">16</span>, <span class="hljs-number">3</span>, <span class="hljs-number">193</span>, <span class="hljs-number">175</span>, <span class="hljs-number">189</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">138</span>, <span class="hljs-number">107</span>],<br>              [<span class="hljs-number">58</span>, <span class="hljs-number">145</span>, <span class="hljs-number">18</span>, <span class="hljs-number">65</span>, <span class="hljs-number">79</span>, <span class="hljs-number">103</span>, <span class="hljs-number">220</span>, <span class="hljs-number">255</span>, <span class="hljs-number">151</span>, <span class="hljs-number">241</span>, <span class="hljs-number">207</span>, <span class="hljs-number">206</span>, <span class="hljs-number">239</span>, <span class="hljs-number">180</span>, <span class="hljs-number">230</span>, <span class="hljs-number">115</span>],<br>              [<span class="hljs-number">150</span>, <span class="hljs-number">172</span>, <span class="hljs-number">116</span>, <span class="hljs-number">34</span>, <span class="hljs-number">231</span>, <span class="hljs-number">173</span>, <span class="hljs-number">53</span>, <span class="hljs-number">128</span>, <span class="hljs-number">226</span>, <span class="hljs-number">248</span>, <span class="hljs-number">55</span>, <span class="hljs-number">232</span>, <span class="hljs-number">28</span>, <span class="hljs-number">117</span>, <span class="hljs-number">223</span>, <span class="hljs-number">110</span>],<br>              [<span class="hljs-number">71</span>, <span class="hljs-number">240</span>, <span class="hljs-number">26</span>, <span class="hljs-number">113</span>, <span class="hljs-number">29</span>, <span class="hljs-number">41</span>, <span class="hljs-number">197</span>, <span class="hljs-number">137</span>, <span class="hljs-number">111</span>, <span class="hljs-number">183</span>, <span class="hljs-number">98</span>, <span class="hljs-number">15</span>, <span class="hljs-number">170</span>, <span class="hljs-number">24</span>, <span class="hljs-number">190</span>, <span class="hljs-number">27</span>],<br>              [<span class="hljs-number">251</span>, <span class="hljs-number">86</span>, <span class="hljs-number">62</span>, <span class="hljs-number">75</span>, <span class="hljs-number">198</span>, <span class="hljs-number">210</span>, <span class="hljs-number">121</span>, <span class="hljs-number">32</span>, <span class="hljs-number">154</span>, <span class="hljs-number">219</span>, <span class="hljs-number">192</span>, <span class="hljs-number">253</span>, <span class="hljs-number">120</span>, <span class="hljs-number">205</span>, <span class="hljs-number">90</span>, <span class="hljs-number">243</span>],<br>              [<span class="hljs-number">31</span>, <span class="hljs-number">221</span>, <span class="hljs-number">168</span>, <span class="hljs-number">51</span>, <span class="hljs-number">136</span>, <span class="hljs-number">7</span>, <span class="hljs-number">199</span>, <span class="hljs-number">49</span>, <span class="hljs-number">177</span>, <span class="hljs-number">19</span>, <span class="hljs-number">1</span>, <span class="hljs-number">89</span>, <span class="hljs-number">39</span>, <span class="hljs-number">129</span>, <span class="hljs-number">235</span>, <span class="hljs-number">95</span>],<br>              [<span class="hljs-number">96</span>, <span class="hljs-number">81</span>, <span class="hljs-number">127</span>, <span class="hljs-number">169</span>, <span class="hljs-number">25</span>, <span class="hljs-number">181</span>, <span class="hljs-number">74</span>, <span class="hljs-number">13</span>, <span class="hljs-number">45</span>, <span class="hljs-number">229</span>, <span class="hljs-number">122</span>, <span class="hljs-number">159</span>, <span class="hljs-number">147</span>, <span class="hljs-number">201</span>, <span class="hljs-number">156</span>, <span class="hljs-number">238</span>],<br>              [<span class="hljs-number">160</span>, <span class="hljs-number">224</span>, <span class="hljs-number">59</span>, <span class="hljs-number">77</span>, <span class="hljs-number">174</span>, <span class="hljs-number">42</span>, <span class="hljs-number">244</span>, <span class="hljs-number">176</span>, <span class="hljs-number">200</span>, <span class="hljs-number">234</span>, <span class="hljs-number">187</span>, <span class="hljs-number">60</span>, <span class="hljs-number">132</span>, <span class="hljs-number">83</span>, <span class="hljs-number">153</span>, <span class="hljs-number">97</span>],<br>              [<span class="hljs-number">23</span>, <span class="hljs-number">43</span>, <span class="hljs-number">4</span>, <span class="hljs-number">126</span>, <span class="hljs-number">186</span>, <span class="hljs-number">119</span>, <span class="hljs-number">214</span>, <span class="hljs-number">38</span>, <span class="hljs-number">225</span>, <span class="hljs-number">105</span>, <span class="hljs-number">21</span>, <span class="hljs-number">99</span>, <span class="hljs-number">85</span>, <span class="hljs-number">33</span>, <span class="hljs-number">12</span>, <span class="hljs-number">125</span>]]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">SubBytes</span>(<span class="hljs-params">self, state, inv=<span class="hljs-literal">False</span></span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        å¯¹è¾“å…¥çš„stateè¿›è¡ŒSç›’ç½®æ¢ã€‚</span><br><span class="hljs-string">        stateæ˜¯ä¸€ä¸ª16ä¸ªå­—èŠ‚å…ƒç´ çš„åˆ—è¡¨ï¼Œä»¥ä¸€ç»´å½¢å¼è®¿é—®</span><br><span class="hljs-string">        è¿”å›å€¼æ˜¯å˜æ¢åçš„äºŒç»´åˆ—è¡¨</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        <span class="hljs-keyword">for</span> i,v <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(state):<br>            <span class="hljs-keyword">if</span> inv == <span class="hljs-literal">False</span>:<br>                state[i] = <span class="hljs-variable language_">self</span>.S_BOX[v&gt;&gt;<span class="hljs-number">4</span>][v&amp;<span class="hljs-number">0xf</span>]<br>            <span class="hljs-keyword">else</span>:<br>                state[i] = <span class="hljs-variable language_">self</span>.S_BOX_INV[v&gt;&gt;<span class="hljs-number">4</span>][v&amp;<span class="hljs-number">0xf</span>]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">ShiftRows</span>(<span class="hljs-params">self, state, inv=<span class="hljs-literal">False</span></span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        stateæ˜¯ä¸€ä¸ª16ä¸ªå­—èŠ‚å…ƒç´ çš„åˆ—è¡¨ï¼Œä»¥ä¸€ç»´å½¢å¼è®¿é—®</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            <span class="hljs-keyword">if</span> inv == <span class="hljs-literal">False</span>:<br>                state[i::<span class="hljs-number">4</span>] = state[i::<span class="hljs-number">4</span>][i:] + state[i::<span class="hljs-number">4</span>][:i] <span class="hljs-comment"># å·¦ç§»</span><br>            <span class="hljs-keyword">else</span>:<br>                state[i::<span class="hljs-number">4</span>] = state[i::<span class="hljs-number">4</span>][-i:] + state[i::<span class="hljs-number">4</span>][:-i]   <span class="hljs-comment"># å³ç§»</span><br><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">MixColumns</span>(<span class="hljs-params">self, state, inv=<span class="hljs-literal">False</span></span>):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">GFmul_by_2</span>(<span class="hljs-params">n</span>):<br>            <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">            è¿™ä¸ªè®¡ç®—æ˜¯æœ‰æ•°å­¦æ„ä¹‰çš„ï¼Œä¸æ˜¯ç®€å•çš„ä¹˜æ³•è¿ç®—ï¼ŒåŸç†å¯è‡ªè¡Œäº†è§£GFåŸŸçš„å®šä¹‰ã€‚</span><br><span class="hljs-string">            :param n:</span><br><span class="hljs-string">            :return:</span><br><span class="hljs-string">            &quot;&quot;&quot;</span><br>            s = (n &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xff</span><br>            <span class="hljs-keyword">if</span> n &amp; <span class="hljs-number">128</span>:<br>                s ^= <span class="hljs-number">0x1b</span><br>            <span class="hljs-keyword">return</span> s<br><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">GFmul_by_3</span>(<span class="hljs-params">n</span>):<br>            <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">            :param n:</span><br><span class="hljs-string">            :return:</span><br><span class="hljs-string">            &quot;&quot;&quot;</span><br>            <span class="hljs-keyword">return</span> n ^ GFmul_by_2(n)<br><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">mix_column</span>(<span class="hljs-params">c</span>):<br>            <span class="hljs-keyword">return</span> [<br>                GFmul_by_2(c[<span class="hljs-number">0</span>]) ^ GFmul_by_3(c[<span class="hljs-number">1</span>]) ^ c[<span class="hljs-number">2</span>] ^ c[<span class="hljs-number">3</span>],<br>                GFmul_by_2(c[<span class="hljs-number">1</span>]) ^ GFmul_by_3(c[<span class="hljs-number">2</span>]) ^ c[<span class="hljs-number">3</span>] ^ c[<span class="hljs-number">0</span>],<br>                GFmul_by_2(c[<span class="hljs-number">2</span>]) ^ GFmul_by_3(c[<span class="hljs-number">3</span>]) ^ c[<span class="hljs-number">0</span>] ^ c[<span class="hljs-number">1</span>],<br>                GFmul_by_2(c[<span class="hljs-number">3</span>]) ^ GFmul_by_3(c[<span class="hljs-number">0</span>]) ^ c[<span class="hljs-number">1</span>] ^ c[<span class="hljs-number">2</span>]<br>            ]<br><br>        <span class="hljs-keyword">if</span> inv == <span class="hljs-literal">False</span>:<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>, <span class="hljs-number">4</span>):<br>                state[i:i + <span class="hljs-number">4</span>] = mix_column(state[i:i + <span class="hljs-number">4</span>])<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>, <span class="hljs-number">4</span>):<br>                    state[i:i + <span class="hljs-number">4</span>] = mix_column(state[i:i + <span class="hljs-number">4</span>])<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">AddRoundKey</span>(<span class="hljs-params">self, state, key</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            state[i] ^= key[i]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">key_expansion</span>(<span class="hljs-params">self, key</span>):<br>        key = <span class="hljs-built_in">bytearray</span>(key)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span> * <span class="hljs-number">4</span>):<br>            r = key[-<span class="hljs-number">4</span>:]<br>            r = <span class="hljs-built_in">bytearray</span>(r)<br>            <span class="hljs-keyword">if</span> i % <span class="hljs-number">4</span> == <span class="hljs-number">0</span>:  <span class="hljs-comment"># å¯¹ä¸Šä¸€è½®æœ€å4å­—èŠ‚ï¼Œå…ˆå¾ªç¯å·¦ç§»ä¸€ä½ï¼Œå†S-boxç½®æ¢ã€è½®å¸¸æ•°å¼‚æˆ–ï¼Œä»è€Œè®¡ç®—å‡ºå½“å‰æ–°ä¸€è½®æœ€å‰4å­—èŠ‚</span><br>                <span class="hljs-keyword">for</span> j, v <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(r[<span class="hljs-number">1</span>:] + r[:<span class="hljs-number">1</span>]):<br>                    r[j] = <span class="hljs-variable language_">self</span>.S_BOX[v &gt;&gt; <span class="hljs-number">4</span>][v &amp; <span class="hljs-number">0xf</span>] ^ (<span class="hljs-variable language_">self</span>.RCON[i // <span class="hljs-number">4</span>] <span class="hljs-keyword">if</span> j == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>)<br><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>                key.append(key[-<span class="hljs-number">16</span>] ^ r[j])<br><br>        <span class="hljs-keyword">return</span> key<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">self, b, expanded_key</span>):<br>        <span class="hljs-variable language_">self</span>.AddRoundKey(b, expanded_key)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>):<br>            <span class="hljs-variable language_">self</span>.SubBytes(b)<br>            <span class="hljs-variable language_">self</span>.ShiftRows(b)<br>            <span class="hljs-variable language_">self</span>.MixColumns(b)<br>            <span class="hljs-variable language_">self</span>.AddRoundKey(b, expanded_key[i*<span class="hljs-number">16</span>:])<br><br>        <span class="hljs-variable language_">self</span>.SubBytes(b)<br>        <span class="hljs-variable language_">self</span>.ShiftRows(b)<br>        <span class="hljs-variable language_">self</span>.AddRoundKey(b, expanded_key[-<span class="hljs-number">16</span>:])<br>        <span class="hljs-keyword">return</span> b<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">self, b, expanded_key</span>):<br>        <span class="hljs-variable language_">self</span>.AddRoundKey(b, expanded_key[-<span class="hljs-number">16</span>:])<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>            <span class="hljs-variable language_">self</span>.ShiftRows(b, inv=<span class="hljs-literal">True</span>)<br>            <span class="hljs-variable language_">self</span>.SubBytes(b, inv=<span class="hljs-literal">True</span>)<br>            <span class="hljs-variable language_">self</span>.AddRoundKey(b, expanded_key[i*<span class="hljs-number">16</span>:])<br>            <span class="hljs-variable language_">self</span>.MixColumns(b, inv=<span class="hljs-literal">True</span>)<br><br>        <span class="hljs-variable language_">self</span>.ShiftRows(b, inv=<span class="hljs-literal">True</span>)<br>        <span class="hljs-variable language_">self</span>.SubBytes(b, inv=<span class="hljs-literal">True</span>)<br>        <span class="hljs-variable language_">self</span>.AddRoundKey(b, expanded_key)<br>        <span class="hljs-keyword">return</span> b<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">aes_ecb</span>(<span class="hljs-params">self,<span class="hljs-built_in">type</span>, key, msg</span>):<br>        expanded_key = <span class="hljs-variable language_">self</span>.key_expansion(key)<br>        b = <span class="hljs-built_in">bytearray</span>(msg)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> == <span class="hljs-number">0</span>:<br>            b = <span class="hljs-built_in">bytearray</span>(msg+<span class="hljs-string">b&#x27;\x00&#x27;</span>*(<span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(msg)%<span class="hljs-number">16</span>))<br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(b), <span class="hljs-number">16</span>):<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> == <span class="hljs-number">0</span>:<br>                b[i:i+<span class="hljs-number">16</span>] = <span class="hljs-variable language_">self</span>.encrypt(b[i:i+<span class="hljs-number">16</span>], expanded_key)<br>            <span class="hljs-keyword">else</span>:<br>                b[i:i+<span class="hljs-number">16</span>] = <span class="hljs-variable language_">self</span>.decrypt(b[i:i+<span class="hljs-number">16</span>], expanded_key)<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(b)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    key = <span class="hljs-string">b&#x27;sxyz.blog foobar&#x27;</span><br>    aes = AES()<br>    enc = aes.aes_ecb(<span class="hljs-number">0</span>, <span class="hljs-built_in">bytearray</span>(key), <span class="hljs-string">b&#x27;Gonna find the answer, how to clear this up&#x27;</span>)<br>    dec = aes.aes_ecb(<span class="hljs-number">1</span>, <span class="hljs-built_in">bytearray</span>(key), enc)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Encrypted:&#x27;</span>, enc)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Decrypted:&#x27;</span>, dec)<br></code></pre></td></tr></table></figure><p><img src="/pictures/%E5%88%9D%E8%AF%86AES/image-20250705164453636.png" alt="image-20250705164453636"></p><p>â€‹éªŒè¯æˆåŠŸï¼</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;åˆè¯†AES&quot;&gt;&lt;a href=&quot;#åˆè¯†AES&quot; class=&quot;headerlink&quot; title=&quot;åˆè¯†AES&quot;&gt;&lt;/a&gt;åˆè¯†AES&lt;/h1&gt;&lt;p&gt;â€‹	ä½¿ç”¨pythonå®ç°ï¼Œä¸»è¦æ˜¯ç†Ÿæ‚‰åŠ å¯†æµç¨‹ï¼Œå¹¶ä¸”åŠ å¼ºpythonç¼–ç¨‹èƒ½åŠ›ã€‚&lt;a href=&quot;https://sxy</summary>
      
    
    
    
    <category term="CTF" scheme="http://bumak.github.io/categories/CTF/"/>
    
    
    <category term="crypto" scheme="http://bumak.github.io/tags/crypto/"/>
    
  </entry>
  
  <entry>
    <title>XYCTF2025</title>
    <link href="http://bumak.github.io/2025/07/04/XYCTF2025/XYCTF2025RE/"/>
    <id>http://bumak.github.io/2025/07/04/XYCTF2025/XYCTF2025RE/</id>
    <published>2025-07-04T12:25:01.428Z</published>
    <updated>2025-07-04T12:25:39.023Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>â€‹å¤ç°äº†4ã€5ä¸ªé¢˜åï¼Œå°±æ„Ÿè§‰éš¾åº¦æœ‰ç‚¹å¤ªå¤§äº†ï¼Œå¥½å‡ ä¸ªé¢˜éƒ½æ¶‰åŠåˆ°æ²¡å­¦è¿‡çš„æŠ€æœ¯ï¼Œç”±äºæˆ‘çš„WindowsåŸºç¡€å¾ˆå·®ï¼Œæˆ‘çš„çŸ¥è¯†ä¸€ç›´å¾ˆçç¢ï¼Œåšé¢˜çš„æ—¶å€™æ„Ÿè§‰ä¹Ÿåªæ˜¯èƒ½è·‘ä¸ªè„šæœ¬ï¼Œæ€è·¯æ ¹æœ¬æ²¡æœ‰é¢†æ‚Ÿï¼Œè€Œä¸”æ²¡æœ‰æ·±å…¥çš„å­¦ä¹ çŸ¥è¯†ï¼Œæ²¡æœ‰æ”¶è·ï¼Œåªæ˜¯åœ¨åŠ¨æ‰‹èƒ½åŠ›æ–¹é¢å¼ºäº†ä¸€ç‚¹ç‚¹ï¼Œæ€§ä»·æ¯”å¤ªä½äº†ã€‚</p><p>â€‹å­¦ä¹ è·¯çº¿è¿˜æœªç¡®å®šï¼Œæ¯å¤©å°±åªæœ‰å¤ç°é¢˜ç›®ï¼Œå¾ˆéš¾å—ï¼Œçœ‹ä¸åˆ°å‰è¿›çš„æ–¹å‘ã€‚æˆ‘è€ƒé‡ç€ï¼Œæœ¬æ¥è¦è€ƒç ”å¤ä¹ äº†ï¼Œæœ‰å¾ˆå¤šäº‹æƒ…ç­‰ç€æˆ‘å»å¿™ï¼Œæˆ‘éƒ½æ˜¯æ¨äº†å…¶ä»–äº‹æƒ…ï¼Œæ‹¿å‡ºè€ƒè¯•å‘¨åçš„å‡ å¤©æ¥å…¨ç¥è´¯æ³¨çš„å­¦ä¹ åšé¢˜ï¼Œä½†æ˜¯è‡ªå·±è‡ªå­¦é€†å‘è¶Šå¾€åè¶Šéš¾äº†ï¼ŒåŸºç¡€å¤ªé‡è¦äº†ï¼Œå¼€å‘ç»éªŒä¹Ÿå¾ˆé‡è¦ã€‚æˆ‘æ˜¯ä¸æ˜¯éœ€è¦åˆç†çš„è®¡åˆ’ä¸€ä¸‹æˆ‘çš„å­¦ä¹ äº†ï¼Œå‡å°‘æ— è°“åˆ·é¢˜çš„æ—¶é—´ï¼Œä»¥è€ƒç ”å¤ä¹ ä¸ºä¸­å¿ƒï¼Œæœ‰ç©ºä½™å°±åšä¸€åšé¢˜ï¼Œè¿™æ ·ä¹Ÿè®¸å¿ƒæ€ä¼šå¥½å¾ˆå¤šã€‚æˆä¸ºé€†å‘å¤§ä½¬ä¹Ÿä¸æ˜¯ä¸€è¹´è€Œå°±çš„äº‹æƒ…ï¼Œä¸€å¹´ã€ä¸¤å¹´ç”šè‡³æ•°åå¹´ï¼Œè¿™æ˜¯ä¸€ä¸ªçˆ±å¥½ï¼Œæˆ‘è¦å°è¯•æ²¡æœ‰é€†å‘çš„æ—¶æœŸäº†ã€‚</p><p>â€‹â€”â€”2025 06 14</p><hr><h1 id="WARMUP-é™„ä»¶VBS"><a href="#WARMUP-é™„ä»¶VBS" class="headerlink" title="WARMUP(é™„ä»¶VBS)"></a>WARMUP(é™„ä»¶VBS)</h1><p>â€‹è¿™æ˜¯ä¸€ä¸ªvbsç¨‹åºï¼Œé€šè¿‡<code>wscript.echo</code>å‡½æ•°è¾“å‡ºä»£ç ï¼Œä½†æ˜¯è®¾ç½®çš„çª—å£å¤ªå¤§ï¼Œåˆä¸çŸ¥é“æ€ä¹ˆä¿®æ”¹ã€‚äºæ˜¯ä½¿ç”¨pythonè„šæœ¬æå–å‡ºchrå­—æ®µï¼Œåœ¨pythonä¸­è¿è¡Œè¾“å‡ºä»£ç ã€‚</p><blockquote><p>å­¦ä¹ ä¸€ä¸‹<code>vbs</code>è¯­è¨€çš„åŸºç¡€çŸ¥è¯†ï¼šDimæ˜¯å£°æ˜å˜é‡çš„å…³é”®å­—ï¼Œæ•°ç»„æ ‡è¯†ä¸º<code>s(255)</code>å½¢å¼ï¼Œå­—ç¬¦ä¸²ä¸‹æ ‡æ˜¯ä»1å¼€å§‹çš„ã€‚å­—ç¬¦ä¸²æ‹¼æ¥æ˜¯ä½¿ç”¨&amp;ç¬¦å·ï¼ŒRight(str,n)å‡½æ•°è¡¨ç¤ºå¯¹å­—ç¬¦ä¸²ä»å³å‘å·¦å–nä½ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_vbs_chr_obfuscation_and_output</span>(<span class="hljs-params">input_vbs_file, output_txt_file</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    è¯»å– VBScript æ–‡ä»¶ï¼Œæå– chr() å½¢å¼çš„æ··æ·†å­—ç¬¦ï¼Œ</span><br><span class="hljs-string">    è®¡ç®—å‡ºå…¶å¯¹åº”çš„ ASCII ç å€¼å’Œå®é™…å­—ç¬¦ï¼Œ</span><br><span class="hljs-string">    å¹¶å°†è§£ç åçš„ç»“æœè¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡æœ¬æ–‡ä»¶ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Args:</span><br><span class="hljs-string">        input_vbs_file (str): åŒ…å«æ··æ·† VBScript ä»£ç çš„è¾“å…¥æ–‡ä»¶è·¯å¾„ï¼ˆä¾‹å¦‚ &#x27;chal.vbs&#x27;ï¼‰ã€‚</span><br><span class="hljs-string">        output_txt_file (str): å­˜å‚¨è§£ç ç»“æœçš„è¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼ˆä¾‹å¦‚ &#x27;code.txt&#x27;ï¼‰ã€‚</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    decoded_string_parts = []<br><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_vbs_file, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            vbs_code = f.read()<br>    <span class="hljs-keyword">except</span> FileNotFoundError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;é”™è¯¯: è¾“å…¥æ–‡ä»¶ &#x27;<span class="hljs-subst">&#123;input_vbs_file&#125;</span>&#x27; æœªæ‰¾åˆ°ã€‚è¯·ç¡®ä¿æ–‡ä»¶è·¯å¾„æ­£ç¡®ã€‚&quot;</span>)<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è¯»å–æ–‡ä»¶ &#x27;<span class="hljs-subst">&#123;input_vbs_file&#125;</span>&#x27; æ—¶å‘ç”Ÿé”™è¯¯: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-comment"># æ­£åˆ™è¡¨è¾¾å¼æ¥åŒ¹é… chr() ä¸­çš„æ•°å­¦è¡¨è¾¾å¼</span><br>    <span class="hljs-comment"># æ•è·ç»„ ([0-9\s\+\-\*\/\.]+) ä¼šæå– chr() æ‹¬å·å†…çš„å†…å®¹</span><br>    chr_pattern = re.<span class="hljs-built_in">compile</span>(<span class="hljs-string">r&quot;chr\(\s*([0-9\s\+\-\*\/\.]+)\s*\)&quot;</span>, re.IGNORECASE)<br><br>    <span class="hljs-comment"># æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…é¡¹</span><br>    matches = chr_pattern.findall(vbs_code)<br><br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> matches:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;åœ¨ &#x27;<span class="hljs-subst">&#123;input_vbs_file&#125;</span>&#x27; ä¸­æœªæ‰¾åˆ° &#x27;chr()&#x27; å½¢å¼çš„æ··æ·†è¡¨è¾¾å¼ã€‚&quot;</span>)<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output_txt_file, <span class="hljs-string">&#x27;w&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> outfile:<br>            outfile.write(<span class="hljs-string">&quot;æœªåœ¨ VBScript æ–‡ä»¶ä¸­æ‰¾åˆ°å¯è§£ç çš„ &#x27;chr()&#x27; è¡¨è¾¾å¼ã€‚\n&quot;</span>)<br>        <span class="hljs-keyword">return</span><br><br>    <span class="hljs-keyword">for</span> expression_str <span class="hljs-keyword">in</span> matches:<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-comment"># ä½¿ç”¨ eval() è®¡ç®—æ•°å­¦è¡¨è¾¾å¼</span><br>            <span class="hljs-comment"># æ³¨æ„ï¼ševal() å­˜åœ¨å®‰å…¨é£é™©ï¼Œä»…åœ¨ä¿¡ä»»è¾“å…¥æ¥æºæ—¶ä½¿ç”¨</span><br>            ascii_value = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">eval</span>(expression_str))<br><br>            <span class="hljs-comment"># å°† ASCII ç å€¼è½¬æ¢ä¸ºå­—ç¬¦</span><br>            character = <span class="hljs-built_in">chr</span>(ascii_value)<br><br>            decoded_string_parts.append(character)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è­¦å‘Š: è®¡ç®—è¡¨è¾¾å¼ &#x27;<span class="hljs-subst">&#123;expression_str&#125;</span>&#x27; æ—¶å‡ºé”™: <span class="hljs-subst">&#123;e&#125;</span>ã€‚è¯¥éƒ¨åˆ†å°†è¢«è·³è¿‡æˆ–æ˜¾ç¤ºä¸ºé”™è¯¯ã€‚&quot;</span>)<br><br>    <span class="hljs-comment"># å°†æ‰€æœ‰è§£ç å‡ºçš„å­—ç¬¦è¿æ¥èµ·æ¥å½¢æˆæœ€ç»ˆçš„å­—ç¬¦ä¸²</span><br>    decoded_full_string = <span class="hljs-string">&quot;&quot;</span>.join(decoded_string_parts)<br><br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(output_txt_file, <span class="hljs-string">&#x27;w&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> outfile:<br>            outfile.write(decoded_full_string)<br><br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;æˆåŠŸè§£ç å¹¶è¾“å‡ºç»“æœåˆ° &#x27;<span class="hljs-subst">&#123;output_txt_file&#125;</span>&#x27;ã€‚&quot;</span>)<br><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;å†™å…¥æ–‡ä»¶ &#x27;<span class="hljs-subst">&#123;output_txt_file&#125;</span>&#x27; æ—¶å‘ç”Ÿé”™è¯¯: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-comment"># å®šä¹‰è¾“å…¥å’Œè¾“å‡ºæ–‡ä»¶å</span><br>    input_file_name = <span class="hljs-string">r&quot;F:\StudyFiles\CTF\Review_CTF\XYCTF2025\RE\VBS\chal.vbs&quot;</span><br>    output_file_name = <span class="hljs-string">r&quot;F:\StudyFiles\CTF\Review_CTF\XYCTF2025\RE\VBS\code.txt&quot;</span><br>    <span class="hljs-comment"># è°ƒç”¨å‡½æ•°æ‰§è¡Œè§£ç å’Œè¾“å‡º</span><br>    decode_vbs_chr_obfuscation_and_output(input_file_name, output_file_name)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;-&quot;</span> * <span class="hljs-number">40</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å¤„ç†å®Œæˆã€‚&quot;</span>)<br></code></pre></td></tr></table></figure><figure class="highlight vbscript"><table><tr><td class="code"><pre><code class="hljs vbscript">MsgBox <span class="hljs-string">&quot;Dear CTFER. Have fun in XYCTF 2025!&quot;</span><br>flag = <span class="hljs-built_in">InputBox</span>(<span class="hljs-string">&quot;Enter the FLAG:&quot;</span>, <span class="hljs-string">&quot;XYCTF&quot;</span>)<br>wefbuwiue = <span class="hljs-string">&quot;90df4407ee093d309098d85a42be57a2979f1e51463a31e8d15e2fac4e84ea0df622a55c4ddfb535ef3e51e8b2528b826d5347e165912e99118333151273cc3fa8b2b3b413cf2bdb1e8c9c52865efc095a8dd89b3b3cfbb200bbadbf4a6cd4&quot;</span><br>qwfe = <span class="hljs-string">&quot;rc4key&quot;</span><br><br><br><span class="hljs-keyword">Function</span> RunRC(sMessage, strKey)<br>    <span class="hljs-keyword">Dim</span> kLen, i, j, temp, pos, outHex<br>    <span class="hljs-keyword">Dim</span> s(<span class="hljs-number">255</span>), k(<span class="hljs-number">255</span>)<br>    <br>    kLen = <span class="hljs-built_in">Len</span>(strKey)<br>    <span class="hljs-keyword">For</span> i = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> <span class="hljs-number">255</span><br>        s(i) = i<br>        k(i) = <span class="hljs-built_in">Asc</span>(<span class="hljs-built_in">Mid</span>(strKey, (i Mod kLen) + <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)) <br>    <span class="hljs-keyword">Next</span><br>    <br><br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">For</span> i = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> <span class="hljs-number">255</span><br>        j = (j + s(i) + k(i)) Mod <span class="hljs-number">256</span><br>        temp = s(i)<br>        s(i) = s(j)<br>        s(j) = temp<br>    <span class="hljs-keyword">Next</span><br>    <br>   <br>    i = <span class="hljs-number">0</span> : j = <span class="hljs-number">0</span> : outHex = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">For</span> pos = <span class="hljs-number">1</span> <span class="hljs-keyword">To</span> <span class="hljs-built_in">Len</span>(sMessage)<br>        i = (i + <span class="hljs-number">1</span>) Mod <span class="hljs-number">256</span><br>        j = (j + s(i)) Mod <span class="hljs-number">256</span><br>        temp = s(i)<br>        s(i) = s(j)<br>        s(j) = temp<br>        <br>        <br>        <span class="hljs-keyword">Dim</span> plainChar, cipherByte<br>        plainChar = <span class="hljs-built_in">Asc</span>(<span class="hljs-built_in">Mid</span>(sMessage, pos, <span class="hljs-number">1</span>)) <br>        cipherByte = s((s(i) + s(j)) Mod <span class="hljs-number">256</span>) <span class="hljs-keyword">Xor</span> plainChar<br>        outHex = outHex &amp; <span class="hljs-built_in">Right</span>(<span class="hljs-string">&quot;0&quot;</span> &amp; <span class="hljs-built_in">Hex</span>(cipherByte), <span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">Next</span><br>    <br>    RunRC = outHex<br><span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span><br><br><br><span class="hljs-keyword">If</span> <span class="hljs-built_in">LCase</span>(RunRC(flag, qwfe)) = <span class="hljs-built_in">LCase</span>(wefbuwiue) <span class="hljs-keyword">Then</span><br>    MsgBox <span class="hljs-string">&quot;Congratulations! Correct FLAG!&quot;</span><br><span class="hljs-keyword">Else</span><br>    MsgBox <span class="hljs-string">&quot;Wrong flag.&quot;</span><br><span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span><br></code></pre></td></tr></table></figure><p>â€‹èµ›åšå¨å­ä¸€æŠŠæ¢­å“ˆRC4ï¼Œå°±è¡Œäº†ã€‚å¾—åˆ°<code>flag&#123;We1c0me_t0_XYCTF_2025_reverse_ch@lleng3_by_th3_w@y_p3cd0wn&#39;s_chall_is_r3@lly_gr3@t_&amp;_fuN!&#125;</code></p><p>æŒ‰è¦æ±‚å¾—åˆ°md5å€¼ã€‚</p><h1 id="Moon"><a href="#Moon" class="headerlink" title="Moon"></a>Moon</h1><p>â€‹è¿™æ˜¯ä¸€ä¸ªpydæ–‡ä»¶çš„é€†å‘ï¼Œå¯¹æˆ‘æ¥è¯´ç›¸å½“éš¾ã€‚.pydæ–‡ä»¶æ˜¯PythonåŠ¨æ€æ¨¡å—çš„ä¸€ç§ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªWindowsä¸‹çš„åŠ¨æ€é“¾æ¥åº“ï¼ˆDLLï¼‰æ–‡ä»¶ï¼Œä½†æ˜¯æ‰©å±•åä¸º.pydï¼Œä»¥ä¾¿Pythonèƒ½å¤Ÿè¯†åˆ«å’Œå¯¼å…¥ã€‚</p><p>â€‹.pydæ–‡ä»¶è¿è¡Œä½ ä½¿ç”¨cæˆ–c++ç­‰ç¼–è¯‘å‹è¯­è¨€ç¼–å†™Pythonæ¨¡å—ï¼Œç„¶åä½œä¸ºä¸€ä¸ªæ¨¡å—ä¾›pythonå¯¼å…¥å’Œè°ƒç”¨ï¼Œå°±åƒæ˜¯æ™®é€šçš„Pythonæ–‡ä»¶ä¸€æ ·ã€‚</p><p>â€‹pythonç‰ˆæœ¬å¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥åœ¨IDAçš„å­—ç¬¦ä¸²ä¸­çœ‹åˆ°ã€‚</p><p>â€‹ä¸çŸ¥é“è¯¥æ€ä¹ˆè§£ï¼Œç›´æ¥çœ‹æºç ä¹Ÿåªèƒ½ççŒœï¼Œè€Œä¸”æºç å®¡è®¡è¿˜å¾—ç†Ÿæ‚‰å¯¹åº”çš„å‡½æ•°æ‰å¥½è·Ÿè¸ªï¼Œæˆ‘éƒ½æ²¡ç»éªŒã€‚</p><h3 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h3><p>â€‹ç›´æ¥å­¦ä¹ WPï¼Œçœ‹åˆ°äº†ï¼Œå¤šåŠä¹Ÿæ˜¯çŒœçš„ï¼Œæ²¡æœ‰å¾ˆé€»è¾‘æ€§çš„åˆ†æã€‚</p><p><img src="/pictures/XYCTF2025/image-20250609102034211.png" alt="image-20250609102034211"></p><p>â€‹çŒœæµ‹å°±æ˜¯éšæœºæ•°ç”Ÿæˆæµå¯†é’¥ï¼Œç„¶åå¼‚æˆ–åŠ å¯†ã€‚æ‰€ä»¥å»æ‰¾å¯†æ–‡å°±è¡Œã€‚</p><p>â€‹ä½†æ˜¯å¼€å§‹æˆ‘ä½¿ç”¨Cå†™çš„è„šæœ¬ç”Ÿæˆçš„éšæœºæ•°ä¸å¯¹åŠ²ï¼Œç„¶åçœ‹äº†ä¸€çœ¼WPï¼Œæ˜¯pythonçš„éšæœºæ•°ç”Ÿæˆã€‚</p><p>â€‹ç°åœ¨æˆ‘çš„è„šæœ¬åŸºæœ¬ä¸Šéƒ½æ˜¯AIå†™çš„äº†ï¼Œè™½ç„¶æ­£ç¡®ç‡é«˜ã€é€Ÿåº¦å¿«ï¼Œä½†æ˜¯æˆ‘è‡ªèº«çš„ä»£ç èƒ½åŠ›ä¸‹é™äº†å¾ˆå¤šã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve_xor_cipher</span>():<br>    seed = <span class="hljs-number">1131796</span><br>    random.seed(seed)<br><br>    enflag = <span class="hljs-string">&quot;426b87abd0ceaa3c58761bbb0172606dd8ab064491a2a76af9a93e1ae56fa84206a2f7&quot;</span><br><br>    decoded_bytes = <span class="hljs-built_in">bytearray</span>()<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(enflag), <span class="hljs-number">2</span>):<br>        hex_byte_str = enflag[i:i + <span class="hljs-number">2</span>]<br><br>        en_byte = <span class="hljs-built_in">int</span>(hex_byte_str, <span class="hljs-number">16</span>)<br><br>        random_num = random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)<br><br>        decoded_byte = en_byte ^ random_num<br><br>        decoded_bytes.append(decoded_byte)<br><br>    <span class="hljs-keyword">try</span>:<br>        flag = decoded_bytes.decode(<span class="hljs-string">&#x27;ascii&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Decoded Flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">except</span> UnicodeDecodeError:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Decoded Flag (might contain non-ASCII characters):&quot;</span>)<br>        <span class="hljs-built_in">print</span>(decoded_bytes.<span class="hljs-built_in">hex</span>())<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    solve_xor_cipher()<br></code></pre></td></tr></table></figure><p>â€‹ä¸‹é¢æ˜¯æˆ‘å†™çš„ï¼ŒAIè¿˜æ˜¯å¤ªæ ¼å¼åŒ–äº†ã€‚</p><figure class="highlight py"><table><tr><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> random<br>enflag = <span class="hljs-string">&quot;426b87abd0ceaa3c58761bbb0172606dd8ab064491a2a76af9a93e1ae56fa84206a2f7&quot;</span><br>seed = <span class="hljs-number">1131796</span><br>random.seed(seed)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(enflag),<span class="hljs-number">2</span>):<br>    data = <span class="hljs-built_in">int</span>(enflag[i:i+<span class="hljs-number">2</span>], <span class="hljs-number">16</span>)<br>    data = data ^ random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(data), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><h1 id="Dragon"><a href="#Dragon" class="headerlink" title="Dragon"></a>Dragon</h1><p>â€‹æ‹¿åˆ°ä¸€ä¸ª<code>bc</code>åç¼€æ–‡ä»¶ï¼Œå…ˆä½¿ç”¨è™šæ‹Ÿæœºä¸­çš„LLVMç¯å¢ƒå°†æ–‡ä»¶åæ±‡ç¼–ä¸º.llæ–‡ä»¶ï¼Œæ‰€ä½¿ç”¨å‘½ä»¤ä¸º<code>llvm -dis filename</code>ã€‚<strong>.ll</strong>æ–‡ä»¶æ˜¯LLVMçš„ä¸­é—´è¡¨ç¤ºè¯­è¨€ï¼Œæ˜¯ä¸€ç§ä½¿ç”¨æ–‡æœ¬æ–¹å¼å†™çš„LLVMä¸­é—´ä»£ç ï¼Œå¯è§†ä½œâ€œ<strong>é«˜çº§æ±‡ç¼–</strong>â€ã€‚</p><p>â€‹ç„¶åä½¿ç”¨<code>sublime</code>æ‰“å¼€åæ±‡ç¼–æ–‡ä»¶ï¼Œçœ‹åˆ°mainå‡½æ•°ï¼Œ</p><p>â€‹è¿™æ˜¯<code>for</code>å¾ªç¯çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œå¾ªç¯å­—ç¬¦ä¸²é•¿åº¦é™¤ä»¥2æ¬¡ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250609204824158.png" alt="image-20250609204824158"></p><p>â€‹çœ‹åˆ°forå¾ªç¯çš„ä¸»ä½“ï¼Œå…ˆè°ƒç”¨calculate_crc64_directå‡½æ•°ï¼Œç„¶åå°†è¿”å›å€¼å’Œå¯†æ–‡æ¯”å¯¹ï¼ŒæŒ‰ç…§encåç§°å³å¯æ‰¾åˆ°å¯†æ–‡ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250609204928826.png" alt="image-20250609204928826"></p><p><img src="/pictures/XYCTF2025/image-20250609205043827.png" alt="image-20250609205043827"></p><p>â€‹ä¸‹ä¸€æ­¥çœ‹ä¸€ä¸‹CRC64å‡½æ•°ï¼Œçœ‹çœ‹å…·ä½“çš„è®¡ç®—è¿‡ç¨‹ï¼Œå…¶å®å°±æ˜¯è¿™ä¸ªç®—æ³•ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250609205917935.png" alt="image-20250609205917935"></p><p>â€‹å¾—åˆ°ç»éªŒï¼Œ<code>for.cond</code>è¡¨ç¤ºå¾ªç¯çš„åˆå§‹åŒ–ï¼Œ<code>for.body</code>ä»£è¡¨å¾ªç¯çš„ä¸»è¦é€»è¾‘ï¼Œ<code>for.inc</code>è¡¨ç¤ºç¨‹åºå¾ªç¯å‚æ•°çš„è‡ªåŠ ï¼Œ<code>for.end</code>è¡¨ç¤ºå¾ªç¯çš„è§£é‡Šï¼Œå¾ˆå¥½ç†è§£ã€‚</p><p>â€‹æ•´ä½“çš„æ€è·¯å°±æ˜¯ä½¿ç”¨åŒæ ·çš„è®¡ç®—CRC64çš„æ–¹æ³•ï¼Œå»çˆ†ç ´ç»“æœã€‚è¿™ä¸ªcrc64è®¡ç®—å‡½æ•°çš„æ±‡ç¼–ä»£ç éå¸¸ç®€å•ï¼Œçœ‹æ±‡ç¼–ä»£ç å®Œå…¨èƒ½ä¸€ç‚¹ç‚¹å†™å‡ºæ¥ï¼Œä¹Ÿä¸é•¿ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-type">uint64_t</span> <span class="hljs-title function_">calculate_crc64</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">uint8_t</span> *data, <span class="hljs-type">int</span> len)</span><br>&#123;<br>    <span class="hljs-type">uint64_t</span> crc = <span class="hljs-number">0xFFFFFFFFFFFFFFFF</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; len; i++)<br>    &#123;<br>        crc ^= (<span class="hljs-type">uint64_t</span>)(data[i]) &lt;&lt; <span class="hljs-number">56</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>; j&lt;<span class="hljs-number">8</span>; j++)<br>        &#123;<br>            <span class="hljs-keyword">if</span>(crc &amp; <span class="hljs-number">0x8000000000000000</span>)<br>            &#123;<br>                crc = (crc &lt;&lt; <span class="hljs-number">1</span>) ^ <span class="hljs-number">0x42F0E1EBA9EA3693</span>;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                crc &lt;&lt;= <span class="hljs-number">1</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> crc ^ <span class="hljs-number">0xFFFFFFFFFFFFFFFF</span>;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">uint64_t</span> enc[] = &#123;<span class="hljs-number">0xDC63E34E419F7B47</span>,<span class="hljs-number">0x31EF8D4E7B2BFC6</span>,<span class="hljs-number">0x12D62FBC625FD89E</span>,<span class="hljs-number">0x83E8B6E1CC5755E8</span>,<span class="hljs-number">0xfc7bb1eb2ab665cc</span>,<span class="hljs-number">0x9382ca1b2a62d96b</span>,<span class="hljs-number">0xb1fff8a07673c387</span>,<span class="hljs-number">0xda81627388e05e1</span>,<span class="hljs-number">0x9ef1e61ae8d0aab7</span>,<span class="hljs-number">0x92783fd2e7f26145</span>,<span class="hljs-number">0x63c97ca1f56fe60b</span>,<span class="hljs-number">0x9bd3a8b043b73aab</span>&#125;;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">size_t</span> i =<span class="hljs-number">0</span>; i&lt;<span class="hljs-keyword">sizeof</span>(enc)/<span class="hljs-keyword">sizeof</span>(enc[<span class="hljs-number">0</span>]); i++)<br>    &#123;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">uint16_t</span> j=<span class="hljs-number">0x2020</span>; j&lt;<span class="hljs-number">0xffff</span>; j++)<br>        &#123;<br>            <span class="hljs-type">uint64_t</span> crc = calculate_crc64((<span class="hljs-type">uint8_t</span>*)&amp;j, <span class="hljs-number">2</span>);<br>            <span class="hljs-keyword">if</span>(crc == enc[i])<br>            &#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c%c&quot;</span>, j&amp;<span class="hljs-number">0xff</span>, j&gt;&gt;<span class="hljs-number">8</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="Lake"><a href="#Lake" class="headerlink" title="Lake"></a>Lake</h1><p>â€‹æ— å£³ï¼ŒPascalè¯­è¨€ç¼–å†™ï¼ŒIDAåç¼–è¯‘å‡ºæ¥éƒ½æ˜¯æ— ç¬¦å·è§£æçš„ï¼Œåªèƒ½åŠ¨æ€åˆ†æäº†ã€‚</p><p>â€‹æ ¹æ®ç¨‹åºè¿è¡Œæ—¶çš„ç‰¹å®šï¼Œå¯ä»¥è·Ÿè¸ªsleepå‡½æ•°åˆ°ä¸»é€»è¾‘å‡½æ•°<code>sub_100001B70</code>ã€‚è°ƒè¯•æ—¶å¾ˆå®¹æ˜“å‘ç°<code>sub_10000C760</code>æ˜¯è¾“å‡ºè¯­å¥çš„åœ°æ–¹ï¼Œ<code>sub_10000CB90</code>æ˜¯è¾“å…¥flagçš„åœ°æ–¹ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250610123522648.png" alt="image-20250610123522648"></p><p>â€‹ç¬¬ä¸€æ¬¡åŠ å¯†ï¼Œæ˜¯åˆ©ç”¨ä¸€ä¸ªç±»ä¼¼è™šæ‹Ÿæœºä¸€æ ·çš„ä¸œè¥¿è¿›è¡Œå¤„ç†ï¼Œå–å‡ºæ“ä½œç å‘ç°ï¼Œåªæœ‰128ä¸‰ç§æ“ä½œï¼Œå…¶ä»–éƒ½æ²¡ä½¿ç”¨ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250610123623209.png" alt="image-20250610123623209"></p><p>â€‹ç¬¬äºŒæ¬¡åŠ å¯†å‡½æ•°<code>sub_1000019B0</code>ï¼Œé‡Œé¢å¾ˆæ¸…æ™°çš„ç§»ä½åŠ å¯†ï¼Œç­‰ä»·äº<code>v5[i] = (v3[i+1] &lt;&lt; 3) | (v3[i+2] &gt;&gt; 5)</code></p><p><code>v5[i+1] =  (v3[i+2]&lt;&lt;3) | (v3[i+3] &gt;&gt; 5)</code> <code>v5[i+2] =  (v3[i+3]&lt;&lt;3) | (v3[i] &gt;&gt; 5)</code> <code>v5[i+3] =  (v3[i]&lt;&lt;3) | (v3[i+1] &gt;&gt; 5)</code>ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250610123756995.png" alt="image-20250610123756995"></p><p>â€‹æœ€åè¿›è¡Œå¯†æ–‡æ¯”å¯¹ï¼Œé€»è¾‘å¾ˆæ¸…æ™°äº†ï¼Œå†™è§£å¯†è„šæœ¬å°±è¡Œäº†ã€‚è¿™é¢˜å”¯ä¸€çš„éš¾ç‚¹å°±åœ¨äºæ— ç¬¦å·è§£æï¼Œå‡½æ•°åå’Œå˜é‡å·¨ä¸‘é™‹ï¼Œéœ€è¦è‡ªå·±åŠ¨è°ƒ+é™æ€åˆ†æï¼Œä½“åŠ›æ´»ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250610124019036.png" alt="image-20250610124019036"></p><p>â€‹æˆ‘åˆå¤ä¹ åˆ°äº†Cè¯­è¨€çš„é•¿åº¦è®¡ç®—å‡½æ•°â€”â€”<code>sizeof</code>å‡½æ•°ã€‚</p><blockquote><p>â€‹<code>sizeof</code>è¿”å›æ“ä½œæ•°æ‰€å ç”¨çš„å†…å­˜ç©ºé—´å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œä¸€ä¸ªå­—èŠ‚é€šå¸¸æ˜¯8ä½ï¼Œä½†æ˜¯å…·ä½“ä½æ•°ç”±CHAR_BITå®å®šä¹‰ï¼ˆåœ¨limits.hä¸­ï¼‰ã€‚è¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´å‹ï¼Œé€šå¸¸æ˜¯size_tç±»å‹ï¼Œå®šä¹‰åœ¨<code>&lt;stddef.h&gt;</code>ï¼ˆä»¥åŠå…¶ä»–æ ‡å‡†å¤´æ–‡ä»¶ï¼‰ä¸­ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨<code>sizeof</code>çš„ç»“æœæ—¶ï¼Œæ¨èä½¿ç”¨<code>size_t</code>ç±»å‹å˜é‡æ¥å­˜å‚¨ã€‚</p><p>â€‹å½“<code>sizeof</code>åº”ç”¨äºä¸€ä¸ªè¡¨è¾¾å¼æ—¶ï¼Œå®ƒåªä¼šåˆ†æè¡¨è¾¾å¼çš„ç±»å‹ï¼Œè€Œä¸ä¼šçœŸæ­£æ‰§è¡Œè¯¥è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ï¼Œ<code>sizeof(x++)</code>ä¼šè¿”å›<code>x</code>çš„ç±»å‹å¤§å°ï¼Œä½†<code>x</code>çš„å€¼ä¸ä¼šå› æ­¤è€Œå¢åŠ ã€‚å”¯ä¸€çš„ä¾‹å¤–æ˜¯å½“æ“ä½œæ•°æ˜¯ä¸€ä¸ªå¯å˜é•¿åº¦æ•°ç»„ï¼ˆVLAï¼‰æ—¶ï¼Œå®ƒä¼šåœ¨è¿è¡Œæ—¶æ±‚å€¼ã€‚</p><p>â€‹<code>sizeof(myArray)</code>: è¿”å›æ•´ä¸ªæ•°ç»„çš„æ€»å­—èŠ‚æ•°ï¼Œå³<code>å…ƒç´ æ•°é‡ * å•ä¸ªå…ƒç´ å¤§å°</code>ã€‚è®¡ç®—æ•°ç»„å…ƒç´ ä¸ªæ•°: <code>sizeof(myArray) / sizeof(myArray[0])</code> æ˜¯è®¡ç®—æ•°ç»„å…ƒç´ ä¸ªæ•°çš„å¸¸ç”¨æ–¹æ³•ã€‚</p><p>â€‹<code>sizeof(myPointer)</code>: è¿”å›æŒ‡é’ˆæœ¬èº«åœ¨å†…å­˜ä¸­å ç”¨çš„å­—èŠ‚æ•°ï¼Œè€Œä¸æ˜¯å®ƒæ‰€æŒ‡å‘çš„æ•°æ®çš„å¤§å°ã€‚è¿™é€šå¸¸æ˜¯4æˆ–8å­—èŠ‚ï¼Œå–å†³äºç³»ç»Ÿæ¶æ„ï¼ˆ32ä½æˆ–64ä½ï¼‰ã€‚</p></blockquote><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><br><span class="hljs-comment">//è¿™ä¸ªå‡½æ•°éœ€è¦ä¸»åŠ¨ä¼ å…¥opræ•°ç»„çš„å¤§å°ï¼Œå› ä¸ºåœ¨è¯¥å‡½æ•°é‡Œé¢sizeof(opr)åªèƒ½å¾—åˆ°8ï¼Œä¹Ÿå°±æ˜¯æŒ‡é’ˆçš„å†…å­˜ç©ºé—´å¤§å°ã€‚</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt1</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> *enc, <span class="hljs-type">uint8_t</span> *opr, <span class="hljs-type">int</span> opr_len)</span><br>&#123;<br>    <span class="hljs-type">uint8_t</span> a,b,c;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=opr_len<span class="hljs-number">-3</span>; i&gt;=<span class="hljs-number">0</span> ;i-=<span class="hljs-number">3</span>)<br>    &#123;<br>        a = opr[i];<br>        b = opr[i+<span class="hljs-number">1</span>];<br>        c = opr[i+<span class="hljs-number">2</span>];<br>        <span class="hljs-comment">//è¿™é‡Œæ˜¯å› ä¸ºå·²ç»åˆ†æå‡ºäº†æ“ä½œç åªæœ‰1ã€2ã€8ä¸‰ç§ç±»å‹ã€‚</span><br>        <span class="hljs-keyword">switch</span>(a)<br>        &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>                enc[b] -= c;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>                enc[b] += c;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">8</span>:<br>                enc[b] ^= c;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">default</span>:<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Error\n&quot;</span>);<br>                <span class="hljs-keyword">break</span>;     <br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">decrypt2</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> *enc, <span class="hljs-type">uint8_t</span> *flag)</span><br>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">40</span>;i+=<span class="hljs-number">4</span>)<br>    &#123;<br>        flag[i] = (enc[i+<span class="hljs-number">3</span>]&gt;&gt;<span class="hljs-number">3</span>) | (enc[i+<span class="hljs-number">2</span>]&lt;&lt;<span class="hljs-number">5</span>);<br>        flag[i+<span class="hljs-number">1</span>] = (enc[i]&gt;&gt;<span class="hljs-number">3</span>) | (enc[i+<span class="hljs-number">3</span>]&lt;&lt;<span class="hljs-number">5</span>);<br>        flag[i+<span class="hljs-number">2</span>] = (enc[i+<span class="hljs-number">1</span>]&gt;&gt;<span class="hljs-number">3</span>) | (enc[i]&lt;&lt;<span class="hljs-number">5</span>);<br>        flag[i+<span class="hljs-number">3</span>] = (enc[i+<span class="hljs-number">2</span>]&gt;&gt;<span class="hljs-number">3</span>) | (enc[i+<span class="hljs-number">1</span>]&lt;&lt;<span class="hljs-number">5</span>);<br>    &#125;<br>&#125;<br><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">uint8_t</span> enc[] = &#123;<span class="hljs-number">74</span>, <span class="hljs-number">171</span>, <span class="hljs-number">155</span>, <span class="hljs-number">27</span>, <span class="hljs-number">97</span>, <span class="hljs-number">177</span>, <span class="hljs-number">243</span>, <span class="hljs-number">50</span>, <span class="hljs-number">209</span>, <span class="hljs-number">139</span>, <span class="hljs-number">115</span>, <span class="hljs-number">235</span>, <span class="hljs-number">233</span>, <span class="hljs-number">115</span>, <span class="hljs-number">107</span>, <span class="hljs-number">34</span>, <span class="hljs-number">129</span>, <span class="hljs-number">131</span>, <span class="hljs-number">35</span>, <span class="hljs-number">49</span>, <span class="hljs-number">203</span>, <span class="hljs-number">27</span>, <span class="hljs-number">34</span>, <span class="hljs-number">251</span>, <span class="hljs-number">37</span>, <span class="hljs-number">194</span>, <span class="hljs-number">129</span>, <span class="hljs-number">129</span>, <span class="hljs-number">115</span>, <span class="hljs-number">34</span>, <span class="hljs-number">250</span>, <span class="hljs-number">3</span>, <span class="hljs-number">156</span>, <span class="hljs-number">75</span>, <span class="hljs-number">91</span>, <span class="hljs-number">73</span>, <span class="hljs-number">151</span>, <span class="hljs-number">135</span>, <span class="hljs-number">219</span>, <span class="hljs-number">81</span>&#125;;<br>    <span class="hljs-type">uint8_t</span> opr_sequ[] = &#123;<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">1</span>, <span class="hljs-number">26</span>, <span class="hljs-number">85</span>, <span class="hljs-number">1</span>, <span class="hljs-number">35</span>, <span class="hljs-number">12</span>, <span class="hljs-number">2</span>, <span class="hljs-number">14</span>, <span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">27</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">6</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">27</span>, <span class="hljs-number">14</span>, <span class="hljs-number">2</span>, <span class="hljs-number">25</span>, <span class="hljs-number">3</span>, <span class="hljs-number">2</span>, <span class="hljs-number">26</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">12</span>, <span class="hljs-number">2</span>, <span class="hljs-number">12</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">37</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">32</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">9</span>, <span class="hljs-number">12</span>, <span class="hljs-number">8</span>, <span class="hljs-number">26</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">13</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">15</span>, <span class="hljs-number">2</span>, <span class="hljs-number">10</span>, <span class="hljs-number">14</span>, <span class="hljs-number">1</span>, <span class="hljs-number">16</span>, <span class="hljs-number">7</span>, <span class="hljs-number">1</span>, <span class="hljs-number">12</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">34</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">21</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">39</span>, <span class="hljs-number">126</span>, <span class="hljs-number">2</span>, <span class="hljs-number">7</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">8</span>, <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">1</span>, <span class="hljs-number">34</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2</span>, <span class="hljs-number">18</span>, <span class="hljs-number">8</span>, <span class="hljs-number">2</span>, <span class="hljs-number">25</span>, <span class="hljs-number">9</span>, <span class="hljs-number">8</span>, <span class="hljs-number">14</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">8</span>, <span class="hljs-number">8</span>, <span class="hljs-number">27</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">13</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">13</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">23</span>, <span class="hljs-number">12</span>, <span class="hljs-number">8</span>, <span class="hljs-number">34</span>, <span class="hljs-number">14</span>, <span class="hljs-number">2</span>, <span class="hljs-number">18</span>, <span class="hljs-number">52</span>, <span class="hljs-number">1</span>, <span class="hljs-number">38</span>, <span class="hljs-number">119</span>&#125;;<br>    <span class="hljs-type">uint8_t</span> flag[<span class="hljs-number">40</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    decrypt2(enc,flag);<br>    decrypt1(flag,opr_sequ,<span class="hljs-keyword">sizeof</span>(opr_sequ));<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">40</span>;i++)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,flag[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="CrackMe"><a href="#CrackMe" class="headerlink" title="CrackMe"></a>CrackMe</h1><p>â€‹IDAæŸ¥çœ‹ï¼ŒéMFCç¨‹åºï¼Œxspyæ‰¾ä¸åˆ°æŒ‰é”®å¯¹åº”çš„å‡½æ•°ã€‚è°ƒè¯•çš„æ—¶å€™ï¼Œæäº¤æŒ‰é”®è¢«ç¦æ­¢äº†ï¼Œéœ€è¦æ‰¾åˆ°å¯¹åº”çš„é€»è¾‘patchæ‰ã€‚</p><p>â€‹çœ‹WPï¼Œè€ƒå¯Ÿçš„æ–¹å‘æ˜¯win32çª—å£ç¨‹åºé€†å‘ã€åè°ƒè¯•å¯¹æŠ—ã€å¤šçº¿ç¨‹å’Œå¼‚æ­¥ã€‚</p><p>â€‹csä¸œè¥¿ï¼Œx64dbgä¸€ç‚¹è°ƒè¯•ä¸æ˜ç™½ã€‚è‡ªå·±é‡æ–°å­¦win32çª—å£ç¨‹åºã€‚åšäº†ï¼Œä¹Ÿé€†ä¸äº†ï¼Œä»£ç æ··æ·†çš„å¤ªæ¶å¿ƒäº†ï¼Œidaçš„æ’ä»¶è¿˜è£…ä¸ä¸Šï¼Œx64dbgä¸€ç›´åˆ°ä¸äº†checkç‚¹ï¼Œä¸€ç‚¹ç‚¹æˆ‘å´©æºƒäº†ï¼ŒèŠ±å‡ å¤©éƒ½è§£å†³ä¸äº†çš„é¢˜ï¼Œè¯´æ˜è¿™æ ¹æœ¬ä¸æ˜¯æˆ‘è¿™ä¸ªé˜¶æ®µèƒ½æŒæ¡çš„é¢˜ã€‚è¿˜æ˜¯ä¸­ç­‰!</p><hr><p>â€‹æ—¢ç„¶æ— æ³•è‡ªå·±å®Œæ•´å¤ç°ï¼Œæ›´åˆ«æè‡ªå·±æ€è€ƒï¼Œé‚£ä¹ˆæˆ‘å°±è·Ÿç€å­¦ä¸€ä¸‹ç®—æ³•é€†å‘å§ï¼Œé”»ç‚¼ä¸€ä¸‹ä»£ç èƒ½åŠ›å¥½äº†ã€‚æ€»ä¸èƒ½ä¸€ç›´å¡ä½å§ï¼Œåé¢çš„è·¯è¿˜å¾ˆè¿œï¼Œæˆ‘ä¸èƒ½åœ¨è¿™é‡Œåœä¸‹ã€‚</p><hr><h3 id="å¤ç°-1"><a href="#å¤ç°-1" class="headerlink" title="å¤ç°"></a>å¤ç°</h3><p>â€‹é‡Œé¢æœ‰ä¸ªç‰¹åˆ«æœ‰ç‰¹å¾çš„å‡½æ•°ï¼Œæˆ‘çœ‹ä¸æ‡‚ï¼Œç›´æ¥å…¨éƒ¨é—®AIã€‚</p><blockquote><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul><li><strong>è¿™æ®µä»£ç æ˜¯ä¸€ä¸ªåŸºäºå¯¼å‡ºå‡½æ•°åå“ˆå¸Œçš„åŠ¨æ€APIè°ƒç”¨å™¨ã€‚</strong></li><li>å®ƒé€šè¿‡å‚æ•°å†³å®šåŠ è½½å“ªä¸ªç³»ç»ŸDLLï¼Œä»è¯¥DLLå¯¼å‡ºè¡¨é‡Œç”¨å“ˆå¸ŒåŒ¹é…å‡½æ•°åï¼Œæ‰¾åˆ°å‡½æ•°æŒ‡é’ˆåè°ƒç”¨ï¼Œå¹¶è¿”å›ç»“æœã€‚</li><li>ç»“åˆå‰é¢ä»£ç ï¼Œæ„Ÿè§‰æ•´ä½“ä»£ç æ˜¯ä¸ªå¤æ‚çš„â€œä¿æŠ¤å£³â€æˆ–â€œè‡ªå®šä¹‰APIè°ƒç”¨å±‚â€ï¼Œæœ‰é˜²è°ƒè¯•+åŠ¨æ€è°ƒç”¨æœºåˆ¶ã€‚</li></ul></blockquote><p><img src="/pictures/XYCTF2025/image-20250612220942036.png" alt="image-20250612220942036"></p><p>â€‹å› ä¸ºè¿™ä¸ªé˜²æŠ¤ï¼Œæ‰€ä»¥æˆ‘ä»¬æ— æ³•é€šè¿‡å¯¼å…¥å‡½æ•°çš„äº¤å‰å¼•ç”¨æ¥åˆ‡å…¥ç¨‹åºï¼Œä½†æ˜¯æˆ‘ç†è§£äº†è¿™ä¸ªæ˜¯è°ƒç”¨å‡½æ•°çš„åœ°æ–¹ï¼ˆè€Œä¸”å¯åŒæ ·åŠŸèƒ½ï¼Œç›¸åŒçš„ä»£ç çš„è¿™ä¸ªå‡½æ•°æœ‰å¾ˆå¤šåç§°ï¼ŒIDAåœ¨ä¸åŒåœ°æ–¹éƒ½å–äº†ä¸åŒçš„åç§°ï¼Œä½†æ˜¯ç‚¹è¿›å»çœ‹æ˜¯æä¸ºç›¸ä¼¼çš„ï¼‰ï¼ŒçŸ¥é“äº†è¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œæˆ‘ä»¥å‰ä¸äº†è§£ï¼Œåªä¼šæ„Ÿåˆ°å¤ªå¤æ‚ï¼Œå¤ªå¯æ€•ã€‚ç°åœ¨æˆ‘æ˜ç™½äº†ï¼Œå®ƒè°ƒç”¨å‡½æ•°çš„åŠŸèƒ½åï¼Œæˆ‘å°±æ¸…æ¥šç±»ä¼¼ä¸‹é¢è¿™ç§ä»£ç å°±æ˜¯å‡½æ•°è°ƒç”¨ï¼Œè°ƒç”¨çš„å°±æ˜¯<code>sub_7FF6D7FF1320</code>ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250612222609678.png" alt="image-20250612222609678"></p><p>â€‹è€Œåƒè¿™ç§ï¼Œå°±ä¸æ˜¯ä»€ä¹ˆä¸»è¦æ“ä½œï¼Œå¤šåŠæ˜¯èµ‹å€¼å•Šç­‰ç­‰æ— å…³çš„åº•å±‚æ“ä½œã€‚</p><p><img src="/pictures/XYCTF2025/image-20250612222847321.png" alt="image-20250612222847321"></p><p>â€‹åƒ<code>_CheckForDebuggerJustMyCode</code>è¿™ç§å‡½æ•°ï¼Œæˆ‘å¼€å§‹ä»¥ä¸ºæ˜¯å‡ºé¢˜äººå†™çš„åè°ƒè¯•éƒ¨åˆ†ï¼Œæ£€ç´¢æ‰çŸ¥é“æ˜¯ç³»ç»Ÿä»£ç ï¼Œåº”è¯¥æ˜¯VSç¨‹åºè‡ªå¸¦çš„ä¸€ä¸ªå’Œè°ƒè¯•æœ‰å…³çš„ä¸œè¥¿ï¼Œæˆ‘è¿˜æ²¡æœ‰æ·±å…¥äº†è§£ï¼Œä½†æ˜¯ç¡®è®¤äº†è¿™ä¸ªå‡½æ•°å¯¹åšé¢˜æ— å½±å“ã€‚</p><p>â€‹æˆ‘ä¹Ÿæ‰¾åˆ°äº†PEBçš„åè°ƒè¯•ä»£ç ï¼Œæ˜¯åœ¨<code>TlsCallback_0</code>â€”â€”<code>sub_7FF6D7FF2370</code>â€”â€”<code>sub_7FF6D7FF1320</code>â€”â€”<code>sub_7FF6D7FEE7E0</code>â€”â€”<code>sub_7FF6D7FEF280</code>å¤„ï¼Œæ˜¯çœŸéš¾æ‰¾å•Šï¼Œæˆ‘è¿˜æ˜¯è·Ÿç€å¤§ä½¬ç¿»æºç æ‰¾åˆ°çš„ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250612222252435.png" alt="image-20250612222252435"></p><p>â€‹æœ¬ä»¥ä¸ºç®€å•çš„ä¸‹ä¸ªæ–­ç‚¹ï¼Œæ”¹ä¸€æ¬¡æ ‡å¿—ä½å°±èƒ½ç»•è¿‡ï¼Œä½†æ˜¯æƒ…å†µå¹¶éå¦‚æ­¤ï¼ŒIDAç›´æ¥å¡æ­»äº†ï¼Œè¿é€€å‡ºå‘½ä»¤éƒ½æ²¡æœ‰æ•ˆæœäº†ï¼Œè°ƒè¯•å™¨ç›´æ¥ä¸èµ·ä½œç”¨äº†ã€‚çœ‹WPå­¦ä¹ åˆ°ï¼Œè¿™æ˜¯é¢˜ç›®ä½¿â½¤<code>NtSetInformationThread</code> è®¾ç½®çº¿ç¨‹å±æ€§ <code>ThreadHideFromDebugger</code> æ¥ä¸è®©è°ƒè¯•å™¨è°ƒè¯•ï¼Œæœ‰å…³çš„ç‰¹å¾å°±æ˜¯è¿™ä¸ª<code>0x11</code>æ•°ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250613194110999.png" alt="image-20250613194110999"></p><p>â€‹è¿™æ¬¡çš„åè°ƒè¯•å¯¹æŠ—ï¼Œç»•è¿‡æŠ€å·§æ˜¯ä¿®æ”¹æ ‡å¿—0x11ä¸ºå…¶ä»–å€¼ï¼ŒåŒæ—¶ä¿®æ”¹å¯¹<code>BeingDebugded</code>çš„åˆ¤æ–­é€»è¾‘ï¼Œå¯ä»¥å°†ç­‰äº1æ”¹ä¸º0ï¼Œå¦‚ä¸‹å›¾å³å¯ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250613195146488.png" alt="image-20250613195146488"></p><p>â€‹<code>sub_7FF65DFA1320</code>å‡½æ•°è¿˜æœ‰è°ƒç”¨<code>NtSetInformationThread</code>å‡½æ•°çš„åœ°æ–¹ï¼Œä¿®æ”¹ä¸ºå…¶ä»–å€¼ï¼Œå¦‚ä¸‹å›¾å³å¯ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250613195106815.png" alt="image-20250613195106815"></p><p>â€‹ä¿®æ”¹å¦‚ä¸Šä¸‰ä¸ªä½ç½®åï¼Œå°±èƒ½æˆåŠŸæ­£å¸¸è°ƒè¯•äº†ï¼ŒæŒ‰é”®ä¸ä¼šâ€œç°â€äº†ã€‚<strong>(â‰§âˆ€â‰¦)ã‚</strong>ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥æ„‰å¿«çš„è°ƒè¯•ç¨‹åºäº†ï¼ŒæŸ¥çœ‹åŠ å¯†éªŒè¯é€»è¾‘äº†ã€‚</p><hr><p>â€‹<code>sub_7FF65DF9E7E0</code>å‡½æ•°ç›¸å½“äº<code>WndProc</code>å‡½æ•°ï¼Œæ–­ç‚¹ä¸‹åœ¨è¿™ä¸ªå‡½æ•°å¤´å‡ è¡Œå³å¯ï¼Œè¾“å…¥åé¦–å…ˆè¿›å…¥case0ï¼Œè¿™é‡Œæ˜¯åˆå§‹åŒ–çª—å£ï¼Œç„¶åå†è¿›å…¥case4ï¼Œå†è¿›å…¥case5ï¼Œåé¢è¿˜å¾—å›case0éªŒè¯æœ€åä¸€æ­¥ï¼Œæ€»å…±åˆ†ä¸‰ä¸ªéƒ¨åˆ†éªŒè¯ã€‚</p><p>â€‹åœ¨case4é‡Œé¢ï¼Œå¼‚æˆ–åŠ å¯†éªŒè¯å˜›ï¼Œæ£€æŸ¥å‰5ä½çš„<code>flag&#123;</code>ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250613203657885.png" alt="image-20250613203657885"></p><p>â€‹çœ‹åˆ°case5é‡Œé¢è°ƒç”¨çš„å‡½æ•°ï¼Œå…ˆç”Ÿæˆä¸€ä¸ªå›ºå®šçš„æ•°ç»„ï¼Œä¹Ÿå°±æ˜¯æ›¿æ¢boxï¼Œç„¶åé€šè¿‡å¼‚æˆ–ã€æ›¿æ¢ç­‰æ“ä½œè¿›è¡ŒåŠ å¯†ï¼Œæœ€åè¿›è¡Œæ¯”è¾ƒã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥æ‹¿åˆ°è¿™ä¸ªæ›¿æ¢ç›’ï¼Œç„¶åçˆ†ç ´è¿™ä¸ƒä½ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250613204251325.png" alt="image-20250613204251325"></p><p>â€‹æå–æ•°æ®IDAè„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">data = []<br>base = <span class="hljs-number">0xF33A8FF0C0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>    addr = base + i * <span class="hljs-number">4</span><br>    data.append(get_wide_dword(addr))<br><br><span class="hljs-built_in">print</span>(data)<br></code></pre></td></tr></table></figure><p>â€‹çˆ†ç ´è„šæœ¬ï¼Œå¾—åˆ°ç¬¬äºŒæ®µæ˜¯<code>moshui_</code>ã€‚è¿˜è®©æˆ‘åˆå¤ä¹ äº†ä¸€épythonè¿ç®—ç¬¦çš„åŸºç¡€çŸ¥è¯†ï¼Œå¥½å¥½å¥½ï¼</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">box = [<span class="hljs-number">0</span>, <span class="hljs-number">3233442988</span>, <span class="hljs-number">1510334235</span>, <span class="hljs-number">2596254647</span>, <span class="hljs-number">3020668470</span>, <span class="hljs-number">1957810842</span>, <span class="hljs-number">3993919789</span>, <span class="hljs-number">783551873</span>, <span class="hljs-number">3009837615</span>, <span class="hljs-number">1943803523</span>, <span class="hljs-number">3915621684</span>, <span class="hljs-number">702138776</span>, <span class="hljs-number">124634137</span>, <span class="hljs-number">3352799413</span>, <span class="hljs-number">1567103746</span>, <span class="hljs-number">2647816110</span>, <span class="hljs-number">3183342109</span>, <span class="hljs-number">2097651377</span>, <span class="hljs-number">3887607046</span>, <span class="hljs-number">654459306</span>, <span class="hljs-number">162941995</span>, <span class="hljs-number">3373015175</span>, <span class="hljs-number">1404277552</span>, <span class="hljs-number">2466906012</span>, <span class="hljs-number">249268274</span>, <span class="hljs-number">3462522014</span>, <span class="hljs-number">1423857449</span>, <span class="hljs-number">2489596805</span>, <span class="hljs-number">3134207492</span>, <span class="hljs-number">2053790376</span>, <span class="hljs-number">3772115231</span>, <span class="hljs-number">544179635</span>, <span class="hljs-number">2685067897</span>, <span class="hljs-number">1622183637</span>, <span class="hljs-number">4195302754</span>, <span class="hljs-number">984961486</span>, <span class="hljs-number">335633487</span>, <span class="hljs-number">3569037539</span>, <span class="hljs-number">1308918612</span>, <span class="hljs-number">2394877944</span>, <span class="hljs-number">325883990</span>, <span class="hljs-number">3554079994</span>, <span class="hljs-number">1231636301</span>, <span class="hljs-number">2312317921</span>, <span class="hljs-number">2808555104</span>, <span class="hljs-number">1742555852</span>, <span class="hljs-number">4251122043</span>, <span class="hljs-number">1037604311</span>, <span class="hljs-number">498536548</span>, <span class="hljs-number">3708648648</span>, <span class="hljs-number">1202900863</span>, <span class="hljs-number">2265490387</span>, <span class="hljs-number">2847714898</span>, <span class="hljs-number">1762050814</span>, <span class="hljs-number">4089016649</span>, <span class="hljs-number">855842277</span>, <span class="hljs-number">2932959819</span>, <span class="hljs-number">1852507879</span>, <span class="hljs-number">4107580752</span>, <span class="hljs-number">879679996</span>, <span class="hljs-number">450548861</span>, <span class="hljs-number">3663771857</span>, <span class="hljs-number">1088359270</span>, <span class="hljs-number">2154129354</span>, <span class="hljs-number">2607071921</span>, <span class="hljs-number">1541320221</span>, <span class="hljs-number">3244367274</span>, <span class="hljs-number">31158534</span>, <span class="hljs-number">795835527</span>, <span class="hljs-number">4023717931</span>, <span class="hljs-number">1969922972</span>, <span class="hljs-number">3050360624</span>, <span class="hljs-number">671266974</span>, <span class="hljs-number">3904427058</span>, <span class="hljs-number">1913087877</span>, <span class="hljs-number">2998733609</span>, <span class="hljs-number">2617837224</span>, <span class="hljs-number">1555261956</span>, <span class="hljs-number">3322730931</span>, <span class="hljs-number">112637215</span>, <span class="hljs-number">651767980</span>, <span class="hljs-number">3865271296</span>, <span class="hljs-number">2094854071</span>, <span class="hljs-number">3160834843</span>, <span class="hljs-number">2463272602</span>, <span class="hljs-number">1382605366</span>, <span class="hljs-number">3369554305</span>, <span class="hljs-number">141376813</span>, <span class="hljs-number">2512341635</span>, <span class="hljs-number">1426400815</span>, <span class="hljs-number">3485111704</span>, <span class="hljs-number">251722036</span>, <span class="hljs-number">565507253</span>, <span class="hljs-number">3775830041</span>, <span class="hljs-number">2075208622</span>, <span class="hljs-number">3138078466</span>, <span class="hljs-number">997073096</span>, <span class="hljs-number">4224994404</span>, <span class="hljs-number">1634467795</span>, <span class="hljs-number">2714866559</span>, <span class="hljs-number">2405801726</span>, <span class="hljs-number">1340076626</span>, <span class="hljs-number">3579855333</span>, <span class="hljs-number">366619977</span>, <span class="hljs-number">2282248935</span>, <span class="hljs-number">1219638859</span>, <span class="hljs-number">3524101628</span>, <span class="hljs-number">314042704</span>, <span class="hljs-number">1006888145</span>, <span class="hljs-number">4240017533</span>, <span class="hljs-number">1711684554</span>, <span class="hljs-number">2797360998</span>, <span class="hljs-number">2262029013</span>, <span class="hljs-number">1181335161</span>, <span class="hljs-number">3705015758</span>, <span class="hljs-number">476864866</span>, <span class="hljs-number">853044451</span>, <span class="hljs-number">4066508879</span>, <span class="hljs-number">1759359992</span>, <span class="hljs-number">2825379668</span>, <span class="hljs-number">901097722</span>, <span class="hljs-number">4111451222</span>, <span class="hljs-number">1873836001</span>, <span class="hljs-number">2936675149</span>, <span class="hljs-number">2176718540</span>, <span class="hljs-number">1090812512</span>, <span class="hljs-number">3686517207</span>, <span class="hljs-number">453092731</span>, <span class="hljs-number">3988292385</span>, <span class="hljs-number">755167117</span>, <span class="hljs-number">3082640442</span>, <span class="hljs-number">1996959894</span>, <span class="hljs-number">1504918807</span>, <span class="hljs-number">2567524795</span>, <span class="hljs-number">62317068</span>, <span class="hljs-number">3272380064</span>, <span class="hljs-number">1591671054</span>, <span class="hljs-number">2657392034</span>, <span class="hljs-number">81470997</span>, <span class="hljs-number">3294710457</span>, <span class="hljs-number">3939845944</span>, <span class="hljs-number">711928724</span>, <span class="hljs-number">2966460451</span>, <span class="hljs-number">1886057615</span>, <span class="hljs-number">1342533948</span>, <span class="hljs-number">2428444048</span>, <span class="hljs-number">167816743</span>, <span class="hljs-number">3401237131</span>, <span class="hljs-number">3826175754</span>, <span class="hljs-number">615818150</span>, <span class="hljs-number">3188396049</span>, <span class="hljs-number">2125561021</span>, <span class="hljs-number">3814918931</span>, <span class="hljs-number">601450431</span>, <span class="hljs-number">3110523912</span>, <span class="hljs-number">2044508324</span>, <span class="hljs-number">1466479909</span>, <span class="hljs-number">2547177865</span>, <span class="hljs-number">225274430</span>, <span class="hljs-number">3453421202</span>, <span class="hljs-number">1303535960</span>, <span class="hljs-number">2366115316</span>, <span class="hljs-number">397917763</span>, <span class="hljs-number">3608007407</span>, <span class="hljs-number">4189708142</span>, <span class="hljs-number">956543938</span>, <span class="hljs-number">2747007093</span>, <span class="hljs-number">1661365465</span>, <span class="hljs-number">4275313527</span>, <span class="hljs-number">1047427035</span>, <span class="hljs-number">2765210732</span>, <span class="hljs-number">1684777152</span>, <span class="hljs-number">1256170817</span>, <span class="hljs-number">2321926637</span>, <span class="hljs-number">282753626</span>, <span class="hljs-number">3495958262</span>, <span class="hljs-number">4027552581</span>, <span class="hljs-number">817233897</span>, <span class="hljs-number">2852801630</span>, <span class="hljs-number">1789927666</span>, <span class="hljs-number">1141124467</span>, <span class="hljs-number">2227061215</span>, <span class="hljs-number">503444072</span>, <span class="hljs-number">3736837828</span>, <span class="hljs-number">1131014506</span>, <span class="hljs-number">2211677638</span>, <span class="hljs-number">426522225</span>, <span class="hljs-number">3654703837</span>, <span class="hljs-number">4150417244</span>, <span class="hljs-number">936918000</span>, <span class="hljs-number">2909243463</span>, <span class="hljs-number">1843258603</span>, <span class="hljs-number">1994146192</span>, <span class="hljs-number">3060149564</span>, <span class="hljs-number">752459403</span>, <span class="hljs-number">3965973031</span>, <span class="hljs-number">3268935590</span>, <span class="hljs-number">40735498</span>, <span class="hljs-number">2563907773</span>, <span class="hljs-number">1483230225</span>, <span class="hljs-number">3317316543</span>, <span class="hljs-number">83908371</span>, <span class="hljs-number">2680153252</span>, <span class="hljs-number">1594198024</span>, <span class="hljs-number">1907459465</span>, <span class="hljs-number">2970347813</span>, <span class="hljs-number">733239954</span>, <span class="hljs-number">3943577150</span>, <span class="hljs-number">3412177805</span>, <span class="hljs-number">198958881</span>, <span class="hljs-number">2439277718</span>, <span class="hljs-number">1373503546</span>, <span class="hljs-number">2137656763</span>, <span class="hljs-number">3218104599</span>, <span class="hljs-number">628085408</span>, <span class="hljs-number">3855990284</span>, <span class="hljs-number">2013776290</span>, <span class="hljs-number">3099436302</span>, <span class="hljs-number">570562233</span>, <span class="hljs-number">3803740693</span>, <span class="hljs-number">3423369108</span>, <span class="hljs-number">213261112</span>, <span class="hljs-number">2517215375</span>, <span class="hljs-number">1454621731</span>, <span class="hljs-number">3604390889</span>, <span class="hljs-number">376229701</span>, <span class="hljs-number">2362670322</span>, <span class="hljs-number">1281953886</span>, <span class="hljs-number">1658658271</span>, <span class="hljs-number">2724688243</span>, <span class="hljs-number">953729732</span>, <span class="hljs-number">4167216744</span>, <span class="hljs-number">1706088902</span>, <span class="hljs-number">2768942442</span>, <span class="hljs-number">1068828381</span>, <span class="hljs-number">4279200369</span>, <span class="hljs-number">3518719984</span>, <span class="hljs-number">285281116</span>, <span class="hljs-number">2344532203</span>, <span class="hljs-number">1258607687</span>, <span class="hljs-number">1802195444</span>, <span class="hljs-number">2882616664</span>, <span class="hljs-number">829329135</span>, <span class="hljs-number">4057260611</span>, <span class="hljs-number">3747672002</span>, <span class="hljs-number">534414190</span>, <span class="hljs-number">2238001369</span>, <span class="hljs-number">1172266101</span>, <span class="hljs-number">3624741851</span>, <span class="hljs-number">414664567</span>, <span class="hljs-number">2181625024</span>, <span class="hljs-number">1119000684</span>, <span class="hljs-number">1812370925</span>, <span class="hljs-number">2898065729</span>, <span class="hljs-number">906185462</span>, <span class="hljs-number">4139329114</span>]<br><br>enc = [<span class="hljs-number">0x46A95BAD</span>,<span class="hljs-number">0x1CAC84B6</span>,<span class="hljs-number">0xA67CB2B2</span>,<span class="hljs-number">0x32188937</span>,<span class="hljs-number">0x4872D39F</span>,<span class="hljs-number">0xF2A2E59B</span>,<span class="hljs-number">0x11B94D2</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">127</span>):<br>        tmp = j ^ <span class="hljs-number">0x79</span> &amp; <span class="hljs-number">0xff</span><br>        <br>        <span class="hljs-comment">#æ›´å¥½çš„é€‰æ‹©æ˜¯ ((~box[tmp] ^ 0xB0E0E879) &amp; 0xffffffff)ï¼Œä¸‹é¢è¿™ä¸ªæ˜¯ä¸ªæœ‰å†—ä½™çš„ä»£ç ã€‚</span><br>        <span class="hljs-comment">#å› ä¸ºpythonä¸­ä¼˜å…ˆçº§ï¼šå–å&gt;ä¸&gt;å¼‚æˆ–ï¼Œä½¿ç”¨ä¸‹é¢çš„ä»£ç æ˜¯å…ˆç®—æ‹¬å·ï¼Œç„¶åç®—åé¢çš„ä¸ï¼Œç„¶åæ‰ç®—å¼‚æˆ–çš„ã€‚</span><br>        <span class="hljs-comment">#ä¹Ÿå°±æ˜¯è¯´æœ€åçš„ä¸æ ¹æœ¬æ²¡èµ·ä½œç”¨ï¼Œé™åˆ¶ä¸äº†å‰é¢æ‹¬å·çš„æ•°ï¼Œå®ƒç›´æ¥å’Œ0xB0E0E879çˆ†äº†ã€‚</span><br>        <span class="hljs-keyword">if</span> ((~box[tmp] &amp; <span class="hljs-number">0xffffffff</span>) ^ <span class="hljs-number">0xB0E0E879</span> &amp; <span class="hljs-number">0xffffffff</span>) == enc[i]:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(j), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>â€‹</p><p>â€‹æœ€åä¸€æ®µï¼Œé€šè¿‡æ–­ç‚¹ï¼Œä¹Ÿå¯ä»¥å‘ç°ï¼Œæ˜¯åœ¨TLSå›è°ƒå‡½æ•°è¿™é‡Œçš„ä¸€ä¸ªçº¿ç¨‹é‡Œé¢ï¼Œå®ƒä¸€ç›´åœ¨while(1)å¾ªç¯ï¼Œç­‰å¾…å‰ä¸¤éƒ¨åˆ†éªŒè¯é€šè¿‡æ‰ä¼šè¿›å…¥è¿›å…¥ç¬¬ä¸‰éƒ¨åˆ†çš„éªŒè¯çš„ï¼Œè¿™é‡Œåº”è¯¥æ˜¯é€šè¿‡å…±äº«å…¨å±€å˜é‡æ ‡å¿—ä½å’Œifè¯­å¥æ¥å®ç°è¿™ä¸ªæ•ˆæœçš„ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250613215606861.png" alt="image-20250613215606861"></p><p>â€‹ä¸‹é¢ç”Ÿæˆäº†ä¸€ä¸ª128ä½çš„å¯†é’¥ï¼Œä¸€ä¸ªå¾ªç¯5ä¸€ä¸ªå¾ªç¯7ï¼Œå¯ä»¥çŒœåˆ°æ˜¯ä½¿ç”¨å‰ä¸¤æ®µflagæ¥ç”Ÿæˆå¯†é’¥å•Šã€‚ç›´æ¥æå–å°±å¯ä»¥äº†ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250613220005888.png" alt="image-20250613220005888"></p><p><img src="/pictures/XYCTF2025/image-20250613220123411.png" alt="image-20250613220123411"></p><p>â€‹åé¢åˆåœ¨éªŒè¯æœ«å°¾æ˜¯ä¸æ˜¯}ç¬¦å·ï¼Œä¸æ˜¯å°±è¿›å…¥ifï¼Œå¤„ç†é”™è¯¯é€»è¾‘ã€‚åŒæ—¶æ ¹æ®+28è¿™ä¸ªåç§»ï¼Œæˆ‘ä»¬èƒ½å¤ŸçŒœåˆ°flagæ€»é•¿åº¦ä¸º29ä¸ªå­—èŠ‚ï¼Œå‰é¢12ä¸ªå·²ç»éªŒè¯ï¼Œåé¢å†éªŒè¯17ä¸ªå­—ç¬¦ï¼ˆåŒ…æ‹¬ç»“å°¾çš„}ï¼‰ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250613220329827.png" alt="image-20250613220329827"></p><p>â€‹çœ‹åˆ°åé¢çš„åŠ å¯†å‡½æ•°å’ŒéªŒè¯ä»£ç ï¼Œv7å°±æ˜¯å¯†æ–‡ã€‚<code>sub_7FF65DFA1500</code>å‚æ•°æœ‰å¯†é’¥ã€è¾“å…¥çš„flagã€é•¿åº¦ã€è¾“å‡ºç¼“å†²åŒºã€‚</p><p><img src="/pictures/XYCTF2025/image-20250613220636641.png" alt="image-20250613220636641"></p><p>â€‹é‡Œé¢åˆæœ‰ä¸€äº›å¯†é’¥æ“ä½œï¼Œç„¶ååŠ å¯†0x10000æ¬¡ï¼Œä½†æ˜¯å› ä¸ºåŠ å¯†çš„æ˜æ–‡å’Œå¯†æ–‡ä¿å­˜åœ¨ä¸¤ä¸ªä¸åŒçš„æ•°ç»„ï¼Œæ‰€ä»¥å…¶å®å’ŒåŠ å¯†ä¸€æ¬¡ä¸€æ ·ï¼Œæ¯æ¬¡éƒ½æ˜¯åŒæ ·çš„ç»“æœå†™å…¥å¯†æ–‡çš„ç¼“å†²åŒºã€‚</p><p><img src="/pictures/XYCTF2025/image-20250613220840974.png" alt="image-20250613220840974"></p><p>â€‹å­¦ä¹ å¤§ä½¬çš„WPï¼Œé‡Œé¢æ˜¯ä¸€ä¸ªIDEAåŠ å¯†ç®—æ³•ï¼Œæˆ‘æ˜¯èœé¸¡ï¼Œéƒ½æ²¡æœ‰ç¢°åˆ°è¿‡è¿™ä¸ªç®—æ³•ï¼Œå¥½å¥½å­¦å­¦ã€‚çƒ¦çš„ä¸€æ‰¹ï¼Œæ€ä¹ˆç°åœ¨è¿™ä¸ªAIè¿˜æ˜¯è¿™ä¹ˆç…ç¬”å•Šï¼Œç»™å‡ºçš„ä»£ç å…¨æ˜¯é”™çš„ï¼Œè¶Šæ”¹è¶Šå·®ï¼Œåƒåœ¾ç‹—å±AIã€‚</p><p>â€‹å­¦ä¹ ä¸‹å¤§ä½¬çš„ä»£ç å§ï¼Œæˆ‘ç°åœ¨è¿˜æ˜¯ä¸ä¼šå†™ä»£ç ï¼Œç®—æ³•éƒ½ä¸å¤ªèƒ½ç†è§£ï¼Œæ•°å­¦èƒ½åŠ›å¾ˆå·®äº†ï¼Œä»£ç èƒ½åŠ›ä¹Ÿå¾ˆå·®äº†ã€‚æˆ‘æ„Ÿè§‰æˆ‘è¦å»ç»ƒç®—æ³•é¢˜äº†ï¼Œå“ˆå“ˆï¼Œæœ‰æ—¶é—´ä¸€å®šå»ç»ƒå¥½å§ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bitset&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cmath&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;windows.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><br><span class="hljs-keyword">typedef</span> bitset&lt;16&gt; code;<br><span class="hljs-keyword">typedef</span> bitset&lt;128&gt; key;<br><br>bitset&lt;16&gt; sub_key[<span class="hljs-number">52</span>];<br>bitset&lt;16&gt; inv_sub_key[<span class="hljs-number">52</span>];<br><br><span class="hljs-function">code <span class="hljs-title">XOR</span><span class="hljs-params">(code code_1, code code_2)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> code_1 ^ code_2;<br>&#125;<br><br><span class="hljs-function">code <span class="hljs-title">Plus</span><span class="hljs-params">(code code_1, code code_2)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> tmp = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++)<br>    &#123;<br>        tmp += code_1[i] * <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, i) + code_2[i] * <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, i);<br>    &#125;<br>    tmp %= <span class="hljs-number">65536</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bitset</span>&lt;<span class="hljs-number">16</span>&gt;(tmp);<br>&#125;<br><br><span class="hljs-function">code <span class="hljs-title">invPlus</span><span class="hljs-params">(code code_in)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> tmp = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++)<br>        tmp += code_in[i] * <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, i);<br>    tmp = <span class="hljs-number">65536</span> - tmp;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bitset</span>&lt;<span class="hljs-number">16</span>&gt;(tmp);<br>&#125;<br><br><span class="hljs-function">code <span class="hljs-title">Times</span><span class="hljs-params">(code code_1, code code_2)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">long</span> <span class="hljs-type">long</span> tmp_1 = <span class="hljs-number">0</span>, tmp_2 = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++)<br>    &#123;<br>        tmp_1 += code_1[i] * <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, i);<br>        tmp_2 += code_2[i] * <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, i);<br>    &#125;<br>    <span class="hljs-keyword">if</span> (tmp_1 == <span class="hljs-number">0</span>)<br>        tmp_1 = <span class="hljs-number">65536</span>;<br>    <span class="hljs-keyword">if</span> (tmp_2 == <span class="hljs-number">0</span>)<br>        tmp_2 = <span class="hljs-number">65536</span>;<br>    <span class="hljs-type">long</span> <span class="hljs-type">long</span> tmp = (tmp_1 * tmp_2) % <span class="hljs-number">65537</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bitset</span>&lt;<span class="hljs-number">16</span>&gt;(tmp == <span class="hljs-number">65536</span> ? <span class="hljs-number">0</span> : tmp);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Exgcd</span><span class="hljs-params">(<span class="hljs-type">int</span> a, <span class="hljs-type">int</span> b, <span class="hljs-type">int</span> &amp;x, <span class="hljs-type">int</span> &amp;y)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (!b)<br>        x = <span class="hljs-number">1</span>, y = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">Exgcd</span>(b, a % b, y, x), y -= a / b * x;<br>&#125;<br><br><span class="hljs-function">code <span class="hljs-title">invTimes</span><span class="hljs-params">(code code_in)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> tmp = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++)<br>        tmp += code_in[i] * <span class="hljs-built_in">pow</span>(<span class="hljs-number">2</span>, i);<br>    <span class="hljs-type">int</span> x, y;<br>    <span class="hljs-type">int</span> p = <span class="hljs-number">65537</span>;<br>    <span class="hljs-built_in">Exgcd</span>(tmp, p, x, y);<br>    x = (x % p + p) % p;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bitset</span>&lt;<span class="hljs-number">16</span>&gt;(x);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">subkeys_get</span><span class="hljs-params">(code keys_input[<span class="hljs-number">8</span>])</span></span><br><span class="hljs-function"></span>&#123;<br>    key keys;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++)<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">16</span>; j++)<br>            keys[j + <span class="hljs-number">16</span> * i] = keys_input[<span class="hljs-number">7</span> - i][j];<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++)<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">16</span>; j++)<br>            sub_key[i][<span class="hljs-number">15</span> - j] = keys[<span class="hljs-number">127</span> - (j + <span class="hljs-number">16</span> * i)];<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++)<br>    &#123;<br>        key tmp_keys = keys &gt;&gt; <span class="hljs-number">103</span>;<br>        keys = (keys &lt;&lt; <span class="hljs-number">25</span>) | tmp_keys;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = (<span class="hljs-number">8</span> + <span class="hljs-number">8</span> * i); j &lt; (<span class="hljs-number">8</span> * (i + <span class="hljs-number">2</span>)); j++)<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt; <span class="hljs-number">16</span>; k++)<br>                sub_key[j][<span class="hljs-number">15</span> - k] = keys[<span class="hljs-number">127</span> - (k + <span class="hljs-number">16</span> * (j - <span class="hljs-number">8</span> - <span class="hljs-number">8</span> * i))];<br>    &#125;<br><br>    key tmp_keys = keys &gt;&gt; <span class="hljs-number">103</span>;<br>    keys = (keys &lt;&lt; <span class="hljs-number">25</span>) | tmp_keys;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">48</span>; i &lt; <span class="hljs-number">52</span>; i++)<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">16</span>; j++)<br>            sub_key[i][<span class="hljs-number">15</span> - j] = keys[<span class="hljs-number">127</span> - (j + <span class="hljs-number">16</span> * (i - <span class="hljs-number">48</span>))];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">inv_subkeys_get</span><span class="hljs-params">(code sub_key[<span class="hljs-number">52</span>])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">6</span>; i &lt; <span class="hljs-number">48</span>; i += <span class="hljs-number">6</span>)<br>    &#123;<br>        inv_sub_key[i] = <span class="hljs-built_in">invTimes</span>(sub_key[<span class="hljs-number">48</span> - i]);<br>        inv_sub_key[i + <span class="hljs-number">1</span>] = <span class="hljs-built_in">invPlus</span>(sub_key[<span class="hljs-number">50</span> - i]);<br>        inv_sub_key[i + <span class="hljs-number">2</span>] = <span class="hljs-built_in">invPlus</span>(sub_key[<span class="hljs-number">49</span> - i]);<br>        inv_sub_key[i + <span class="hljs-number">3</span>] = <span class="hljs-built_in">invTimes</span>(sub_key[<span class="hljs-number">51</span> - i]);<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">48</span>; i += <span class="hljs-number">6</span>)<br>    &#123;<br>        inv_sub_key[i + <span class="hljs-number">4</span>] = sub_key[<span class="hljs-number">46</span> - i];<br>        inv_sub_key[i + <span class="hljs-number">5</span>] = sub_key[<span class="hljs-number">47</span> - i];<br>    &#125;<br><br>    inv_sub_key[<span class="hljs-number">0</span>] = <span class="hljs-built_in">invTimes</span>(sub_key[<span class="hljs-number">48</span>]);<br>    inv_sub_key[<span class="hljs-number">1</span>] = <span class="hljs-built_in">invPlus</span>(sub_key[<span class="hljs-number">49</span>]);<br>    inv_sub_key[<span class="hljs-number">2</span>] = <span class="hljs-built_in">invPlus</span>(sub_key[<span class="hljs-number">50</span>]);<br>    inv_sub_key[<span class="hljs-number">3</span>] = <span class="hljs-built_in">invTimes</span>(sub_key[<span class="hljs-number">51</span>]);<br><br>    inv_sub_key[<span class="hljs-number">48</span>] = <span class="hljs-built_in">invTimes</span>(sub_key[<span class="hljs-number">0</span>]);<br>    inv_sub_key[<span class="hljs-number">49</span>] = <span class="hljs-built_in">invPlus</span>(sub_key[<span class="hljs-number">1</span>]);<br>    inv_sub_key[<span class="hljs-number">50</span>] = <span class="hljs-built_in">invPlus</span>(sub_key[<span class="hljs-number">2</span>]);<br>    inv_sub_key[<span class="hljs-number">51</span>] = <span class="hljs-built_in">invTimes</span>(sub_key[<span class="hljs-number">3</span>]);<br>&#125;<br><br><span class="hljs-function">bitset&lt;64&gt; <span class="hljs-title">dencrypt</span><span class="hljs-params">(bitset&lt;<span class="hljs-number">64</span>&gt; cipher)</span></span><br><span class="hljs-function"></span>&#123;<br>    bitset&lt;16&gt; I_1, I_2, I_3, I_4;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++)<br>    &#123;<br>        I_1[<span class="hljs-number">15</span> - i] = cipher[<span class="hljs-number">63</span> - i];<br>        I_2[<span class="hljs-number">15</span> - i] = cipher[<span class="hljs-number">47</span> - i];<br>        I_3[<span class="hljs-number">15</span> - i] = cipher[<span class="hljs-number">31</span> - i];<br>        I_4[i] = cipher[i];<br>    &#125;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">48</span>; i += <span class="hljs-number">6</span>)<br>    &#123;<br>        bitset&lt;16&gt; tmp_1 = <span class="hljs-built_in">Times</span>(inv_sub_key[i], I_1);<br>        bitset&lt;16&gt; tmp_2 = <span class="hljs-built_in">Plus</span>(inv_sub_key[i + <span class="hljs-number">1</span>], I_2);<br>        bitset&lt;16&gt; tmp_3 = <span class="hljs-built_in">Plus</span>(inv_sub_key[i + <span class="hljs-number">2</span>], I_3);<br>        bitset&lt;16&gt; tmp_4 = <span class="hljs-built_in">Times</span>(inv_sub_key[i + <span class="hljs-number">3</span>], I_4);<br>        bitset&lt;16&gt; tmp_5 = <span class="hljs-built_in">XOR</span>(tmp_1, tmp_3);<br>        bitset&lt;16&gt; tmp_6 = <span class="hljs-built_in">XOR</span>(tmp_2, tmp_4);<br>        bitset&lt;16&gt; tmp_7 = <span class="hljs-built_in">Times</span>(inv_sub_key[i + <span class="hljs-number">4</span>], tmp_5);<br>        bitset&lt;16&gt; tmp_8 = <span class="hljs-built_in">Plus</span>(tmp_6, tmp_7);<br>        bitset&lt;16&gt; tmp_9 = <span class="hljs-built_in">Times</span>(tmp_8, inv_sub_key[i + <span class="hljs-number">5</span>]);<br>        bitset&lt;16&gt; tmp_10 = <span class="hljs-built_in">Plus</span>(tmp_7, tmp_9);<br>        I_1 = <span class="hljs-built_in">XOR</span>(tmp_1, tmp_9);<br>        I_2 = <span class="hljs-built_in">XOR</span>(tmp_3, tmp_9);<br>        I_3 = <span class="hljs-built_in">XOR</span>(tmp_2, tmp_10);<br>        I_4 = <span class="hljs-built_in">XOR</span>(tmp_4, tmp_10);<br>    &#125;<br>    bitset&lt;16&gt; Y_1 = <span class="hljs-built_in">Times</span>(I_1, inv_sub_key[<span class="hljs-number">48</span>]);<br>    bitset&lt;16&gt; Y_2 = <span class="hljs-built_in">Plus</span>(I_3, inv_sub_key[<span class="hljs-number">49</span>]);<br>    bitset&lt;16&gt; Y_3 = <span class="hljs-built_in">Plus</span>(I_2, inv_sub_key[<span class="hljs-number">50</span>]);<br>    bitset&lt;16&gt; Y_4 = <span class="hljs-built_in">Times</span>(I_4, inv_sub_key[<span class="hljs-number">51</span>]);<br><br>    bitset&lt;64&gt; plaint;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">16</span>; i++)<br>    &#123;<br>        plaint[i] = Y_4[i];<br>        plaint[i + <span class="hljs-number">16</span>] = Y_3[i];<br>        plaint[i + <span class="hljs-number">32</span>] = Y_2[i];<br>        plaint[i + <span class="hljs-number">48</span>] = Y_1[i];<br>    &#125;<br>    <span class="hljs-keyword">return</span> plaint;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> box1[] = &#123;<br>        <span class="hljs-number">0x00000000</span>, <span class="hljs-number">0xC0BA6CAC</span>, <span class="hljs-number">0x5A05DF1B</span>, <span class="hljs-number">0x9ABFB3B7</span>, <span class="hljs-number">0xB40BBE36</span>, <span class="hljs-number">0x74B1D29A</span>,<br>        <span class="hljs-number">0xEE0E612D</span>, <span class="hljs-number">0x2EB40D81</span>, <span class="hljs-number">0xB3667A2F</span>, <span class="hljs-number">0x73DC1683</span>, <span class="hljs-number">0xE963A534</span>, <span class="hljs-number">0x29D9C998</span>, <span class="hljs-number">0x076DC419</span>, <span class="hljs-number">0xC7D7A8B5</span>,<br>        <span class="hljs-number">0x5D681B02</span>, <span class="hljs-number">0x9DD277AE</span>, <span class="hljs-number">0xBDBDF21D</span>, <span class="hljs-number">0x7D079EB1</span>, <span class="hljs-number">0xE7B82D06</span>, <span class="hljs-number">0x270241AA</span>, <span class="hljs-number">0x09B64C2B</span>, <span class="hljs-number">0xC90C2087</span>,<br>        <span class="hljs-number">0x53B39330</span>, <span class="hljs-number">0x9309FF9C</span>, <span class="hljs-number">0x0EDB8832</span>, <span class="hljs-number">0xCE61E49E</span>, <span class="hljs-number">0x54DE5729</span>, <span class="hljs-number">0x94643B85</span>, <span class="hljs-number">0xBAD03604</span>, <span class="hljs-number">0x7A6A5AA8</span>,<br>        <span class="hljs-number">0xE0D5E91F</span>, <span class="hljs-number">0x206F85B3</span>, <span class="hljs-number">0xA00AE279</span>, <span class="hljs-number">0x60B08ED5</span>, <span class="hljs-number">0xFA0F3D62</span>, <span class="hljs-number">0x3AB551CE</span>, <span class="hljs-number">0x14015C4F</span>, <span class="hljs-number">0xD4BB30E3</span>,<br>        <span class="hljs-number">0x4E048354</span>, <span class="hljs-number">0x8EBEEFF8</span>, <span class="hljs-number">0x136C9856</span>, <span class="hljs-number">0xD3D6F4FA</span>, <span class="hljs-number">0x4969474D</span>, <span class="hljs-number">0x89D32BE1</span>, <span class="hljs-number">0xA7672660</span>, <span class="hljs-number">0x67DD4ACC</span>,<br>        <span class="hljs-number">0xFD62F97B</span>, <span class="hljs-number">0x3DD895D7</span>, <span class="hljs-number">0x1DB71064</span>, <span class="hljs-number">0xDD0D7CC8</span>, <span class="hljs-number">0x47B2CF7F</span>, <span class="hljs-number">0x8708A3D3</span>, <span class="hljs-number">0xA9BCAE52</span>, <span class="hljs-number">0x6906C2FE</span>,<br>        <span class="hljs-number">0xF3B97149</span>, <span class="hljs-number">0x33031DE5</span>, <span class="hljs-number">0xAED16A4B</span>, <span class="hljs-number">0x6E6B06E7</span>, <span class="hljs-number">0xF4D4B550</span>, <span class="hljs-number">0x346ED9FC</span>, <span class="hljs-number">0x1ADAD47D</span>, <span class="hljs-number">0xDA60B8D1</span>,<br>        <span class="hljs-number">0x40DF0B66</span>, <span class="hljs-number">0x806567CA</span>, <span class="hljs-number">0x9B64C2B1</span>, <span class="hljs-number">0x5BDEAE1D</span>, <span class="hljs-number">0xC1611DAA</span>, <span class="hljs-number">0x01DB7106</span>, <span class="hljs-number">0x2F6F7C87</span>, <span class="hljs-number">0xEFD5102B</span>,<br>        <span class="hljs-number">0x756AA39C</span>, <span class="hljs-number">0xB5D0CF30</span>, <span class="hljs-number">0x2802B89E</span>, <span class="hljs-number">0xE8B8D432</span>, <span class="hljs-number">0x72076785</span>, <span class="hljs-number">0xB2BD0B29</span>, <span class="hljs-number">0x9C0906A8</span>, <span class="hljs-number">0x5CB36A04</span>,<br>        <span class="hljs-number">0xC60CD9B3</span>, <span class="hljs-number">0x06B6B51F</span>, <span class="hljs-number">0x26D930AC</span>, <span class="hljs-number">0xE6635C00</span>, <span class="hljs-number">0x7CDCEFB7</span>, <span class="hljs-number">0xBC66831B</span>, <span class="hljs-number">0x92D28E9A</span>, <span class="hljs-number">0x5268E236</span>,<br>        <span class="hljs-number">0xC8D75181</span>, <span class="hljs-number">0x086D3D2D</span>, <span class="hljs-number">0x95BF4A83</span>, <span class="hljs-number">0x5505262F</span>, <span class="hljs-number">0xCFBA9598</span>, <span class="hljs-number">0x0F00F934</span>, <span class="hljs-number">0x21B4F4B5</span>, <span class="hljs-number">0xE10E9819</span>,<br>        <span class="hljs-number">0x7BB12BAE</span>, <span class="hljs-number">0xBB0B4702</span>, <span class="hljs-number">0x3B6E20C8</span>, <span class="hljs-number">0xFBD44C64</span>, <span class="hljs-number">0x616BFFD3</span>, <span class="hljs-number">0xA1D1937F</span>, <span class="hljs-number">0x8F659EFE</span>, <span class="hljs-number">0x4FDFF252</span>,<br>        <span class="hljs-number">0xD56041E5</span>, <span class="hljs-number">0x15DA2D49</span>, <span class="hljs-number">0x88085AE7</span>, <span class="hljs-number">0x48B2364B</span>, <span class="hljs-number">0xD20D85FC</span>, <span class="hljs-number">0x12B7E950</span>, <span class="hljs-number">0x3C03E4D1</span>, <span class="hljs-number">0xFCB9887D</span>,<br>        <span class="hljs-number">0x66063BCA</span>, <span class="hljs-number">0xA6BC5766</span>, <span class="hljs-number">0x86D3D2D5</span>, <span class="hljs-number">0x4669BE79</span>, <span class="hljs-number">0xDCD60DCE</span>, <span class="hljs-number">0x1C6C6162</span>, <span class="hljs-number">0x32D86CE3</span>, <span class="hljs-number">0xF262004F</span>,<br>        <span class="hljs-number">0x68DDB3F8</span>, <span class="hljs-number">0xA867DF54</span>, <span class="hljs-number">0x35B5A8FA</span>, <span class="hljs-number">0xF50FC456</span>, <span class="hljs-number">0x6FB077E1</span>, <span class="hljs-number">0xAF0A1B4D</span>, <span class="hljs-number">0x81BE16CC</span>, <span class="hljs-number">0x41047A60</span>,<br>        <span class="hljs-number">0xDBBBC9D7</span>, <span class="hljs-number">0x1B01A57B</span>, <span class="hljs-number">0xEDB88321</span>, <span class="hljs-number">0x2D02EF8D</span>, <span class="hljs-number">0xB7BD5C3A</span>, <span class="hljs-number">0x77073096</span>, <span class="hljs-number">0x59B33D17</span>, <span class="hljs-number">0x990951BB</span>,<br>        <span class="hljs-number">0x03B6E20C</span>, <span class="hljs-number">0xC30C8EA0</span>, <span class="hljs-number">0x5EDEF90E</span>, <span class="hljs-number">0x9E6495A2</span>, <span class="hljs-number">0x04DB2615</span>, <span class="hljs-number">0xC4614AB9</span>, <span class="hljs-number">0xEAD54738</span>, <span class="hljs-number">0x2A6F2B94</span>,<br>        <span class="hljs-number">0xB0D09823</span>, <span class="hljs-number">0x706AF48F</span>, <span class="hljs-number">0x5005713C</span>, <span class="hljs-number">0x90BF1D90</span>, <span class="hljs-number">0x0A00AE27</span>, <span class="hljs-number">0xCABAC28B</span>, <span class="hljs-number">0xE40ECF0A</span>, <span class="hljs-number">0x24B4A3A6</span>,<br>        <span class="hljs-number">0xBE0B1011</span>, <span class="hljs-number">0x7EB17CBD</span>, <span class="hljs-number">0xE3630B13</span>, <span class="hljs-number">0x23D967BF</span>, <span class="hljs-number">0xB966D408</span>, <span class="hljs-number">0x79DCB8A4</span>, <span class="hljs-number">0x5768B525</span>, <span class="hljs-number">0x97D2D989</span>,<br>        <span class="hljs-number">0x0D6D6A3E</span>, <span class="hljs-number">0xCDD70692</span>, <span class="hljs-number">0x4DB26158</span>, <span class="hljs-number">0x8D080DF4</span>, <span class="hljs-number">0x17B7BE43</span>, <span class="hljs-number">0xD70DD2EF</span>, <span class="hljs-number">0xF9B9DF6E</span>, <span class="hljs-number">0x3903B3C2</span>,<br>        <span class="hljs-number">0xA3BC0075</span>, <span class="hljs-number">0x63066CD9</span>, <span class="hljs-number">0xFED41B77</span>, <span class="hljs-number">0x3E6E77DB</span>, <span class="hljs-number">0xA4D1C46C</span>, <span class="hljs-number">0x646BA8C0</span>, <span class="hljs-number">0x4ADFA541</span>, <span class="hljs-number">0x8A65C9ED</span>,<br>        <span class="hljs-number">0x10DA7A5A</span>, <span class="hljs-number">0xD06016F6</span>, <span class="hljs-number">0xF00F9345</span>, <span class="hljs-number">0x30B5FFE9</span>, <span class="hljs-number">0xAA0A4C5E</span>, <span class="hljs-number">0x6AB020F2</span>, <span class="hljs-number">0x44042D73</span>, <span class="hljs-number">0x84BE41DF</span>,<br>        <span class="hljs-number">0x1E01F268</span>, <span class="hljs-number">0xDEBB9EC4</span>, <span class="hljs-number">0x4369E96A</span>, <span class="hljs-number">0x83D385C6</span>, <span class="hljs-number">0x196C3671</span>, <span class="hljs-number">0xD9D65ADD</span>, <span class="hljs-number">0xF762575C</span>, <span class="hljs-number">0x37D83BF0</span>,<br>        <span class="hljs-number">0xAD678847</span>, <span class="hljs-number">0x6DDDE4EB</span>, <span class="hljs-number">0x76DC4190</span>, <span class="hljs-number">0xB6662D3C</span>, <span class="hljs-number">0x2CD99E8B</span>, <span class="hljs-number">0xEC63F227</span>, <span class="hljs-number">0xC2D7FFA6</span>, <span class="hljs-number">0x026D930A</span>,<br>        <span class="hljs-number">0x98D220BD</span>, <span class="hljs-number">0x58684C11</span>, <span class="hljs-number">0xC5BA3BBF</span>, <span class="hljs-number">0x05005713</span>, <span class="hljs-number">0x9FBFE4A4</span>, <span class="hljs-number">0x5F058808</span>, <span class="hljs-number">0x71B18589</span>, <span class="hljs-number">0xB10BE925</span>,<br>        <span class="hljs-number">0x2BB45A92</span>, <span class="hljs-number">0xEB0E363E</span>, <span class="hljs-number">0xCB61B38D</span>, <span class="hljs-number">0x0BDBDF21</span>, <span class="hljs-number">0x91646C96</span>, <span class="hljs-number">0x51DE003A</span>, <span class="hljs-number">0x7F6A0DBB</span>, <span class="hljs-number">0xBFD06117</span>,<br>        <span class="hljs-number">0x256FD2A0</span>, <span class="hljs-number">0xE5D5BE0C</span>, <span class="hljs-number">0x7807C9A2</span>, <span class="hljs-number">0xB8BDA50E</span>, <span class="hljs-number">0x220216B9</span>, <span class="hljs-number">0xE2B87A15</span>, <span class="hljs-number">0xCC0C7794</span>, <span class="hljs-number">0x0CB61B38</span>,<br>        <span class="hljs-number">0x9609A88F</span>, <span class="hljs-number">0x56B3C423</span>, <span class="hljs-number">0xD6D6A3E9</span>, <span class="hljs-number">0x166CCF45</span>, <span class="hljs-number">0x8CD37CF2</span>, <span class="hljs-number">0x4C69105E</span>, <span class="hljs-number">0x62DD1DDF</span>, <span class="hljs-number">0xA2677173</span>,<br>        <span class="hljs-number">0x38D8C2C4</span>, <span class="hljs-number">0xF862AE68</span>, <span class="hljs-number">0x65B0D9C6</span>, <span class="hljs-number">0xA50AB56A</span>, <span class="hljs-number">0x3FB506DD</span>, <span class="hljs-number">0xFF0F6A71</span>, <span class="hljs-number">0xD1BB67F0</span>, <span class="hljs-number">0x11010B5C</span>,<br>        <span class="hljs-number">0x8BBEB8EB</span>, <span class="hljs-number">0x4B04D447</span>, <span class="hljs-number">0x6B6B51F4</span>, <span class="hljs-number">0xABD13D58</span>, <span class="hljs-number">0x316E8EEF</span>, <span class="hljs-number">0xF1D4E243</span>, <span class="hljs-number">0xDF60EFC2</span>, <span class="hljs-number">0x1FDA836E</span>,<br>        <span class="hljs-number">0x856530D9</span>, <span class="hljs-number">0x45DF5C75</span>, <span class="hljs-number">0xD80D2BDB</span>, <span class="hljs-number">0x18B74777</span>, <span class="hljs-number">0x8208F4C0</span>, <span class="hljs-number">0x42B2986C</span>, <span class="hljs-number">0x6C0695ED</span>, <span class="hljs-number">0xACBCF941</span>,<br>        <span class="hljs-number">0x36034AF6</span>, <span class="hljs-number">0xF6B9265A</span>, <span class="hljs-number">0xCCCCCCCC</span>, <span class="hljs-number">0xCCCCCC00</span>, <span class="hljs-number">0x00000100</span>, <span class="hljs-number">0x00000000</span>, <span class="hljs-number">0xF6B9265A</span>, <span class="hljs-number">0xCCCCCCCC</span>,<br>        <span class="hljs-number">0x00000008</span>, <span class="hljs-number">0x00000000</span>&#125;;<br><br>    <span class="hljs-type">uint32_t</span> enc1[]&#123;<br>        <span class="hljs-number">0x46A95BAD</span>,<br>        <span class="hljs-number">0x1CAC84B6</span>,<br>        <span class="hljs-number">0xA67CB2B2</span>,<br>        <span class="hljs-number">0x32188937</span>,<br>        <span class="hljs-number">0x4872D39F</span>,<br>        <span class="hljs-number">0xF2A2E59B</span>,<br>        <span class="hljs-number">0x011B94D2</span>,<br>    &#125;;<br><br>    <span class="hljs-comment">// çˆ†ç ´å‰7å­—èŠ‚</span><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">7</span>; i++)<br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> c = <span class="hljs-number">28</span>; c &lt; <span class="hljs-number">132</span>; c++)<br>        &#123;<br>            <span class="hljs-keyword">if</span> ((~box1[(<span class="hljs-type">uint8_t</span>)c ^ <span class="hljs-number">0x79</span>] ^ <span class="hljs-number">0xB0E0E879</span>) == enc1[i])<br>            &#123;<br>                <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, c);<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// å16å­—èŠ‚è¿›è¡ŒIDEAè§£å¯†</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> enc2[<span class="hljs-number">16</span>] = &#123;<br>        <span class="hljs-number">0x5C</span>, <span class="hljs-number">0x2F</span>, <span class="hljs-number">0xD0</span>, <span class="hljs-number">0xEC</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x0E</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x57</span>,<br>        <span class="hljs-number">0x6A</span>, <span class="hljs-number">0x9F</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xF6</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xA4</span>, <span class="hljs-number">0xAC</span>, <span class="hljs-number">0x90</span>&#125;;<br>    <span class="hljs-comment">// unsigned int key[4] = &#123;</span><br>    <span class="hljs-comment">//     0x42B2986C, 0x12345678, 0x0D6D6A3E, 0x89ABCDEF&#125;;</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> key[<span class="hljs-number">4</span>] = &#123;<br>        <span class="hljs-number">0x6C98B242</span>, <span class="hljs-number">0x78563412</span>, <span class="hljs-number">0x3E6A6D0D</span>, <span class="hljs-number">0xEFCDAB89</span>&#125;;<br><br>    code keys_input[<span class="hljs-number">8</span>];<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)<br>    &#123;<br>        keys_input[<span class="hljs-number">2</span> * i + <span class="hljs-number">1</span>] = key[i] &amp; <span class="hljs-number">0xFFFF</span>;<br>        keys_input[<span class="hljs-number">2</span> * i] = (key[i] &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xFFFF</span>;<br>    &#125;<br><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> result[<span class="hljs-number">16</span>];<br>    bitset&lt;64&gt; cipher1, cipher2;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">8</span>; i++)<br>    &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">8</span>; j++)<br>        &#123;<br>            cipher1[<span class="hljs-number">63</span> - (i * <span class="hljs-number">8</span> + j)] = (enc2[i] &gt;&gt; (<span class="hljs-number">7</span> - j)) &amp; <span class="hljs-number">1</span>;<br>            cipher2[<span class="hljs-number">63</span> - (i * <span class="hljs-number">8</span> + j)] = (enc2[i + <span class="hljs-number">8</span>] &gt;&gt; (<span class="hljs-number">7</span> - j)) &amp; <span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-built_in">subkeys_get</span>(keys_input);<br>    <span class="hljs-built_in">inv_subkeys_get</span>(sub_key);<br><br>    bitset&lt;64&gt; plain1 = <span class="hljs-built_in">dencrypt</span>(cipher1);<br>    bitset&lt;64&gt; plain2 = <span class="hljs-built_in">dencrypt</span>(cipher2);<br><br>    <span class="hljs-type">uint64_t</span> plain1_val = plain<span class="hljs-number">1.</span><span class="hljs-built_in">to_ullong</span>();<br>    <span class="hljs-type">uint64_t</span> plain2_val = plain<span class="hljs-number">2.</span><span class="hljs-built_in">to_ullong</span>();<br><br>    <span class="hljs-type">uint8_t</span> dec2[<span class="hljs-number">16</span>]&#123;&#125;;<br>    <span class="hljs-built_in">memcpy</span>(dec2, &amp;plain2_val, <span class="hljs-number">8</span>);<br>    <span class="hljs-built_in">memcpy</span>(dec2 + <span class="hljs-number">8</span>, &amp;plain1_val, <span class="hljs-number">8</span>);<br>    <span class="hljs-built_in">reverse</span>(dec2, dec2 + <span class="hljs-number">16</span>);<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%.16s\n&quot;</span>, dec2);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ezVMï¼ˆé™„ä»¶chalï¼‰"><a href="#ezVMï¼ˆé™„ä»¶chalï¼‰" class="headerlink" title="ezVMï¼ˆé™„ä»¶chalï¼‰"></a>ezVMï¼ˆé™„ä»¶chalï¼‰</h1><p>â€‹æ— å£³64ä½ELFç¨‹åºï¼Œç¨‹åºæœ‰å¼‚å¸¸ï¼ŒIDAåˆ†æè›®ä¹…æ‰ç»“æŸã€‚</p><p>â€‹æ ¹æ®å­—ç¬¦ä¸²å¼•ç”¨æ‰¾åˆ°ä¸»é€»è¾‘ï¼Œå…ˆè¿›è¡Œé•¿åº¦æ¯”å¯¹ï¼Œç„¶ååŠ å¯†ï¼Œæœ€åcheckï¼Œå¯†æ–‡åœ¨<code>unk_1639E40</code>å¤„ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250614130136465.png" alt="image-20250614130136465"></p><p>â€‹é‡Œé¢çš„å‡½æ•°å‘¢ï¼Œå°±ç®—äº†ï¼Œåˆæ˜¯å¤ªæ— è¯­çš„ä»£ç ï¼Œä¸€å †åƒåœ¾ï¼Œçœ‹ä¸æ¸…æ¥šä¸€ç‚¹ã€‚å­¦ä¹ WPï¼Œåæ­£æ˜¯å­¦æ–°ä¸œè¥¿ã€‚</p><h3 id="å¤ç°livå¤§ä½¬çš„WP"><a href="#å¤ç°livå¤§ä½¬çš„WP" class="headerlink" title="å¤ç°livå¤§ä½¬çš„WP"></a>å¤ç°livå¤§ä½¬çš„WP</h3><p>â€‹å­¦ä¹ çŸ¥é“è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨<strong>unicorn</strong>æ¡†æ¶æ‰§è¡Œè™šæ‹Ÿä»£ç çš„ç¨‹åºï¼Œæˆ‘ä»¬è¦ä½¿ç”¨<strong>bindiff</strong>æ¥æ¢å¤ä¸€äº›è¢«ä¸¢å¼ƒçš„å‡½æ•°ç¬¦å·ä¿¡æ¯ã€‚å…·ä½“æ“ä½œå°±æ˜¯ï¼Œå…ˆæåˆ°å¯¹åº”æ¶æ„çš„åŠ¨æ€åº“æ–‡ä»¶ï¼ˆWindowså°±æ˜¯dllæ–‡ä»¶ï¼‰ï¼Œç„¶åé€šè¿‡<strong>bindiff</strong>å¯ä»¥è¿›è¡Œå‡½æ•°çº§åˆ«çš„æ¯”è¾ƒï¼Œè¿™ä¼šå¸®åŠ©ä½ <strong>è¯†åˆ«ç›®æ ‡ç¨‹åºä¸­å“ªäº›å‡½æ•°æ˜¯ Unicorn çš„å®ç°</strong>ï¼Œå¹¶å¯ä»¥<strong>å¯¼å…¥å‡½æ•°å</strong>ã€‚</p><p>â€‹ä½†æ˜¯åŠ¨æ€åº“æ–‡ä»¶éœ€è¦è‡ªå·±ç¼–è¯‘å•Šï¼Œå¾ˆéš¾æ‰¾åˆ°ç°æˆçš„ã€‚åˆæ‰“æ¶ˆäº†æˆ‘çš„ç§¯ææ€§å•Šã€‚</p><hr><p>â€‹åœ¨Ubuntu24è™šæ‹Ÿæœºä¸­å®‰è£…Unicornæ¡†æ¶ï¼Œå»ºè®®æ–¹å¼ï¼š</p><ul><li>ä½¿ç”¨<strong>python3-venv</strong>è™šæ‹Ÿç¯å¢ƒï¼Œåœ¨å…¶ä¸­ä½¿ç”¨<code>pip install unicorn</code>ç›´æ¥ä¸‹è½½ã€‚ä¹‹åå¯ä»¥é€šè¿‡<code>from unicorn import *</code>ã€ <code>from unicorn.x86_const import *</code>çš„æ–¹å¼å¯¼å…¥æ¨¡å—ï¼Œä¸ç†Ÿæ‚‰çš„åŒå­¦å¯ä»¥é€šè¿‡<code>help(unicorn)</code>æŸ¥çœ‹å…¶æ¨¡å—ä¿¡æ¯ã€‚</li></ul><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># unicorn_example.py</span><br><span class="hljs-keyword">from</span> unicorn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> unicorn.x86_const <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># åˆ›å»ºä¸€ä¸ª Unicorn å¼•æ“</span><br>uc = Uc(UC_ARCH_X86, UC_MODE_64)<br><br><span class="hljs-comment"># ä¸ºç¨‹åºåˆ†é…å†…å­˜ï¼ˆè¿™é‡Œé€‰æ‹©äº†0x1000åœ°å€èµ·å§‹çš„å†…å­˜åŒºï¼‰</span><br>uc.mem_map(<span class="hljs-number">0x1000</span>, <span class="hljs-number">2</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>)<br><br><span class="hljs-comment"># å‘å†…å­˜å†™å…¥ä»£ç ï¼ˆç®€å•çš„æ±‡ç¼–ä»£ç ï¼‰</span><br>code = <span class="hljs-string">b&quot;\x48\x31\xc0&quot;</span>  <span class="hljs-comment"># x86_64 æ±‡ç¼–ï¼šxor rax, rax</span><br>uc.mem_write(<span class="hljs-number">0x1000</span>, code)<br><br><span class="hljs-comment"># è®¾ç½®ç¨‹åºçš„èµ·å§‹åœ°å€</span><br>uc.reg_write(UC_X86_REG_RIP, <span class="hljs-number">0x1000</span>)<br><br><span class="hljs-comment"># æ‰§è¡Œæ¨¡æ‹Ÿï¼ˆæœ€å¤šæ‰§è¡Œ 1 æ­¥ï¼‰</span><br>uc.emu_start(<span class="hljs-number">0x1000</span>, <span class="hljs-number">0x1000</span> + <span class="hljs-built_in">len</span>(code))<br><br><span class="hljs-comment"># è·å–å¹¶è¾“å‡ºç»“æœï¼ˆæ­¤å¤„æˆ‘ä»¬æŸ¥è¯¢ RAX å¯„å­˜å™¨çš„å€¼ï¼‰</span><br>result = uc.reg_read(UC_X86_REG_RAX)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;RAX = <span class="hljs-subst">&#123;result&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><ul><li>å¦‚æœæœ‰ç½‘è”é€šgithubï¼Œå¯ä»¥é€šè¿‡<code>git clone https://github.com/unicorn-engine/unicorn.git</code>å‘½ä»¤æ‹‰å–é¢„ç¼–è¯‘æ–‡ä»¶ï¼Œç„¶å<code>cd unicorn</code>ã€<code>mkdir build</code>ã€<code>cd build</code>ã€<code>cmake ..</code>ã€<code>make</code>ï¼Œç¼–è¯‘å¥½äº†ä¹‹åï¼Œ å¯ä»¥ç¼–å†™cppæ–‡ä»¶äº†ï¼Œç¼–å†™å®Œåï¼Œé€šè¿‡g++ç¼–è¯‘é“¾æ¥å‡ºå¯æ‰§è¡Œç¨‹åºã€‚å‘½ä»¤ç¤ºä¾‹å¦‚ä¸‹ï¼š<code>g++ -o unicorn_test /home/ubuntu/æ¡Œé¢/unicorn_test.cpp     -I/home/ubuntu/æ¡Œé¢/unicorn/include     -L/home/ubuntu/æ¡Œé¢/unicorn/build     -lunicorn</code>ã€‚æœ‰å¯èƒ½ä¼šæŠ¥é”™æ‰¾ä¸åˆ°å…±äº«åº“æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤<code>export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/home/ubuntu/æ¡Œé¢/unicorn/build</code>ï¼Œå…¶ä¸­çš„è·¯å¾„è‡ªè¡Œä¿®æ”¹ã€‚</li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unicorn/unicorn.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ADDRESS 0x1000000  <span class="hljs-comment">// èµ·å§‹åœ°å€</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span> </span>&#123;<br>    uc_engine *uc;<br>    uc_err err;<br><br>    <span class="hljs-comment">// åˆå§‹åŒ– Unicorn æ¨¡æ‹Ÿå™¨</span><br>    err = <span class="hljs-built_in">uc_open</span>(UC_ARCH_X86, UC_MODE_64, &amp;uc);<br>    <span class="hljs-keyword">if</span> (err != UC_ERR_OK) &#123;<br>        std::cerr &lt;&lt; <span class="hljs-string">&quot;Failed to initialize Unicorn engine!&quot;</span> &lt;&lt; std::endl;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// æ˜ å°„ 2MB çš„å†…å­˜åŒºåŸŸï¼Œè®¾ç½®å¯è¯»ã€å¯å†™ã€å¯æ‰§è¡Œæƒé™</span><br>    err = <span class="hljs-built_in">uc_mem_map</span>(uc, ADDRESS, <span class="hljs-number">2</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>, UC_PROT_READ | UC_PROT_WRITE | UC_PROT_EXEC);<br>    <span class="hljs-keyword">if</span> (err != UC_ERR_OK) &#123;<br>        std::cerr &lt;&lt; <span class="hljs-string">&quot;Failed to map memory!&quot;</span> &lt;&lt; std::endl;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// å°†ä¸€æ®µç®€å•çš„æœºå™¨ç å†™å…¥å†…å­˜ï¼ˆå¦‚ `int 0x80` ä¸­æ–­æŒ‡ä»¤ï¼‰</span><br>    <span class="hljs-type">uint8_t</span> code[] = &#123; <span class="hljs-number">0xCD</span>, <span class="hljs-number">0x80</span> &#125;; <span class="hljs-comment">// x86 ä¸­æ–­æŒ‡ä»¤</span><br>    err = <span class="hljs-built_in">uc_mem_write</span>(uc, ADDRESS, code, <span class="hljs-built_in">sizeof</span>(code));<br>    <span class="hljs-keyword">if</span> (err != UC_ERR_OK) &#123;<br>        std::cerr &lt;&lt; <span class="hljs-string">&quot;Failed to write code to memory!&quot;</span> &lt;&lt; std::endl;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// æ‰§è¡Œè¯¥æ®µä»£ç </span><br>    err = <span class="hljs-built_in">uc_emu_start</span>(uc, ADDRESS, ADDRESS + <span class="hljs-built_in">sizeof</span>(code), <span class="hljs-number">0</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// æ·»åŠ timeoutå’Œcount</span><br>    <span class="hljs-keyword">if</span> (err != UC_ERR_OK) &#123;<br>        std::cerr &lt;&lt; <span class="hljs-string">&quot;Failed to start emulation!&quot;</span> &lt;&lt; std::endl;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// é‡Šæ”¾ Unicorn å¼•æ“</span><br>    <span class="hljs-built_in">uc_close</span>(uc);<br><br>    std::cout &lt;&lt; <span class="hljs-string">&quot;Emulation completed successfully!&quot;</span> &lt;&lt; std::endl;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><hr><p>â€‹å…¶å®ï¼Œåœ¨unicornç¼–è¯‘åï¼Œåœ¨buildç›®å½•ä¸‹é¢æœ‰å¾ˆå¤šæ¶æ„çš„ç¤ºä¾‹æ–‡ä»¶ï¼Œå¦‚sample_x86ã€sample_arm64ç­‰ç­‰ï¼Œå¦‚æœåªæ˜¯æ¢å¤ç¬¦å·çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨è¿™äº›ä¾‹å­ï¼Œä¸éœ€è¦è‡ªå·±ç äº†ã€‚ä½†æ˜¯ï¼Œåœ¨æˆ‘çš„ç¯å¢ƒä¸‹ç¼–è¯‘å‡ºæ¥çš„ELFç¨‹åºè¿›è¡Œbindiffï¼Œå®Œå…¨æ¯”å¯¹ä¸ä¸Šï¼Œæ¢å¤ä¸äº†å¯¹åº”çš„å‡½æ•°åã€‚å°±å…ˆè¿™æ ·å§ï¼Œç›´æ¥æŠ„å¤§ä½¬æ¢å¤çš„ç¬¦å·å§ã€‚</p><p>â€‹</p><p>â€‹ç„¶åå°†ä»¥ä¸Šè°ƒç”¨writeå†™å…¥çš„æ•°æ®æå–ï¼ˆ5ä¸ªå…¨éƒ¨æå–ï¼‰ï¼Œéšä¾¿æ‰¾ä¸€ä¸ªARM64æ¡†æ¶ï¼ˆ<strong>å› ä¸ºæ ¹æ®åç¼–è¯‘ä»£ç çœ‹å‡ºæ¥æ˜¯ä½¿ç”¨unicornæ¨¡æ‹Ÿæ‰§è¡ŒARM64çš„æŒ‡ä»¤</strong>ï¼‰çš„.soï¼ˆ<strong>å®‰å“appç¨‹åºéƒ½æœ‰è¿™ç§ARM64çš„soç¨‹åº</strong>ï¼‰å¤åˆ¶åˆ°å¯¹åº”åœ°å€ï¼Œä»¥ä¾¿åç¼–è¯‘çœ‹ä»£ç ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250627220457369.png" alt="image-20250627220457369"></p><p>â€‹okï¼Œå†™å…¥è¿™ä¸ªå››ä¸ªæ•°æ®åï¼Œå°±å¯ä»¥åç¼–è¯‘å‡ºæ¥äº†ã€‚æ³¨æ„ï¼Œdata_2æ˜¯ä¼šé‡æ–°è¦†ç›–Code_Armä¸­çš„ï¼Œå¿…é¡»è¦†ç›–æ‰é‚£ä¸€éƒ¨åˆ†ã€‚æˆ‘ä¹Ÿæ˜¯ç»ˆäºçœ‹åˆ°è¿™ä¸ªå‡½æ•°äº†ï¼ï¼ˆ<strong>è¿˜æ˜¯æœ‰ä¸ªé—®é¢˜ï¼Œæˆ‘çš„MEMORY[]åœ°å€å’Œå¤§ä½¬çš„è¿˜ä¸ä¸€æ ·ï¼Œæ˜¯å“ªé‡Œé”™äº†å—ï¼Ÿ</strong>ï¼‰</p><p>â€‹å¤§ä½¬è¯´è¿™æ˜¯è™šæ‹Ÿæœºæ‰§è¡Œå‡½æ•°ï¼Œæœ€åè¿˜æ˜¯é€šè¿‡hookæ¨¡æ‹Ÿæ‰§è¡Œï¼Œçœ‹æ±‡ç¼–åˆ†æé€»è¾‘ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250627220713636.png" alt="image-20250627220713636"></p><p>â€‹åœ¨Hookæ¨¡æ‹Ÿæ—¶ï¼Œç”±äºåœ¨ubuntuç³»ç»Ÿä¸‹ï¼Œ æˆ‘å°æ”¹äº†ä¸€ä¸‹ç¨‹åºï¼Œä¿®æ”¹äº†ä¸€ä¸‹windows.hçš„æ›¿ä»£ï¼Œç»“æœç¼–è¯‘å‡ºæ¥å°±æ­»å¾ªç¯äº†ğŸ˜¥ã€‚çœŸéš¾å—ã€‚æ”¹Windowsçš„python-unicornï¼Œè¿˜æ˜¯æ­»å¾ªç¯ï¼Œå¼€åœ¨å¯åŠ¨æ¨¡æ‹Ÿçš„è¾“å‡ºå°±æ²¡äº†ï¼Œå¸Œæœ›å“ªä¸ªå¸ˆå‚…èƒ½å¤ŸæŒ‡ç‚¹ä¸€ä¸‹ã€‚</p><p>â€‹ç»è¿‡é‡æ–°å°è¯•ï¼Œæˆ‘å°†codeçš„å­—èŠ‚ä¿å­˜åˆ°äº†ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼Œç„¶ååœ¨ç¨‹åºä¸­è¯»å–ï¼Œè¿™æ ·å°±èƒ½å¤Ÿæ­£å¸¸è·‘äº†ã€‚å¥½ç„å­¦ï¼Œæ˜¯ä¸æ˜¯è¿™ç§æ–‡æœ¬å¤ªé•¿äº†ï¼Œ<strong>Typora</strong>ä¿å­˜å‡ºé”™å•Šï¼Œè¿˜æ˜¯é£æ°´é—®é¢˜ï¼Œè¿™ä¸ªå–æ•°æ®çš„æ“ä½œï¼Œæˆ‘é‡å¤äº†è‡³å°‘äº”æ¬¡ï¼</p><p>â€‹ä¹Ÿæœ‰å¯èƒ½æ˜¯<strong>010Editor</strong>çš„é—®é¢˜ï¼Œå¤§é‡å­—èŠ‚æ•°æ®å¤åˆ¶ç²˜è´´æ—¶å°±ç»™æˆ‘å¼ºè¡Œæ¢æˆæ–‡æœ¬æ¨¡å¼ï¼Œéå¾—å…ˆä¿å­˜äºŒè¿›åˆ¶æ•°æ®åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œç„¶åå†é€šè¿‡â€œæ–‡ä»¶æ’å…¥â€åŠŸèƒ½ï¼ŒæŠŠå­—èŠ‚æ•°æ®æ”¾è¿›å»ã€‚</p><p>â€‹ä¸‹é¢çš„ç»ˆäºèƒ½è·‘äº†ï¼</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#demo_2</span><br>Data1 = [<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe4</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe4</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xd8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe4</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe4</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x0a</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x29</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe4</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xd8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xd4</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xd4</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x0f</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x5b</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x11</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xb0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x53</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xb1</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xb2</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x6f</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xb3</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x77</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xb4</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x6d</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xb5</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x61</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xb6</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x6b</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xb7</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x65</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xb8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xb9</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x5f</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xba</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x6d</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xbb</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x61</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xbc</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x64</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xbd</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x65</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xbe</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x69</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xbf</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xb0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf4</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xd0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x19</span>,<span class="hljs-number">0x19</span>,<span class="hljs-number">0xa0</span>,<span class="hljs-number">0xa0</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x12</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf4</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xcc</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf4</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xc8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf4</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xc4</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x12</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf4</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xc0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x0c</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x37</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x13</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xec</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x0a</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xdc</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x0c</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x83</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xdc</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xdc</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xdc</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x48</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x3b</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x33</span>,<span class="hljs-number">0x22</span>,<span class="hljs-number">0x11</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x0d</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf4</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x12</span>,<span class="hljs-number">0x12</span>,<span class="hljs-number">0xab</span>,<span class="hljs-number">0xab</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xec</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xec</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xd0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xec</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xec</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xec</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x88</span>,<span class="hljs-number">0x77</span>,<span class="hljs-number">0x66</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x0b</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x0d</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf4</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x66</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0x23</span>,<span class="hljs-number">0x23</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x0c</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x75</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xec</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x0b</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe0</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe8</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x0c</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x0c</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x29</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x02</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>]<br>Data2 = [<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x81</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x4d</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x7c</span>,<span class="hljs-number">0x04</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x29</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x97</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x0b</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xdd</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xa5</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x7f</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xe5</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x05</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x7f</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xc5</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x11</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0x07</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0xf3</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x8a</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0x00</span>,<span class="hljs-number">0x00</span>]<br>Data3 = [<span class="hljs-number">0x28</span>,<span class="hljs-number">0x4a</span>,<span class="hljs-number">0x1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> unicorn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> unicorn.arm64_const <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> demo_2<br><br>Base = <span class="hljs-number">0x1000000</span><br>Stack = <span class="hljs-number">0x7F0000</span><br>InputAddr = <span class="hljs-number">0x14C28</span><br>Input = <span class="hljs-string">b&#x27;XYCTF&#123;fun_un1c0rn_with_4rm64_VM&#125;&#x27;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hook_code</span>(<span class="hljs-params">uc, address, size, user_data</span>):<br>    <span class="hljs-keyword">if</span> address == <span class="hljs-number">0x1FAC</span>:<br>        w1 = uc.reg_read(UC_ARM64_REG_W1)<br>        w0 = uc.reg_read(UC_ARM64_REG_W0)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;W3 = W1 ^ W0 --- <span class="hljs-subst">&#123;w1:#x&#125;</span> ^ <span class="hljs-subst">&#123;w0:#x&#125;</span> = <span class="hljs-subst">&#123;w1 ^ w0:#x&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> address == <span class="hljs-number">0x2054</span>:<br>        w3 = uc.reg_read(UC_ARM64_REG_W3)<br>        w0 = uc.reg_read(UC_ARM64_REG_W0)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;W2 = W0 ^ W3 --- <span class="hljs-subst">&#123;w0:#x&#125;</span> ^ <span class="hljs-subst">&#123;w3:#x&#125;</span> = <span class="hljs-subst">&#123;w3 ^ w0:#x&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> address == <span class="hljs-number">0x2180</span>:<br>        w1 = uc.reg_read(UC_ARM64_REG_W1)<br>        w4 = uc.reg_read(UC_ARM64_REG_W4)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;W1 = W1 ^ W4 --- <span class="hljs-subst">&#123;w1:#x&#125;</span> ^ <span class="hljs-subst">&#123;w4:#x&#125;</span> = <span class="hljs-subst">&#123;w1 ^ w4:#x&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> address == <span class="hljs-number">0x2238</span>:<br>        w3 = uc.reg_read(UC_ARM64_REG_W3)<br>        w0 = uc.reg_read(UC_ARM64_REG_W0)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;W2 = W0 ^ W3 --- <span class="hljs-subst">&#123;w0:#x&#125;</span> ^ <span class="hljs-subst">&#123;w3:#x&#125;</span> = <span class="hljs-subst">&#123;w3 ^ w0:#x&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> address == <span class="hljs-number">0x2BE4</span>:<br>        w1 = uc.reg_read(UC_ARM64_REG_W1)<br>        w0 = uc.reg_read(UC_ARM64_REG_W0)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;W3 = W1 &gt;&gt; W0 --- <span class="hljs-subst">&#123;w1:#x&#125;</span> &gt;&gt; <span class="hljs-subst">&#123;w0:#x&#125;</span> = <span class="hljs-subst">&#123;(w1 &gt;&gt; w0):#x&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> address == <span class="hljs-number">0x2CD4</span>:<br>        w1 = uc.reg_read(UC_ARM64_REG_W1)<br>        w0 = uc.reg_read(UC_ARM64_REG_W0)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;W2 = W1 &gt;&gt; W0 --- <span class="hljs-subst">&#123;w1:#x&#125;</span> &gt;&gt; <span class="hljs-subst">&#123;w0:#x&#125;</span> = <span class="hljs-subst">&#123;(w1 &gt;&gt; w0):#x&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> address == <span class="hljs-number">0x2EA4</span>:<br>        w1 = uc.reg_read(UC_ARM64_REG_W1)<br>        w0 = uc.reg_read(UC_ARM64_REG_W0)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;W2 = W1 &lt;&lt; W0 --- <span class="hljs-subst">&#123;w1:#x&#125;</span> &lt;&lt; <span class="hljs-subst">&#123;w0:#x&#125;</span> = <span class="hljs-subst">&#123;(w1 &lt;&lt; w0):#x&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> address == <span class="hljs-number">0x2DB4</span>:<br>        w1 = uc.reg_read(UC_ARM64_REG_W1)<br>        w0 = uc.reg_read(UC_ARM64_REG_W0)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;W2 = W1 &lt;&lt; W0 --- <span class="hljs-subst">&#123;w1:#x&#125;</span> &lt;&lt; <span class="hljs-subst">&#123;w0:#x&#125;</span> = <span class="hljs-subst">&#123;(w1 &lt;&lt; w0):#x&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> address == <span class="hljs-number">0x232C</span>:<br>        w3 = uc.reg_read(UC_ARM64_REG_W3)<br>        w0 = uc.reg_read(UC_ARM64_REG_W0)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;W2 = W0 &amp; W3 --- <span class="hljs-subst">&#123;w0:#x&#125;</span> &amp; <span class="hljs-subst">&#123;w3:#x&#125;</span> = <span class="hljs-subst">&#123;w0 &amp; w3:#x&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> address ==<span class="hljs-number">0x241C</span>:<br>        w1 = uc.reg_read(UC_ARM64_REG_W1)<br>        w0 = uc.reg_read(UC_ARM64_REG_W0)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;W2 = W0 &amp; W1 --- <span class="hljs-subst">&#123;w0:#x&#125;</span> &amp; <span class="hljs-subst">&#123;w1:#x&#125;</span> = <span class="hljs-subst">&#123;w0 &amp; w1:#x&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> address == <span class="hljs-number">0x1CC4</span>:<br>        w0 = uc.reg_read(UC_ARM64_REG_W0)<br>        w1 = uc.reg_read(UC_ARM64_REG_W1)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;W2 = W1 + W0 --- <span class="hljs-subst">&#123;w1:#x&#125;</span> + <span class="hljs-subst">&#123;w0:#x&#125;</span> = <span class="hljs-subst">&#123;w1 + w0:#x&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> address == <span class="hljs-number">0x1A0C</span>:<br>        w0 = uc.reg_read(UC_ARM64_REG_W0)<br>        w1 = uc.reg_read(UC_ARM64_REG_W1)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;W2 = W1 + W0 --- <span class="hljs-subst">&#123;w1:#x&#125;</span> + <span class="hljs-subst">&#123;w0:#x&#125;</span> = <span class="hljs-subst">&#123;w1 + w0:#x&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> address == <span class="hljs-number">0x1AB4</span>:<br>        w0 = uc.reg_read(UC_ARM64_REG_W0)<br>        w3 = uc.reg_read(UC_ARM64_REG_W3)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;W2 = W0 + W3 --- <span class="hljs-subst">&#123;w0:#x&#125;</span> + <span class="hljs-subst">&#123;w3:#x&#125;</span> = <span class="hljs-subst">&#123;w0 + w3:#x&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> address == <span class="hljs-number">0x1BE0</span>:<br>        w1 = uc.reg_read(UC_ARM64_REG_W1)<br>        w4 = uc.reg_read(UC_ARM64_REG_W4)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;W1 = W1 + W4 --- <span class="hljs-subst">&#123;w1:#x&#125;</span> + <span class="hljs-subst">&#123;w4:#x&#125;</span> = <span class="hljs-subst">&#123;w1 + w4:#x&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> address == <span class="hljs-number">0x1E98</span>:<br>        w0 = uc.reg_read(UC_ARM64_REG_W0)<br>        w1 = uc.reg_read(UC_ARM64_REG_W1)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;W2 = W1 - W0 --- <span class="hljs-subst">&#123;w1:#x&#125;</span> - <span class="hljs-subst">&#123;w0:#x&#125;</span> = <span class="hljs-subst">&#123;w1 - w0:#x&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">elif</span> address == <span class="hljs-number">0x1DA8</span>:<br>        w0 = uc.reg_read(UC_ARM64_REG_W0)<br>        w3 = uc.reg_read(UC_ARM64_REG_W3)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;W2 = W0 - W3 --- <span class="hljs-subst">&#123;w0:#x&#125;</span> - <span class="hljs-subst">&#123;w3:#x&#125;</span> = <span class="hljs-subst">&#123;w0 - w3:#x&#125;</span>&quot;</span>)<br><br>        <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;code&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            Code = f.read()<br>        Data1 = <span class="hljs-built_in">bytes</span>(demo_2.Data1)<br>        Data2 = <span class="hljs-built_in">bytes</span>(demo_2.Data2)<br>        Data3 = <span class="hljs-built_in">bytes</span>(demo_2.Data3)<br>        mu = Uc(UC_ARCH_ARM64, UC_MODE_ARM)  <span class="hljs-comment"># æ¶æ„+æ¨¡å¼</span><br><br>        <span class="hljs-comment">#æ˜ å°„å†…å­˜</span><br>        mu.mem_map(<span class="hljs-number">0</span>,Base,UC_PROT_ALL)<br>        <span class="hljs-comment">#mu.mem_map(Stack-4096,0x4000,UC_PROT_ALL)</span><br><br>        mu.hook_add(UC_HOOK_CODE, hook_code)<br><br>        mu.mem_write(InputAddr,Input)<br>        mu.mem_write(<span class="hljs-number">0xC70</span>,Code)<br>        mu.mem_write(<span class="hljs-number">0x14010</span>,Data1)<br>        mu.mem_write(<span class="hljs-number">0x30F0</span>,Data2)<br>        mu.mem_write(<span class="hljs-number">0x149E8</span>,Data3)<br><br>        mu.reg_write(UC_ARM64_REG_X0, InputAddr)<br>        mu.reg_write(UC_ARM64_REG_SP, Stack)<br><br>        mu.emu_start(<span class="hljs-number">0x0C70</span>,<span class="hljs-number">0x2EF4</span>)<br><br>        result = mu.mem_read(InputAddr,<span class="hljs-number">48</span>)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;result[i]:02x&#125;</span> &quot;</span>, end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-built_in">print</span>()<br>    <span class="hljs-keyword">except</span> UcError <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Unicorn error: %s&quot;</span> % e)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    main()<br></code></pre></td></tr></table></figure><p>â€‹ç°åœ¨çš„é—®é¢˜è¿˜æœ‰ä¸¤ä¸ªï¼šä¸€å°±æ˜¯è¿™ä¸ª<strong>å…³é”®è®¡ç®—åœ°å€ç©¶ç«Ÿæ˜¯æ€ä¹ˆç­›é€‰å‡ºæ¥çš„</strong>ï¼Œè¿˜æœ‰å…¶ä»–çš„è®¡ç®—å¤„æ²¡æœ‰æ·»åŠ è¿›å»å•Šï¼Ÿå…¶äºŒå°±æ˜¯çœ‹è¾“å‡ºçš„<strong>è®¡ç®—è¿‡ç¨‹åˆ†æåŠ å¯†ç®—æ³•</strong>äº†ã€‚</p><p>â€‹ä¹Ÿæ²¡æœ‰äººèƒ½å›ç­”ï¼Œæˆ‘çŒœå°±æ˜¯éšä¾¿æŒ‘äº†ä¸€äº›è®¡ç®—å‡ºæ¥ï¼Œæ‡’å¾—å…¨å†™ã€‚ä¸Šé¢æˆ‘å·²ç»è¡¥å…¨äº†æ‰€æœ‰çš„è®¡ç®—æŒ‡ä»¤åœ°å€ï¼Œæ›´ç¾å‘³çš„äº«å—å§ã€‚</p><p>â€‹éšä¾¿çœ‹çœ‹è¿™ä¸ªè®¡ç®—è¿‡ç¨‹ï¼Œå¾ˆæ˜æ˜¾æ˜¯æœ‰è§„å¾‹çš„ï¼Œå¾ˆåƒæ˜¯ä¸ªå¾ªç¯ï¼Œå¾ªç¯å¤šå°‘è½®å‘¢ï¼Œè€å®æ•°å§ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250704183341268.png" alt="image-20250704183341268"></p><p>â€‹å…ˆä»æœ€åŸºç¡€çš„ä¸€è½®å¼€å§‹çœ‹èµ·ï¼Œå¯ä»¥å…ˆçœ‹ä¸¤è½®ï¼Œç¡®å®šå…¶ä¸­çš„å¸¸æ•°é¡¹ï¼Œç„¶åç”±å‚æ•°å¼€å§‹é€æ¸å®šä¹‰å˜é‡æ¥è¿˜åŸè®¡ç®—è¿‡ç¨‹ï¼Œå¹¶ä¸”å¤šæ¬¡éªŒè¯ã€‚å”¯ä¸€çš„ç¼ºç‚¹å°±æ˜¯ï¼Œè½®æ•°å¤ªğŸ”å„¿å¤šï¼Œè®©äººæœ›è€Œç”Ÿç•ï¼Œä¸æ˜¯æœ‰flagçš„è¯±æƒ‘ï¼Œè°å¹²è¿™ä¹ˆè‹¦é€¼çš„æ´»ï¼Œå½“ç„¶æˆ‘ä»¬REâœŒæ˜¯ä¸ä¼šè¿™ä¹ˆåƒäºçš„ï¼Œæ¯ä¸€è½®çš„é•¿åº¦æ˜¯22è¡Œï¼ŒåŠ ä¸Šè®¡æ•°çš„ä¸€è¡Œï¼Œæˆ‘ä»¬å¯ä»¥å¤åˆ¶åˆ°å¦ä¸€ä¸ªå¼ºå¤§çš„æ–‡æœ¬ç¼–è¾‘å™¨å»å¿«é€Ÿè®¡ç®—è½®æ•°ã€‚</p><p>â€‹çœ‹è§„å¾‹çš„ä¸œè¥¿è¿˜æ˜¯å¤ªé¸¡å„¿ä¸çˆ½äº†ï¼Œå¤ªæŠ˜ç£¨æ²¡æœ‰è€å¿ƒçš„æˆ‘å•Šã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">W3 = W1 &gt;&gt; W0 --- <span class="hljs-number">0x75667b46</span> &gt;&gt; <span class="hljs-number">0x5</span> = <span class="hljs-number">0x3ab33da</span><span class="hljs-comment">#v1 &gt;&gt; 5</span><br>W2 = W1 &lt;&lt; W0 --- <span class="hljs-number">0x75667b46</span> &lt;&lt; <span class="hljs-number">0x6</span> = <span class="hljs-number">0x1d599ed180</span><span class="hljs-comment">#v1 &lt;&lt; 6</span><br>W3 = W1 ^ W0 --- <span class="hljs-number">0x3ab33da</span> ^ <span class="hljs-number">0x599ed180</span> = <span class="hljs-number">0x5a35e25a</span> <span class="hljs-comment">#(v1&gt;&gt;5) ^ (v1 &lt;&lt; 6 &amp; 0xfffffffff)</span><br>W2 = W0 ^ W3 --- <span class="hljs-number">0x75667b46</span> ^ <span class="hljs-number">0x11223344</span> = <span class="hljs-number">0x64444802</span><span class="hljs-comment">#v1 ^ key0</span><br>W2 = W1 + W0 --- <span class="hljs-number">0x5a35e25a</span> + <span class="hljs-number">0x64444802</span> = <span class="hljs-number">0xbe7a2a5c</span><span class="hljs-comment">#t1 = ((v1&gt;&gt;5) ^ ...) + (v1 ^ key0)</span><br>W2 = W0 &amp; W3 --- <span class="hljs-number">0x0</span> &amp; <span class="hljs-number">0x3</span> = <span class="hljs-number">0x0</span><br>W2 = W1 + W0 --- <span class="hljs-number">0x776f6853</span> + <span class="hljs-number">0x0</span> = <span class="hljs-number">0x776f6853</span><br>W2 = W0 ^ W3 --- <span class="hljs-number">0x776f6853</span> ^ <span class="hljs-number">0xabab1212</span> = <span class="hljs-number">0xdcc47a41</span><span class="hljs-comment">#t2</span><br>W3 = W1 ^ W0 --- <span class="hljs-number">0xbe7a2a5c</span> ^ <span class="hljs-number">0xdcc47a41</span> = <span class="hljs-number">0x62be501d</span><span class="hljs-comment">#t1 ^ t2</span><br>W2 = W1 + W0 --- <span class="hljs-number">0x62be501d</span> + <span class="hljs-number">0x54435958</span> = <span class="hljs-number">0xb701a975</span><span class="hljs-comment">#v0 = t2 + ?</span><br>W2 = W1 - W0 --- <span class="hljs-number">0x0</span> - <span class="hljs-number">0xa0a01919</span> = -<span class="hljs-number">0xa0a01919</span><span class="hljs-comment">#sum-=delta ,  =0x5f5fe6e7</span><br>W3 = W1 &gt;&gt; W0 --- <span class="hljs-number">0xb701a975</span> &gt;&gt; <span class="hljs-number">0x4</span> = <span class="hljs-number">0xb701a97</span><br>W2 = W1 &lt;&lt; W0 --- <span class="hljs-number">0xb701a975</span> &lt;&lt; <span class="hljs-number">0x7</span> = <span class="hljs-number">0x5b80d4ba80</span><br>W3 = W1 ^ W0 --- <span class="hljs-number">0xb701a97</span> ^ <span class="hljs-number">0x80d4ba80</span> = <span class="hljs-number">0x8ba4a017</span><span class="hljs-comment">#t3 = (v0&gt;&gt;4)+(v0&lt;&lt;7)</span><br>W2 = W0 ^ W3 --- <span class="hljs-number">0xb701a975</span> ^ <span class="hljs-number">0x55667788</span> = <span class="hljs-number">0xe267defd</span><span class="hljs-comment">#t4 = v0^key1</span><br>W2 = W1 + W0 --- <span class="hljs-number">0x8ba4a017</span> + <span class="hljs-number">0xe267defd</span> = <span class="hljs-number">0x16e0c7f14</span><span class="hljs-comment">#t3 + (v0^key1)</span><br>W3 = W1 &gt;&gt; W0 --- <span class="hljs-number">0x5f5fe6e7</span> &gt;&gt; <span class="hljs-number">0xb</span> = <span class="hljs-number">0xbebfc</span><span class="hljs-comment">#sum&gt;&gt;11</span><br>W2 = W0 &amp; W3 --- <span class="hljs-number">0xbebfc</span> &amp; <span class="hljs-number">0x3</span> = <span class="hljs-number">0x0</span><span class="hljs-comment">#(sum&gt;&gt;11)&amp;3</span><br>W2 = W1 + W0 --- <span class="hljs-number">0x776f6853</span> + <span class="hljs-number">0x5f5fe6e7</span> = <span class="hljs-number">0xd6cf4f3a</span><br>W2 = W0 ^ W3 --- <span class="hljs-number">0xd6cf4f3a</span> ^ <span class="hljs-number">0x23235566</span> = <span class="hljs-number">0xf5ec1a5c</span><span class="hljs-comment">#t2</span><br>W3 = W1 ^ W0 --- <span class="hljs-number">0xf5ec1a5c</span> ^ <span class="hljs-number">0x6e0c7f14</span> = <span class="hljs-number">0x9be06548</span> <span class="hljs-comment">#t5 = t2^(t3 + (v0^key1))</span><br>W2 = W1 + W0 --- <span class="hljs-number">0x9be06548</span> + <span class="hljs-number">0x75667b46</span> = <span class="hljs-number">0x11146e08e</span><span class="hljs-comment">#v1= t5 + v1</span><br>W2 = W0 + W3 --- <span class="hljs-number">0x0</span> + <span class="hljs-number">0x1</span> = <span class="hljs-number">0x1</span><span class="hljs-comment">#-------------------------------------è®¡æ•°ï¼Œåˆ†è§£çº¿</span><br>W3 = W1 &gt;&gt; W0 --- <span class="hljs-number">0x1146e08e</span> &gt;&gt; <span class="hljs-number">0x5</span> = <span class="hljs-number">0x8a3704</span> <span class="hljs-comment">#v1&gt;&gt;5</span><br>W2 = W1 &lt;&lt; W0 --- <span class="hljs-number">0x1146e08e</span> &lt;&lt; <span class="hljs-number">0x6</span> = <span class="hljs-number">0x451b82380</span><br>W3 = W1 ^ W0 --- <span class="hljs-number">0x8a3704</span> ^ <span class="hljs-number">0x51b82380</span> = <span class="hljs-number">0x51321484</span><br>W2 = W0 ^ W3 --- <span class="hljs-number">0x1146e08e</span> ^ <span class="hljs-number">0x11223344</span> = <span class="hljs-number">0x64d3ca</span><br>W2 = W1 + W0 --- <span class="hljs-number">0x51321484</span> + <span class="hljs-number">0x64d3ca</span> = <span class="hljs-number">0x5196e84e</span><br>W2 = W0 &amp; W3 --- <span class="hljs-number">0x5f5fe6e7</span> &amp; <span class="hljs-number">0x3</span> = <span class="hljs-number">0x3</span><br>W2 = W1 + W0 --- <span class="hljs-number">0x74696564</span> + <span class="hljs-number">0x5f5fe6e7</span> = <span class="hljs-number">0xd3c94c4b</span><br>W2 = W0 ^ W3 --- <span class="hljs-number">0xd3c94c4b</span> ^ <span class="hljs-number">0xabab1212</span> = <span class="hljs-number">0x78625e59</span><br>W3 = W1 ^ W0 --- <span class="hljs-number">0x5196e84e</span> ^ <span class="hljs-number">0x78625e59</span> = <span class="hljs-number">0x29f4b617</span><br>W2 = W1 + W0 --- <span class="hljs-number">0x29f4b617</span> + <span class="hljs-number">0xb701a975</span> = <span class="hljs-number">0xe0f65f8c</span><br>W2 = W1 - W0 --- <span class="hljs-number">0x5f5fe6e7</span> - <span class="hljs-number">0xa0a01919</span> = -<span class="hljs-number">0x41403232</span><br>W3 = W1 &gt;&gt; W0 --- <span class="hljs-number">0xe0f65f8c</span> &gt;&gt; <span class="hljs-number">0x4</span> = <span class="hljs-number">0xe0f65f8</span><br>W2 = W1 &lt;&lt; W0 --- <span class="hljs-number">0xe0f65f8c</span> &lt;&lt; <span class="hljs-number">0x7</span> = <span class="hljs-number">0x707b2fc600</span><br>W3 = W1 ^ W0 --- <span class="hljs-number">0xe0f65f8</span> ^ <span class="hljs-number">0x7b2fc600</span> = <span class="hljs-number">0x7520a3f8</span><br>W2 = W0 ^ W3 --- <span class="hljs-number">0xe0f65f8c</span> ^ <span class="hljs-number">0x55667788</span> = <span class="hljs-number">0xb5902804</span><br>W2 = W1 + W0 --- <span class="hljs-number">0x7520a3f8</span> + <span class="hljs-number">0xb5902804</span> = <span class="hljs-number">0x12ab0cbfc</span><br>W3 = W1 &gt;&gt; W0 --- <span class="hljs-number">0xbebfcdce</span> &gt;&gt; <span class="hljs-number">0xb</span> = <span class="hljs-number">0x17d7f9</span><br>W2 = W0 &amp; W3 --- <span class="hljs-number">0x17d7f9</span> &amp; <span class="hljs-number">0x3</span> = <span class="hljs-number">0x1</span><br>W2 = W1 + W0 --- <span class="hljs-number">0x656b616d</span> + <span class="hljs-number">0xbebfcdce</span> = <span class="hljs-number">0x1242b2f3b</span><br>W2 = W0 ^ W3 --- <span class="hljs-number">0x242b2f3b</span> ^ <span class="hljs-number">0x23235566</span> = <span class="hljs-number">0x7087a5d</span><br>W3 = W1 ^ W0 --- <span class="hljs-number">0x7087a5d</span> ^ <span class="hljs-number">0x2ab0cbfc</span> = <span class="hljs-number">0x2db8b1a1</span><br>W2 = W1 + W0 --- <span class="hljs-number">0x2db8b1a1</span> + <span class="hljs-number">0x1146e08e</span> = <span class="hljs-number">0x3eff922f</span><br>W2 = W0 + W3 --- <span class="hljs-number">0x1</span> + <span class="hljs-number">0x1</span> = <span class="hljs-number">0x2</span> <span class="hljs-comment">#-------------------------------------è®¡æ•°ï¼Œåˆ†è§£çº¿</span><br>W3 = W1 &gt;&gt; W0 --- <span class="hljs-number">0x3eff922f</span> &gt;&gt; <span class="hljs-number">0x5</span> = <span class="hljs-number">0x1f7fc91</span><br>W2 = W1 &lt;&lt; W0 --- <span class="hljs-number">0x3eff922f</span> &lt;&lt; <span class="hljs-number">0x6</span> = <span class="hljs-number">0xfbfe48bc0</span><br></code></pre></td></tr></table></figure><p>â€‹å¤§ä½¬æ€»ç»“å‡ºæ¥äº†åŠ å¯†ä»£ç ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">encipher</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>], <span class="hljs-type">const</span> <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>])</span><br>&#123;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>], v1 = v[<span class="hljs-number">1</span>], sum = <span class="hljs-number">0</span>, delta = <span class="hljs-number">0x5f5fe6e7</span>;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">72</span>; i++)<br>    &#123;<br>        <span class="hljs-keyword">auto</span> tmp = (((v1 &lt;&lt; <span class="hljs-number">6</span>) ^ (v1 &gt;&gt; <span class="hljs-number">5</span>)) + (v1 ^ <span class="hljs-number">0x11223344</span>));<br>        <span class="hljs-keyword">auto</span> tmp2 = (((key[sum &amp; <span class="hljs-number">3</span>] + sum) ^ <span class="hljs-number">0xabab1212</span>) ^ tmp);<br>        v0 += tmp2;<br>        sum += delta;<br>        <span class="hljs-keyword">auto</span> tmp3 = (((v0 &lt;&lt; <span class="hljs-number">7</span>) ^ (v0 &gt;&gt; <span class="hljs-number">4</span>)) + (v0 ^ <span class="hljs-number">0x55667788</span>));<br>        <span class="hljs-keyword">auto</span> tmp4 = ((key[(sum &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>] + sum) ^ <span class="hljs-number">0x23235566</span> ^ tmp3);<br>        v1 += tmp4;<br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0;<br>    v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹ç„¶åå†™è§£å¯†è„šæœ¬å³å¯ã€‚</p><h1 id="EzObf"><a href="#EzObf" class="headerlink" title="EzObf"></a>EzObf</h1><p>â€‹è¿™ç§é€†å‘é¢˜å°±æ˜¯ç¬¬ä¸€æ¬¡æ²¡å¤´ç»ªï¼Œå°±å®Œå…¨ä¸æƒ³åšäº†ã€‚ã€‚</p><h3 id="å¤ç°WP"><a href="#å¤ç°WP" class="headerlink" title="å¤ç°WP"></a>å¤ç°WP</h3><p>â€‹é¦–å…ˆç†Ÿæ‚‰ä¸€ä¸‹ä¸ç†Ÿæ‚‰çš„æ±‡ç¼–æŒ‡ä»¤ã€‚</p><blockquote><p><strong>pushfq</strong></p><p><strong>ä½œç”¨</strong>ï¼šå°† <strong>RFLAGSï¼ˆ64ä½ï¼‰&#x2F;EFLAGSï¼ˆ32ä½ï¼‰å¯„å­˜å™¨çš„å€¼å‹å…¥æ ˆä¸­</strong>ã€‚</p><p><strong>ç”¨é€”</strong>ï¼šä¿å­˜å½“å‰çš„æ ‡å¿—å¯„å­˜å™¨çŠ¶æ€ï¼Œå¸¸ç”¨äºå‡½æ•°è°ƒç”¨å‰ä¿å­˜çŠ¶æ€ï¼Œæˆ–è€…å¤„ç†ä¸­æ–­ã€ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶ä¿æŠ¤æ ‡å¿—å¯„å­˜å™¨ã€‚</p><p><strong>popfq</strong>å°±æ˜¯å¯¹åº”æ¢å¤çš„æŒ‡ä»¤ã€‚</p><p><strong>call    $+5</strong> å…¶ä¸­$ä»£è¡¨å½“å‰æŒ‡ä»¤çš„åœ°å€ï¼Œä½œç”¨å°±æ˜¯ï¼šè·³è½¬åˆ°å½“å‰æŒ‡ä»¤åœ°å€å¾€å5å­—èŠ‚å¤„æ‰§è¡Œä»£ç ï¼ŒåŒæ—¶æŠŠè¿”å›åœ°å€å‹å…¥æ ˆã€‚</p><p><strong>rol</strong>æŒ‡ä»¤æ˜¯å¾ªç¯å·¦ç§»ã€‚</p></blockquote><p>â€‹å¯ä»¥çœ‹åˆ°pushfqå’Œpopfqæ˜¯å¯¹ç§°çš„ï¼Œç­‰ä»·äºéƒ½ä¸èµ·ä½œç”¨ã€‚pushå’Œpopä¹Ÿæ˜¯å¯¹ç§°çš„ï¼Œä¹Ÿå¯ä»¥nopæ‰ï¼ŒçœŸå®æœ‰æ•ˆæ‰§è¡ŒæŒ‡ä»¤åªæœ‰ä¸€æ¡ã€‚</p><p><img src="/pictures/XYCTF2025/image-20250628142121006.png" alt="image-20250628142121006"></p><p>â€‹åŸç†æ¯”è¾ƒæ¸…æ™°äº†ï¼Œçœ‹åˆ°å¤§æ‰‹å­å¸ˆå‚…ç»™çš„IDCè„šæœ¬ï¼Œç›´æ¥è‡ªåŠ¨åŒ–nopæ‰å¹¶ä¸”è®¡ç®—å‡ºæ–°çš„è·³è½¬æŒ‡ä»¤ï¼Œtqlï¼<strong>Ïˆ(ï½€âˆ‡Â´)Ïˆ</strong></p><p><img src="/pictures/XYCTF2025/image-20250628144934914.png" alt="image-20250628144934914"></p><p>â€‹è‡ªå·±å†æ‰‹åŠ¨nopæ‰ä¸Šé¢çš„å‡ è¡Œpushï¼Œç„¶å<strong>apply patches to input files</strong>ï¼Œä¸ä¿å­˜<strong>i64</strong>æ–‡ä»¶ï¼Œé‡æ–°å¯¼å…¥IDAåˆ†æï¼ŒF5å°±èƒ½åç¼–è¯‘å‡ºæ¥äº†ã€‚å¸ˆå‚…å¤ªå¼ºäº†ï¼Œè†œæ‹œï¼</p><p>â€‹å¥½å¥½å­¦ä¹ æ¬£èµä¸€ä¸‹å¸ˆå‚…çš„IDCè„šæœ¬ï¼Œå…¶å®åé¢çœŸå®æ±‡ç¼–æ··æ·†çš„æ ¼å¼éƒ½ä¸€æ ·ï¼Œåªæœ‰ç¬¬ä¸€ä¸ªç‰¹æ®Šä¸€ç‚¹ï¼Œéœ€è¦æ‰‹åŠ¨patchæ‰ä¸€éƒ¨åˆ†ã€‚ä¸‹æ¬¡ç¢°åˆ°å°±å¯ä»¥è¾¹ç ”ç©¶è¾¹æ¨¡ä»¿å†™äº†ã€‚</p><figure class="highlight cpp"><table><tr><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">//ä»addrå¼€å§‹nopæ‰é•¿åº¦ä¸ºlengthä¸ªå­—èŠ‚</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-title">NopCode</span><span class="hljs-params">(Addr, Length)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">auto</span> i;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; Length; i++)<br>    &#123;<br>        <span class="hljs-built_in">PatchByte</span>(Addr + i, <span class="hljs-number">0x90</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//è®¡ç®—å¾ªç¯ç§»ä½</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-title">rol</span><span class="hljs-params">(value, count, bits = <span class="hljs-number">32</span>)</span></span><br><span class="hljs-function"></span>&#123;<br>    count = count % bits;<br>    <span class="hljs-keyword">return</span> ((value &lt;&lt; count) | (value &gt;&gt; (bits - count))) &amp; ((<span class="hljs-number">1</span> &lt;&lt; bits) - <span class="hljs-number">1</span>);<br>&#125;<br><br><span class="hljs-comment">// æœç´¢çœŸå®æ±‡ç¼–ä»£ç çš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-title">FindEnd</span><span class="hljs-params">(Addr)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">auto</span> i;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">0x90</span>; i++)<br>    &#123;<br>        <span class="hljs-keyword">auto</span> v = <span class="hljs-built_in">Dword</span>(Addr + i);<br>        <span class="hljs-keyword">if</span> (v == <span class="hljs-number">0x5153509C</span>)<br>        &#123;<br>            <span class="hljs-keyword">return</span> Addr + i;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">// æœç´¢æœ€åçš„jmp raxæŒ‡ä»¤</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-title">FindJmpRax</span><span class="hljs-params">(Addr)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">auto</span> i;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">0x90</span>; i++)<br>    &#123;<br>        <span class="hljs-keyword">auto</span> v = <span class="hljs-built_in">Word</span>(Addr + i);<br>        <span class="hljs-keyword">if</span> (v == <span class="hljs-number">0xE0FF</span>)<br>        &#123;<br>            <span class="hljs-keyword">return</span> Addr + i;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">// æœç´¢call $+5</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-title">FindCall</span><span class="hljs-params">(Addr)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">auto</span> i;<br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">0x90</span>; i++)<br>    &#123;<br>        <span class="hljs-keyword">auto</span> v = <span class="hljs-built_in">Dword</span>(Addr + i);<br>        <span class="hljs-keyword">if</span> (v == <span class="hljs-number">0xE8</span>)<br>        &#123;<br>            <span class="hljs-keyword">return</span> Addr + i;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">auto</span> StartAddr = <span class="hljs-number">0x1401F400D</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-number">1</span>)<br>    &#123;<br>        <span class="hljs-comment">// æœç´¢çœŸå®æ±‡ç¼–ä»£ç çš„ä¸‹ä¸€ä¸ªæŒ‡ä»¤åœ°å€</span><br>        <span class="hljs-keyword">auto</span> EndAddr = <span class="hljs-built_in">FindEnd</span>(StartAddr);<br>        <span class="hljs-keyword">if</span> (EndAddr == <span class="hljs-number">0</span>)<br>        &#123;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-comment">// çœŸå®æ±‡ç¼–ä»£ç çš„å­—èŠ‚é•¿åº¦</span><br>        <span class="hljs-keyword">auto</span> CodeLength = EndAddr - StartAddr - <span class="hljs-number">13</span>;<br>        <span class="hljs-comment">// æœç´¢Call $+5</span><br>        <span class="hljs-keyword">auto</span> CallAddr = <span class="hljs-built_in">FindCall</span>(StartAddr + <span class="hljs-number">13</span> + CodeLength);<br>        <span class="hljs-keyword">if</span> (CallAddr == <span class="hljs-number">0</span>)<br>        &#123;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-comment">// call $+5çš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ï¼Œå³callæ—¶pushåˆ°æ ˆçš„è¿”å›åœ°å€</span><br>        <span class="hljs-keyword">auto</span> CalcAddr = CallAddr + <span class="hljs-number">5</span>;<br>        <span class="hljs-keyword">auto</span> ebx = <span class="hljs-built_in">Dword</span>(CalcAddr + <span class="hljs-number">2</span>);<br>        <span class="hljs-keyword">auto</span> rol_Value = <span class="hljs-built_in">Byte</span>(CalcAddr + <span class="hljs-number">8</span>);<br>        <span class="hljs-keyword">auto</span> Mode = <span class="hljs-built_in">Dword</span>(CalcAddr + <span class="hljs-number">9</span>);<br>        ebx = <span class="hljs-built_in">rol</span>(ebx, rol_Value);<br><br>        <span class="hljs-comment">// æœç´¢æœ€å°¾éƒ¨çš„jmp raxæŒ‡ä»¤åœ°å€</span><br>        <span class="hljs-keyword">auto</span> JmpRaxAddr = <span class="hljs-built_in">FindJmpRax</span>(StartAddr);<br>        <span class="hljs-keyword">if</span> (JmpRaxAddr == <span class="hljs-number">0</span>)<br>        &#123;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>        <span class="hljs-comment">// ç¬¬ä¸€éƒ¨åˆ†åƒåœ¾æŒ‡ä»¤é•¿åº¦</span><br>        <span class="hljs-keyword">auto</span> TrushCodeLength_1 = CallAddr - (StartAddr + <span class="hljs-number">13</span> + CodeLength);<br>        <span class="hljs-comment">// ç¬¬äºŒéƒ¨åˆ†åƒåœ¾æŒ‡ä»¤é•¿åº¦</span><br>        <span class="hljs-keyword">auto</span> TrushCodeLength_2 = JmpRaxAddr - CallAddr + <span class="hljs-number">2</span>;<br>        <span class="hljs-comment">// Nopæ‰æ— ç”¨çš„æ‰€æœ‰ä»£ç </span><br>        <br>        <span class="hljs-built_in">NopCode</span>(StartAddr, <span class="hljs-number">13</span>);<br>       <br>        <span class="hljs-built_in">NopCode</span>(StartAddr + <span class="hljs-number">13</span> + CodeLength, TrushCodeLength_1);<br>        <br>        <span class="hljs-built_in">NopCode</span>(CallAddr, TrushCodeLength_2);<br>        <span class="hljs-comment">// ä¸€å…±ä¸¤ç§åœ°å€è®¡ç®—ï¼ŒåŠ å’Œå‡</span><br>        <span class="hljs-keyword">if</span> (Mode == <span class="hljs-number">0xffC32B48</span>)<br>        &#123;<br>            CalcAddr = CalcAddr - ebx;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (Mode == <span class="hljs-number">0xffC30348</span>)<br>        &#123;<br>            CalcAddr = CalcAddr + ebx;<br>        &#125;<br>        <span class="hljs-keyword">auto</span> JmpCodeAddr = EndAddr;<br>        <span class="hljs-comment">// è®¡ç®—ç›¸å¯¹è·³è½¬åœ°å€</span><br>        <span class="hljs-keyword">auto</span> JmpOffset = CalcAddr - JmpCodeAddr + <span class="hljs-number">5</span>;<br>        <span class="hljs-comment">// å†™å…¥jmpæŒ‡ä»¤</span><br>        <span class="hljs-built_in">PatchByte</span>(JmpCodeAddr, <span class="hljs-number">0xE9</span>);<br>        <span class="hljs-built_in">PatchDword</span>(JmpCodeAddr + <span class="hljs-number">1</span>, JmpOffset);<br>        <span class="hljs-comment">// jmpçš„åœ°å€ä¸ºä¸‹ä¸€æ¬¡deobfèµ·å§‹åœ°å€</span><br>        StartAddr = CalcAddr;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹ä¸‹é¢ç¬¬næ¬¡é‡æ–°å­¦ä¹ xxteaç®—æ³•ï¼ŒğŸ½ï¼Œè¿Ÿæ—©æˆ‘è¦å‡ºä¸€ç¯‡ç®—æ³•çš„ä¸“æ ï¼Œæ”¶é›†åˆ°è¾ƒä¸°å¯Œçš„pythonè„šæœ¬ï¼Œä»¥åç›´æ¥æ¢­å“ˆï¼</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//æ ‡å‡†åŠ è§£å¯†ä»£ç </span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DELTA 0x9e3779b9</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MX (((z&gt;&gt;5^y<span class="hljs-string">&lt;&lt;2) + (y&gt;</span>&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span><br> <br><span class="hljs-type">void</span> <span class="hljs-title function_">btea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">int</span> n, <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> y, z, sum;<br>    <span class="hljs-type">unsigned</span> p, rounds, e;<br>    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">1</span>)            <span class="hljs-comment">/* Coding Part */</span><br>    &#123;<br>        rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span>/n;<br>        sum = <span class="hljs-number">0</span>;<br>        z = v[n<span class="hljs-number">-1</span>];<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>            sum += DELTA;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p=<span class="hljs-number">0</span>; p&lt;n<span class="hljs-number">-1</span>; p++)<br>            &#123;<br>                y = v[p+<span class="hljs-number">1</span>];<br>                z = v[p] += MX;<br>            &#125;<br>            y = v[<span class="hljs-number">0</span>];<br>            z = v[n<span class="hljs-number">-1</span>] += MX;<br>        &#125;<br>        <span class="hljs-keyword">while</span> (--rounds);<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">-1</span>)      <span class="hljs-comment">/* Decoding Part */</span><br>    &#123;<br>        n = -n;<br>        rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span>/n;<br>        sum = rounds*DELTA;<br>        y = v[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p=n<span class="hljs-number">-1</span>; p&gt;<span class="hljs-number">0</span>; p--)<br>            &#123;<br>                z = v[p<span class="hljs-number">-1</span>];<br>                y = v[p] -= MX;<br>            &#125;<br>            z = v[n<span class="hljs-number">-1</span>];<br>            y = v[<span class="hljs-number">0</span>] -= MX;<br>            sum -= DELTA;<br>        &#125;<br>        <span class="hljs-keyword">while</span> (--rounds);<br>    &#125;<br>&#125;<br> <br> <br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> v[<span class="hljs-number">2</span>]= &#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> k[<span class="hljs-number">4</span>]= &#123;<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>&#125;;<br>    <span class="hljs-type">int</span> n= <span class="hljs-number">2</span>; <span class="hljs-comment">//nçš„ç»å¯¹å€¼è¡¨ç¤ºvçš„é•¿åº¦ï¼Œå–æ­£è¡¨ç¤ºåŠ å¯†ï¼Œå–è´Ÿè¡¨ç¤ºè§£å¯†</span><br>    <span class="hljs-comment">// vä¸ºè¦åŠ å¯†çš„æ•°æ®æ˜¯ä¸¤ä¸ª32ä½æ— ç¬¦å·æ•´æ•°</span><br>    <span class="hljs-comment">// kä¸ºåŠ å¯†è§£å¯†å¯†é’¥ï¼Œä¸º4ä¸ª32ä½æ— ç¬¦å·æ•´æ•°ï¼Œå³å¯†é’¥é•¿åº¦ä¸º128ä½</span><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;åŠ å¯†å‰åŸå§‹æ•°æ®ï¼š%u %u\n&quot;</span>,v[<span class="hljs-number">0</span>],v[<span class="hljs-number">1</span>]);<br>    btea(v, n, k);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;åŠ å¯†åçš„æ•°æ®ï¼š%u %u\n&quot;</span>,v[<span class="hljs-number">0</span>],v[<span class="hljs-number">1</span>]);<br>    btea(v, -n, k);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;è§£å¯†åçš„æ•°æ®ï¼š%u %u\n&quot;</span>,v[<span class="hljs-number">0</span>],v[<span class="hljs-number">1</span>]);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹åç¼–è¯‘çš„ä»£ç ï¼Œéœ€è¦ä»”ç»†çœ‹ï¼Œä¸€è¡Œè¡Œåˆ†æã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main_0</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  __int64 i; <span class="hljs-comment">// rcx</span><br>  <span class="hljs-type">int</span> result; <span class="hljs-comment">// eax</span><br>  _DWORD *v5; <span class="hljs-comment">// rdi</span><br>  HANDLE CurrentProcess; <span class="hljs-comment">// rax</span><br>  __int64 v7; <span class="hljs-comment">// [rsp-20h] [rbp-468h] BYREF</span><br>  _DWORD v8[<span class="hljs-number">2</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-448h] BYREF</span><br>  _BYTE v9[<span class="hljs-number">64</span>]; <span class="hljs-comment">// [rsp+8h] [rbp-440h] BYREF</span><br>  _BYTE *v10; <span class="hljs-comment">// [rsp+48h] [rbp-400h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v11; <span class="hljs-comment">// [rsp+64h] [rbp-3E4h]</span><br>  <span class="hljs-type">int</span> v12; <span class="hljs-comment">// [rsp+84h] [rbp-3C4h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v13; <span class="hljs-comment">// [rsp+A4h] [rbp-3A4h]</span><br>  <span class="hljs-type">int</span> v14; <span class="hljs-comment">// [rsp+C4h] [rbp-384h]</span><br>  <span class="hljs-type">int</span> v15; <span class="hljs-comment">// [rsp+E4h] [rbp-364h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> k; <span class="hljs-comment">// [rsp+104h] [rbp-344h]</span><br>  <span class="hljs-type">int</span> v17; <span class="hljs-comment">// [rsp+124h] [rbp-324h]</span><br>  <span class="hljs-type">int</span> v18; <span class="hljs-comment">// [rsp+144h] [rbp-304h]</span><br>  <span class="hljs-type">int</span> v19; <span class="hljs-comment">// [rsp+164h] [rbp-2E4h]</span><br>  _DWORD v20[<span class="hljs-number">11</span>]; <span class="hljs-comment">// [rsp+188h] [rbp-2C0h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int16 v21; <span class="hljs-comment">// [rsp+1B4h] [rbp-294h]</span><br>  BOOL v22; <span class="hljs-comment">// [rsp+1D4h] [rbp-274h] BYREF</span><br>  <span class="hljs-type">unsigned</span> __int64 j; <span class="hljs-comment">// [rsp+1F8h] [rbp-250h]</span><br>  <span class="hljs-type">unsigned</span> __int64 v24; <span class="hljs-comment">// [rsp+218h] [rbp-230h]</span><br>  _DWORD v25[<span class="hljs-number">16</span>]; <span class="hljs-comment">// [rsp+238h] [rbp-210h]</span><br>  <span class="hljs-type">unsigned</span> __int64 m; <span class="hljs-comment">// [rsp+278h] [rbp-1D0h]</span><br>  <span class="hljs-type">int</span> v27; <span class="hljs-comment">// [rsp+404h] [rbp-44h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v28; <span class="hljs-comment">// [rsp+408h] [rbp-40h]</span><br>  <span class="hljs-type">int</span> v29; <span class="hljs-comment">// [rsp+40Ch] [rbp-3Ch]</span><br>  __int64 v30; <span class="hljs-comment">// [rsp+410h] [rbp-38h]</span><br>  <span class="hljs-type">int</span> v31; <span class="hljs-comment">// [rsp+418h] [rbp-30h]</span><br>  <span class="hljs-type">unsigned</span> __int64 v32; <span class="hljs-comment">// [rsp+420h] [rbp-28h]</span><br><br>  v5 = v8;<br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">174LL</span>; i; --i )<br>    *v5++ = <span class="hljs-number">0xCCCCCCCC</span>;<br>  v32 = (<span class="hljs-type">unsigned</span> __int64)v8 ^ <span class="hljs-number">0x1401D9000L</span>L;<br>  j___CheckForDebuggerJustMyCode(<span class="hljs-number">0x1401ED101L</span>L);<br>  <span class="hljs-built_in">memset</span>(v9, <span class="hljs-number">0</span>, <span class="hljs-number">0x20u</span>LL);<br>  sub_140087C02(<span class="hljs-number">0x1401A1190L</span>L);<br>  <span class="hljs-keyword">if</span> ( !IsDebuggerPresent() )<br>  &#123;<br>    sub_1400868E3();<br>    v10 = v9;<br>    <span class="hljs-built_in">memset</span>(v20, <span class="hljs-number">0</span>, <span class="hljs-number">0x10u</span>LL);<br>    v21 = <span class="hljs-number">8</span>;<br>    v27 = <span class="hljs-number">8</span>;<br>    v18 = <span class="hljs-number">12</span>;<br>    v13 = <span class="hljs-number">0</span>;<br>    v14 = <span class="hljs-number">0x61C88646</span>;<br>    v19 = <span class="hljs-number">0x95664B48</span>;<br>    v17 = <span class="hljs-number">7</span>;<span class="hljs-comment">//å¾ªç¯è½®æ•°æ”¹ä¸ºäº†7</span><br>    v22 = <span class="hljs-number">0</span>;<br>    CurrentProcess = GetCurrentProcess();<br>    CheckRemoteDebuggerPresent(CurrentProcess, &amp;v22);<br>    <span class="hljs-keyword">if</span> ( !v22 )<br>    &#123;<br>      j_srand(<span class="hljs-number">0xAABBu</span>);<br>      <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0LL</span>; j &lt; <span class="hljs-number">4</span>; ++j )<br>        v20[j] = j_rand();<span class="hljs-comment">//å¯†é’¥æ˜¯128ä½ï¼Œ4*32</span><br>      <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>      &#123;<br>        v27 = v17--;<br>        v28 = v27 != <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">if</span> ( !v28 )<br>          <span class="hljs-keyword">break</span>;<br>        v13 += v14;<span class="hljs-comment">//deltaæ˜¯v14ï¼Œsumæ˜¯v13</span><br>        v15 = (v13 &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<span class="hljs-comment">//å‚æ•°e</span><br>        <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; k &lt; v21; ++k )<span class="hljs-comment">//å¯¹åº”çš„æ˜¯æ˜æ–‡é•¿åº¦ï¼Œæ˜æ–‡æ¯32ä½ä¸ºä¸€ä¸ªå…ƒç´ ï¼Œä¸»è¦å°±æ˜¯è®¡ç®—MXçš„è¿‡ç¨‹</span><br>        &#123;<br>          v24 = __rdtsc();<span class="hljs-comment">//è·å–CPUçš„æ—¶é—´æˆ³è®¡æ•°</span><br>          v11 = *(_DWORD *)&amp;v10[<span class="hljs-number">4</span> * ((k + <span class="hljs-number">1</span>) % v21)];<span class="hljs-comment">//å–åˆ°v[p+1]</span><br>          v27 = (<span class="hljs-number">4</span> * v11) ^ (*(_DWORD *)&amp;v10[<span class="hljs-number">4</span> * ((k + v21 - <span class="hljs-number">1</span>) % v21)] &gt;&gt; <span class="hljs-number">5</span>);<span class="hljs-comment">//v[p+1]&lt;&lt;2 ^ v[p-1]&gt;&gt;5</span><br>          v28 = k + v21 - <span class="hljs-number">1</span>;<span class="hljs-comment">//p-1</span><br>          v29 = ((<span class="hljs-number">16</span> * *(_DWORD *)&amp;v10[<span class="hljs-number">4</span> * (v28 % v21)]) ^ (v11 &gt;&gt; <span class="hljs-number">3</span>)) + v27;<span class="hljs-comment">//v[p-1]&lt;&lt;4 ^ v[p+1]&gt;&gt;3 + v27</span><br>          v30 = ((<span class="hljs-type">unsigned</span> __int8)v15 ^ (<span class="hljs-type">unsigned</span> __int8)k) &amp; <span class="hljs-number">3</span>;<span class="hljs-comment">//(e^p)&amp;3 </span><br>            <span class="hljs-comment">//key[(p&amp;3)^e] ^  v[p-1]    +   (sum^v[p+1])   + v[p]</span><br>          v31 = (((*(_DWORD *)&amp;v10[<span class="hljs-number">4</span> * (v28 % v21)] ^ v20[v30]) + (v11 ^ v13)) ^ v29) + *(_DWORD *)&amp;v10[<span class="hljs-number">4</span> * k];<br>          *(_DWORD *)&amp;v10[<span class="hljs-number">4</span> * k] = v31;<span class="hljs-comment">//v[p] = ...</span><br>          v12 = v31;<br>          <span class="hljs-keyword">if</span> ( __rdtsc() - v24 &gt; <span class="hljs-number">0x83C0</span> )<span class="hljs-comment">//åŸºäºæ—¶é—´çš„åè°ƒè¯•</span><br>            <span class="hljs-keyword">goto</span> LABEL_21;<br>        &#125;<br>      &#125;<br>      v25[<span class="hljs-number">0</span>] = <span class="hljs-number">0xA9934E2F</span>;<br>      v25[<span class="hljs-number">1</span>] = <span class="hljs-number">0x30B90FA</span>;<br>      v25[<span class="hljs-number">2</span>] = <span class="hljs-number">0xDCBF1D3</span>;<br>      v25[<span class="hljs-number">3</span>] = <span class="hljs-number">0x328B5BDE</span>;<br>      v25[<span class="hljs-number">4</span>] = <span class="hljs-number">0x44FAB4E</span>;<br>      v25[<span class="hljs-number">5</span>] = <span class="hljs-number">0x1DCF0051</span>;<br>      v25[<span class="hljs-number">6</span>] = <span class="hljs-number">0x85EBBE55</span>;<br>      v25[<span class="hljs-number">7</span>] = <span class="hljs-number">0x93AA773A</span>;<br>      <span class="hljs-keyword">for</span> ( m = <span class="hljs-number">0LL</span>; m &lt; <span class="hljs-number">4</span>; ++m )<br>      &#123;<br>        <span class="hljs-keyword">if</span> ( v25[m] != v8[m + <span class="hljs-number">2</span>] )<span class="hljs-comment">//éªŒè¯flag</span><br>        &#123;<br>          sub_140087C02(<span class="hljs-number">0x1401A11A8L</span>L);<br>          j_system(byte_1401A11A0);<br>          <span class="hljs-keyword">goto</span> LABEL_21;<br>        &#125;<br>      &#125;<br>      sub_140087C02(<span class="hljs-number">0x1401A11C0L</span>L);<br>      j_system(byte_1401A11A0);<br>    &#125;<br>  &#125;<br>LABEL_21:<br>  j__RTC_CheckStackVars(&amp;v7, (_RTC_framedesc *)&amp;unk_1401A1140);<br>  j___security_check_cookie((<span class="hljs-type">unsigned</span> __int64)v8 ^ v32);<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹æ”¹å‚æ•°çš„xxTeaï¼ŒåŠ è§£å¯†é€»è¾‘ä¸€æ ·ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">//å¤§ä½¬çš„è§£å¯†è„šæœ¬</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DELTA 0x61C88646</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MX (((z &gt;&gt; 5 ^ y <span class="hljs-string">&lt;&lt; 2) + (y &gt;</span>&gt; 3 ^ z &lt;&lt; 4)) ^ ((sum ^ y) + (key[(p &amp; 3) ^ e] ^ z)))</span><br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">xxtea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">int</span> n, <span class="hljs-type">uint32_t</span> <span class="hljs-type">const</span> key[<span class="hljs-number">4</span>])</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">uint32_t</span> y, z, sum;<br>    <span class="hljs-type">unsigned</span> p, rounds, e;<br>    <span class="hljs-keyword">if</span> (n &gt; <span class="hljs-number">1</span>) <span class="hljs-comment">/* Coding Part */</span><br>    &#123;<br>        rounds = <span class="hljs-number">7</span>;<br>        sum = <span class="hljs-number">0</span>;<br>        z = v[n - <span class="hljs-number">1</span>];<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>            sum += DELTA;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p = <span class="hljs-number">0</span>; p &lt; n - <span class="hljs-number">1</span>; p++)<br>            &#123;<br>                y = v[p + <span class="hljs-number">1</span>];<br>                z = v[p] += MX;<br>                <span class="hljs-keyword">if</span> (z == <span class="hljs-number">0xA4F41487</span>)<br>                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;11\n&quot;</span>);<br>                <span class="hljs-keyword">if</span> (y == <span class="hljs-number">0xA4F41487</span>)<br>                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;11\n&quot;</span>);<br>            &#125;<br>            y = v[<span class="hljs-number">0</span>];<br>            z = v[n - <span class="hljs-number">1</span>] += MX;<br><br>        &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">-1</span>) <span class="hljs-comment">/* Decoding Part */</span><br>    &#123;<br>        n = -n;<br>        rounds = <span class="hljs-number">7</span>;<br>        sum = rounds * DELTA;<br>        y = v[<span class="hljs-number">0</span>];<br>        <span class="hljs-keyword">do</span><br>        &#123;<br>            e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">3</span>;<br>            <span class="hljs-keyword">for</span> (p = n - <span class="hljs-number">1</span>; p &gt; <span class="hljs-number">0</span>; p--)<br>            &#123;<br>                z = v[p - <span class="hljs-number">1</span>];<br>                y = v[p] -= MX;<br>            &#125;<br>            z = v[n - <span class="hljs-number">1</span>];<br>            y = v[<span class="hljs-number">0</span>] -= MX;<br>            sum -= DELTA;<br>        &#125; <span class="hljs-keyword">while</span> (--rounds);<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">srand</span>(<span class="hljs-number">0xAABB</span>);<br>    <span class="hljs-type">uint32_t</span> key[<span class="hljs-number">4</span>]&#123;&#125;;<br>    <span class="hljs-type">uint32_t</span> Enc[]&#123;<br>        <span class="hljs-number">0xa9934e2f</span>, <span class="hljs-number">0x30b90fa</span>, <span class="hljs-number">0xdcbf1d3</span>, <span class="hljs-number">0x328b5bde</span>,<br>        <span class="hljs-number">0x44fab4e</span>, <span class="hljs-number">0x1dcf0051</span>, <span class="hljs-number">0x85ebbe55</span>, <span class="hljs-number">0x93aa773a</span>&#125;;<br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">4</span>; i++)<br>    &#123;<br>        key[i] = <span class="hljs-built_in">rand</span>();<br>    &#125;<br>    <span class="hljs-built_in">xxtea</span>(Enc, <span class="hljs-number">-8</span>, key);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%.32s\n&quot;</span>, Enc);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><h1 id="Summer"><a href="#Summer" class="headerlink" title="Summer"></a>Summer</h1><h3 id="å¤ç°WP-1"><a href="#å¤ç°WP-1" class="headerlink" title="å¤ç°WP"></a>å¤ç°WP</h3><p>â€‹Haskellè¯­è¨€ç¼–å†™ï¼Œä¸çœ‹äº†ï¼Œå»æ‰¾å¤§ä½¬çš„WPå­¦ä¹ å§ï¼Œå¤ªé›·äººäº†ï¼Œæˆ‘è¦å¿«ç‚¹ç»“æŸè¿™ä¸€partã€‚ç»å…¸é¢˜ä»¥åå†åšä¹Ÿæ²¡äº‹ï¼Œç°åœ¨å°±å¸å–ä¸€ä¸‹ç»éªŒã€‚</p><h1 id="MDriverï¼ˆæ— è§£ï¼Œæˆ‘ä¹Ÿä¸çœ‹äº†ï¼‰"><a href="#MDriverï¼ˆæ— è§£ï¼Œæˆ‘ä¹Ÿä¸çœ‹äº†ï¼‰" class="headerlink" title="MDriverï¼ˆæ— è§£ï¼Œæˆ‘ä¹Ÿä¸çœ‹äº†ï¼‰"></a>MDriverï¼ˆæ— è§£ï¼Œæˆ‘ä¹Ÿä¸çœ‹äº†ï¼‰</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;â€‹	å¤ç°äº†4ã€5ä¸ªé¢˜åï¼Œå°±æ„Ÿè§‰éš¾åº¦æœ‰ç‚¹å¤ªå¤§äº†ï¼Œå¥½å‡ ä¸ªé¢˜éƒ½æ¶‰åŠåˆ°æ²¡å­¦è¿‡çš„æŠ€æœ¯ï¼Œç”±äºæˆ‘çš„WindowsåŸºç¡€å¾ˆå·®ï¼Œæˆ‘çš„çŸ¥è¯†ä¸€ç›´å¾ˆçç¢ï¼Œåšé¢˜çš„æ—¶å€™æ„Ÿ</summary>
      
    
    
    
    <category term="CTF" scheme="http://bumak.github.io/categories/CTF/"/>
    
    
    <category term="å¤ç°WP" scheme="http://bumak.github.io/tags/%E5%A4%8D%E7%8E%B0WP/"/>
    
    <category term="Reverse" scheme="http://bumak.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>DSBCTF2024</title>
    <link href="http://bumak.github.io/2025/06/29/DSBCTF2024/DSBCTF/"/>
    <id>http://bumak.github.io/2025/06/29/DSBCTF2024/DSBCTF/</id>
    <published>2025-06-29T08:50:00.000Z</published>
    <updated>2025-07-01T06:15:08.985Z</updated>
    
    <content type="html"><![CDATA[<h1 id="DSBCTFå•èº«æ¯"><a href="#DSBCTFå•èº«æ¯" class="headerlink" title="DSBCTFå•èº«æ¯"></a>DSBCTFå•èº«æ¯</h1><p>â€‹<a href="https://ctf-show.feishu.cn/docx/R6udd58bxoQGQMxFphncZq8rn5e">å®˜æ–¹WP</a></p><h2 id="easyRE"><a href="#easyRE" class="headerlink" title="easyRE"></a>easyRE</h2><p>â€‹<code>jar</code>ç¨‹åºï¼Œç¬¬ä¸€æ¬¡è§åˆ°ï¼Œå¥½å¥½å­¦ä¹ ä¸€ä¸‹ã€‚<a href="https://www.skfwe.cn/p/%E9%80%86%E5%90%91-jar-e.g-dvt/">æœ‰ä¸ªå…¥é—¨æ–‡ç« </a>ï¼Œçœ‹çœ‹ã€‚</p><p>â€‹ç¬¬ä¸€æ­¥ä½¿ç”¨JD-GUIæ‰“å¼€jarç¨‹åºï¼Œçœ‹åˆ°Applicationç±»ï¼Œé‡Œé¢æœ‰ä¸ªé•¿æ®µçš„base64ï¼Œè§£ç å¾—åˆ°ç¨‹åºä¸»è¦é€»è¾‘å‡½æ•°ã€‚</p><p><img src="/pictures/DSBCTF2024/image-20250612163448413.png" alt="image-20250612163448413"></p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> javax.crypto.Cipher;<br><span class="hljs-keyword">import</span> javax.crypto.spec.SecretKeySpec;<br><span class="hljs-keyword">import</span> java.nio.charset.StandardCharsets;<br><span class="hljs-keyword">import</span> java.security.SecureRandom;<br><span class="hljs-keyword">import</span> java.util.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">D8yDSBCTF</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">P3WSSK</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;AES/ECB/PKCS5Padding&quot;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">C89SYS__</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">C7yyfggl</span> <span class="hljs-operator">=</span> C89SYS__.toUpperCase();<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">N9SSCRT</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;0123456789&quot;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">D9UUSACR</span> <span class="hljs-operator">=</span> C89SYS__ + C7yyfggl + N9SSCRT;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">SecureRandom</span> <span class="hljs-variable">rf3ffc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecureRandom</span>();<br>    <span class="hljs-keyword">public</span>  <span class="hljs-keyword">void</span> <span class="hljs-title function_">start</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span>  b3f7a__0x337f2a(a98fac77f__3c2a(<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">4</span>)).get(<span class="hljs-number">1</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">e3yfbbglsk</span> <span class="hljs-operator">=</span> b3f7a__0x337f2a(a98fac77f__3c2a(<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">4</span>)).get(<span class="hljs-number">0</span>);<br>        <span class="hljs-type">Scanner</span> <span class="hljs-variable">scanner</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>        System.out.println(<span class="hljs-string">&quot;please input password:&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">i3clscwyt</span> <span class="hljs-operator">=</span> scanner.nextLine();<br>        <span class="hljs-keyword">if</span> (e3c7go_to(i3clscwyt,key).equals(e3yfbbglsk)) &#123;<br>            System.out.println(<span class="hljs-string">&quot;Login Successful&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            System.out.println(<span class="hljs-string">&quot;Login Failed&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">private</span>  List&lt;String&gt; <span class="hljs-title function_">b3f7a__0x337f2a</span><span class="hljs-params">(String a783c_7fxf__)</span> &#123;<br>        <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">f37xcrxedrd_</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;jvjeTQVGcDGPgFeC+E90Pz6wYzjcBK49YDx2W+6YFTjk/wma7Oa5J3O2ns8OptbxyNgIvYJf/J4BRJOat0LY2A==&quot;</span>;<br>        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">c0fybbg</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>        List&lt;String&gt; l2crsys = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;String&gt;();<br>        <span class="hljs-type">char</span>[] f117xc = f37xcrxedrd_.toCharArray();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">char</span> c : f117xc) &#123;<br>            c0fybbg.append((<span class="hljs-type">char</span>)(((c &gt;&gt;&gt; <span class="hljs-number">4</span> ^ (c &lt;&lt; <span class="hljs-number">4</span>) ^ (c &gt;&gt;&gt; <span class="hljs-number">4</span>))) &gt;&gt; <span class="hljs-number">4</span>));<br>        &#125;<br>        l2crsys.add(c0fybbg.substring(<span class="hljs-number">0</span>,c0fybbg.length()-<span class="hljs-number">24</span>));<br>        l2crsys.add(c0fybbg.substring(l2crsys.get(<span class="hljs-number">0</span>).length(),c0fybbg.length()));<br>        <span class="hljs-keyword">return</span> l2crsys;<br>    &#125;<br>    <span class="hljs-keyword">public</span>  String <span class="hljs-title function_">a98fac77f__3c2a</span><span class="hljs-params">(<span class="hljs-type">int</span> length)</span> &#123;<br>        <span class="hljs-keyword">if</span> (length &lt; <span class="hljs-number">1</span>) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;Length must be positive&quot;</span>);<br><br>        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">s7cyscrs</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>(length);<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; length; i++) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">randomIndex</span> <span class="hljs-operator">=</span> rf3ffc.nextInt(D9UUSACR.length());<br>            s7cyscrs.append(D9UUSACR.charAt(randomIndex));<br>        &#125;<br>        <span class="hljs-keyword">return</span> s7cyscrs.toString();<br>    &#125;<br>    <span class="hljs-keyword">public</span>  String <span class="hljs-title function_">e3c7go_to</span><span class="hljs-params">(String coysc21k, String k89csbbv)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-keyword">while</span> (k89csbbv.getBytes(StandardCharsets.UTF_8).length &lt; <span class="hljs-number">16</span>) &#123;<br>            k89csbbv += k89csbbv;<br>        &#125;<br>        <span class="hljs-type">byte</span>[] keyBytes = k89csbbv.substring(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>).getBytes(StandardCharsets.UTF_8);<br>        <span class="hljs-type">SecretKeySpec</span> <span class="hljs-variable">s88vfy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SecretKeySpec</span>(keyBytes, <span class="hljs-string">&quot;AES&quot;</span>);<br>        <span class="hljs-type">Cipher</span> <span class="hljs-variable">c1ppy</span> <span class="hljs-operator">=</span> Cipher.getInstance(P3WSSK);<br>        c1ppy.init(Cipher.ENCRYPT_MODE, s88vfy);<br>        <span class="hljs-type">byte</span>[] encryptedBytes = c1ppy.doFinal(coysc21k.getBytes(StandardCharsets.UTF_8));<br>        <span class="hljs-keyword">return</span> Base64.getEncoder().encodeToString(encryptedBytes);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹å¹¸å¥½å­¦è¿‡ä¸€ç‚¹ç‚¹JAVAè¯­æ³•ï¼Œå¹¶ä¸”æœ‰Chatgptçš„è¾…åŠ©ï¼Œæˆ‘å¾ˆé¡ºåˆ©çš„ç†è§£äº†å‡½æ•°é€»è¾‘ã€‚<code>a98fac77f__3c2a</code>æ˜¯ç”ŸæˆæŒ‡å®šé•¿åº¦çš„éšæœºå­—ç¬¦ä¸²ï¼Œå­—ç¬¦è¡¨å°±æ˜¯<code>D9UUSACR</code>ï¼›<code>b3f7a__0x337f2a</code>å°±æ˜¯å¯¹<code>f37xcrxedrd_</code>å­—ç¬¦ä¸²è¿›è¡Œåˆ†å‰²ï¼Œåé¢24ä½ä¸ºæ•°ç»„ç¬¬äºŒä¸ªå…ƒç´ ï¼Œå‰é¢çš„å­—ç¬¦ä¸²ä¸ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯å¯†æ–‡ï¼›<code>e3c7go_to</code>åŠ å¯†æ–¹å¼å°±æ˜¯å°†keyå–å‰16ä½ï¼Œç„¶åå¯¹è¾“å…¥è¿›è¡ŒAESåŠ å¯†ï¼Œå¯¹åº”æ¨¡å¼å¦‚<code>P3WSSK</code>ï¼Œæœ€åè½¬base64è¡¨ç¤ºã€‚</p><p>â€‹æ‰€ä»¥å’Œéšæœºæ•°ä¸€ç‚¹å…³ç³»æ²¡æœ‰ï¼Œåªæ˜¯ä¸ªè¿·æƒ‘é¡¹ï¼Œèµ›åšå¨å­ä¸€æŠŠæ¢­ã€‚</p><p><img src="/pictures/DSBCTF2024/image-20250612171208129.png" alt="image-20250612171208129"></p><h2 id="é€å•èº«çš„è‡ªå·±ä¸€æŸï¼ˆ64æœµï¼‰èŠ±"><a href="#é€å•èº«çš„è‡ªå·±ä¸€æŸï¼ˆ64æœµï¼‰èŠ±" class="headerlink" title="é€å•èº«çš„è‡ªå·±ä¸€æŸï¼ˆ64æœµï¼‰èŠ±"></a>é€å•èº«çš„è‡ªå·±ä¸€æŸï¼ˆ64æœµï¼‰èŠ±</h2><p>â€‹ç†Ÿæ‚‰çš„exeé»‘æ¡†æ¡†ç¨‹åºï¼Œå›½é™…æƒ¯ä¾‹å…ˆæŸ¥å£³ï¼Œæ— å£³ç™½èŒ¶ã€‚<strong>(ã‚âˆ€ï½¥)</strong></p><p>â€‹ç¨‹åºè¡¨é¢çœ‹ä¸Šå»æ¯”è¾ƒç®€å•ï¼Œå¾ˆå®¹æ˜“è¿½è¸ªåˆ°ä¸»è¦é€»è¾‘ï¼Œä½†æ˜¯å°±æ˜¯åŠ å¯†è¿‡ç¨‹çœ‹çš„å¾ˆéš¾å—ï¼Œå‡½æ•°é‡Œé¢å¥—å¥½å‡ ä¸ªå‡½æ•°ï¼Œè¿˜éƒ½æ²¡æœ‰æ­£ç»åç§°ï¼ŒåŠŸèƒ½åˆ†æå¤ªéº»çƒ¦äº†ã€‚<strong>(â•¥ï¹â•¥)</strong></p><p>â€‹å¤ªéš¾äº†ï¼ŒåŠ¨è°ƒéƒ½çœ‹ä¸å‡ºæ¥ï¼ŒçœŸçš„æ˜¯æ— è¯­ä½äº†ã€‚æˆ‘å¥½åƒä¸å¤ªé€‚åˆå¤©å¤©åšé¢˜äº†ï¼Œéƒ½åšä¸å‡ºæ¥ï¼Œå®Œå…¨éƒ½æ²¡æ€è·¯ï¼Œå’Œæˆ‘çš„èƒ½åŠ›éƒ½ä¸åœ¨ä¸€ä¸ªæ°´å¹³ä¸Šå•Šã€‚</p><p>â€‹</p><p>â€‹è¿˜æ˜¯æ…¢æ…¢æ¥å§ï¼Œæˆ‘å®šäº†ä¸€ä¸ªç­–ç•¥ï¼šç¢°åˆ°ä¸€ä¸ªé¢˜åï¼Œå¦‚æœæ˜¯æ–°é¢˜å‹ï¼ˆæ–°è¯­è¨€æˆ–è€…æ˜¯æ–°æŠ€æœ¯ï¼‰ï¼Œä¸€å®šå°½é‡è‡ªå·±å…ˆå†™ä¸€ä¸ªdemoå‡ºæ¥çœ‹ä¸€çœ‹ç†Ÿæ‚‰ä¸€ä¸‹å…¶é€†å‘ï¼Œç„¶åä¼šäº‹åŠåŠŸå€ã€‚</p><p>â€‹çœ‹åˆ°checké‡Œé¢çš„é•¿åº¦æ¯”è¾ƒï¼Œå¯†æ–‡é•¿åº¦æ˜¯<strong>0x38</strong>ï¼Œè€Œä¸”æˆ‘ä»¬è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦39ä¸ªæ—¶ä¸º0x34ï¼Œ40å¯¹åº”0x38ï¼Œ42å¯¹åº”0x38ï¼Œ43å¯¹åº”0x3Cã€‚æ ¹æ®è¿™ä¸ªç‰¹å¾ï¼Œæˆ‘ä»¬æ¨æ–­å‡ºï¼Œå…¶ä¸­å¾ˆå¯èƒ½æœ‰base64çš„å˜æ¢ã€‚</p><p>â€‹<strong>å°ä¼™ç±½ï¼Œå¦‚æœæ— æ³•æ‰¾åˆ°å“ªäº›æ˜¯ç”¨æˆ·ä»£ç ï¼Œå°±åŠ¨è°ƒå§ï¼Œåˆ«æ€•ï¼Œè¿™é¢˜å¤§å¤šæ•°æ˜¯ç³»ç»Ÿä»£ç ã€‚</strong>ğŸ˜‚</p><p><img src="/pictures/DSBCTF2024/image-20250626161812242.png" alt="image-20250626161812242"></p><p>â€‹<img src="/pictures/DSBCTF2024/image-20250626162116531.png" alt="image-20250626162116531"></p><p>â€‹æˆ‘ä»¬çš„è¾“å…¥é•¿åº¦å°±æ˜¯40ã€41å’Œ42äº†ï¼Œå¯†æ–‡æ˜¯<code>[121, 84, 114, 67, 35, 83, 42, 76, 36, 84, 74, 116, 122, 119, 86, 65, 120, 82, 65, 77, 36, 120, 106, 80, 122, 119, 78, 67, 120, 82, 110, 70, 37, 104, 114, 86, 120, 81, 121, 77, 36, 120, 106, 94, 114, 67, 77, 77, 36, 83, 118, 79, 35, 84, 81, 97]</code>ï¼Œå³<strong>yTrC#S*L$TJtzwVAxRAM$xjPzwNCxRnF%hrVxQyM$xj^rCMM$SvO#TQa</strong>ã€‚</p><p>â€‹æ›¿æ¢è¡¨ä¸º<strong>abcdefghijklmnopqrstuvwxyz!@#$%^&amp;*()ABCDEFGHIJKLMNOPQRSTUVWXYZ&lt;&gt;a</strong>ã€‚</p><p>â€‹çœ‹äº†åŠå¤©å°±ä¸€ä¸ªæ¢è¡¨çš„base64åŠ å¯†ï¼Œä¸­é—´ä¸€å †ä¸çŸ¥é“æ˜¯å•¥çš„ä¸œè¥¿ï¼Œæœ‰è‡ªåŠ¨è¡¥**\0**ç»“æŸç¬¦çš„ï¼Œæœ‰éªŒè¯ä¸‹æ ‡çš„ã€‚æˆ‘ç›´æ¥è¢«å“é€€äº†ï¼</p><p>â€‹æœ‰ç‚¹æè‡ªå·±å¿ƒæ€äº†ã€‚</p><p><img src="/pictures/DSBCTF2024/image-20250626161332933.png" alt="image-20250626161332933"></p><p>â€‹åŸæ¥å¼€å¤´è¿˜æœ‰ä¸€ä¸ªç®€å•çš„èŠ±æŒ‡ä»¤å•Šã€‚</p><h2 id="ç ´è§£é£æœºå¤§æˆ˜"><a href="#ç ´è§£é£æœºå¤§æˆ˜" class="headerlink" title="ç ´è§£é£æœºå¤§æˆ˜"></a>ç ´è§£é£æœºå¤§æˆ˜</h2><p>â€‹æœ‰ä¸€ä¸ªæ–°é¢–çš„åè°ƒè¯•æŠ€æœ¯ï¼Œå½“åœ¨è°ƒè¯•æ—¶ï¼Œa1&#x3D;1ï¼Œä¼šé™¤ä»¥0ï¼Œå¯¼è‡´ç¨‹åºå´©æºƒï¼›æ²¡æœ‰è°ƒè¯•æ—¶ï¼Œa1&#x3D;0, è®¡ç®— (a1 - 1) &#x3D; -1ï¼Œè½¬æ¢ä¸ºæ— ç¬¦å·åæ˜¯å¾ˆå¤§çš„æ•°ï¼ˆ0xFFFFFFFFï¼‰ï¼Œ0 é™¤ä»¥ä»»ä½•éé›¶æ•°éƒ½æ˜¯ 0 â†’ è¿”å› 0ï¼Œç¨‹åºæ­£å¸¸è¿è¡Œã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __usercall sub_4120A0@&lt;eax&gt;(<span class="hljs-type">unsigned</span> __int64 a1@&lt;edx:eax&gt;)<br>&#123;<br>  LODWORD(a1) = NtCurrentPeb()-&gt;BeingDebugged;<br>  LODWORD(a1) = a1 / (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(a1 - <span class="hljs-number">1</span>);<br>  <span class="hljs-keyword">return</span> a1;<br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹å…¨éƒ¨æ‰‹åŠ¨nopä¹Ÿå¤ªéº»çƒ¦äº†ï¼Œå­¦ä¹ WPä¸­ç›´æ¥NOPæ‰è¿™ä¸ªå‡½æ•°çš„æ–¹æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">debugfun = <span class="hljs-string">b&quot;\x64\xA1\x30\x00\x00\x00\x0F\xB6\x40\x02\x89\xC3\x83\xEB\x01\xF7\xF3&quot;</span><span class="hljs-comment">#è¿™ä¸ªå‡½æ•°æ‰€æœ‰çš„å­—èŠ‚</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;a.exe&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    data = f.read()<br><br><span class="hljs-comment"># æ›¿æ¢å¹¶æ¥ä½è¿”å›å€¼</span><br>patched_data = data.replace(debugfun, <span class="hljs-string">b&quot;\x90&quot;</span> * <span class="hljs-built_in">len</span>(debugfun))<br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;b.exe&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f2:<br>    f2.write(patched_data)<br></code></pre></td></tr></table></figure><p>â€‹IDAæ‰“å¼€åï¼Œæ­£å¸¸ä»**_main**å‡½æ•°å¼€å§‹åˆ†æï¼Œå…ˆçœ‹åˆ°ä¸‰ä¸ªå‡½æ•°ï¼Œ<strong>sub_416900</strong>åº”è¯¥æ˜¯åˆå§‹åŒ–éƒ¨åˆ†ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">sub_416900</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// ebx</span><br>  <span class="hljs-type">int</span> result; <span class="hljs-comment">// eax</span><br><br>  result = dword_432038;<span class="hljs-comment">//é™æ€å˜é‡é˜²æ­¢é‡å¤æ‰§è¡Œ</span><br>  <span class="hljs-keyword">if</span> ( !dword_432038 )<br>  &#123;<br>    dword_432038 = <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; dword_418B30[i + <span class="hljs-number">1</span>]; ++i )<br>      ;<br>    <span class="hljs-keyword">for</span> ( ; i; --i )<br>      ((<span class="hljs-type">void</span> (*)(<span class="hljs-type">void</span>))dword_418B30[i])();<span class="hljs-comment">//å€’åºéå†å‡½æ•°æŒ‡é’ˆæ•°ç»„å¹¶è°ƒç”¨</span><br>    result = sub_4014C0(sub_416870);<span class="hljs-comment">//è°ƒç”¨æ³¨å†Œç±»å‡½æ•°</span><br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><hr><blockquote><p><code>RegisterClassA</code> æ˜¯ Windows API æä¾›çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äº<strong>å‘æ“ä½œç³»ç»Ÿæ³¨å†Œä¸€ä¸ªçª—å£ç±»ï¼ˆWindow Classï¼‰</strong>ï¼Œä»¥ä¾¿åç»­è°ƒç”¨ <code>CreateWindow</code> æˆ– <code>CreateWindowEx</code> åˆ›å»ºè¯¥ç±»çš„çª—å£ã€‚</p></blockquote><blockquote><p>ğŸ§  ä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Ÿå®ƒçš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>è¿™æ˜¯æ‰€è°“çš„ <strong>å‡½æ•°æŒ‡é’ˆä¼ é€’</strong>ï¼Œç›®çš„æ˜¯ï¼š</p><ul><li><strong>å»¶è¿Ÿè°ƒç”¨</strong>ï¼šæˆ‘å…ˆå‘Šè¯‰ä½ è¯¥è°ƒç”¨å“ªä¸ªå‡½æ•°ï¼Œä»¥åå†æ‰§è¡Œï¼›</li><li><strong>å›è°ƒæœºåˆ¶ï¼ˆcallbackï¼‰</strong>ï¼šæˆ‘æŠŠä½ å‘Šè¯‰æˆ‘çš„å‡½æ•°è®°ä¸‹æ¥ï¼Œç­‰äº‹ä»¶è§¦å‘æ—¶è‡ªåŠ¨è°ƒç”¨ï¼›</li><li><strong>æ¨¡å—åŒ–è®¾è®¡</strong>ï¼šè®©ç¨‹åºçš„æŸä¸ªéƒ¨åˆ†ï¼ˆæ¯”å¦‚åˆå§‹åŒ–ã€æ¸…ç†ã€å“åº”æŸä¸ªçŠ¶æ€ï¼‰èƒ½è¢«â€œçµæ´»æ›¿æ¢â€ã€‚</li></ul></blockquote><p>ä¾‹å¦‚ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">void</span> <span class="hljs-title function_">callLater</span><span class="hljs-params">(<span class="hljs-type">void</span> (*func)(<span class="hljs-type">void</span>))</span> &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;å‡†å¤‡è°ƒç”¨ä½ ç»™æˆ‘çš„å‡½æ•°ï¼\n&quot;</span>);<br>    func();  <span class="hljs-comment">// è°ƒç”¨ä¼ å…¥çš„å‡½æ•°</span><br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">sayHello</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ä½ å¥½ï¼Œæˆ‘æ˜¯ä½ ä¼ å…¥çš„å‡½æ•°ï¼\n&quot;</span>);<br>&#125;<br><br>callLater(sayHello);<br></code></pre></td></tr></table></figure><hr><p>â€‹çœ‹åˆ°<strong>sub_415291</strong>ï¼Œæ˜æ˜¾çš„win32çª—å£ç¨‹åºä»£ç ï¼Œå…¶ä½œç”¨å°±æ˜¯åˆ›å»ºä¸»çª—å£ï¼ŒåŠ è½½èµ„æºï¼ˆå›¾ç‰‡ï¼‰ï¼Œè®¾ç½®æ§ä»¶ï¼Œåˆå§‹åŒ–ä¸€äº›é€»è¾‘ç»„ä»¶ã€‚</p><p><img src="/pictures/DSBCTF2024/image-20250629145153137.png" alt="image-20250629145153137"></p><p>â€‹<strong>sub_41677B</strong>å‡½æ•°æ˜¯Windowsæ¶ˆæ¯å¾ªç¯å¤„ï¼Œæ˜¯ç¨‹åºçš„â€œä¸»å¾ªç¯â€ã€‚<strong>sub_415D40</strong>å‡½æ•°è¿›å…¥çœ‹åˆ°å‡ ç™¾è¡Œå‡½æ•°è°ƒç”¨ï¼Œç»å¤§å¤šæ•°éƒ½æ˜¯è¢«nopæ‰çš„åè°ƒè¯•å‡½æ•°ï¼Œä¸è¿‡ä¹Ÿå‡ ä¸ªå…¶ä»–å…³é”®å‡½æ•°ï¼Œå¤ªæ‡’äº†ï¼Œå°±ä¸è¦ä¸€ä¸ªä¸ªç¿»äº†ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">sub_41677B</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">int</span> result; <span class="hljs-comment">// eax</span><br><br>  <span class="hljs-keyword">while</span> ( <span class="hljs-number">1</span> )<br>  &#123;<br>    result = dword_42F98C;<span class="hljs-comment">//è¿è¡Œæ§åˆ¶å¼€å…³å˜é‡</span><br>    <span class="hljs-keyword">if</span> ( !dword_42F98C )<br>      <span class="hljs-keyword">break</span>;<br>    result = sub_414BC5();<br>    <span class="hljs-keyword">if</span> ( result &gt; <span class="hljs-number">9999</span> )<br>      <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">if</span> ( PeekMessageA(&amp;Msg, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1u</span>) )<span class="hljs-comment">//æŸ¥è¯¢æ¶ˆæ¯ï¼ˆéé˜»å¡ï¼‰</span><br>    &#123;<br>      TranslateMessage(&amp;Msg);<span class="hljs-comment">//å¤„ç†æŒ‰é”®ç­‰</span><br>      sub_415BEA();<br>      sub_41574F();<br>      DispatchMessageA(&amp;Msg);<span class="hljs-comment">//åˆ†å‘ç»™çª—å£è¿‡ç¨‹</span><br>    &#125;<br>    sub_415D40();<span class="hljs-comment">//è‡ªå®šä¹‰æ¯å¸§é€»è¾‘</span><br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹æ ¹æ®å°æ¸¸æˆçš„æç¤ºï¼Œå¾—åˆ†ä¸º10000å³å¯é€šå…³ï¼Œå¯è§<strong>sub_414BC5</strong>å‡½æ•°æ˜¯è¿”å›å¾—åˆ†äº†ï¼Œè¿›å»çœ‹çœ‹ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs C"><span class="hljs-type">int</span> <span class="hljs-title function_">sub_414BC5</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">12345</span> - dword_42F99C;<span class="hljs-comment">//è¯¥é™æ€å˜é‡æœ¬èº«åˆå§‹åŒ–ä¸º12345ï¼Œä¿è¯èµ·å§‹å¾—åˆ†ä¸º0.</span><br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹ä½†æ˜¯é€šè¿‡äº¤å‰å¼•ç”¨ï¼Œå¯ä»¥å‘ç°æœ‰å…¶ä»–å‡½æ•°åœ¨è°ƒç”¨å®ƒæŸ¥è¯¢åˆ†æ•°ï¼Œè·Ÿè¿‡å»çœ‹çœ‹<strong>sub_415C43</strong>ï¼ŒæŸ¥çœ‹äº¤å‰å¼•ç”¨ï¼Œå‘ç°è¯¥å‡½æ•°åˆšå¥½åœ¨æ¶ˆæ¯å¾ªç¯çš„<strong>sub_415D40</strong>å‡½æ•°é‡Œé¢ï¼Œå¯ä»¥çŒœæµ‹è¿™æ˜¯é€šå…³åé€»è¾‘çš„ä»£ç ã€‚</p><p>â€‹å®ƒåœ¨å¹²å˜›å‘¢ï¼Ÿå…ˆè¯»å–ç”¨æˆ·è¾“å…¥å¯†é’¥ï¼Œç„¶åå¯¹åŠ å¯†ä»£ç è¿›è¡Œå¼‚æˆ–è§£å¯†ï¼Œç„¶åé€šè¿‡<code>VirtualProtect</code> å°†è¿™å—å†…å­˜åŒºåŸŸçš„ä¿æŠ¤å±æ€§æ”¹æˆ <code>0x40</code>ï¼Œä¹Ÿå°±æ˜¯ <code>PAGE_EXECUTE_READWRITE</code>ï¼Œå…è®¸ä»£ç æ‰§è¡Œï¼Œæœ€åè°ƒç”¨è§£å¯†åçš„å‡½æ•°ã€‚å¯†é’¥æ˜¯å¤šå°‘å‘¢ï¼Ÿæ ¹æ®å‡½æ•°ç»“å°¾æ˜¯<strong>retn</strong>æŒ‡ä»¤ï¼ˆ<strong>C3</strong>ï¼‰çš„ç‰¹å¾ï¼ŒæŸ¥çœ‹åˆ°æœ€åä¸€ä¸ªåŠ å¯†å­—èŠ‚æ˜¯<strong>0Fh</strong>ï¼Œæˆ‘ä»¬å¾—å‡ºå¯†é’¥æ˜¯<strong>204</strong>ã€‚</p><p>â€‹ç”±äºä¸»å¾ªç¯é‡Œé¢æ¯å½“åˆ°10000äº†ç¨‹åºå°±ç›´æ¥é€€å‡ºäº†ï¼Œæ ¹æœ¬æ— æ³•åˆ°è¿™ä¸€å—ï¼Œæ‰€ä»¥æˆ‘ä»¬IDAæ‰‹åŠ¨æ”¹å˜ä¸€ä¸‹è·³è½¬ï¼Œè®©è¿™ä¸ªå‡½æ•°æ‰§è¡Œä¸€ä¸‹ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">sub_415C43</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">void</span> *v1; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v2; <span class="hljs-comment">// [esp+4h] [ebp-34h]</span><br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// [esp+8h] [ebp-30h]</span><br>  <span class="hljs-type">int</span> v4; <span class="hljs-comment">// [esp+Ch] [ebp-2Ch]</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [esp+10h] [ebp-28h]</span><br>  DWORD flOldProtect; <span class="hljs-comment">// [esp+14h] [ebp-24h] BYREF</span><br>  <span class="hljs-type">int</span> v7[<span class="hljs-number">3</span>]; <span class="hljs-comment">// [esp+18h] [ebp-20h] BYREF</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// [esp+28h] [ebp-10h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+2Ch] [ebp-Ch]</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [esp+30h] [ebp-8h]</span><br>  <span class="hljs-type">int</span> v11; <span class="hljs-comment">// [esp+34h] [ebp-4h]</span><br>  <span class="hljs-type">int</span> savedregs; <span class="hljs-comment">// [esp+38h] [ebp+0h]</span><br><br>  <span class="hljs-keyword">if</span> ( sub_414BC5() == <span class="hljs-number">10000</span> )<br>  &#123;<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>, v7);<br>    HIBYTE(v8) = v7[<span class="hljs-number">0</span>];<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">0x16917</span>; ++i )<br>      *((_BYTE *)sub_419060 + i) ^= HIBYTE(v8);<br>    VirtualProtect(sub_419060, <span class="hljs-number">0x16918u</span>, <span class="hljs-number">0x40u</span>, &amp;flOldProtect);<br>    v1 = <span class="hljs-built_in">malloc</span>(<span class="hljs-number">0x100000u</span>);<br>    sub_419060(v1, v2, v3, v4, v5, flOldProtect, v7[<span class="hljs-number">0</span>], v7[<span class="hljs-number">1</span>], v7[<span class="hljs-number">2</span>], v1, v8, i, v10, v11, savedregs);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹æ‰§è¡Œå®Œä¹‹åå°±å‡ºç°äº†ä¸€ä¸ª<strong>res.jpg</strong>å›¾ç‰‡ï¼Œå¾—åˆ°<strong>ctfshow{162dfd79-b4bf-455a-9065-16105e421687}</strong>ã€‚</p><p><img src="/pictures/DSBCTF2024/res.jpg" alt="res.jpg"></p><h2 id="æ²¡æ—¶é—´å¥½å¥½çˆ±ä½ ï¼Œæ‰€ä»¥é€‰æ‹©å•èº«"><a href="#æ²¡æ—¶é—´å¥½å¥½çˆ±ä½ ï¼Œæ‰€ä»¥é€‰æ‹©å•èº«" class="headerlink" title="æ²¡æ—¶é—´å¥½å¥½çˆ±ä½ ï¼Œæ‰€ä»¥é€‰æ‹©å•èº«"></a>æ²¡æ—¶é—´å¥½å¥½çˆ±ä½ ï¼Œæ‰€ä»¥é€‰æ‹©å•èº«</h2><p>â€‹å›½é™…æƒ¯ä¾‹ï¼Œå…ˆæŸ¥å£³ã€‚æ— å£³ï¼Œ64ä½ç¨‹åºã€‚</p><p>â€‹IDAç©¶æå¥½è¯»ä»£ç ï¼Œç¬¬ä¸€ä¸ªè¿·å®«<strong>sddssdsssdd</strong>ï¼Œç¬¬äºŒä¸ªæ˜¯åšæ•°ç‹¬ï¼ˆå¼€å§‹è¿˜çœ‹ä¸å‡ºæ¥ï¼‰ï¼Œçœ‹åˆ°ç¬¬ä¸‰ä¸ªç»·ä¸ä½äº†ï¼Œåˆtmè€ƒé­”æ–¹ï¼Œæˆ‘è¿™é­”æ–¹å°±è¿‡ä¸å»äº†å‘—ã€‚<strong>RRuFFRRFFUUFFRRFFuRR</strong>ã€‚ï¼ˆå¯ä»¥å»<a href="https://rubiks-cube-solver.com/">ç½‘ç«™</a>æŸ¥ï¼‰</p><p><img src="/pictures/DSBCTF2024/image-20250629164104513.png" alt="image-20250629164104513"></p><p>â€‹æœ€åçš„ç­”æ¡ˆæ˜¯<strong>sddssdsssdd513749862RRuFFRRFFUUFFRRFFuRR</strong>ã€‚</p><p>â€‹æ‰“å¼€å‹ç¼©åŒ…é‡Œé¢çš„txtæ–‡ä»¶ï¼Œçœ‹åˆ°æœ€ä¸‹é¢çš„<strong>ctfshow{After_all_Iâ€™m_t0o_busy_to h@ve_t1me_to_l0ve_y0u_we11}</strong>ã€‚</p><blockquote><p>â€‹è¿™é‡Œä¸å¾—ä¸è¡¥ä¸€ç‚¹é­”æ–¹çš„åŸºç¡€çŸ¥è¯†äº†ï¼Œå›½é™…æ¯”èµ›æ ‡å‡†é­”æ–¹æ˜¯ï¼š<strong>ä¸Šé¢ç™½è‰²ï¼Œå‰é¢ç»¿è‰²ï¼Œä¸‹é¢é»„è‰²ï¼Œåé¢è“è‰²ï¼Œå³é¢çº¢è‰²ï¼Œå·¦é¢æ©™è‰²</strong>ã€‚</p><p>â€‹é­”æ–¹é€‰æ‹©ç¬¦å·ï¼Œ<strong>Rè¡¨ç¤ºå³é¢é¡ºæ—¶é’ˆ</strong>ï¼Œ<strong>Fè¡¨ç¤ºå‰é¢é¡ºæ—¶é’ˆ</strong>ï¼Œ<strong>Uè¡¨ç¤ºä¸Šé¢é¡ºæ—¶é’ˆ</strong>ï¼Œ<strong>r(Râ€™)è¡¨ç¤ºå³é¢é€†æ—¶é’ˆ</strong>ï¼Œ<strong>f(Fâ€™)è¡¨ç¤ºå‰é¢é€†æ—¶é’ˆ</strong>ï¼Œ<strong>u(Uâ€™)è¡¨ç¤ºä¸Šé¢é€†æ—¶é’ˆ</strong>ã€‚</p></blockquote><p><img src="/pictures/DSBCTF2024/image-20250629162655820.png" alt="image-20250629162655820"></p><p>â€‹å¯ä»¥çœ‹ä¸€ä¸ªâ€œFâ€å¯¹åº”çš„ä»£ç ï¼Œå…ˆä¿å­˜å‰é¢çš„æ•°ç»„æ•°æ®ï¼Œç„¶åè¿›è¡Œé‡æ–°èµ‹å€¼ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªä»£ç é«˜ä½æœ‰ç‚¹é—®é¢˜å•Šï¼Œå› ä¸ºå®ƒåªä¿®æ”¹äº†å‰é¢ï¼Œæ²¡æœ‰ç»™å‘¨å›´çš„å››ä¸ªé¢æ›´æ–°ï¼Œä¸èƒ½è¡¨ç¤ºå®Œæ•´çš„Fæ“ä½œå•Šï¼Œæ‰€ä»¥è¯´è¿™ä¸ªå‡½æ•°åº”è¯¥åªèƒ½è¯´æ˜¯èµ·ä¸€ä¸ªâ€œæç¤ºâ€çš„ä½œç”¨ã€‚ï¼ˆåæ­£è¾“å…¥æ­£ç¡®ä¸å¦éƒ½æ˜¯ä¸€æ ·çš„æç¤ºä¿¡æ¯ï¼Œå®ƒä¹Ÿæ²¡æ£€æŸ¥ï¼‰</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">rotateFaceClockwise</span><span class="hljs-params">(<span class="hljs-type">int</span> a1)</span><span class="hljs-comment">//a1å¯èƒ½å€¼ä¸º0ã€1ã€2ï¼Œå› ä¸ºFRUæ“ä½œä¸»è¦</span><br>&#123;<br>  __int64 result; <span class="hljs-comment">// rax</span><br>  _DWORD v2[<span class="hljs-number">12</span>]; <span class="hljs-comment">// [rsp+0h] [rbp-40h]</span><br>  <span class="hljs-type">int</span> m; <span class="hljs-comment">// [rsp+30h] [rbp-10h]</span><br>  <span class="hljs-type">int</span> k; <span class="hljs-comment">// [rsp+34h] [rbp-Ch]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+38h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+3Ch] [rbp-4h]</span><br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">2</span>; ++i )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; j &lt;= <span class="hljs-number">2</span>; ++j )<br>    &#123;<br>      result = j + <span class="hljs-number">3LL</span> * i;<br>      v2[result] = cube[<span class="hljs-number">9</span> * a1 + <span class="hljs-number">3</span> * i + j];<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; k &lt;= <span class="hljs-number">2</span>; ++k )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( m = <span class="hljs-number">0</span>; m &lt;= <span class="hljs-number">2</span>; ++m )<br>    &#123;<br>      result = m + <span class="hljs-number">9LL</span> * a1 + <span class="hljs-number">3LL</span> * k;<br>      cube[result] = v2[<span class="hljs-number">3</span> * (<span class="hljs-number">2</span> - m) + k];<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;DSBCTFå•èº«æ¯&quot;&gt;&lt;a href=&quot;#DSBCTFå•èº«æ¯&quot; class=&quot;headerlink&quot; title=&quot;DSBCTFå•èº«æ¯&quot;&gt;&lt;/a&gt;DSBCTFå•èº«æ¯&lt;/h1&gt;&lt;p&gt;â€‹	&lt;a href=&quot;https://ctf-show.feishu.cn/docx</summary>
      
    
    
    
    <category term="CTF" scheme="http://bumak.github.io/categories/CTF/"/>
    
    
    <category term="å¤ç°WP" scheme="http://bumak.github.io/tags/%E5%A4%8D%E7%8E%B0WP/"/>
    
    <category term="Reverse" scheme="http://bumak.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>XYCTF2024</title>
    <link href="http://bumak.github.io/2025/06/29/XYCTF2024/XYCTF2024/"/>
    <id>http://bumak.github.io/2025/06/29/XYCTF2024/XYCTF2024/</id>
    <published>2025-06-29T02:25:00.000Z</published>
    <updated>2025-07-01T06:12:49.830Z</updated>
    
    <content type="html"><![CDATA[<h1 id="èªæ˜çš„ä¿¡ä½¿"><a href="#èªæ˜çš„ä¿¡ä½¿" class="headerlink" title="èªæ˜çš„ä¿¡ä½¿"></a>èªæ˜çš„ä¿¡ä½¿</h1><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc = <span class="hljs-string">&quot;oujp&#123;H0d_TwXf_Lahyc0_14_e3ah_Rvy0ac@wc!&#125;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    <span class="hljs-keyword">if</span> enc[i].isalpha():<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(enc[i]) &gt;= <span class="hljs-number">97</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">ord</span>(enc[i]) &lt;= <span class="hljs-number">122</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(enc[i]) - <span class="hljs-number">97</span> - <span class="hljs-number">9</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">97</span>), end=<span class="hljs-string">&quot;&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(enc[i]) - <span class="hljs-number">65</span> - <span class="hljs-number">9</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">65</span>), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(enc[i], end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure><h1 id="easy-language"><a href="#easy-language" class="headerlink" title="easy language"></a>easy language</h1><p>â€‹è‡ªå·±åˆ†æä¸å‡ºæ¥ï¼ŒWPè¯´è¿˜æ˜¯å¾—ä¸‹æ’ä»¶ã€‚</p><p>â€‹ä»Šå¤©æ™šä¸Šæœ€å¤§çš„æ”¶è·ï¼šä¸‹è½½å¥½äº†<code>IDA PRO 7.5</code>ç»¿è‰²ç‰ˆæœ¬ï¼Œå…å®‰è£…çš„ï¼Œä¸‹è½½å³ç”¨ï¼Œè¿˜èƒ½é€‚é…æ˜“è¯­è¨€åç¼–è¯‘å™¨æ’ä»¶ï¼Œè¿˜é…ç½®å¥½äº†è®¾ç½®ä¸­æ–‡å‡½æ•°åçš„é…ç½®æ–‡ä»¶é—®é¢˜å’ŒDLLæ–‡ä»¶é—®é¢˜ï¼ˆç”¨å¤§ä½¬çš„ï¼‰ï¼Œéƒ½èƒ½ç”¨ï¼Œå¤ªé€‚é…äº†ï¼Œæ²¡æœ‰å¥‡æ€ªçš„ç¯å¢ƒé—®é¢˜ï¼Œæˆ‘å¤ªçˆ±äº†ï¼Œè¿˜é¡ºå¸¦é‡åˆ°ä¸€ä¸ªåˆ†äº«IDAâ€œçš®è‚¤â€çš„å¤§ä½¬ï¼Œæˆ‘çš„IDAåˆå‡çº§äº†ï¼Œå¤ªçˆ½äº†ï¼</p><p>â€‹IDA9.0ä¹Ÿä¸‹è½½äº†ä¸€ä¸ªååˆ¶æ§åˆ¶æµå¹³å¦åŒ–çš„æ’ä»¶ï¼Œä¹Ÿå¤ªæ£’äº†ï¼</p><p>â€‹ç®€å•è®°å½•ä¸€ä¸‹æˆ‘çš„åˆ†æï¼Œå…ˆæ ¹æ®æ˜“è¯­è¨€æ’ä»¶åç¼–è¯‘çš„å‡½æ•°åæ‰¾åˆ°çœŸæ­£çš„è¾“å…¥æ¡†æ‰€åœ¨çš„é€»è¾‘å‡½æ•°ã€‚è¿™é‡Œå…ˆæ˜¯é€šè¿‡è¯»å–ç»„ä»¶çš„å±æ€§æ¥è·å–æ–‡æœ¬æ¡†çš„å†…å®¹ï¼Œç„¶åä½¿ç”¨AES-ECBåŠ å¯†ä¸€æ¬¡ï¼Œ</p><p><img src="/pictures/XYCTF2024/image-20250604094838934.png" alt="image-20250604094838934"></p><p>â€‹åœ¨SUB_403E67å‡½æ•°ä¸­è°ƒç”¨äº†SUB_403EE7å‡½æ•°ï¼Œè¿›è¡Œäº†ä¼¼äºbase64çš„ç§»ä½ã€ä¸æˆ–æ“ä½œã€‚</p><p><img src="/pictures/XYCTF2024/image-20250604095033633.png" alt="image-20250604095033633"></p><p>â€‹å›åˆ°åŸå‡½æ•°ï¼Œåé¢è¿›è¡Œäº†å­—ç¬¦æ¯”å¯¹å’Œæç¤ºä¿¡æ¯è¾“å‡ºã€‚è™½ç„¶ä»£ç æ²¡æœ‰è¿‡å¤šçš„æ··æ·†ï¼Œä½†æ˜¯è¿˜æ˜¯å¤ªéš¾çœ‹äº†ï¼ŒWPä¸Šéƒ½æ˜¯çŒœå‡ºæ¥çš„ã€‚æˆ‘åªèƒ½å…ˆå°±è¿™æ ·äº†ï¼Œå–å¯†æ–‡base64å’ŒAES-ECBè§£å¯†å³å¯ï¼Œå»æ‰¾å­—ç¬¦ä¸²å³å¯ã€‚</p><p><img src="/pictures/XYCTF2024/image-20250604095318810.png" alt="image-20250604095318810"></p><p>â€‹èµ›åšå¨å­è§£å¯†å¦‚ä¸‹ã€‚</p><p><img src="/pictures/XYCTF2024/image-20250604100537143.png" alt="image-20250604100537143"></p><h1 id="å–µå–µå–µçš„flagç¢äº†ä¸€åœ°"><a href="#å–µå–µå–µçš„flagç¢äº†ä¸€åœ°" class="headerlink" title="å–µå–µå–µçš„flagç¢äº†ä¸€åœ°"></a>å–µå–µå–µçš„flagç¢äº†ä¸€åœ°</h1><p><code>flag&#123;My_fl@g_h4s_br0ken_4parT_Bu7_Y0u_c@n_f1x_1t!&#125;</code></p><h1 id="ç»™é˜¿å§¨å€’ä¸€æ¯å¡å¸ƒå¥‡è¯º"><a href="#ç»™é˜¿å§¨å€’ä¸€æ¯å¡å¸ƒå¥‡è¯º" class="headerlink" title="ç»™é˜¿å§¨å€’ä¸€æ¯å¡å¸ƒå¥‡è¯º"></a>ç»™é˜¿å§¨å€’ä¸€æ¯å¡å¸ƒå¥‡è¯º</h1><p>â€‹é€»è¾‘å¾ˆæ¸…æ™°ï¼Œæ²¡ä»€ä¹ˆæ–°çŸ¥è¯†ï¼Œå°±æ˜¯åˆé‡æ–°ç†Ÿæ‚‰äº†ä¸€èˆ¬teaçš„é€†å‘ç®—æ³•ã€‚</p><p>â€‹è‡³äºè€é—®é¢˜ï¼ŒIDAï¼Œå¤§å°ç«¯çš„é—®é¢˜ï¼Œæˆ‘çš„è®¤è¯†æ˜¯ï¼šå…ˆåšï¼Œéƒ½è¯•ä¸€éã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-comment">//é­”æ”¹tea</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">detea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">uint32_t</span> *k, <span class="hljs-type">int</span> i)</span>;<br><span class="hljs-comment">//uint32_t data1 = 0x7472795f;</span><br><span class="hljs-type">uint32_t</span> data1 = <span class="hljs-number">0x5F797274</span>;<br><span class="hljs-type">uint32_t</span> data2 = <span class="hljs-number">0x64726168</span>;<br><span class="hljs-comment">//uint32_t data2 = 0x68617264;</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> enc[<span class="hljs-number">8</span>] = &#123;<span class="hljs-number">0x9B28ED45</span>, <span class="hljs-number">0x145EC6E9</span>, <span class="hljs-number">0x5B27A6C3</span>, <span class="hljs-number">0xE59E75D5</span>, <span class="hljs-number">0xE82C2500</span>,<span class="hljs-number">0xA4211D92</span>,<span class="hljs-number">0xCD8A4B62</span>,<span class="hljs-number">0xA668F440</span>&#125;;<br>    <span class="hljs-comment">//uint32_t enc[8] = &#123;0x45ed289b, 0xe9c65e14, 0xc3a6275b, 0xd5759ee5,0x00252ce8,0x921d21a4,0x624b8acd,0x40f468a6&#125;;</span><br>    <span class="hljs-type">char</span> key[<span class="hljs-number">16</span>] = <span class="hljs-string">&quot;give_you_cup_tea&quot;</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">6</span>; i&gt;=<span class="hljs-number">0</span>; i=i<span class="hljs-number">-2</span>)<br>    &#123;<br>        detea(enc, (<span class="hljs-type">uint32_t</span>*)key, i);<br>    &#125;<br><br>    <span class="hljs-type">char</span> *flag = (<span class="hljs-type">char</span>*)enc;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">32</span>; i++)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, flag[i]);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">detea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">uint32_t</span> *k, <span class="hljs-type">int</span> i)</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> v0 = v[i], v1 = v[i+<span class="hljs-number">1</span>];<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x6E75316C</span>;<br>    <span class="hljs-type">uint32_t</span> sum = delta * <span class="hljs-number">32</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i =<span class="hljs-number">31</span>; i &gt;= <span class="hljs-number">0</span>; i--)<br>    &#123;<br>        v1 -= ((v0 &gt;&gt; <span class="hljs-number">5</span>) + k[<span class="hljs-number">3</span>]) ^ (v0 + sum) ^ ((v0 &lt;&lt; <span class="hljs-number">4</span>) + k[<span class="hljs-number">2</span>]) ^ (sum + i);<br>        v0 -= ((v1 &gt;&gt; <span class="hljs-number">5</span>) + k[<span class="hljs-number">1</span>]) ^ (v1 + sum) ^ ((v1 &lt;&lt; <span class="hljs-number">4</span>) + k[<span class="hljs-number">0</span>]) ^ (sum + i);<br>        sum = sum - delta;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(i != <span class="hljs-number">0</span>)<br>    &#123;<br>        v0 ^= v[i<span class="hljs-number">-2</span>];<br>        v1 ^= v[i<span class="hljs-number">-1</span>];<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        v0 ^= data1;<br>        v1 ^= data2;<br>    &#125;<br>    v[i] = v0;<br>    v[i+<span class="hljs-number">1</span>] = v1;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ä½ æ˜¯çœŸçš„å¤§å­¦ç”Ÿå—ï¼Ÿ"><a href="#ä½ æ˜¯çœŸçš„å¤§å­¦ç”Ÿå—ï¼Ÿ" class="headerlink" title="ä½ æ˜¯çœŸçš„å¤§å­¦ç”Ÿå—ï¼Ÿ"></a>ä½ æ˜¯çœŸçš„å¤§å­¦ç”Ÿå—ï¼Ÿ</h1><p>â€‹ç¬¬ä¸€æ¬¡è§è¿™ç§ä¸œè¥¿ï¼Œè®°å½•ä¸€ä¸‹ã€‚è¿™ä¸ªä»£ç æ˜¯ä¸€ä¸ªä½¿ç”¨ <strong>8086å®æ¨¡å¼</strong> å’Œ <strong>MS-DOSä¸­æ–­</strong> ç¼–å†™çš„å¯æ‰§è¡Œç¨‹åºï¼Œç»“æ„ä¸Šå¾ˆå…¸å‹ã€‚</p><p>æ–‡ä»¶æå°ï¼Œåªæœ‰1kbä¸åˆ°ï¼Œç¬¬ä¸€æ¬¡çœ‹è¿™ç§è¿˜æ²¡å¾ˆé€‚åº”ï¼Œæœ‰ç‚¹é æ³¨é‡Šå’ŒçŒœã€‚IDAåç¼–è¯‘æºç å¦‚ä¸‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs assembly">dseg:0000 ;<br>dseg:0000 ; +-------------------------------------------------------------------------+<br>dseg:0000 ; |      This file was generated by The Interactive Disassembler (IDA)      |<br>dseg:0000 ; |           Copyright (c) 2024 Hex-Rays, &lt;support@hex-rays.com&gt;           |<br>dseg:0000 ; |                      License info: 48-FCB4-5471-8F                      |<br>dseg:0000 ; |                                 TOM_RUS                                 |<br>dseg:0000 ; +-------------------------------------------------------------------------+<br>dseg:0000 ;<br>dseg:0000 ; Input SHA256 : DE9713F39D770A61E966FDA9C0A9DDF6C3EF5B4037FF5AD4C7ABB962123AFEA3<br>dseg:0000 ; Input MD5    : B64AACBF6ED401B5AE4EB32A63A8E65F<br>dseg:0000 ; Input CRC32  : DF414641<br>dseg:0000 ; Compiler     : Visual C++ (guessed)<br>dseg:0000<br>dseg:0000 ; File Name   : F:\StudyFiles\CTF\Review_CTF\XYCTF2024\RE\ä½ æ˜¯çœŸçš„å¤§å­¦ç”Ÿå—ï¼Ÿ.EXE<br>dseg:0000 ; Format      : MS-DOS executable (EXE)<br>dseg:0000 ; Base Address: 1000h Range: 10000h-100AEh Loaded length: AEh<br>dseg:0000 ; Entry Point : 1005:0<br>dseg:0000<br>dseg:0000                 .686p<br>dseg:0000                 .mmx<br>dseg:0000                 .model large<br>dseg:0000<br>dseg:0000 ; ===========================================================================<br>dseg:0000<br>dseg:0000 ; Segment type: Pure data<br>dseg:0000 dseg            segment para stack &#x27;DATA&#x27; use16<br>dseg:0000                 assume cs:dseg<br>dseg:0000 unk_10000       db  0Dh                 ; DATA XREF: start+5â†“o<br>dseg:0001                 db  0Ah<br>dseg:0002                 db  69h ; i<br>dseg:0003                 db  6Eh ; n<br>dseg:0004                 db  70h ; p<br>dseg:0005                 db  75h ; u<br>dseg:0006                 db  74h ; t<br>dseg:0007                 db  20h<br>dseg:0008                 db  73h ; s<br>dseg:0009                 db  74h ; t<br>dseg:000A                 db  72h ; r<br>dseg:000B                 db  69h ; i<br>dseg:000C                 db  6Eh ; n<br>dseg:000D                 db  67h ; g<br>dseg:000E                 db  3Ah ; :<br>dseg:000F                 db  24h ; $<br>dseg:0010 unk_10010       db  0Dh                 ; DATA XREF: start+15â†“o<br>dseg:0011                 db  0Ah<br>dseg:0012                 db  24h ; $<br>dseg:0013 unk_10013       db  0Dh                 ; DATA XREF: start+52â†“o<br>dseg:0014                 db  0Ah<br>dseg:0015                 db  59h ; Y<br>dseg:0016                 db  65h ; e<br>dseg:0017                 db  73h ; s<br>dseg:0018                 db  24h ; $<br>dseg:0019 unk_10019       db  76h ; v             ; DATA XREF: start+3Dâ†“o<br>dseg:001A                 db  0Eh<br>dseg:001B                 db  77h ; w<br>dseg:001C                 db  14h<br>dseg:001D                 db  60h ; `<br>dseg:001E                 db    6<br>dseg:001F                 db  7Dh ; &#125;<br>dseg:0020                 db    4<br>dseg:0021                 db  6Bh ; k<br>dseg:0022                 db  1Eh<br>dseg:0023                 db  41h ; A<br>dseg:0024                 db  2Ah ; *<br>dseg:0025                 db  44h ; D<br>dseg:0026                 db  2Bh ; +<br>dseg:0027                 db  5Ch ; \<br>dseg:0028                 db    3<br>dseg:0029                 db  3Bh ; ;<br>dseg:002A                 db  0Bh<br>dseg:002B                 db  33h ; 3<br>dseg:002C                 db    5<br>dseg:002D unk_1002D       db  15h                 ; DATA XREF: start+Dâ†“o<br>dseg:002E byte_1002E      db 0                    ; DATA XREF: start+21â†“r<br>dseg:002F unk_1002F       db    0                 ; DATA XREF: start+39â†“o<br>dseg:0030                 db    0<br>dseg:0031                 db    0<br>dseg:0032                 db    0<br>dseg:0033                 db    0<br>dseg:0034                 db    0<br>dseg:0035                 db    0<br>dseg:0036                 db    0<br>dseg:0037                 db    0<br>dseg:0038                 db    0<br>dseg:0039                 db    0<br>dseg:003A                 db    0<br>dseg:003B                 db    0<br>dseg:003C                 db    0<br>dseg:003D                 db    0<br>dseg:003E                 db    0<br>dseg:003F                 db    0<br>dseg:0040                 db    0<br>dseg:0041                 db    0<br>dseg:0042                 db    0<br>dseg:0043                 db    0<br>dseg:0044                 db    0<br>dseg:0045                 db    0<br>dseg:0046                 db    0<br>dseg:0047                 db    0<br>dseg:0048                 db    0<br>dseg:0049                 db    0<br>dseg:004A                 db    0<br>dseg:004B                 db    0<br>dseg:004C                 db    0<br>dseg:004D                 db    0<br>dseg:004E                 db    0<br>dseg:004F                 db    0<br>dseg:004F dseg            ends<br>dseg:004F<br>seg001:0000 ; ===========================================================================<br>seg001:0000<br>seg001:0000 ; Segment type: Pure code<br>seg001:0000 seg001          segment byte public &#x27;CODE&#x27; use16<br>seg001:0000                 assume cs:seg001<br>seg001:0000                 assume es:nothing, ss:dseg, ds:nothing, fs:nothing, gs:nothing<br>seg001:0000<br>seg001:0000 ; =============== S U B R O U T I N E =======================================<br>seg001:0000<br>seg001:0000 ; Attributes: noreturn<br>seg001:0000<br>seg001:0000                 public start<br>seg001:0000 start           proc near<br>seg001:0000                 mov     ax, seg dseg<br>seg001:0003                 mov     ds, ax<br>seg001:0005                 assume ds:dseg<br>seg001:0005                 lea     dx, unk_10000<br>seg001:0009                 mov     ah, 9<br>seg001:000B                 int     21h             ; DOS - PRINT STRING<br>seg001:000B                                         ; DS:DX -&gt; string terminated by &quot;$&quot;<br>seg001:000D                 lea     dx, unk_1002D<br>seg001:0011                 mov     ah, 0Ah<br>seg001:0013                 int     21h             ; DOS - BUFFERED KEYBOARD INPUT<br>seg001:0013                                         ; DS:DX -&gt; buffer<br>seg001:0015                 lea     dx, unk_10010<br>seg001:0019                 mov     ah, 9<br>seg001:001B                 int     21h             ; DOS - PRINT STRING<br>seg001:001B                                         ; DS:DX -&gt; string terminated by &quot;$&quot;<br>seg001:001D                 xor     cx, cx<br>seg001:001F                 xor     ax, ax<br>seg001:0021                 mov     cl, byte_1002E<br>seg001:0025                 mov     si, 2Fh ; &#x27;/&#x27;<br>seg001:0028                 mov     al, [si]<br>seg001:002A                 add     si, cx<br>seg001:002C<br>seg001:002C loc_1007C:                              ; CODE XREF: start+37â†“j<br>seg001:002C                 sub     si, 1<br>seg001:002F                 xor     [si], al<br>seg001:0031                 mov     al, [si]<br>seg001:0033                 dec     cx<br>seg001:0034                 cmp     cx, 0<br>seg001:0037                 jnz     short loc_1007C<br>seg001:0039                 lea     si, unk_1002F<br>seg001:003D                 lea     di, unk_10019<br>seg001:0041<br>seg001:0041 loc_10091:                              ; CODE XREF: start+50â†“j<br>seg001:0041                 mov     al, [si]<br>seg001:0043                 mov     bl, [di]<br>seg001:0045                 add     si, 1<br>seg001:0048                 inc     di<br>seg001:0049                 cmp     al, bl<br>seg001:004B                 jnz     short loc_100AA<br>seg001:004D                 cmp     cx, 0<br>seg001:0050                 jnz     short loc_10091<br>seg001:0052                 lea     dx, unk_10013<br>seg001:0056                 mov     ah, 9<br>seg001:0058                 int     21h             ; DOS - PRINT STRING<br>seg001:0058                                         ; DS:DX -&gt; string terminated by &quot;$&quot;<br>seg001:005A<br>seg001:005A loc_100AA:                              ; CODE XREF: start+4Bâ†‘j<br>seg001:005A                 mov     ah, 4Ch<br>seg001:005C                 int     21h             ; DOS - 2+ - QUIT WITH EXIT CODE (EXIT)<br>seg001:005C start           endp                    ; AL = exit code<br>seg001:005C<br>seg001:005C seg001          ends<br>seg001:005C<br>seg001:005C<br>seg001:005C                 end start<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">data = [<span class="hljs-number">0x76</span>,<span class="hljs-number">0xe</span>,<span class="hljs-number">0x77</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0x6</span>,<span class="hljs-number">0x7d</span>,<span class="hljs-number">0x4</span>,<span class="hljs-number">0x6b</span>,<span class="hljs-number">0x1e</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x2a</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x2b</span>,<span class="hljs-number">0x5c</span>,<span class="hljs-number">0x3</span>,<span class="hljs-number">0x3b</span>,<span class="hljs-number">0xb</span>,<span class="hljs-number">0x33</span>,<span class="hljs-number">0x5</span>,<span class="hljs-number">0x15</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data),<span class="hljs-number">0</span>):<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(data[i] ^ data[i+<span class="hljs-number">1</span>]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><h1 id="ç ¸æ ¸æ¡ƒ"><a href="#ç ¸æ ¸æ¡ƒ" class="headerlink" title="ç ¸æ ¸æ¡ƒ"></a>ç ¸æ ¸æ¡ƒ</h1><p>â€‹æ–°å£³ï¼ŒNsPacK3.xï¼Œå›½äº§å£³ï¼ŒåŒ—æ–—ï¼Œé€šå¸¸æ˜¯ç—…æ¯’ä½¿ç”¨çš„å£³ã€‚è¿˜ä»¥ä¸ºç½‘ä¸Šèƒ½æ‰¾åˆ°ç°æˆçš„è„±å£³å·¥å…·ï¼Œç»è¿‡åªæœ‰ä¸€ä¸ª08å¹´çš„è€ä¸œè¥¿ï¼Œè¿˜ç”¨ä¸äº†äº†ã€‚çœ‹WPä¹Ÿæ˜¯æ‰‹åŠ¨è„±å£³ï¼Œæˆ‘ä¹Ÿæ‰‹æ’•å§ã€‚è¿˜ä»¥ä¸ºèƒ½å’Œè·å¾—æ–°å·¥å…·äº†ï¼Œå“ï¼Œè¿™ä¹Ÿæ˜¯ä¸ªå‹ç¼©å£³ï¼Œå †æ ˆå¹³è¡¡åŒæ ·é€‚ç”¨ã€‚</p><p>â€‹32ä½ç¨‹åºï¼Œå¾ˆæ˜æ˜¾çš„<code>pushfd</code>ã€<code>pushad</code>ã€<code>popfd</code>ã€<code>popad</code>æŒ‡ä»¤ã€‚</p><p>â€‹ç„¶åå°±æ˜¯æœ€åŸºç¡€çš„å¼‚æˆ–åŠ å¯†ï¼Œç›´æ¥çœ‹è„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">xor = <span class="hljs-string">&quot;this_is_not_flag&quot;</span><br>enc = [<span class="hljs-number">0x12</span>,<span class="hljs-number">0x4</span>,<span class="hljs-number">0x8</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x5c</span>,<span class="hljs-number">0x4a</span>,<span class="hljs-number">0x3d</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0xa</span>,<span class="hljs-number">0x10</span>,<span class="hljs-number">0x67</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x1</span>,<span class="hljs-number">0x46</span>,<span class="hljs-number">0x5a</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x42</span>,<span class="hljs-number">0x6e</span>,<span class="hljs-number">0xc</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0xc</span>,<span class="hljs-number">0xd</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0x3e</span>,<span class="hljs-number">0x4b</span>,<span class="hljs-number">0x5f</span>,<span class="hljs-number">0x2</span>,<span class="hljs-number">0x1</span>,<span class="hljs-number">0x4c</span>,<span class="hljs-number">0x5e</span>,<span class="hljs-number">0x5b</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x6e</span>,<span class="hljs-number">0xc</span>,<span class="hljs-number">0x16</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x5b</span>,<span class="hljs-number">0x12</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i] ^ <span class="hljs-built_in">ord</span>(xor[i % <span class="hljs-built_in">len</span>(xor)])), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><h1 id="DebugMeï¼ˆAPKï¼‰"><a href="#DebugMeï¼ˆAPKï¼‰" class="headerlink" title="DebugMeï¼ˆAPKï¼‰"></a>DebugMeï¼ˆAPKï¼‰</h1><p>â€‹apké€†å‘ï¼Œå…ˆæ”¾ä¸€è¾¹ã€‚</p><p>â€‹JADXæ‰“å¼€ï¼Œæ²¡æœ‰å¯ä»¥çœ‹çš„ä»£ç ï¼Œä¸çŸ¥é“æ€ä¹ˆå›äº‹ï¼Œå¾ˆå¤šä¹±ç ã€‚æˆ‘ä¹‹å‰çš„æ–‡ä»¶éƒ½èƒ½æ˜¾ç¤ºï¼Œå·¥å…·æ²¡æœ‰é—®é¢˜ï¼Œé‚£å°±æ˜¯æœ‰é˜²æŠ¤æ‰‹æ®µäº†ã€‚ä¸ä¼šï¼Œä¸æƒ³å»æœäº†ï¼Œç›´æ¥çœ‹WPå­¦ä¹ ã€‚</p><p>â€‹å…ˆæ‰¾èµ„æºä¸‹è½½JEBï¼Œä»˜è´¹è½¯ä»¶ï¼Œå¾—ç ´è§£ç‰ˆã€‚</p><p>â€‹ä¸‹è½½å¥½äº†ï¼Œä½¿ç”¨å’ŒJADXå·®ä¸å¤šï¼Œç”Ÿæˆçš„é¡¹ç›®æ–‡ä»¶éƒ½æ˜¯å’ŒåŸæ–‡ä»¶ä¿å­˜åœ¨ä¸€èµ·ï¼Œè¿™ä¸€ç‚¹ç‰¹åˆ«å¥½ï¼Œä¸éœ€è¦æˆ‘ä»¬è‡ªå·±å»è®¾ç½®è·¯å¾„äº†ï¼Œä¹Ÿä¸å®¹æ˜“Cç›˜çˆ†äº†ã€‚</p><p>â€‹éœ€è¦ä¿®æ”¹mainfestä¸­çš„å¯è°ƒå¼å±æ€§ã€‚ä½¿ç”¨<code>apktool d DebugMe.apk -o out</code>è§£åŒ…ï¼Œä¿®æ”¹å¥½åï¼Œä½¿ç”¨å‘½ä»¤<code>apktool b out -o target_debug.apk</code>é‡æ–°æ‰“åŒ…ã€‚ä½†æ˜¯å¥½åƒæ²¡æœ‰è¿™ä¹ˆç®€å•ã€‚</p><p>â€‹æœ€åæˆåŠŸäº†ï¼Œè®°å½•ä¸€ä¸‹ç¯å¢ƒé…ç½®çš„è¿‡ç¨‹ã€‚</p><p>â€‹é¦–å…ˆï¼Œè¦ä½¿ç”¨MTç®¡ç†å™¨ç›´æ¥åœ¨æ¨¡æ‹Ÿå™¨ä¸­ä¿®æ”¹<code>Android.mainfest.xml</code>æ–‡ä»¶ï¼Œæ·»åŠ <code>android:debuggable=&quot;true&quot;</code>ï¼Œä¿®æ”¹ä¹‹åä¿å­˜æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨MTè‡ªåŠ¨æ‰“åŒ…æˆæ–°çš„APKã€‚</p><p>â€‹å°†æ–°çš„APKé€šè¿‡æ¨¡æ‹Ÿå™¨çš„å…±äº«æ–‡ä»¶å¤¹ä¼ å›åˆ°ç”µè„‘ä¸Šï¼Œä½¿ç”¨JEBæ‰“å¼€åç¼–è¯‘ã€‚ä¹‹åå°±æ˜¯å¼€å§‹è°ƒè¯•APKäº†ï¼Œæ³¨æ„ï¼šå…ˆè¦å°†<code>adb</code>æ·»åŠ åˆ°ç¯å¢ƒå˜é‡é‡Œé¢ï¼ŒJEBå°±æ˜¯é€šè¿‡adbæ¥æ‰¾åˆ°æ¨¡æ‹Ÿå™¨è®¾å¤‡çš„ã€‚ç„¶åä½¿ç”¨ <code>adb devices</code>å‘½ä»¤æŸ¥çœ‹è®¾å¤‡ï¼Œç„¶åä½¿ç”¨å‘½ä»¤<code>adb shell am start -D -n com.xyctf.ezapk/.MainActivity</code>å¯åŠ¨å¾…è°ƒè¯•çš„è¿›ç¨‹ï¼Œå…¶ä¸­-nåé¢æ˜¯å¾…è°ƒè¯•çš„åŒ…åç­‰ç­‰ã€‚</p><p>â€‹å†åœ¨JEBä¸­æ‰“å¼€è°ƒè¯•å™¨ï¼Œé€‰æ‹©å¥½å¯¹åº”çš„æ¨¡æ‹Ÿå™¨å’Œè¿›ç¨‹ï¼Œå°±å¯ä»¥æˆåŠŸè°ƒè¯•äº†ã€‚æ­£å¸¸è°ƒè¯•æ³¨æ„åŠ æ–­ç‚¹å†è¿æ¥ç¨‹åºã€‚</p><p><img src="/pictures/XYCTF2024/image-20250603173505598.png" alt="image-20250603173505598"></p><p>â€‹<code>XYCTF&#123;d3bugg3r_15_v3ry_u53ful&#125;</code></p><h1 id="èˆ”ç‹—å››éƒ¨æ›²â€“ç®€çˆ±"><a href="#èˆ”ç‹—å››éƒ¨æ›²â€“ç®€çˆ±" class="headerlink" title="èˆ”ç‹—å››éƒ¨æ›²â€“ç®€çˆ±"></a>èˆ”ç‹—å››éƒ¨æ›²â€“ç®€çˆ±</h1><p>â€‹ä¸€å¼€å§‹å§ï¼ŒDIEåˆ†ææ˜¯ELFç¨‹åºï¼Œå°±ç›´æ¥IDAæ‰“å¼€ã€‚ï¼ˆä½†å®é™…ä¸Šæ˜¯.oæ–‡ä»¶ï¼Œä½¿ç”¨gccé“¾æ¥ï¼Œå½“ç„¶IDAåç¼–è¯‘å‡ºæ¥ä»£ç éƒ½å·®ä¸å¤šï¼‰ã€‚</p><p>â€‹æœ€åæ˜¯å¯¹srcæ•°ç»„å’Œsæ•°ç»„è¿›è¡Œæ¯”è¾ƒï¼Œä½†æ˜¯å¾ˆå¥‡æ€ªçš„æ˜¯ï¼Œsrcæ•°æ®å°±æ˜¯æ²¡æœ‰å˜åŒ–ï¼Œè¿™é‡Œæ˜¯å¯¹sæ•°ç»„åŠ å¯†ä¸¤æ¬¡åå†ä½¿ç”¨howtoloveå‡½æ•°åŠ å¯†ï¼Œæ‰€ä»¥æ­£å¸¸çš„é€†å‘é€»è¾‘ä¹Ÿåº”è¯¥æ˜¯ä¸‰æ¬¡é€†å‘å‡½æ•°è§£å¯†ã€‚<img src="/pictures/XYCTF2024/image-20250602201458975.png" alt="image-20250602201458975"></p><p>â€‹ä½†æ˜¯ï¼Œçœ‹WPå¯ä»¥åˆ†æçŸ¥ï¼Œç¨‹åºçš„æºç å°±æ˜¯å¯¹å¯†æ–‡å’Œè¾“å…¥çš„ï¼Œéƒ½è¿›è¡Œäº†åŠ å¯†ï¼Œç„¶åè°ƒç”¨howtoloveï¼Œç„¶åæ‰æ¯”å¯¹ï¼Œæ¯”å¯¹å¯¹è±¡æ˜¯<code>user_input_int</code>å’Œ<code>plaintext_int</code>ã€‚è€ŒhowtoloveåŠ å¯†çš„æ˜¯<code>loveletter</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯”å¯¹å°±æ˜¯å‡æ¯”å¯¹ï¼Œé‚£ä¸€å±‚encipheråŠ å¯†å®Œå…¨æ²¡æœ‰å¿…è¦ï¼Œå°±ç›¸å½“äºåœ¨è¾“å…¥å­—ç¬¦ä¸²å’Œå‡flagè¿›è¡Œæ˜æ–‡æ¯”å¯¹ã€‚è¿™ä¸ªç¨‹åºä¸­çš„æ¯”å¯¹å°±ä¸æ˜¯æ­£å¸¸çš„ï¼Œæˆ‘ä»¬ä¸èƒ½æŒ‰ç…§æ­£å¸¸çš„é€»è¾‘å–é¢„æœŸæˆ‘ä»¬è¾“å…¥æ­£ç¡®flagå°±ä¼šè¾“å‡ºæ­£ç¡®çš„æç¤ºä¿¡æ¯ã€‚ä¸éš¾çŒœå‡ºï¼Œä½œè€…æƒ³è¦å‘Šè¯‰æˆ‘ä»¬ï¼Œhowtoloveå‡½æ•°æ‰æ˜¯åŠ å¯†çš„é€»è¾‘ã€‚</p><p>â€‹ç®—äº†ï¼Œä¸æƒ³å¤šè¯´äº†ï¼Œæˆ‘æ€€ç–‘æºç å°±æ˜¯é”™çš„ç‰ˆæœ¬ï¼Œæ€ä¹ˆèƒ½è¿™æ ·éªŒè¯å•Šã€‚</p><p><img src="/pictures/XYCTF2024/image-20250602201907424.png" alt="image-20250602201907424"></p><p><img src="/pictures/XYCTF2024/image-20250602201956024.png" alt="image-20250602201956024"></p><p>â€‹åˆ†æåŠå¤©ï¼Œä¸€è°ƒè¯•å°±å‘ç°ï¼Œdestæ˜¯tmæŒ‡å‘srcçš„å‰¯æœ¬ï¼Œv14æ˜¯æŒ‡å‘å’ŒsåŒæ ·å†…å®¹çš„ï¼Œä½†æ˜¯v14æ˜¯æŒ‡å‘sçš„å‰¯æœ¬çš„ï¼Œåé¢çš„sæ‰æ˜¯çœŸæ­£å¯¹sæ•°ç»„è¿›è¡ŒåŠ å¯†çš„ï¼Œæ‰€ä»¥å®é™…ä¸Šæœ€åæ¯”å¯¹å°±æ˜¯srcæ•°ç»„å’Œhowtolove(s)å¾—åˆ°çš„æ•°ç»„ã€‚</p><p>â€‹ç‹—æ—¥çš„åç¼–è¯‘ä¸€ç‚¹çœ‹ä¸å‡ºæ¥ï¼Œçœ‹ç€å°±æ˜¯å¯¹æŒ‡é’ˆè¿›è¡Œæ“ä½œï¼ŒæŒ‡å‘çš„å°±æ˜¯åŒä¸€ä¸ªæ•°ç»„å•Šï¼Œå†ä¹Ÿä¸ä¿¡åç¼–è¯‘çš„ä¼ªä»£ç äº†ã€‚</p><p>â€‹å½“ç„¶ï¼Œåé¢é—®AIåˆæƒ³åˆ°ä¸€äº›ï¼šmemcpyå‡½æ•°ä¸€èˆ¬æ˜¯å¯¹ä¸¤ä¸ªä¸åŒåœ°å€çš„æ•°ç»„è¿›è¡Œå¤åˆ¶æ“ä½œï¼Œå¦‚æœv14å’ŒsæŒ‡é’ˆç›¸åŒçš„è¯ï¼Œé‚£å¤„ç†çš„å°±æ˜¯åŒä¸€å—å†…å­˜äº†ï¼Œé‚£å¤åˆ¶è¿˜æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼è¿™é‡Œå¯èƒ½èƒ½getåˆ°ä¸€äº›å¼‚å¸¸ä¹‹å¤„ï¼Œå¼€å§‹æ²¡æœ‰è¿™ä¸ªç†è§£ã€‚</p><p>â€‹ä¸‹é¢è‡ªå·±å†™çš„ä»£ç é™„ä¸Šã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span> </span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">re_howtolove</span><span class="hljs-params">(<span class="hljs-type">char</span> *a1)</span><br>&#123;<br>    <span class="hljs-type">int</span> v2[<span class="hljs-number">1802</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-comment">//memset(v2, 0, sizeof(v2));</span><br>    v2[<span class="hljs-number">32</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">65</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">66</span>] = <span class="hljs-number">4</span>;<br>    v2[<span class="hljs-number">98</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">99</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">185</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">186</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">187</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">188</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">189</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">190</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">191</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">192</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">193</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">194</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">195</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">196</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">197</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">198</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">199</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">200</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">201</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">202</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">203</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">204</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">205</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">206</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">207</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">208</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">209</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">210</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">211</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">212</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">213</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">214</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">215</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">216</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">217</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">218</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">219</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">220</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">221</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">222</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">223</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">224</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">225</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">226</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">227</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">228</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">229</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">232</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">256</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">257</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">303</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">304</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">305</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">306</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">307</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">308</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">328</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">329</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">330</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">331</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">332</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">333</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">334</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">335</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">336</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">337</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">338</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">339</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">340</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">341</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">342</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">353</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">354</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">430</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">431</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">432</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">523</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">524</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">564</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">565</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">627</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">628</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">629</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">630</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">631</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">632</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">633</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">634</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">635</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">636</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">637</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">638</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">639</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">640</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">641</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">642</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">643</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">644</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">645</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">646</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">647</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">648</span>] = <span class="hljs-number">4</span>;<br>    v2[<span class="hljs-number">649</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">650</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">651</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">652</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">653</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">680</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">687</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">688</span>] = <span class="hljs-number">4</span>;<br>    v2[<span class="hljs-number">698</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">766</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">767</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">818</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">819</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">820</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">827</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">828</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">846</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">847</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">890</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">891</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">892</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">893</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">894</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">895</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">896</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">897</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">898</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">899</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">900</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">901</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">902</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">903</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">904</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">905</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">906</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">907</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">908</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">909</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">910</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">911</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">912</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">913</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">914</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">915</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">916</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">917</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">918</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">919</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">920</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">921</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">922</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">923</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">924</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">925</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">926</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">927</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">928</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">929</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">930</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">931</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">932</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">933</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">934</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">989</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">994</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">995</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">996</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">997</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">998</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">999</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1000</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1001</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1002</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1003</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1013</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1014</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1015</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1016</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1017</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1018</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1019</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1020</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1021</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1022</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1023</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1024</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1025</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1026</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1027</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">1028</span>] = <span class="hljs-number">3</span>;<br><br>    <span class="hljs-type">int</span> v3 =<span class="hljs-number">1027</span>,v4 =<span class="hljs-number">31</span>;<br>    <br>    <span class="hljs-comment">// for(; v3&gt;=0; --v3)</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     switch(v2[v3])</span><br>    <span class="hljs-comment">//     &#123;</span><br>    <span class="hljs-comment">//         case 0:</span><br>    <span class="hljs-comment">//             --crypted[v4];</span><br>    <span class="hljs-comment">//             break;</span><br>    <span class="hljs-comment">//         case 1:</span><br>    <span class="hljs-comment">//             ++crypted[v4];</span><br>    <span class="hljs-comment">//             break;</span><br>    <span class="hljs-comment">//         case 2:</span><br>    <span class="hljs-comment">//             v4--;</span><br>    <span class="hljs-comment">//             break;</span><br>    <span class="hljs-comment">//         case 4:</span><br>    <span class="hljs-comment">//             crypted[v4] -= crypted[v4+1] + 70 ;è¿™é‡Œå°±æ˜¯é”™è¯¯ä¹‹å¤„ï¼Œè¿™ä¸ªé”™è¯¯è¯­å¥ç­‰ä»·äº-(crypted[v4+1]+70)ï¼Œæ˜¯é”™è¯¯çš„å•Šï¼Œæˆ‘ä»¬è¦çš„å®é™…ä¸Šæ˜¯-crypted[v4+1]-70ã€‚</span><br>    <span class="hljs-comment">//             break;</span><br>    <span class="hljs-comment">//         case 5:</span><br>    <span class="hljs-comment">//             crypted[v4] += crypted[v4+1] - 70 ;è¿™é‡ŒåŒç†ã€‚</span><br>    <span class="hljs-comment">//             break;</span><br>    <span class="hljs-comment">//         default:</span><br>    <span class="hljs-comment">//             break;</span><br>    <span class="hljs-comment">//     &#125;</span><br>    <span class="hljs-comment">// &#125;</span><br>    <br>    <span class="hljs-keyword">for</span>(; v3&gt;=<span class="hljs-number">0</span>; --v3)<br>    &#123;<br>        <span class="hljs-keyword">switch</span>(v2[v3])<br>        &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>                --a1[v4];<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>                ++a1[v4];<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>                v4--;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>                a1[v4] = a1[v4] - a1[v4+<span class="hljs-number">1</span>] + <span class="hljs-number">70</span> ;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br>                a1[v4] = a1[v4] + a1[v4+<span class="hljs-number">1</span>] - <span class="hljs-number">70</span> ;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">default</span>:<br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//æ— ç”¨çš„tea</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">detea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">uint32_t</span> *k)</span><br>&#123;<br>    <span class="hljs-type">int</span> rounds = <span class="hljs-number">52</span>;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>];<br>    <span class="hljs-type">uint32_t</span> v1 = v[<span class="hljs-number">1</span>];<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x9E3779B9</span>;<br>    <span class="hljs-type">uint32_t</span> sum = delta * rounds;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;rounds;i++)<br>    &#123;<br>        v1 -= (((v0 &gt;&gt; <span class="hljs-number">4</span>)^(v0&lt;&lt;<span class="hljs-number">5</span>)) + v0) ^ (k[(sum &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>] + sum);<br>        sum -= delta;<br>        v0 -= (((v1 &gt;&gt; <span class="hljs-number">4</span>)^(v1&lt;&lt;<span class="hljs-number">5</span>)) + v1) ^ (k[sum &amp; <span class="hljs-number">3</span>] + sum);<br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0;<br>    v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">char</span> crypted[<span class="hljs-number">32</span>] = <span class="hljs-string">&quot;flag&#123;Love_is_not_one_sided_Love&#125;&quot;</span>;<br>    re_howtolove(crypted);<br>    <span class="hljs-comment">//uint32_t key[4] = &#123;0x12345678,0x9ABCDEF0,0x9AB111F0,0x9A323EF0&#125;;</span><br>    <span class="hljs-comment">//detea((uint32_t *)crypted, key);</span><br>    <span class="hljs-comment">//detea((uint32_t *)crypted, key);</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">32</span>;i++)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,crypted[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="ä½•é¡»ç›¸æ€ç…®ä½™å¹´"><a href="#ä½•é¡»ç›¸æ€ç…®ä½™å¹´" class="headerlink" title="ä½•é¡»ç›¸æ€ç…®ä½™å¹´"></a>ä½•é¡»ç›¸æ€ç…®ä½™å¹´</h1><p>â€‹ç»™äº†ä¸ªçº¯æ–‡æœ¬ï¼Œ6ï¼Œçœ‹ç€åº”è¯¥æ˜¯æœºå™¨ç å’Œå¯†æ–‡ã€‚ç»“æœè·ªäº†ï¼Œ32ã€64ä½éƒ½ä¸è¡Œã€‚</p><p>â€‹çœ‹WPä½¿ç”¨äº†ä¸€ä¸ªpythonåº“ï¼Œæ¥è¿›è¡Œåæ±‡ç¼–ï¼Œæ˜¯x86-32çš„ã€‚</p><p>â€‹ä¸‹é¢æ˜¯åæ±‡ç¼–çš„ä»£ç ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> capstone <span class="hljs-keyword">import</span> *<br><br>code = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">0x55  0x8b  0xec  0x81  0xec  0xa8  0x0  0x0  0x0  0xa1  0x0  0x40  0x41  0x0  0x33  0xc5  0x89  0x45  0xfc  0x68  0x9c  0x0  0x0  0x0  0x6a  0x0  0x8d  0x85  0x60  0xff  0xff  0xff  0x50  0xe8  0x7a  0xc  0x0  0x0  0x83  0xc4  0xc  0xc7  0x85  0x58  0xff  0xff  0xff  0x27  0x0  0x0  0x0  0xc7  0x85  0x5c  0xff  0xff  0xff  0x0  0x0  0x0  0x0  0xeb  0xf  0x8b  0x8d  0x5c  0xff  0xff  0xff  0x83  0xc1  0x1  0x89  0x8d  0x5c  0xff  0xff  0xff  0x83  0xbd  0x5c  0xff  0xff  0xff  0x27  0xf  0x8d  0xed  0x0  0x0  0x0  0x8b  0x95  0x5c  0xff  0xff  0xff  0x81  0xe2  0x3  0x0  0x0  0x80  0x79  0x5  0x4a  0x83  0xca  0xfc  0x42  0x85  0xd2  0x75  0x25  0x8b  0x85  0x5c  0xff  0xff  0xff  0x8b  0x8c  0x85  0x60  0xff  0xff  0xff  0x3  0x8d  0x5c  0xff  0xff  0xff  0x8b  0x95  0x5c  0xff  0xff  0xff  0x89  0x8c  0x95  0x60  0xff  0xff  0xff  0xe9  0xac  0x0  0x0  0x0  0x8b  0x85  0x5c  0xff  0xff  0xff  0x25  0x3  0x0  0x0  0x80  0x79  0x5  0x48  0x83  0xc8  0xfc  0x40  0x83  0xf8  0x1  0x75  0x22  0x8b  0x8d  0x5c  0xff  0xff  0xff  0x8b  0x94  0x8d  0x60  0xff  0xff  0xff  0x2b  0x95  0x5c  0xff  0xff  0xff  0x8b  0x85  0x5c  0xff  0xff  0xff  0x89  0x94  0x85  0x60  0xff  0xff  0xff  0xeb  0x73  0x8b  0x8d  0x5c  0xff  0xff  0xff  0x81  0xe1  0x3  0x0  0x0  0x80  0x79  0x5  0x49  0x83  0xc9  0xfc  0x41  0x83  0xf9  0x2  0x75  0x23  0x8b  0x95  0x5c  0xff  0xff  0xff  0x8b  0x84  0x95  0x60  0xff  0xff  0xff  0xf  0xaf  0x85  0x5c  0xff  0xff  0xff  0x8b  0x8d  0x5c  0xff  0xff  0xff  0x89  0x84  0x8d  0x60  0xff  0xff  0xff  0xeb  0x38  0x8b  0x95  0x5c  0xff  0xff  0xff  0x81  0xe2  0x3  0x0  0x0  0x80  0x79  0x5  0x4a  0x83  0xca  0xfc  0x42  0x83  0xfa  0x3  0x75  0x20  0x8b  0x85  0x5c  0xff  0xff  0xff  0x8b  0x8c  0x85  0x60  0xff  0xff  0xff  0x33  0x8d  0x5c  0xff  0xff  0xff  0x8b  0x95  0x5c  0xff  0xff  0xff  0x89  0x8c  0x95  0x60  0xff  0xff  0xff  0xe9  0xf7  0xfe  0xff  0xff  0x33  0xc0  0x8b  0x4d  0xfc  0x33  0xcd  0xe8  0x4  0x0  0x0  0x0  0x8b  0xe5  0x5d  0xc3</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>opcode = []<br>code = code.split()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(code), <span class="hljs-number">1</span>):<br>    opcode.append(<span class="hljs-built_in">int</span>(code[i][<span class="hljs-number">2</span>:], <span class="hljs-number">16</span>))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(opcode[i]), end=<span class="hljs-string">&#x27; &#x27;</span>)<br><br><br>opcode = <span class="hljs-built_in">bytes</span>(opcode)<br><br>BaseAddr = <span class="hljs-number">0</span><br><br>md = Cs(CS_ARCH_X86, CS_MODE_32)<br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> md.disasm(opcode, <span class="hljs-number">0</span>):<br>    addr = x.address + BaseAddr<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(addr)[<span class="hljs-number">2</span>:],x.mnemonic,x.op_str)<br></code></pre></td></tr></table></figure><p>â€‹è¿™ä¸ªé¢˜è¿˜æ˜¯ä¸€ç‚¹éš¾åº¦çš„ï¼Œéœ€è¦æ“…é•¿æ±‡ç¼–ä»£ç ï¼Œæˆ–è€…æ“…é•¿chatgptï¼ˆå“ˆå“ˆï¼‰ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs assembly">1 mov ebp, esp<br>3 sub esp, 0xa8<br>9 mov eax, dword ptr [0x414000]<br>e xor eax, ebp<br>10 mov dword ptr [ebp - 4], eax<br>13 push 0x9c<br>18 push 0<br>1a lea eax, [ebp - 0xa0]<br>20 push eax<br>21 call 0xca0<br>26 add esp, 0xc<br>29 mov dword ptr [ebp - 0xa8], 0x27<br>33 mov dword ptr [ebp - 0xa4], 0<br>3d jmp 0x4e<br>3f mov ecx, dword ptr [ebp - 0xa4]<br>45 add ecx, 1<br>48 mov dword ptr [ebp - 0xa4], ecx;i++<br>4e cmp dword ptr [ebp - 0xa4], 0x27;i&lt;0x27<br>55 jge 0x148<br>5b mov edx, dword ptr [ebp - 0xa4]<br>61 and edx, 0x80000003;å–ç¬¦å·ä½å’Œæœ€ä½2ä½<br>67 jns 0x6e;ç»“æœéè´Ÿè·³è½¬<br>69 dec edx<br>6a or edx, 0xfffffffc<br>6d inc edx<br>6e test edx, edx;æŒ‰ä½ä¸ï¼Œä½†ä¸ä¿å­˜ç»“æœï¼Œåªè®¾ç½®æ ‡å¿—ä½Z<br>70 jne 0x97;edx!=0è·³è½¬<br>72 mov eax, dword ptr [ebp - 0xa4]<br>78 mov ecx, dword ptr [ebp + eax*4 - 0xa0];æ•°ç»„å–å€¼ï¼Œè®¾æ•°ç»„æ˜¯s<br>7f add ecx, dword ptr [ebp - 0xa4];s[i]+i<br>85 mov edx, dword ptr [ebp - 0xa4]<br>8b mov dword ptr [ebp + edx*4 - 0xa0], ecx    ;s[i]=s[i]+i<br>92 jmp 0x143<br>97 mov eax, dword ptr [ebp - 0xa4]<br>9d and eax, 0x80000003<br>a2 jns 0xa9;ç¬¦å·ä½ä¸º0è·³è½¬<br>a4 dec eax<br>a5 or eax, 0xfffffffc<br>a8 inc eax<br>a9 cmp eax, 1<br>ac jne 0xd0<br>ae mov ecx, dword ptr [ebp - 0xa4]<br>b4 mov edx, dword ptr [ebp + ecx*4 - 0xa0]<br>bb sub edx, dword ptr [ebp - 0xa4];s[i]-i<br>c1 mov eax, dword ptr [ebp - 0xa4]<br>c7 mov dword ptr [ebp + eax*4 - 0xa0], edx;s[i]=s[i]-i<br>ce jmp 0x143<br>d0 mov ecx, dword ptr [ebp - 0xa4]<br>d6 and ecx, 0x80000003<br>dc jns 0xe3<br>de dec ecx<br>df or ecx, 0xfffffffc<br>e2 inc ecx<br>e3 cmp ecx, 2<br>e6 jne 0x10b<br>e8 mov edx, dword ptr [ebp - 0xa4]<br>ee mov eax, dword ptr [ebp + edx*4 - 0xa0]<br>f5 imul eax, dword ptr [ebp - 0xa4];s[i] * i<br>fc mov ecx, dword ptr [ebp - 0xa4]<br>102 mov dword ptr [ebp + ecx*4 - 0xa0], eax<br>109 jmp 0x143<br>10b mov edx, dword ptr [ebp - 0xa4]<br>111 and edx, 0x80000003<br>117 jns 0x11e<br>119 dec edx<br>11a or edx, 0xfffffffc<br>11d inc edx<br>11e cmp edx, 3<br>121 jne 0x143<br>123 mov eax, dword ptr [ebp - 0xa4]<br>129 mov ecx, dword ptr [ebp + eax*4 - 0xa0]<br>130 xor ecx, dword ptr [ebp - 0xa4];s[i] ^ i<br>136 mov edx, dword ptr [ebp - 0xa4]<br>13c mov dword ptr [ebp + edx*4 - 0xa0], ecx<br>143 jmp 0x3f<br>148 xor eax, eax<br>14a mov ecx, dword ptr [ebp - 4]<br>14d xor ecx, ebp<br>14f call 0x158<br>154 mov esp, ebp<br>156 pop ebp<br>157 ret <br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc = [<span class="hljs-number">88</span>,<span class="hljs-number">88</span>,<span class="hljs-number">134</span>,<span class="hljs-number">87</span>,<span class="hljs-number">74</span>,<span class="hljs-number">118</span>,<span class="hljs-number">318</span>,<span class="hljs-number">101</span>,<span class="hljs-number">59</span>,<span class="hljs-number">92</span>,<span class="hljs-number">480</span>,<span class="hljs-number">60</span>,<span class="hljs-number">65</span>,<span class="hljs-number">41</span>,<span class="hljs-number">770</span>,<span class="hljs-number">110</span>,<span class="hljs-number">73</span>,<span class="hljs-number">31</span>,<span class="hljs-number">918</span>,<span class="hljs-number">39</span>,<span class="hljs-number">120</span>,<span class="hljs-number">27</span>,<span class="hljs-number">1188</span>,<span class="hljs-number">47</span>,<span class="hljs-number">77</span>,<span class="hljs-number">24</span>,<span class="hljs-number">1352</span>,<span class="hljs-number">44</span>,<span class="hljs-number">81</span>,<span class="hljs-number">23</span>,<span class="hljs-number">1680</span>,<span class="hljs-number">46</span>,<span class="hljs-number">85</span>,<span class="hljs-number">15</span>,<span class="hljs-number">1870</span>,<span class="hljs-number">66</span>,<span class="hljs-number">91</span>,<span class="hljs-number">16</span>,<span class="hljs-number">4750</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">4</span> == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i]-i), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">4</span> == <span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i]+i), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">4</span> == <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i]//i), end=<span class="hljs-string">&#x27;&#x27;</span>)<span class="hljs-comment">#éœ€è¦æ˜¯æ•´é™¤ï¼Œå‘ä¸‹å–æ•´</span><br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">4</span> == <span class="hljs-number">3</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i]^i), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-keyword">continue</span><br></code></pre></td></tr></table></figure><h1 id="ez-enc"><a href="#ez-enc" class="headerlink" title="ez_enc"></a>ez_enc</h1><p>â€‹</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc = [<span class="hljs-number">0x27</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0xb</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x3</span>,<span class="hljs-number">0xc8</span>,<span class="hljs-number">0xc</span>,<span class="hljs-number">0x1f</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x36</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0xcb</span>,<span class="hljs-number">0x2d</span>,<span class="hljs-number">0xe9</span>,<span class="hljs-number">0x32</span>,<span class="hljs-number">0xe</span>,<span class="hljs-number">0x11</span>,<span class="hljs-number">0x26</span>,<span class="hljs-number">0x2</span>,<span class="hljs-number">0xc</span>,<span class="hljs-number">0x7</span>,<span class="hljs-number">0xfc</span>,<span class="hljs-number">0x27</span>,<span class="hljs-number">0x3d</span>,<span class="hljs-number">0x2d</span>,<span class="hljs-number">0xed</span>,<span class="hljs-number">0x35</span>,<span class="hljs-number">0x59</span>,<span class="hljs-number">0xeb</span>,<span class="hljs-number">0x3c</span>,<span class="hljs-number">0x3e</span>,<span class="hljs-number">0xe4</span>,<span class="hljs-number">0x7d</span>]<br><br>key = <span class="hljs-string">&quot;IMouto&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)-<span class="hljs-number">2</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>    enc[i] = enc[i] ^ <span class="hljs-built_in">ord</span>(key[i%<span class="hljs-number">6</span>])<br>    enc[i] = enc[i] - enc[i+<span class="hljs-number">1</span>]<br><br>    <span class="hljs-comment">#ç”¨ä¸Šä¸€ä¸ªå­—ç¬¦æ±‚å‡ºæ¥çš„tmpå¿…æ»¡è¶³åœ¨0åˆ°20ä¹‹é—´çš„é™åˆ¶</span><br>    tmp = enc[i-<span class="hljs-number">1</span>] ^ <span class="hljs-built_in">ord</span>(key[(i-<span class="hljs-number">1</span>)%<span class="hljs-number">6</span>])<br>    tmp = tmp - enc[i]<br>    enc[i] += tmp // <span class="hljs-number">20</span> * <span class="hljs-number">20</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;f&quot;</span>, end=<span class="hljs-string">&quot;&quot;</span>)<span class="hljs-comment">#ç¬¬ä¸€ä¸ªå°±ä¸ç”¨ç®—äº†</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(enc)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i]), end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure><h1 id="baby-unity"><a href="#baby-unity" class="headerlink" title="baby unity"></a>baby unity</h1><p>â€‹æ¸¸æˆæ˜¯unityåšçš„è¾“å…¥éªŒè¯æ–‡æœ¬æ¡†ï¼Ÿå“ˆï¼Œè¿™ä¹ˆææ˜¯å§ï¼Œå°æ¸¸æˆéƒ½ä¸ç»™ç©ï¼Œä¸ä¼šé€†ï¼Œç›´æ¥å­¦WPã€‚</p><p>â€‹GameAssembly.dllå’Œbaby unity.exeéƒ½è¢«upxå‹ç¼©äº†ä¸€ä¸‹ï¼Œå¸ˆå‚…è¯´å•çº¯ä¸ºäº†å‡å°‘é™„ä»¶çš„å¤§å°ï¼Œå“ˆï¼Œè¿˜å¾—å…ˆå»å£³ã€‚</p><p>â€‹å…ˆä½¿ç”¨Il2CppDumper.exeæ¢å¤ç¬¦å·ä¿¡æ¯ï¼Œå…ˆé€‰.dllæ–‡ä»¶ï¼Œå†é€‰.batæ–‡ä»¶ã€‚ç„¶åä½¿ç”¨IDAæ‰“å¼€DLLæ–‡ä»¶ï¼Œä½¿ç”¨pythonè„šæœ¬ida_with_struct_py3.pyåŠ è½½åˆšåˆšå¾—åˆ°çš„script.jsonå’Œil2cpp.hæ–‡ä»¶ã€‚</p><p>â€‹å†ä½¿ç”¨dnSpyå»æŸ¥çœ‹Assembly-CSharp.dllæ–‡ä»¶ï¼Œçœ‹å…¶ä¸­å¯ç–‘çš„ç±»åã€æ–¹æ³•åï¼Œä½†æ˜¯é‡Œé¢æ˜¯æ²¡åŠæ³•çœ‹æºç çš„ï¼Œæ‰€ä»¥è¦å›åˆ°IDAä¸­æŸ¥çœ‹åç¼–è¯‘çš„æºç ï¼Œç”±äºæ¢å¤äº†ç¬¦å·ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨IDAç›´æ¥æœç´¢å‡½æ•°åå°±è¡Œäº†ã€‚</p><p><img src="/pictures/XYCTF2024/image-20250605150220575.png" alt="image-20250605150220575"></p><p><img src="/pictures/XYCTF2024/image-20250605150236561.png" alt="image-20250605150236561"></p><p>â€‹çœ‹åˆ°IDAï¼Œæˆ‘ä»¬æ¢ä¸ªä¸»é¢˜é¢œè‰²ï¼Œä¹‹å‰çš„æœ‰ç‚¹çœ‹è…»äº†ã€‚çœ‹åˆ°æ˜æ˜¾çš„base64å’Œå¼‚æˆ–0xFï¼Œæ¯”è¾ƒå¥‡æ€ªçš„æ˜¯å¯†æ–‡å±…ç„¶æ˜¯åœ¨æ³¨é‡Šé‡Œï¼Œéš¾ä¸æˆè¿™ä¸ª8å­—èŠ‚ä¿å­˜çš„æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å…¶ä»–æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²ï¼Œè¿™é‡Œèƒ½çœ‹åˆ°æ˜¯å› ä¸ºæ¢å¤äº†ç¬¦å·ä¿¡æ¯ï¼Œè¿™é‡Œè‡ªåŠ¨æŠŠå­—ç¬¦ä¸²å–å‡ºæ”¾åœ¨è¿™é‡Œäº†ï¼Ÿ</p><p>â€‹ä¹‹åèµ›åšå¨å­è§£å¯†å°±å¥½ã€‚</p><p><img src="/pictures/XYCTF2024/image-20250605151110999.png" alt="image-20250605151110999"></p><p><img src="/pictures/XYCTF2024/image-20250605151155177.png" alt="image-20250605151155177"></p><h1 id="ez-unityï¼ˆæœªåšï¼Œç¯å¢ƒä¸è¡Œï¼‰"><a href="#ez-unityï¼ˆæœªåšï¼Œç¯å¢ƒä¸è¡Œï¼‰" class="headerlink" title="ez unityï¼ˆæœªåšï¼Œç¯å¢ƒä¸è¡Œï¼‰"></a>ez unityï¼ˆæœªåšï¼Œç¯å¢ƒä¸è¡Œï¼‰</h1><p>â€‹è¿™ç§il2cppçš„unityé€†å‘å®Œå…¨æ²¡æœ‰æ¥è§¦è¿‡ï¼Œç°åœ¨éƒ½æ˜¯å®è¡ŒWPå­¦ä¹ å¤§æ³•ï¼Œé…ç¯å¢ƒå°±èŠ±äº†å¥½é•¿æ—¶é—´ï¼Œä¸‹é¢è®°å½•ä¸€ä¸‹æˆ‘è¸©çš„å‘ã€‚</p><p>â€‹é¦–å…ˆå°†èƒ½å¤Ÿç”Ÿæˆhook.jsè„šæœ¬çš„æ–¹æ³•ï¼Œå…ˆé€šè¿‡pipä¸‹è½½å¥½fridaå’Œfrida-toolså·¥å…·ï¼Œç„¶åé€šè¿‡<code>npm i frida-il2cpp-bridge</code>å‘½ä»¤ä¸‹è½½ä¸‹æ¥æ¡†æ¶ï¼Œç„¶åé…ç½®package.jsonæ–‡ä»¶ï¼Œå…·ä½“å†…å®¹æ ¹æ®éœ€è¦é…ç½®ï¼ˆå½“ç„¶å»æŠ„ï¼‰ï¼Œ<a href="https://blog.csdn.net/weixin_44292683/article/details/132125663">è¯¦ç»†çš„æ•™ç¨‹</a>æ–‡ç« å°±æ˜¯è¿™ä¸ªï¼Œå°±æ˜¯å…¶ä¸­çš„æ–¹æ³•2ã€‚</p><p>â€‹åœ¨ä¸€åˆ‡å‡†å¤‡å°±ç»ªåï¼Œæˆ‘æ‰§è¡Œç¬¬ä¸€ä¸ªæ³¨å…¥å‘½ä»¤å°±æŠ¥é”™äº†ï¼Œæˆ‘åå¤æ›´æ¢æ–‡ä»¶ï¼Œæ›´æ¢fridaç¯å¢ƒåˆ°16.2.1å’Œ17.1.0ï¼Œä¹Ÿé‡ä¸‹äº†é¢˜ç›®é™„ä»¶ï¼Œåœ¨è™šæ‹ŸæœºCTFOSå’Œæœ¬æœºä¸Šéƒ½è¯•è¿‡äº†ï¼Œä½†æ˜¯éƒ½æ˜¯æŠ¥å‡ºåŒæ ·ä¸€ä¸ªé”™è¯¯ï¼Œæˆ‘å®Œå…¨ä¸ç†è§£æ˜¯ä¸ºä»€ä¹ˆã€‚</p><p><img src="/pictures/XYCTF2024/image-20250606202411829.png" alt="image-20250606202411829"></p><p>â€‹åé¢ä½¿ç”¨æ•™ç¨‹çš„ç¬¬ä¸€ç§æ–¹æ³•ç¼–è¯‘frida-il2cpp-bridgeé¡¹ç›®åï¼Œä¹Ÿæ˜¯æ²¡èƒ½è§£å†³é—®é¢˜ã€‚</p><p><img src="/pictures/XYCTF2024/image-20250606204030666.png" alt="image-20250606204030666"></p><p>â€‹</p><h1 id="ezmath"><a href="#ezmath" class="headerlink" title="ezmath"></a>ezmath</h1><p>â€‹pythoné€†å‘ï¼Œä¸€ä¸ªäºŒæ¬¡å¤šé¡¹å¼æ±‚è§£é—®é¢˜ï¼Œå­¦ä¹ z3æ±‚è§£å™¨ã€‚è§£åŒ…å‡ºæ¥ï¼Œæ˜¯ä»¥è¿™ç§å½¢å¼æ¥è¡¨ç¤ºä¹˜ç§¯çš„ï¼š<code>sum( (lambda .0: [ flag[23] for _ in .0 ])(range(flag[23])) )</code>ã€‚</p><p>â€‹å¼ºè¡Œä½¿ç”¨z3ç ´è§£ï¼Œè€—æ—¶å¾ˆé•¿ï¼Œæˆ‘ç­‰äº†åå‡ åˆ†é’Ÿéƒ½æ²¡ç»“æœï¼Œä¸çŸ¥é“è¿˜è¦ç®—å¤šä¹…ï¼Œç›´æ¥çœ‹WPï¼Œæœ‰ä¸€ä¸ªå¾ˆå·§å¦™çš„æ€è·¯ï¼Œå› ä¸ºè¿™ä¸ªäºŒæ¬¡å¤šé¡¹å¼&#x3D;0ï¼Œè€Œä¸”å¼å­ä¸­æ¯ä¸ªäºŒæ¬¡é¡¹çš„ç³»æ•°éƒ½æ˜¯1ï¼Œæˆ‘ä»¬çŸ¥é“(x_i - ord(flag[i]))**2 &#x3D; 0ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„è¿™äº›å¼å­å±•å¼€å°±ä¼šå¾—åˆ°è¯¥é¢˜çš„çš„å¼å­ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé™„ä»¶ä¸­ç»™å‡ºçš„äºŒæ¬¡å¤šé¡¹å¼å°±æ˜¯å°†äºŒæ¬¡å¹³æ–¹é¡¹å±•å¼€çš„ç»“æœã€‚è¿™æ ·å°±æœ‰ä¸€ä¸ªè§„å¾‹äº†ï¼Œæ‰€æœ‰çš„ä¸€æ¬¡é¡¹ç³»æ•°é™¤ä»¥2å°±æ˜¯å¯¹åº”çš„å¸¸æ•°å€¼ï¼ˆå¯¹åº”flagçš„ASCIIç å€¼ï¼‰ã€‚</p><p>â€‹åº”è¯¥è¯´è¿™æ˜¯ä¸€ä¸ªæ•°å­¦æ¨å¯¼æŠ€å·§ï¼Œåœ¨æ•°å­¦é¢˜ä¸­ä¹Ÿä¼šä½¿ç”¨çš„æŠ€å·§ã€‚åˆä¸­ç”Ÿéƒ½ä¼šï¼Œå¤§å­¦ç”Ÿæƒ³ä¸åˆ°ä¸€ç‚¹ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">flag = (lambda .0: [ ord(i) for i in .0 ])(input(&#x27;flag:&#x27;))</span><br><span class="hljs-string">if len(flag) == 32 and (((((((((((((((((((((sum((lambda .0: [ flag[23] for _ in .0 ])(range(flag[23]))) + sum((lambda .0: [ flag[12] for _ in .0 ])(range(flag[12]))) + sum((lambda .0: [ flag[1] for _ in .0 ])(range(flag[1]))) - sum((lambda .0: [ flag[24] for _ in .0 ])(range(222)))) + sum((lambda .0: [ flag[22] for _ in .0 ])(range(flag[22]))) + sum((lambda .0: [ flag[31] for _ in .0 ])(range(flag[31]))) + sum((lambda .0: [ flag[26] for _ in .0 ])(range(flag[26]))) - sum((lambda .0: [ flag[9] for _ in .0 ])(range(178))) - sum((lambda .0: [ flag[29] for _ in .0 ])(range(232)))) + sum((lambda .0: [ flag[17] for _ in .0 ])(range(flag[17]))) - sum((lambda .0: [ flag[23] for _ in .0 ])(range(150))) - sum((lambda .0: [ flag[6] for _ in .0 ])(range(226))) - sum((lambda .0: [ flag[7] for _ in .0 ])(range(110)))) + sum((lambda .0: [ flag[19] for _ in .0 ])(range(flag[19]))) + sum((lambda .0: [ flag[2] for _ in .0 ])(range(flag[2]))) - sum((lambda .0: [ flag[0] for _ in .0 ])(range(176)))) + sum((lambda .0: [ flag[10] for _ in .0 ])(range(flag[10]))) - sum((lambda .0: [ flag[12] for _ in .0 ])(range(198)))) + sum((lambda .0: [ flag[24] for _ in .0 ])(range(flag[24]))) + sum((lambda .0: [ flag[9] for _ in .0 ])(range(flag[9]))) - sum((lambda .0: [ flag[3] for _ in .0 ])(range(168)))) + sum((lambda .0: [ flag[8] for _ in .0 ])(range(flag[8]))) - sum((lambda .0: [ flag[2] for _ in .0 ])(range(134)))) + sum((lambda .0: [ flag[14] for _ in .0 ])(range(flag[14]))) - sum((lambda .0: [ flag[13] for _ in .0 ])(range(170)))) + sum((lambda .0: [ flag[4] for _ in .0 ])(range(flag[4]))) - sum((lambda .0: [ flag[10] for _ in .0 ])(range(142)))) + sum((lambda .0: [ flag[27] for _ in .0 ])(range(flag[27]))) + sum((lambda .0: [ flag[15] for _ in .0 ])(range(flag[15]))) - sum((lambda .0: [ flag[15] for _ in .0 ])(range(224)))) + sum((lambda .0: [ flag[16] for _ in .0 ])(range(flag[16]))) - sum((lambda .0: [ flag[11] for _ in .0 ])(range(230))) - sum((lambda .0: [ flag[1] for _ in .0 ])(range(178)))) + sum((lambda .0: [ flag[28] for _ in .0 ])(range(flag[28]))) - sum((lambda .0: [ flag[5] for _ in .0 ])(range(246))) - sum((lambda .0: [ flag[17] for _ in .0 ])(range(168)))) + sum((lambda .0: [ flag[30] for _ in .0 ])(range(flag[30]))) - sum((lambda .0: [ flag[21] for _ in .0 ])(range(220))) - sum((lambda .0: [ flag[22] for _ in .0 ])(range(212))) - sum((lambda .0: [ flag[16] for _ in .0 ])(range(232)))) + sum((lambda .0: [ flag[25] for _ in .0 ])(range(flag[25]))) - sum((lambda .0: [ flag[4] for _ in .0 ])(range(140))) - sum((lambda .0: [ flag[31] for _ in .0 ])(range(250))) - sum((lambda .0: [ flag[28] for _ in .0 ])(range(150)))) + sum((lambda .0: [ flag[11] for _ in .0 ])(range(flag[11]))) + sum((lambda .0: [ flag[13] for _ in .0 ])(range(flag[13]))) - sum((lambda .0: [ flag[14] for _ in .0 ])(range(234)))) + sum((lambda .0: [ flag[7] for _ in .0 ])(range(flag[7]))) - sum((lambda .0: [ flag[8] for _ in .0 ])(range(174)))) + sum((lambda .0: [ flag[3] for _ in .0 ])(range(flag[3]))) - sum((lambda .0: [ flag[25] for _ in .0 ])(range(242)))) + sum((lambda .0: [ flag[29] for _ in .0 ])(range(flag[29]))) + sum((lambda .0: [ flag[5] for _ in .0 ])(range(flag[5]))) - sum((lambda .0: [ flag[30] for _ in .0 ])(range(142))) - sum((lambda .0: [ flag[26] for _ in .0 ])(range(170))) - sum((lambda .0: [ flag[19] for _ in .0 ])(range(176)))) + sum((lambda .0: [ flag[0] for _ in .0 ])(range(flag[0]))) - sum((lambda .0: [ flag[27] for _ in .0 ])(range(168)))) + sum((lambda .0: [ flag[20] for _ in .0 ])(range(flag[20]))) - sum((lambda .0: [ flag[20] for _ in .0 ])(range(212)))) + sum((lambda .0: [ flag[21] for _ in .0 ])(range(flag[21]))) + sum((lambda .0: [ flag[6] for _ in .0 ])(range(flag[6]))) + sum((lambda .0: [ flag[18] for _ in .0 ])(range(flag[18]))) - sum((lambda .0: [ flag[18] for _ in .0 ])(range(178)))) + 297412 == 0:</span><br><span class="hljs-string">    print(&#x27;yes&#x27;)</span><br><span class="hljs-string">    return None</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-comment">#æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œ]ä¸éœ€è¦è½¬ä¹‰å•Šã€‚</span><br>pattern = <span class="hljs-string">r&quot;sum\(\(lambda .0: \[ flag\[(\d+)] for _ in .0 ]\)\(range\((\d+)\)\)\)&quot;</span><br><br>matches = re.findall(pattern, <span class="hljs-built_in">str</span>)<br><br>flag = [<span class="hljs-number">0</span>] * <span class="hljs-number">32</span><br><br><span class="hljs-keyword">for</span> <span class="hljs-keyword">match</span> <span class="hljs-keyword">in</span> matches:<br>    flag[<span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>[<span class="hljs-number">0</span>])] = <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>[<span class="hljs-number">1</span>])//<span class="hljs-number">2</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><h1 id="èˆ”ç‹—å››éƒ¨æ›²â€“ç›¸é€¢å·²æ˜¯ä¸Šä¸Šç­¾"><a href="#èˆ”ç‹—å››éƒ¨æ›²â€“ç›¸é€¢å·²æ˜¯ä¸Šä¸Šç­¾" class="headerlink" title="èˆ”ç‹—å››éƒ¨æ›²â€“ç›¸é€¢å·²æ˜¯ä¸Šä¸Šç­¾"></a>èˆ”ç‹—å››éƒ¨æ›²â€“ç›¸é€¢å·²æ˜¯ä¸Šä¸Šç­¾</h1><p>â€‹åˆæ˜¯8086+DOSç³»åˆ—ï¼ŒIDAç›´æ¥æ‰“å¼€è¿˜ä¸è¡Œã€‚ç®—äº†ï¼Œä¹±ä¸ƒå…«ç³Ÿçš„ï¼Œç›´æ¥çœ‹WPã€‚</p><p>â€‹æœ‰æ ‡å¿—ä½è¢«ä¿®æ”¹äº†ï¼Œå¦‚ä¸‹å›¾ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸Šé¢çš„çº¢æ¡†åº”è¯¥æ˜¯ä¸‹é¢çš„PEå¤´çš„åœ°å€ï¼Œè¿™é‡Œè¢«æ”¹äº†ï¼Œè¦æ”¹å›0x100ï¼Œä¹Ÿå°±æ˜¯0001ã€‚ä¹‹åå°±èƒ½IDAæ­£å¸¸è¯†åˆ«äº†ã€‚</p><p><img src="/pictures/XYCTF2024/image-20250601115228908.png" alt="image-20250601115228908"></p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#z3ç ´è§£key</span><br><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># å®šä¹‰å˜é‡ï¼Œå‡è®¾æ˜¯æ•´æ•°</span><br>byte = [Int(<span class="hljs-string">f&#x27;byte_<span class="hljs-subst">&#123;i&#125;</span>&#x27;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>)]<br><br>s = Solver()<br><br><span class="hljs-comment"># å˜é‡èŒƒå›´å‡è®¾ï¼šæ¯”å¦‚å­—èŠ‚å¯æ‰“å°å­—ç¬¦èŒƒå›´(32~126)ï¼Œæˆ–è€…0~255</span><br><span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> byte:<br>    s.add(b &gt;= <span class="hljs-number">32</span>, b &lt;= <span class="hljs-number">126</span>)<br><br><span class="hljs-comment"># æ·»åŠ æ–¹ç¨‹</span><br>s.add(<br>    <span class="hljs-number">532</span> * byte[<span class="hljs-number">5</span>] + <span class="hljs-number">829</span> * byte[<span class="hljs-number">4</span>] + <span class="hljs-number">258</span> * byte[<span class="hljs-number">3</span>] + <span class="hljs-number">811</span> * byte[<span class="hljs-number">2</span>] + <span class="hljs-number">997</span> * byte[<span class="hljs-number">1</span>] + <span class="hljs-number">593</span> * byte[<span class="hljs-number">0</span>] == <span class="hljs-number">292512</span>,<br>    <span class="hljs-number">576</span> * byte[<span class="hljs-number">5</span>] + <span class="hljs-number">695</span> * byte[<span class="hljs-number">4</span>] + <span class="hljs-number">602</span> * byte[<span class="hljs-number">3</span>] + <span class="hljs-number">328</span> * byte[<span class="hljs-number">2</span>] + <span class="hljs-number">686</span> * byte[<span class="hljs-number">1</span>] + <span class="hljs-number">605</span> * byte[<span class="hljs-number">0</span>] == <span class="hljs-number">254496</span>,<br>    <span class="hljs-number">580</span> * byte[<span class="hljs-number">5</span>] + <span class="hljs-number">448</span> * byte[<span class="hljs-number">4</span>] + <span class="hljs-number">756</span> * byte[<span class="hljs-number">3</span>] + <span class="hljs-number">449</span> * byte[<span class="hljs-number">2</span>] + <span class="hljs-number">512</span> * byte[<span class="hljs-number">1</span>] + <span class="hljs-number">373</span> * byte[<span class="hljs-number">0</span>] == <span class="hljs-number">222479</span>,<br>    <span class="hljs-number">597</span> * byte[<span class="hljs-number">5</span>] + <span class="hljs-number">855</span> * byte[<span class="hljs-number">4</span>] + <span class="hljs-number">971</span> * byte[<span class="hljs-number">3</span>] + <span class="hljs-number">422</span> * byte[<span class="hljs-number">2</span>] + <span class="hljs-number">635</span> * byte[<span class="hljs-number">1</span>] + <span class="hljs-number">560</span> * byte[<span class="hljs-number">0</span>] == <span class="hljs-number">295184</span>,<br>    <span class="hljs-number">524</span> * byte[<span class="hljs-number">5</span>] + <span class="hljs-number">324</span> * byte[<span class="hljs-number">4</span>] + <span class="hljs-number">925</span> * byte[<span class="hljs-number">3</span>] + <span class="hljs-number">388</span> * byte[<span class="hljs-number">2</span>] + <span class="hljs-number">507</span> * byte[<span class="hljs-number">1</span>] + <span class="hljs-number">717</span> * byte[<span class="hljs-number">0</span>] == <span class="hljs-number">251887</span>,<br>    <span class="hljs-number">414</span> * byte[<span class="hljs-number">5</span>] + <span class="hljs-number">495</span> * byte[<span class="hljs-number">4</span>] + <span class="hljs-number">518</span> * byte[<span class="hljs-number">3</span>] + <span class="hljs-number">884</span> * byte[<span class="hljs-number">2</span>] + <span class="hljs-number">368</span> * byte[<span class="hljs-number">1</span>] + <span class="hljs-number">312</span> * byte[<span class="hljs-number">0</span>] == <span class="hljs-number">211260</span><br>)<br><br><span class="hljs-keyword">if</span> s.check() == sat:<br>    model = s.model()<br>    solution = [model[b].as_long() <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> byte]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(solution[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No solution found.&quot;</span>)<br><span class="hljs-comment">#XYCTF!</span><br></code></pre></td></tr></table></figure><p>â€‹è¿™ä¸ªå¸é¢˜æœ‰æ€ªä¸œè¥¿ï¼Œè„šæœ¬ç»å¯¹æœ‰æ€ªä¸œè¥¿ã€‚ä»Šå¤©å°±è®©æˆ‘ç¢°ä¸Šäº†ï¼ŒçœŸtmæ™¦æ°”ã€‚ã€‚</p><p>â€‹ä¸‹é¢æ˜¯æˆ‘ç…§ç€WPæ”¹äº†ä¸€ç‚¹èƒ½è·‘çš„è„šæœ¬ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//xxteaè§£å¯†</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DELTA 0x9E3779B9</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MX (((z ^ key[e ^ (p &amp; 5)]) + (y ^ sum)) ^ (((z <span class="hljs-string">&lt;&lt; 4) ^(y &gt;</span>&gt; 3)) + ((y <span class="hljs-string">&lt;&lt; 2) ^ (z &gt;</span>&gt; 5))))</span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">dexxtea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">int</span> n, <span class="hljs-type">char</span> *key)</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> e = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint32_t</span> rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<br>    <span class="hljs-type">uint32_t</span> sum = DELTA * rounds;<br>    <span class="hljs-type">uint32_t</span> y = <span class="hljs-number">0</span>, z = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint32_t</span> p;<br>    <span class="hljs-keyword">do</span>&#123;<br>        e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">5</span>;<br>        <span class="hljs-keyword">for</span>(p=n<span class="hljs-number">-1</span>; p&gt;<span class="hljs-number">0</span>; p--)<br>        &#123;<br>            y = v[(p+<span class="hljs-number">1</span>)%n];     <span class="hljs-comment">//ä¿å­˜åŠ å¯†ä½çš„åä¸€ä½</span><br>            z = v[(p<span class="hljs-number">-1</span>)%n];         <span class="hljs-comment">//ä¿å­˜åŠ å¯†ä½çš„å‰ä¸€ä½</span><br>            v[p] -= MX;<br>        &#125;<br>        y = v[(p+<span class="hljs-number">1</span>)%n];     <span class="hljs-comment">//ä¿å­˜åŠ å¯†ä½çš„åä¸€ä½</span><br>        z = v[(p<span class="hljs-number">-1</span>)%n];         <span class="hljs-comment">//ä¿å­˜åŠ å¯†ä½çš„å‰ä¸€ä½</span><br>        v[p] -= MX;<br>        sum -= DELTA;<br>    &#125;<span class="hljs-keyword">while</span>(--rounds);<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> enc[<span class="hljs-number">8</span>] = &#123;<span class="hljs-number">0x66697271</span>,<span class="hljs-number">0x896E2285</span>,<span class="hljs-number">0xC5188C1B</span>,<span class="hljs-number">0x72BCFD03</span>,<span class="hljs-number">0x538011CA</span>,<span class="hljs-number">0x4DA146AC</span>,<span class="hljs-number">0x86630D6B</span>,<span class="hljs-number">0xF89797F0</span>&#125;;<br>    <span class="hljs-type">char</span> *key = <span class="hljs-string">&quot;XYCTF!&quot;</span>;<br>    dexxtea(enc, <span class="hljs-number">8</span>, key);<br>    <span class="hljs-type">char</span> *flag = (<span class="hljs-type">char</span>*)enc;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i &lt; <span class="hljs-number">32</span>;i++)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,flag[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œçœ‹è¿™ä¸ªå¾ªç¯ä½“çš„å†…å®¹ï¼Œä¸Šé¢èƒ½è·‘ï¼Œä¸‹é¢å°±æ˜¯é”™çš„ã€‚å·®åˆ«å°±åœ¨äºp&#x3D;0çš„æƒ…å†µï¼Œæ˜¯æ”¾åœ¨å¾ªç¯ä½“å†…éƒ¨ï¼Œè¿˜æ˜¯æ”¾åœ¨å¾ªç¯ä½“å¤–éƒ¨äº†ã€‚ç»“æœè¯¦ç»†ä¿¡æ¯åˆ†æï¼Œæˆ‘å¾—åˆ°ä¸€ç§å¯èƒ½è§£é‡Šï¼šå› ä¸ºpæ˜¯æ— ç¬¦å·32ä½æ•´æ•°ï¼Œæ°¸è¿œå¤§äºç­‰äº0ï¼Œæ‰€ä»¥ä¸‹é¢çš„æƒ…å†µåº”è¯¥æ˜¯æ— é™å¾ªç¯ï¼Œåœ¨ç¼–è¯‘å™¨ä¼˜åŒ–çš„æƒ…å†µåï¼Œè¿™ä¸ªåœ°æ–¹åº”è¯¥è¢«è¯†åˆ«å‡ºæ˜¯æ— é™å¾ªç¯ï¼Œç›´æ¥ä¸­æ–­ç¨‹åºäº†ï¼Œåœ¨forå¾ªç¯é‡Œé¢æ’å…¥printfæ ¹æœ¬ä¸è¾“å‡ºå•Šã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">do</span>&#123;<br>        e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">5</span>;<br>        <span class="hljs-keyword">for</span>(p=n<span class="hljs-number">-1</span>; p&gt;<span class="hljs-number">0</span>; p--)<br>        &#123;<br>            y = v[(p+<span class="hljs-number">1</span>)%n];     <span class="hljs-comment">//ä¿å­˜åŠ å¯†ä½çš„åä¸€ä½</span><br>            z = v[(p<span class="hljs-number">-1</span>)%n];         <span class="hljs-comment">//ä¿å­˜åŠ å¯†ä½çš„å‰ä¸€ä½</span><br>            v[p] -= MX;<br>        &#125;<br>        y = v[(p+<span class="hljs-number">1</span>)%n];     <span class="hljs-comment">//ä¿å­˜åŠ å¯†ä½çš„åä¸€ä½</span><br>        z = v[(p<span class="hljs-number">-1</span>)%n];         <span class="hljs-comment">//ä¿å­˜åŠ å¯†ä½çš„å‰ä¸€ä½</span><br>        v[p] -= MX;<br>        sum -= DELTA;<br>&#125;<span class="hljs-keyword">while</span>(--rounds);<br>    <br>    <br><span class="hljs-keyword">do</span>&#123;<br>        e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">5</span>;<br>        <span class="hljs-keyword">for</span>(p=n<span class="hljs-number">-1</span>; p&gt;=<span class="hljs-number">0</span>; p--)<br>        &#123;<br>            y = v[(p+<span class="hljs-number">1</span>)%n];     <span class="hljs-comment">//ä¿å­˜åŠ å¯†ä½çš„åä¸€ä½</span><br>            z = v[(p<span class="hljs-number">-1</span>)%n];         <span class="hljs-comment">//ä¿å­˜åŠ å¯†ä½çš„å‰ä¸€ä½</span><br>            v[p] -= MX;<br>        &#125;<br>        sum -= DELTA;<br>&#125;<span class="hljs-keyword">while</span>(--rounds);<br></code></pre></td></tr></table></figure><p>â€‹ç¬¬äºŒä¸ªé—®é¢˜æ¥äº†ï¼ŒæŒ‰ç…§ç¬¬ä¸€ä¸ªèƒ½è·‘çš„ç‰ˆæœ¬ï¼Œæˆ‘å°†pçš„ç±»å‹æ”¹ä¸ºintå‹ï¼Œä¸ºä»€ä¹ˆå°±åˆä¸è¡Œäº†ï¼Ÿ</p><p>â€‹ç¬¬äºŒä¸ªé—®é¢˜ä¹Ÿæœ‰äº†ç­”æ¡ˆï¼šçœ‹åˆ°è¿™ä¸ªå‚æ•°zçš„ä»£ç <code>z = v[(p-1)%n];</code> ã€‚æ— è®ºpæ˜¯æœ‰ç¬¦å·32ä½æ•´æ•°ï¼Œè¿˜æ˜¯æ— ç¬¦å·ï¼Œ<code>p-1ï¼ˆp=0ï¼‰</code>åœ¨æœºå™¨å†…çš„è¡¨ç¤ºéƒ½æ˜¯<code>FFFFFFFF</code>ï¼Œé€šè¿‡æ ¼å¼åŒ–å­—ç¬¦<code>%x</code>è¾“å‡ºéƒ½æ˜¯è¿™æ ·çš„ã€‚è€Œåˆ†åˆ«é€šè¿‡<code>%d %u</code>è¾“å‡ºï¼Œå´æ˜¯<code>-1</code>å’Œ<code>4294967295</code>ã€‚å†çœ‹ï¼Œ<code>(p-1)%8</code>åœ¨é€šè¿‡<code>%08x</code>è¾“å‡ºçš„æ—¶å€™å´åˆ†åˆ«æ˜¯<code>ffffffff</code> <code>00000007</code>ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨æœ‰ç¬¦å·æ•°ä¸­<code>-1%8=-1</code>ã€‚æ— ç¬¦å·æ•°<code>FFFFFFFF</code>ï¼ˆ<code>4294967295</code>ï¼‰æ¨¡8æ˜¯ç­‰äº7çš„ã€‚æ‰€ä»¥ä¼šå¯¼è‡´zçš„å–å€¼æ—¶çš„ç´¢å¼•å€¼ä¸ä¸€æ ·ã€‚</p><p>â€‹</p><p>â€‹ç»¼ä¸Šï¼Œæ€»ç»“å‡ºæ— ç¬¦å·æ•°å½“ç´¢å¼•å€¼ï¼Œè¦ç‰¹æ®Šå¤„ç†ç­‰äº0çš„æƒ…å†µï¼›æœ‰ç¬¦å·æ•°çš„æ¨¡è¿ç®—ä¸­ï¼Œè´Ÿæ•°æ¨¡æ­£æ•°è¿˜æ˜¯è´Ÿæ•°ã€‚</p><h1 id="Trustmeï¼ˆAPKï¼‰"><a href="#Trustmeï¼ˆAPKï¼‰" class="headerlink" title="Trustmeï¼ˆAPKï¼‰"></a>Trustmeï¼ˆAPKï¼‰</h1><p>â€‹åˆæ˜¯apkï¼Œæ”¾ä¸€è¾¹ã€‚è¿˜æ˜¯å­¦ä¹ WPã€‚</p><p>â€‹è¿™ä¸ªå€’æ˜¯æŒºæ­£å¸¸ï¼Œå¯ä»¥ä½¿ç”¨JADXæ‰“å¼€åˆ†æã€‚MainActivityä¸­æœ‰å‡çš„åˆ¤æ–­ï¼Œå¯¹å…¶è¿›è¡Œè§£å¯†å‡ºæ¥å¾—åˆ°ç”¨æˆ·åã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data: <span class="hljs-built_in">bytes</span>, key: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-comment"># KSA: Key Scheduling Algorithm</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    <span class="hljs-comment"># PRGA: Pseudo-Random Generation Algorithm</span><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        out.append(char ^ S[(S[i] + S[j]) % <span class="hljs-number">256</span>])<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br><span class="hljs-comment"># è¾“å…¥å¯†æ–‡ï¼ˆåå…­è¿›åˆ¶ï¼‰å’Œå¯†é’¥</span><br>cipher_hex = <span class="hljs-string">&quot;5a3c46e0228b444decc7651c8a7ca93ba4cb35a46f7eb589bef4&quot;</span><br>cipher_bytes = <span class="hljs-built_in">bytes</span>.fromhex(cipher_hex)<br>key = <span class="hljs-string">b&quot;XYCTF&quot;</span><br><br><span class="hljs-comment"># è§£å¯†</span><br>plaintext_bytes = rc4(cipher_bytes, key)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;åŸæ–‡å¯†ç æ˜¯:&quot;</span>, plaintext_bytes.decode())<br><span class="hljs-comment">#åŸæ–‡å¯†ç æ˜¯: The Real username is admin</span><br></code></pre></td></tr></table></figure><p>â€‹ä½†æ˜¯æ²¡æœ‰å…¶ä»–ä¿¡æ¯äº†ï¼Œæˆ‘ä»¬ç¿»çœ‹åˆ°Proxyç±»ï¼Œçœ‹åˆ°å…¶ä¸­åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„shell.apkï¼Œæ˜¯å¯¹class.dexä¸­çš„æ•°æ®è¿›è¡Œæå–æ“ä½œçš„ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">data: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    <span class="hljs-comment"># å¯¹æ¯ä¸ªå­—èŠ‚å¼‚æˆ– 0xFF</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(b ^ <span class="hljs-number">0xFF</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">split_payload_from_dex</span>(<span class="hljs-params">bArr: <span class="hljs-built_in">bytes</span>, apkFileName: <span class="hljs-built_in">str</span></span>):<br>    <span class="hljs-comment"># å– dex æœ«å°¾4ä¸ªå­—èŠ‚ï¼Œè¯»å–payloadé•¿åº¦ï¼ˆintï¼Œ4å­—èŠ‚ï¼‰</span><br>    readInt = struct.unpack(<span class="hljs-string">&quot;&gt;I&quot;</span>, bArr[-<span class="hljs-number">4</span>:])[<span class="hljs-number">0</span>]  <span class="hljs-comment"># å¤§ç«¯ï¼Œè·ŸJavaé»˜è®¤DataInputStream.readIntä¸€æ ·</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Payload length: <span class="hljs-subst">&#123;readInt&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># å–å‡ºpayloadæ•°æ®</span><br>    payload_encrypted = bArr[-<span class="hljs-number">4</span> - readInt : -<span class="hljs-number">4</span>]<br><br>    <span class="hljs-comment"># è§£å¯†</span><br>    payload_decrypted = decrypt(payload_encrypted)<br><br>    <span class="hljs-comment"># å†™å…¥è§£å¯†åçš„ APK æ–‡ä»¶</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(apkFileName, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(payload_decrypted)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Decrypted payload saved to <span class="hljs-subst">&#123;apkFileName&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># ç¤ºä¾‹è°ƒç”¨</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-comment"># å‡è®¾ dex.bin æ˜¯ä½ æ•´ä¸ª dex æ–‡ä»¶</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;F:\StudyFiles\CTF\Review_CTF\XYCTF2024\RE\Trustme\classes.dex&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        dex_bytes = f.read()<br><br>    split_payload_from_dex(dex_bytes, <span class="hljs-string">&quot;shell.apk&quot;</span>)<br></code></pre></td></tr></table></figure><p>â€‹å¾—åˆ°shell.apkåï¼Œçœ‹åˆ°äº†å¯†æ–‡æ¯”å¯¹çš„é€»è¾‘ï¼Œå°±æ˜¯ä½¿ç”¨sqlè¯­å¥éªŒè¯ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®ã€‚ä½†æ˜¯ï¼Œapkè§£å‹åå¾—åˆ°çš„&#x2F;assets&#x2F;mydb.dbæ–‡ä»¶æ˜¯æ— æ³•æ­£å¸¸è¯»å–çš„ï¼Œä»”ç»†è¯»æºç ï¼Œçœ‹åˆ°MoveSQLiteUtilç±»ä¸­æœ‰åˆ›å»ºdbæ–‡ä»¶çš„æ–¹æ³•ï¼Œæ˜¯å¯¹mydb.dbæ–‡ä»¶å¼‚æˆ–0xffè§£å¯†å¾—åˆ°çš„ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;F:\StudyFiles\CTF\Review_CTF\XYCTF2024\RE\Trustme\assets\mydb.db&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    data = f.read()<br>    new_data = <span class="hljs-built_in">bytearray</span>(data)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>        new_data[i] = data[i] ^ <span class="hljs-number">0xff</span><br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;F:\StudyFiles\CTF\Review_CTF\XYCTF2024\RE\Trustme\assets\mydb_decrypted.db&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f2:<br>        f2.write(new_data)<br></code></pre></td></tr></table></figure><p>â€‹æ‰“å¼€è§£å¯†æ–‡ä»¶ï¼Œå°±çœ‹åˆ°äº†flagã€‚</p><p>â€‹è¿™é¢˜è¿˜æœ‰SQLæ³¨å…¥æ¼æ´ï¼Œå¯†ç ä¸º<code>&#39; or 1=1 --</code>å°±èƒ½å¾—åˆ°flagã€‚</p><h1 id="é¦’å¤´"><a href="#é¦’å¤´" class="headerlink" title="é¦’å¤´"></a>é¦’å¤´</h1><p>â€‹æ— å£³ï¼ŒIDAæ‰“å¼€ï¼Œä»£ç å¾ˆæ¸…æ™°ï¼Œè€ƒå¯Ÿçš„æ˜¯<code>å“ˆå¤«æ›¼æ ‘</code>æ•°æ®ç»“æ„ï¼Œå¥½ä¹…ä¹‹å‰å­¦çš„æ•°æ®ç»“æ„äº†ï¼Œç°åœ¨éƒ½å¿˜äº†ï¼Œé‡æ–°æ¸©ä¹ ä¸€ä¸‹ã€‚çœ‹ä¸æ‡‚å•Šï¼ŒçœŸçš„éš¾ã€‚è¿™é¢˜å°±è®¤çœŸåˆ†æä¸€éï¼Œå®Œæ•´å†™æ€è·¯ï¼Œå½“ä½œæ˜¯å­¦ä¹ æ–°çŸ¥è¯†äº†ã€‚</p><p>â€‹é€šè¿‡å­¦ä¹ ï¼ŒçŸ¥é“äº†IDAä¸­é€šè¿‡<code>add type</code>è‡ªå®šä¹‰ç»“æ„ä½“ï¼Œç„¶åé€šè¿‡<code>Y</code>é”®ä¿®æ”¹åç¼–è¯‘çš„å‡½æ•°å‚æ•°ç±»å‹ä¸ºè‡ªå®šä¹‰çš„ç»“æ„ä½“æŒ‡é’ˆï¼Œè¿™æ ·IDAå°±èƒ½è‡ªåŠ¨è¯†åˆ«äº†ã€‚</p><p>â€‹å…ˆçœ‹ç»“æ„åˆå§‹åŒ–å‡½æ•°ï¼Œè¿™é‡Œå“ˆå¤«æ›¼æ ‘æ˜¯é€šè¿‡<code>æ•°ç»„</code>ä¿å­˜çš„å•Šï¼Œè€Œa1å°±æ˜¯è¿™ä¸ªæŒ‡å‘è¿™ä¸ªæ•°ç»„çš„æŒ‡é’ˆï¼Œè¿™ä¸ªæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œè¿™é‡Œå¹¶ä¸æ˜¯æŒ‡é’ˆæ•°ç»„ï¼Œè€Œæ˜¯ç»“æ„ä½“æ•°ç»„ã€‚<code>(*a1)[i]</code>å°±æ˜¯ç¬¬iä¸ªèŠ‚ç‚¹ï¼Œè€Œå…¶indexå°±æ˜¯å…¶åœ¨åŸå­—ç¬¦ä¸²ä¸­çš„ä¸‹æ ‡ã€‚</p><p><img src="/pictures/XYCTF2024/image-20250603135741772.png" alt="image-20250603135741772"></p><p>â€‹çœ‹åˆ°createå‡½æ•°æ˜¯æ„å»ºå“ˆå¤«æ›¼æ ‘çš„ã€‚</p><p><img src="/pictures/XYCTF2024/image-20250603140500857.png" alt="image-20250603140500857"></p><p>â€‹çœ‹åˆ°checkå‡½æ•°ï¼Œè¿™é‡Œå¾ˆå·§å¦™çš„å¯¹å·¦å¶å­èŠ‚ç‚¹è¿›è¡Œäº†å€¼å’Œä¸‹æ ‡çš„æ¯”å¯¹ï¼Œè€Œå¯¹å³å¶å­èŠ‚ç‚¹åªè¿›è¡Œäº†ä¸‹æ ‡çš„æ¯”å¯¹ï¼Œè¿™æ ·å°±ä¸å¿…æŠŠæ‰€æœ‰flagçš„å­—ç¬¦å€¼å…¨ä¿å­˜åœ¨å˜é‡ä¸­ï¼Œæ˜¾çš„å¤ªç®€å•ã€‚åŒæ—¶ä¹Ÿå¯ä»¥æ ‡æ³¨å­—ç¬¦åœ¨flagä¸­çš„ä½ç½®ã€‚</p><p><img src="/pictures/XYCTF2024/image-20250603140650890.png" alt="image-20250603140650890"></p><p>â€‹ç†æ¸…é€»è¾‘åï¼Œæˆ‘å¼€å§‹æ˜¯æ‰‹åŠ¨è§£å¯†ï¼Œå°±åƒæ˜¯ä¸‹é¢è¿™æ ·ï¼Œåœ¨æ‰‹åŠ¨æ“ä½œçš„è¿‡ç¨‹ä¸­æˆ‘æ‰¾åˆ°äº†è§„å¾‹ã€‚</p><p>â€‹å°±æ˜¯å¯æ‰“å°å­—ç¬¦çš„æ•°å­—åœ¨32åˆ°126ä¹‹é—´ï¼Œé‚£ä¹ˆä»1åˆ°24çš„æ•°å­—ä¸€å®šæ˜¯è¡¨ç¤ºä¸‹æ ‡çš„ï¼Œå¹¶ä¸”ç”±äºå“ˆå¤«æ›¼æ ‘æ˜¯æ»¡äºŒå‰æ ‘ï¼Œå³é™¤å¶å­èŠ‚ç‚¹å¤–çš„å…¶ä»–èŠ‚ç‚¹éƒ½æœ‰ä¸¤ä¸ªå­©å­èŠ‚ç‚¹ã€‚</p><p>â€‹æˆ‘ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾Aæœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ï¼Œä¸”éƒ½æ˜¯å¶å­èŠ‚ç‚¹ï¼Œå·¦å³å­©å­åˆ†åˆ«ä¸ºBã€Cã€‚é‚£ä¹ˆæ‰«æåˆ°Açš„æ—¶å€™ï¼Œæ ¹æ®ç¨‹åºå°±ä¼šåˆ¤æ–­ä¸€ä¸‹Bçš„æƒå€¼ï¼ˆå­—ç¬¦å€¼ï¼‰ï¼Œç„¶åé€’å½’è¿›å…¥åˆ°BèŠ‚ç‚¹ï¼Œè¿™æ—¶å€™åˆä¼šæ¯”è¾ƒä¸€æ¬¡ä¸‹æ ‡å€¼ï¼Œç„¶åä»å¶å­èŠ‚ç‚¹Bè¿”å›ï¼Œæ¥ç€åˆ°å³å¶å­èŠ‚ç‚¹Cï¼Œç»§ç»­æ¯”è¾ƒä¸‹æ ‡ï¼Œç„¶åè¿”å›åˆ°Açš„å…„å¼ŸèŠ‚ç‚¹å»æ¯”å¯¹ã€‚</p><p>â€‹æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®å¾ªç¯æ•°ç»„çš„å€¼ï¼Œæ£€æµ‹åˆ°ä¸‹æ ‡ï¼Œå°±å¯ä»¥åˆ©ç”¨å‰å‡ ä½çš„æƒå€¼è®¡ç®—å‡ºåŸå­—ç¬¦ä¸²ä¸­è¯¥ä¸‹æ ‡å¯¹äºçš„ASCIIç å€¼æ˜¯å¤šå°‘ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">data = [<span class="hljs-number">2270</span>, <span class="hljs-number">917</span>, <span class="hljs-number">446</span>, <span class="hljs-number">217</span>, <span class="hljs-number">106</span>, <span class="hljs-number">51</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>, <span class="hljs-number">17</span>, <span class="hljs-number">229</span>, <span class="hljs-number">114</span>, <span class="hljs-number">16</span>, <span class="hljs-number">11</span>, <span class="hljs-number">471</span>, <span class="hljs-number">233</span>, <span class="hljs-number">116</span>, <span class="hljs-number">14</span>, <span class="hljs-number">13</span>, <span class="hljs-number">238</span>, <span class="hljs-number">118</span>, <span class="hljs-number">12</span>, <span class="hljs-number">7</span>, <span class="hljs-number">1353</span>, <span class="hljs-number">557</span>, <span class="hljs-number">248</span>, <span class="hljs-number">123</span>, <span class="hljs-number">6</span>, <span class="hljs-number">24</span>, <span class="hljs-number">309</span>, <span class="hljs-number">137</span>, <span class="hljs-number">67</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">172</span>, <span class="hljs-number">84</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">796</span>, <span class="hljs-number">383</span>, <span class="hljs-number">186</span>, <span class="hljs-number">89</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">197</span>, <span class="hljs-number">97</span>, <span class="hljs-number">48</span>, <span class="hljs-number">23</span>, <span class="hljs-number">10</span>, <span class="hljs-number">21</span>, <span class="hljs-number">413</span>, <span class="hljs-number">203</span>, <span class="hljs-number">101</span>, <span class="hljs-number">22</span>, <span class="hljs-number">9</span>, <span class="hljs-number">210</span>, <span class="hljs-number">104</span>, <span class="hljs-number">19</span>, <span class="hljs-number">18</span>]<br><br>flag = [<span class="hljs-number">0</span>] * <span class="hljs-number">25</span><br>flag[<span class="hljs-number">20</span>] = <span class="hljs-number">51</span><br>flag[<span class="hljs-number">15</span>] = <span class="hljs-number">106</span> -<span class="hljs-number">51</span><br>flag[<span class="hljs-number">17</span>] = <span class="hljs-number">217</span> - <span class="hljs-number">106</span><br>flag[<span class="hljs-number">16</span>] = <span class="hljs-number">114</span><br>flag[<span class="hljs-number">11</span>] = <span class="hljs-number">229</span> - <span class="hljs-number">114</span><br>flag[<span class="hljs-number">14</span>] = <span class="hljs-number">116</span><br>flag[<span class="hljs-number">13</span>] = <span class="hljs-number">233</span> - <span class="hljs-number">116</span><br>flag[<span class="hljs-number">12</span>] = <span class="hljs-number">118</span><br>flag[<span class="hljs-number">7</span>] = <span class="hljs-number">238</span> - <span class="hljs-number">118</span><br>flag[<span class="hljs-number">6</span>] = <span class="hljs-number">123</span><br>flag[<span class="hljs-number">24</span>] = <span class="hljs-number">248</span> - <span class="hljs-number">123</span><br>flag[<span class="hljs-number">3</span>] = <span class="hljs-number">67</span><br>flag[<span class="hljs-number">5</span>] = <span class="hljs-number">137</span> - <span class="hljs-number">67</span><br>flag[<span class="hljs-number">4</span>] = <span class="hljs-number">84</span><br>flag[<span class="hljs-number">1</span>] = <span class="hljs-number">172</span> - <span class="hljs-number">84</span><br>flag[<span class="hljs-number">2</span>] = <span class="hljs-number">89</span><br>flag[<span class="hljs-number">8</span>] = <span class="hljs-number">186</span> - <span class="hljs-number">89</span><br>flag[<span class="hljs-number">23</span>] = <span class="hljs-number">48</span><br>flag[<span class="hljs-number">10</span>] = <span class="hljs-number">97</span> - <span class="hljs-number">48</span><br>flag[<span class="hljs-number">21</span>] = <span class="hljs-number">197</span> - <span class="hljs-number">97</span><br>flag[<span class="hljs-number">22</span>] = <span class="hljs-number">101</span><br>flag[<span class="hljs-number">9</span>] = <span class="hljs-number">203</span> - <span class="hljs-number">101</span><br>flag[<span class="hljs-number">19</span>] = <span class="hljs-number">104</span><br>flag[<span class="hljs-number">18</span>] = <span class="hljs-number">210</span> - <span class="hljs-number">104</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">25</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><p>â€‹ä¸‹é¢æ˜¯è‡ªåŠ¨å¤„ç†çš„è„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">data = [<span class="hljs-number">2270</span>, <span class="hljs-number">917</span>, <span class="hljs-number">446</span>, <span class="hljs-number">217</span>, <span class="hljs-number">106</span>, <span class="hljs-number">51</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>, <span class="hljs-number">17</span>, <span class="hljs-number">229</span>, <span class="hljs-number">114</span>, <span class="hljs-number">16</span>, <span class="hljs-number">11</span>, <span class="hljs-number">471</span>, <span class="hljs-number">233</span>, <span class="hljs-number">116</span>, <span class="hljs-number">14</span>, <span class="hljs-number">13</span>, <span class="hljs-number">238</span>, <span class="hljs-number">118</span>, <span class="hljs-number">12</span>, <span class="hljs-number">7</span>, <span class="hljs-number">1353</span>, <span class="hljs-number">557</span>, <span class="hljs-number">248</span>, <span class="hljs-number">123</span>, <span class="hljs-number">6</span>, <span class="hljs-number">24</span>, <span class="hljs-number">309</span>, <span class="hljs-number">137</span>, <span class="hljs-number">67</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">172</span>, <span class="hljs-number">84</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">796</span>, <span class="hljs-number">383</span>, <span class="hljs-number">186</span>, <span class="hljs-number">89</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">197</span>, <span class="hljs-number">97</span>, <span class="hljs-number">48</span>, <span class="hljs-number">23</span>, <span class="hljs-number">10</span>, <span class="hljs-number">21</span>, <span class="hljs-number">413</span>, <span class="hljs-number">203</span>, <span class="hljs-number">101</span>, <span class="hljs-number">22</span>, <span class="hljs-number">9</span>, <span class="hljs-number">210</span>, <span class="hljs-number">104</span>, <span class="hljs-number">19</span>, <span class="hljs-number">18</span>]<br>flag = [<span class="hljs-number">0</span>] * <span class="hljs-number">25</span><br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(data):<br>    <span class="hljs-keyword">if</span> data[i] &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> data[i] &lt; <span class="hljs-number">25</span>:<br>        n = <span class="hljs-number">1</span><br>        tmp = i<br>        <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(data) <span class="hljs-keyword">and</span> data[i] &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> data[i] &lt; <span class="hljs-number">25</span>:<br>            <span class="hljs-keyword">if</span> n == <span class="hljs-number">1</span>:<br>                flag[data[i]] = data[tmp-n]<br>            <span class="hljs-keyword">else</span>:<br>                flag[data[i]] = data[tmp-n] - data[tmp-n+<span class="hljs-number">1</span>]<br>            i += <span class="hljs-number">1</span><br>            n += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        i += <span class="hljs-number">1</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">25</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><h1 id="Whatâ€™s-this"><a href="#Whatâ€™s-this" class="headerlink" title="Whatâ€™s this"></a>Whatâ€™s this</h1><p>â€‹æ–°ä¸œè¥¿ï¼Œç¬¬ä¸€æ¬¡ç¢°è§ï¼Œæ–‡ä»¶å¤´æ˜¯<code>1B 4C 75 61 51</code>ã€‚èŠ‚çº¦æ—¶é—´ï¼Œå­¦ä¹ WPã€‚</p><p>â€‹Chatgptçš„è§£é‡Šæ˜¯ï¼š<code>1B 4C 75 61 51</code> æ˜¯ä¸€ä¸ª <strong>Luaå­—èŠ‚ç æ–‡ä»¶ï¼ˆç¼–è¯‘åçš„Luaæ–‡ä»¶ï¼‰çš„æ–‡ä»¶å¤´</strong>ï¼Œå³ä¸æ˜¯æ™®é€šçš„ <code>.lua</code> æºä»£ç æ–‡ä»¶ï¼Œè€Œæ˜¯å·²ç»ç¼–è¯‘æˆLuaè™šæ‹Ÿæœºå¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚æ‰€ä»¥æˆ‘ä»¬è¦åç¼–è¯‘ï¼Œçœ‹æºä»£ç ã€‚</p><p>â€‹WPä¸­ç»™å‡ºäº†åœ¨çº¿å·¥å…·ï¼Œæˆ‘ä»¬ä¸Šç½‘ç«™åç¼–è¯‘å¥½äº†ã€‚ä¹Ÿæ˜¯æœ‰å¹¸æ¥è§¦åˆ°äº†ä¸€ä¸‹LUAè„šæœ¬ï¼Œè¿™æ˜¯æ¸¸æˆå¼€å‘éå¸¸æµè¡Œçš„è¯­è¨€ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br>flag = <span class="hljs-string">&quot;==AeuFEcwxGPuJ0PBNzbC16ctFnPB5DPzI0bwx6bu9GQ2F1XOR1U&quot;</span><br>flag = flag.replace(<span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;W&quot;</span>)<br>flag = flag.replace(<span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;H&quot;</span>)<br>flag = flag.replace(<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;g&quot;</span>)<br>flag = flag[::-<span class="hljs-number">1</span>]<br>flag = base64.b64decode(flag).decode()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>    tmp = <span class="hljs-built_in">ord</span>(flag[i]) - <span class="hljs-number">3</span><br>    tmp = (tmp ^ <span class="hljs-number">8</span>) % <span class="hljs-number">256</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(tmp), end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure><h1 id="ez-rand"><a href="#ez-rand" class="headerlink" title="ez_rand"></a>ez_rand</h1><p>â€‹åˆæ˜¯åƒåœ¾é¢˜ï¼Œæ€è·¯å¾ˆç®€å•ï¼Œçˆ†ç ´å°±è¡Œäº†ï¼Œå¯¹åº”å¥½å‚æ•°ç±»å‹ã€‚</p><p>â€‹sbçš„WPä¸­ï¼Œç›´æ¥rand()%255ï¼Œæ— è¯­äº†ã€‚tmçš„ï¼Œæˆ‘åˆä¸€ç›´çˆ†ç ´ä¸å‡ºæ¥ï¼Œæ˜æ˜æ˜¯ç…§ç€å˜é‡ç±»å‹æŠ„çš„ã€‚è¿ç®—å¼éƒ½æ˜¯ç…§ç€æŠ„çš„ã€‚</p><p>â€‹éº»ç—¹çš„ï¼Œæ”¹äº†ä¸€ä¸‹å¼‚æˆ–å€¼çš„è®¡ç®—å°±å¥½äº†ï¼Œè¿˜å¿˜äº†ä¹‹å‰é”™çš„æ˜¯ä»€ä¹ˆæ ·å­çš„äº†ï¼Œç°åœ¨æ€ä¹ˆæ”¹éƒ½æ˜¯å¯¹çš„ã€‚çœŸçš„æ˜¯ç„å­¦ï¼Œé”™è¯¯æ¶ˆå¤±äº†ï¼Œå®Œå…¨æ‰¾ä¸åˆ°ä¹‹å‰é”™çš„æ˜¯ä»€ä¹ˆæ ·å­çš„äº†ã€‚</p><p>â€‹æ— è¯­é€†å¤©äº†ï¼Œå†ä¹Ÿä¸æƒ³ç¢°è¿™ä¸ªç…ç¬”Cè¯­è¨€äº†ã€‚</p><p><img src="/pictures/XYCTF2024/image-20250601171908123.png" alt="image-20250601171908123"></p><figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">//åˆ«äººçš„è„šæœ¬</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;ctime&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> cipher[<span class="hljs-number">50</span>] = &#123;<span class="hljs-number">0x5D</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x34</span>,<span class="hljs-number">0xB2</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x91</span>,<span class="hljs-number">0x12</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4D</span>&#125;;<br><span class="hljs-type">int</span> v7;<br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(<span class="hljs-type">char</span> s[])</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">if</span>(<span class="hljs-built_in">strstr</span>(s,<span class="hljs-string">&quot;XYCTF&quot;</span>)||<span class="hljs-built_in">strstr</span>(s,<span class="hljs-string">&quot;flag&quot;</span>))<br>&#123;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><span class="hljs-type">char</span> ans[<span class="hljs-number">50</span>];<br><span class="hljs-type">int</span> _round=<span class="hljs-number">-5</span>;<br><span class="hljs-function"><span class="hljs-type">signed</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v4=<span class="hljs-number">0</span>;v4&lt;<span class="hljs-number">65536</span>;v4++)<br>&#123;<br><span class="hljs-built_in">srand</span>(v4);<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">29</span>;i++)<br>&#123;<br>v7=<span class="hljs-built_in">rand</span>();<br><span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> temp=((<span class="hljs-number">2155905153</span>*<span class="hljs-number">1LL</span>*v7)&gt;&gt;<span class="hljs-number">32</span>);<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> num=v7+(<span class="hljs-type">int</span>)((temp&amp;<span class="hljs-number">0x80000000</span>)!=<span class="hljs-number">0</span>)+((<span class="hljs-type">int</span>)temp&gt;&gt;<span class="hljs-number">7</span>);<br>ans[i]=num^cipher[i];<br>&#125;<br><span class="hljs-keyword">if</span>(<span class="hljs-built_in">cmp</span>(ans))<br>&#123;<br>_round=v4;<br><span class="hljs-keyword">break</span>;<br>&#125;<br>&#125;<br><span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s %d&quot;</span>,ans,_round);<br><span class="hljs-comment">//XYCTF&#123;R@nd_1s_S0_S0_S0_easy!&#125; 21308</span><br>&#125;<br></code></pre></td></tr></table></figure><h1 id="èˆ”ç‹—å››éƒ¨æ›²â€“è®°å¿†çš„æ—¶å…‰æœº"><a href="#èˆ”ç‹—å››éƒ¨æ›²â€“è®°å¿†çš„æ—¶å…‰æœº" class="headerlink" title="èˆ”ç‹—å››éƒ¨æ›²â€“è®°å¿†çš„æ—¶å…‰æœº"></a>èˆ”ç‹—å››éƒ¨æ›²â€“è®°å¿†çš„æ—¶å…‰æœº</h1><p>â€‹okï¼Œé«˜çº§çš„åç¼–è¯‘ï¼Œç±»ä¼¼èŠ±æŒ‡ä»¤ä¸€æ ·çš„åç¼–è¯‘æ–¹å¼ã€‚æ–¹æ³•ä¸ºå…ˆæŠŠè¦è·³è½¬çš„åœ°å€ä¿å­˜åˆ°å¯„å­˜å™¨ä¸Šï¼Œç„¶åé€šè¿‡å¯„å­˜å™¨è·³è½¬ï¼›æˆ–è€…æä¸ª<code>endbr64</code>æŒ‡ä»¤ï¼Œå½±å“åç¼–è¯‘ã€‚</p><p>â€‹ç›´æ¥å­¦ä¹ WPã€‚è¯´æ˜¯å¯ä»¥é€šè¿‡è·³è½¬è¡¨ï¼Œä¿®å¤åç¼–è¯‘ï¼Œä½†æ˜¯æ²¡æ¼”ç¤ºå…·ä½“æ“ä½œï¼Œå¯¹å°ç™½å¤ªä¸å‹å¥½äº†ã€‚å…¶ä»–äººä¹Ÿéƒ½æ˜¯çœ‹æ±‡ç¼–æˆ–è€…åŠ¨è°ƒçš„ï¼Œé‚£å°±å¹²å§ï¼ŒåŠ¨è°ƒçœ‹çœ‹ã€‚</p><p>â€‹é¦–å…ˆä¸€ä¸ªcmpï¼Œé•¿åº¦æ£€éªŒï¼Œ0x30ï¼Œ48ä½ã€‚ç„¶åæ¯ä¸€ä½åŠ å¯†åå’Œå¯†æ–‡æ¯”å¯¹ï¼Œ48ä¸ªå­—ç¬¦å…¨éƒ¨ç›¸åŒå°±æ˜¯æˆåŠŸã€‚</p><p>â€‹encå‡½æ•°ï¼Œé¦–å…ˆæœ‰ä¸ªxorå˜åŒ–å€¼ï¼ˆi+6ï¼Œiä»0å¼€å§‹çš„ï¼‰ï¼Œå†xorå›ºå®šå€¼0x66ï¼Œå†å‡6ï¼Œç„¶åxorå¯†æ–‡çš„å¯¹åº”ä½ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc = [<span class="hljs-number">105</span>, <span class="hljs-number">88</span>, <span class="hljs-number">97</span>, <span class="hljs-number">99</span>, <span class="hljs-number">103</span>, <span class="hljs-number">76</span>, <span class="hljs-number">77</span>, <span class="hljs-number">50</span>, <span class="hljs-number">152</span>, <span class="hljs-number">32</span>, <span class="hljs-number">77</span>, <span class="hljs-number">81</span>, <span class="hljs-number">123</span>, <span class="hljs-number">37</span>, <span class="hljs-number">117</span>, <span class="hljs-number">81</span>, <span class="hljs-number">163</span>, <span class="hljs-number">88</span>, <span class="hljs-number">96</span>, <span class="hljs-number">114</span>, <span class="hljs-number">66</span>, <span class="hljs-number">98</span>, <span class="hljs-number">103</span>, <span class="hljs-number">102</span>, <span class="hljs-number">55</span>, <span class="hljs-number">108</span>, <span class="hljs-number">48</span>, <span class="hljs-number">70</span>, <span class="hljs-number">102</span>, <span class="hljs-number">79</span>, <span class="hljs-number">93</span>, <span class="hljs-number">3</span>, <span class="hljs-number">93</span>, <span class="hljs-number">164</span>, <span class="hljs-number">102</span>, <span class="hljs-number">1</span>, <span class="hljs-number">67</span>, <span class="hljs-number">104</span>, <span class="hljs-number">125</span>, <span class="hljs-number">124</span>, <span class="hljs-number">85</span>, <span class="hljs-number">79</span>, <span class="hljs-number">122</span>, <span class="hljs-number">63</span>, <span class="hljs-number">108</span>, <span class="hljs-number">18</span>, <span class="hljs-number">33</span>, <span class="hljs-number">9</span>]<br>key = <span class="hljs-string">&quot;i_have_get_shell_but_where_is_you_my_dear_baby!!&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    tmp = (enc[i] ^ <span class="hljs-built_in">ord</span>(key[i])) % <span class="hljs-number">256</span><br>    tmp = (tmp + <span class="hljs-number">6</span>) % <span class="hljs-number">256</span><br>    tmp = (tmp ^ <span class="hljs-number">0x66</span>) % <span class="hljs-number">256</span><br>    tmp = (tmp ^ (i+<span class="hljs-number">6</span>)) % <span class="hljs-number">256</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(tmp), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><p>â€‹è¿™é¢˜ä¼šåŠ¨è°ƒå…¶å®å¾ˆç®€å•ï¼Œåªæ˜¯åç¼–è¯‘åšåšæ ·å­ï¼Œæœ‰ç‚¹å“äººç½¢äº†ã€‚</p><h1 id="ez-cube"><a href="#ez-cube" class="headerlink" title="ez_cube"></a>ez_cube</h1><p>â€‹IDAæ‰“å¼€ï¼ŒçœŸæ˜¯ä¸ªåšé­”æ–¹çš„é¢˜ï¼Œè¿˜å¾—æœ‰ç‚¹ç©ºé—´æƒ³è±¡åŠ›æ‰è¡Œã€‚åˆå§‹çŠ¶æ€å¦‚ä¸‹ã€‚</p><p>â€‹WPç»™å‡ºçš„åœ¨çº¿ç½‘ç«™ï¼Œæ²¡åŠæ³•åšåˆ°é™åˆ¶æ—‹è½¬ï¼Œå°±æ— æ³•æŒ‰ç…§é¢˜ç›®ä¸­çš„æ–¹å¼è§£å‡ºã€‚å¯ä»¥ä½¿ç”¨pythonå†™ä¸€ä¸ªæ±‚è§£è„šæœ¬ï¼Œåªä½¿ç”¨å››ç§ç›®æ ‡æ—‹è½¬ï¼Œé™åˆ¶æ­¥æ•°ï¼ŒBFSå°±æ˜¯å¾ˆå¯è¡Œçš„ã€‚</p><p>â€‹ä½†æ˜¯æˆ‘ä¸æƒ³åœ¨è¿™æ ·ä¸€ä¸ªéä¸“ä¸šé€†å‘çš„é¢˜ç›®è€—è¿™ä¹ˆå¤šæ—¶é—´ï¼Œæ‰€ä»¥ç›´æ¥è¿‡äº†ã€‚é™„ä¸Šåˆ«äººçš„è„šæœ¬ã€‚</p><p><img src="/pictures/XYCTF2024/image-20250601205219843.png" alt="image-20250601205219843"></p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> tqdm<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">x</span>):<br>A=[<span class="hljs-string">&quot;R&quot;</span>]*<span class="hljs-number">9</span><br>B=[<span class="hljs-string">&quot;B&quot;</span>]*<span class="hljs-number">9</span><br>C=[<span class="hljs-string">&quot;G&quot;</span>]*<span class="hljs-number">9</span><br>D=[<span class="hljs-string">&quot;O&quot;</span>]*<span class="hljs-number">9</span><br>E=[<span class="hljs-string">&quot;Y&quot;</span>]*<span class="hljs-number">9</span><br>F=[<span class="hljs-string">&quot;W&quot;</span>]*<span class="hljs-number">9</span><br>B[<span class="hljs-number">1</span>]=<span class="hljs-string">&#x27;R&#x27;</span><br>A[<span class="hljs-number">1</span>]=<span class="hljs-string">&#x27;G&#x27;</span><br>C[<span class="hljs-number">1</span>]=<span class="hljs-string">&#x27;B&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x:<br><span class="hljs-keyword">if</span> i==<span class="hljs-string">&#x27;R&#x27;</span>:<br>v0 = A[<span class="hljs-number">2</span>]<br>v1 = A[<span class="hljs-number">5</span>]<br>v2 = A[<span class="hljs-number">8</span>]<br>A[<span class="hljs-number">2</span>] = F[<span class="hljs-number">2</span>]<br>A[<span class="hljs-number">5</span>] = F[<span class="hljs-number">5</span>]<br>A[<span class="hljs-number">8</span>] = F[<span class="hljs-number">8</span>]<br>F[<span class="hljs-number">2</span>] = D[<span class="hljs-number">6</span>]<br>F[<span class="hljs-number">5</span>] = D[<span class="hljs-number">3</span>]<br>F[<span class="hljs-number">8</span>] = D[<span class="hljs-number">0</span>]<br>D[<span class="hljs-number">0</span>] = E[<span class="hljs-number">8</span>]<br>D[<span class="hljs-number">3</span>] = E[<span class="hljs-number">5</span>]<br>D[<span class="hljs-number">6</span>] = E[<span class="hljs-number">2</span>]<br>E[<span class="hljs-number">2</span>] = v0<br>E[<span class="hljs-number">5</span>] = v1<br>E[<span class="hljs-number">8</span>] = v2<br>v3 = C[<span class="hljs-number">1</span>]<br>C[<span class="hljs-number">1</span>] = C[<span class="hljs-number">3</span>]<br>C[<span class="hljs-number">3</span>] = C[<span class="hljs-number">7</span>]<br>C[<span class="hljs-number">7</span>] = C[<span class="hljs-number">5</span>]<br>C[<span class="hljs-number">5</span>] = v3<br>v4 = C[<span class="hljs-number">0</span>]<br>C[<span class="hljs-number">0</span>] = C[<span class="hljs-number">6</span>]<br>C[<span class="hljs-number">6</span>] = C[<span class="hljs-number">8</span>]<br>C[<span class="hljs-number">8</span>] = C[<span class="hljs-number">2</span>]<br>C[<span class="hljs-number">2</span>] = v4<br><span class="hljs-keyword">if</span> i==<span class="hljs-string">&#x27;U&#x27;</span>:<br>v0 = A[<span class="hljs-number">0</span>]<br>v1 = A[<span class="hljs-number">1</span>]<br>v2 = A[<span class="hljs-number">2</span>]<br>A[<span class="hljs-number">0</span>] = C[<span class="hljs-number">0</span>]<br>A[<span class="hljs-number">1</span>] = C[<span class="hljs-number">1</span>]<br>A[<span class="hljs-number">2</span>] = C[<span class="hljs-number">2</span>]<br>C[<span class="hljs-number">0</span>] = D[<span class="hljs-number">0</span>]<br>C[<span class="hljs-number">1</span>] = D[<span class="hljs-number">1</span>]<br>C[<span class="hljs-number">2</span>] = D[<span class="hljs-number">2</span>]<br>D[<span class="hljs-number">0</span>] = B[<span class="hljs-number">0</span>]<br>D[<span class="hljs-number">1</span>] = B[<span class="hljs-number">1</span>]<br>D[<span class="hljs-number">2</span>] = B[<span class="hljs-number">2</span>]<br>B[<span class="hljs-number">0</span>] = v0<br>B[<span class="hljs-number">1</span>] = v1<br>B[<span class="hljs-number">2</span>] = v2<br>v3 = E[<span class="hljs-number">1</span>]<br>E[<span class="hljs-number">1</span>] = E[<span class="hljs-number">3</span>]<br>E[<span class="hljs-number">3</span>] = E[<span class="hljs-number">7</span>]<br>E[<span class="hljs-number">7</span>] = E[<span class="hljs-number">5</span>]<br>E[<span class="hljs-number">5</span>] = v3<br>v4 = E[<span class="hljs-number">0</span>]<br>E[<span class="hljs-number">0</span>] = E[<span class="hljs-number">6</span>]<br>E[<span class="hljs-number">6</span>] = E[<span class="hljs-number">8</span>]<br>E[<span class="hljs-number">8</span>] = E[<span class="hljs-number">2</span>]<br>E[<span class="hljs-number">2</span>] = v4<br><span class="hljs-keyword">if</span> i==<span class="hljs-string">&#x27;r&#x27;</span>:<br>v0 = A[<span class="hljs-number">2</span>]<br>v1 = A[<span class="hljs-number">5</span>]<br>v2 = A[<span class="hljs-number">8</span>]<br>A[<span class="hljs-number">2</span>] = E[<span class="hljs-number">2</span>]<br>A[<span class="hljs-number">5</span>] = E[<span class="hljs-number">5</span>]<br>A[<span class="hljs-number">8</span>] = E[<span class="hljs-number">8</span>]<br>E[<span class="hljs-number">2</span>] = D[<span class="hljs-number">6</span>]<br>E[<span class="hljs-number">5</span>] = D[<span class="hljs-number">3</span>]<br>E[<span class="hljs-number">8</span>] = D[<span class="hljs-number">0</span>]<br>D[<span class="hljs-number">0</span>] = F[<span class="hljs-number">8</span>]<br>D[<span class="hljs-number">3</span>] = F[<span class="hljs-number">5</span>]<br>D[<span class="hljs-number">6</span>] = F[<span class="hljs-number">2</span>]<br>F[<span class="hljs-number">2</span>] = v0<br>F[<span class="hljs-number">5</span>] = v1<br>F[<span class="hljs-number">8</span>] = v2<br>v3 = C[<span class="hljs-number">1</span>]<br>C[<span class="hljs-number">1</span>] = C[<span class="hljs-number">5</span>]<br>C[<span class="hljs-number">5</span>] = C[<span class="hljs-number">7</span>]<br>C[<span class="hljs-number">7</span>] = C[<span class="hljs-number">3</span>]<br>C[<span class="hljs-number">3</span>] = v3<br>v4 = C[<span class="hljs-number">0</span>]<br>C[<span class="hljs-number">0</span>] = C[<span class="hljs-number">2</span>]<br>C[<span class="hljs-number">2</span>] = C[<span class="hljs-number">8</span>]<br>C[<span class="hljs-number">8</span>] = C[<span class="hljs-number">6</span>]<br>C[<span class="hljs-number">6</span>] = v4<br><span class="hljs-keyword">if</span> i==<span class="hljs-string">&#x27;u&#x27;</span>:<br>v0 = A[<span class="hljs-number">0</span>]<br>v1 = A[<span class="hljs-number">1</span>]<br>v2 = A[<span class="hljs-number">2</span>]<br>A[<span class="hljs-number">0</span>] = B[<span class="hljs-number">0</span>]<br>A[<span class="hljs-number">1</span>] = B[<span class="hljs-number">1</span>]<br>A[<span class="hljs-number">2</span>] = B[<span class="hljs-number">2</span>]<br>B[<span class="hljs-number">0</span>] = D[<span class="hljs-number">0</span>]<br>B[<span class="hljs-number">1</span>] = D[<span class="hljs-number">1</span>]<br>B[<span class="hljs-number">2</span>] = D[<span class="hljs-number">2</span>]<br>D[<span class="hljs-number">0</span>] = C[<span class="hljs-number">0</span>]<br>D[<span class="hljs-number">1</span>] = C[<span class="hljs-number">1</span>]<br>D[<span class="hljs-number">2</span>] = C[<span class="hljs-number">2</span>]<br>C[<span class="hljs-number">0</span>] = v0<br>C[<span class="hljs-number">1</span>] = v1<br>C[<span class="hljs-number">2</span>] = v2<br>v3 = E[<span class="hljs-number">1</span>]<br>E[<span class="hljs-number">1</span>] = E[<span class="hljs-number">5</span>]<br>E[<span class="hljs-number">5</span>] = E[<span class="hljs-number">7</span>]<br>E[<span class="hljs-number">7</span>] = E[<span class="hljs-number">3</span>]<br>E[<span class="hljs-number">3</span>] = v3<br>v4 = E[<span class="hljs-number">0</span>]<br>E[<span class="hljs-number">0</span>] = E[<span class="hljs-number">2</span>]<br>E[<span class="hljs-number">2</span>] = E[<span class="hljs-number">8</span>]<br>E[<span class="hljs-number">8</span>] = E[<span class="hljs-number">6</span>]<br>E[<span class="hljs-number">6</span>] = v4<br><span class="hljs-keyword">if</span> A==[<span class="hljs-string">&quot;R&quot;</span>]*<span class="hljs-number">9</span> <span class="hljs-keyword">and</span> B==[<span class="hljs-string">&quot;B&quot;</span>]*<span class="hljs-number">9</span> <span class="hljs-keyword">and</span> C==[<span class="hljs-string">&quot;G&quot;</span>]*<span class="hljs-number">9</span> <span class="hljs-keyword">and</span> D==[<span class="hljs-string">&quot;O&quot;</span>]*<span class="hljs-number">9</span> <span class="hljs-keyword">and</span> E==[<span class="hljs-string">&quot;Y&quot;</span>]*<span class="hljs-number">9</span> <span class="hljs-keyword">and</span> F==[<span class="hljs-string">&quot;W&quot;</span>]*<span class="hljs-number">9</span>:<br><span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br><span class="hljs-keyword">else</span>:<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br>    <br>flag=[]<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">13</span>):<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm.tqdm(<span class="hljs-built_in">list</span>(product(<span class="hljs-string">&#x27;RUru&#x27;</span>,repeat=j))):<br>x=<span class="hljs-string">&#x27;&#x27;</span>.join(i)<br><span class="hljs-keyword">if</span> f(x):<br>flag.append(x)<br>[<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag&#123;%s&#125;&quot;</span>%x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> flag]<br></code></pre></td></tr></table></figure><h1 id="ä»Šå¤•æ˜¯ä½•å¹´"><a href="#ä»Šå¤•æ˜¯ä½•å¹´" class="headerlink" title="ä»Šå¤•æ˜¯ä½•å¹´"></a>ä»Šå¤•æ˜¯ä½•å¹´</h1><p>â€‹IDAæ‰“å¼€ï¼Œå“‡ï¼Œéƒ½åç¼–è¯‘ä¸äº†ï¼Œç¬¬ä¸€æ¬¡ç¢°è§è¿™ç§ï¼ŒæŸ¥å£³è¿˜æ²¡æœ‰å£³ï¼Œåˆæ˜¯RUSTè¯­è¨€å†™çš„ã€‚</p><p>â€‹å­¦ä¹ WPï¼ŒåŸæ¥è¿™æ˜¯LoongArchæ¶æ„çš„ELFäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªLoongArchæ¶æ„çš„ç¯å¢ƒæ¥è¿è¡Œè¿™ä¸ªç¨‹åºã€‚</p><p>â€‹æŒ‰ç…§WPçš„å‘½ä»¤åœ¨kaliä¸Šé¢ä¸‹è½½å¥½äº†qemu-userï¼Œå‘½ä»¤ä¸º<code>sudo apt install qemu-user</code>ã€‚ç„¶åå°±å¯ä»¥ç›´æ¥è¿è¡Œmainç¨‹åºäº†ã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆä¾¿æ·å•Šï¼Ÿ</p><blockquote><p>èƒŒåçš„æœºåˆ¶ï¼š<code>binfmt_misc</code></p><ul><li>Linux æœ‰ä¸ªå†…æ ¸åŠŸèƒ½å«åš <strong><code>binfmt_misc</code></strong>ï¼Œå®ƒèƒ½è®©ç³»ç»Ÿè¯†åˆ«ä¸åŒæ ¼å¼çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</li><li>å½“ä½ è¿è¡Œä¸€ä¸ªéæœ¬æœºæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶æ—¶ï¼Œå†…æ ¸é€šè¿‡ <code>binfmt_misc</code> æ‰¾åˆ°å¯¹åº”çš„è§£é‡Šå™¨ï¼ˆæ¯”å¦‚ <code>qemu-arm</code>ï¼‰ï¼Œè‡ªåŠ¨è°ƒç”¨å®ƒæ¥è¿è¡Œç¨‹åºã€‚</li><li>è¿™æ ·ä½ å°±æ„Ÿè§‰â€œç›´æ¥è¿è¡Œï¼Œä¸ç”¨é¢å¤–å‘½ä»¤â€ï¼Œå…¶å®æ˜¯ç³»ç»Ÿå¸®ä½ è‡ªåŠ¨è½¬å‘äº†ã€‚</li></ul></blockquote><p>â€‹å¹¸å¥½æœ‰æ•™ç¨‹ï¼Œä¸ç„¶æˆ‘å»ç½‘ä¸Šæ‰¾åˆå¾—èŠ±å¤§æŠŠæ—¶é—´ï¼Œé”™è¯¯ç‡è¿˜é«˜ï¼Œå„ç§ç¯å¢ƒé—®é¢˜ã€‚</p><h1 id="Findme"><a href="#Findme" class="headerlink" title="Findme"></a>Findme</h1><p>â€‹ç»™äº†ä¸‰ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼ŒDIEä¹ŸæŸ¥ä¸å‡ºæ¥ã€‚æ–°ä¸œè¥¿ï¼Œè¿˜æ˜¯ç›´æ¥çœ‹WPã€‚6ï¼ŒåŸæ¥æ˜¯æœ‰éšè—çš„ï¼Œæˆ‘è¿˜ä»¥ä¸ºè¿™å‡ ä¸ªæ–‡ä»¶æ˜¯ä¸€æ ·çš„ä¸œè¥¿ï¼Œç»“æœä¸€çœ‹ï¼Œæ–‡ä»¶<code>Doraemon1</code> <code>Doraemon2</code>ç¡®å®æ¯”è¾ƒè¿·ï¼Œä½†æ˜¯<code>Doraemon4</code>å°±æ˜¯exeæ–‡ä»¶æ–‡ä»¶å•Šï¼Œ æ–‡ä»¶å¤´å°±èƒ½çœ‹å‡ºæ¥ï¼Œè¿˜å»æ‰äº†åç¼€åã€‚</p><p>â€‹å…ˆçœ‹exeç¨‹åºï¼Œå…ˆæ˜¯ä¸€ä¸ªRC4ç±»çš„KSAï¼Œåˆå§‹åŒ–Sç›’å¹¶ç”¨å¯†é’¥æ‰“ä¹±ï¼Œå¯†é’¥ä¸ºï¼š<code>Find_Doraemon</code>ã€‚</p><p><img src="/pictures/XYCTF2024/image-20250602111610021.png" alt="image-20250602111610021"></p><p>â€‹ç„¶åæ˜¯PRGAï¼Œä¼ªéšæœºæ•°æµåŠ å¯†ã€‚å¯¹Doraemon3æ–‡ä»¶è¯»å–å­—ç¬¦ï¼Œå¼‚æˆ–åŠ å¯†åå†™å…¥Doraemon1æ–‡ä»¶ï¼Œå¹¶ä¸”è·Ÿç€è‹¥å¹²ä¸ªéšæœºæ•°ã€‚</p><p><img src="/pictures/XYCTF2024/image-20250602111920780.png" alt="image-20250602111920780"></p><p>â€‹æ‰€ä»¥æˆ‘ä»¬å¯¹Doraemon1æ–‡ä»¶è¿›è¡Œè¯»å–é€†å‘å¤„ç†å°±è¡Œï¼Œå…ˆé€ å‡ºSç›’ï¼Œç„¶åå†æ¬¡å¼‚æˆ–å³å¯ï¼Œå¹¶ä¸”ä½¿ç”¨Sç›’ä¸­çš„æ•°è¿›è¡Œä¼ªéšæœºç”Ÿæˆï¼Œå»æ‰ä¸­é—´çš„è‹¥å¹²å­—ç¬¦åï¼Œåˆ°è¾¾ä¸‹ä¸€ä¸ªåŠ å¯†å­—ç¬¦ï¼Œç›´è‡³æ–‡ä»¶è¯»å–å®Œã€‚</p><p>â€‹æˆ‘ç°åœ¨å†™ä»£ç çš„èƒ½åŠ›æœ‰ç‚¹å·®ï¼Œç»å¸¸æœ‰é—å¿˜çš„ç‚¹ï¼Œæ”¹èµ·æ¥èŠ±å¾ˆå¤šæ—¶é—´ã€‚è¿˜å¾—ç»ƒã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span>  </span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br>FILE *fp = <span class="hljs-literal">NULL</span>;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">KSA</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> *S, <span class="hljs-type">uint8_t</span> *K)</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> i;<br>    <span class="hljs-type">int</span> j = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>( i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">512</span>;i++)<br>    &#123;<br>        S[i] = -(<span class="hljs-type">char</span>)i;<br>    &#125;<br>    i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(i&lt;<span class="hljs-number">512</span>)<br>    &#123;<br>        j = (K[i%<span class="hljs-number">13</span>] + S[i] + j) % <span class="hljs-number">512</span>;<br>        <span class="hljs-type">uint8_t</span> temp = S[i];<br>        S[i] = S[j];<br>        S[j] = temp;<br>        i++;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">PRGA</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> *S)</span><br>&#123;<br>    <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>, v8=<span class="hljs-number">0</span> , v9 = <span class="hljs-number">0</span> ;<br>    <span class="hljs-type">uint8_t</span> temp, k;<br>    <span class="hljs-type">uint8_t</span> b;<br>    fp = fopen(<span class="hljs-string">&quot;F:\\StudyFiles\\CTF\\Review_CTF\\XYCTF2024\\RE\\Findme\\Doraemon1&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>);<br>    FILE *stream = fopen(<span class="hljs-string">&quot;./Doraemon3&quot;</span>,<span class="hljs-string">&quot;wb&quot;</span>);<br>    <span class="hljs-keyword">if</span> (fp == <span class="hljs-literal">NULL</span>) &#123;<br>        perror(<span class="hljs-string">&quot;Error opening file&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(stream == <span class="hljs-literal">NULL</span>) &#123;<br>        perror(<span class="hljs-string">&quot;Error opening file&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    &#125;<br>    <span class="hljs-keyword">while</span>(!feof(fp))<br>    &#123;<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">512</span>;<br>        j = (S[i] + j) % <span class="hljs-number">512</span>;<br>        temp = S[i];<br>        S[i] = S[j];<br>        S[j] = temp;<br>        k = S[(<span class="hljs-type">uint8_t</span>)((S[i] + S[j]) % <span class="hljs-number">512</span>)];<br>        b = fgetc(fp);<br>        fputc(b^k, stream);<br>        srand(S[v8 %<span class="hljs-number">512</span>]);<br>        v9 = rand() % <span class="hljs-number">4</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> t=<span class="hljs-number">0</span>; t&lt;v9; t++)<br>        &#123;<br>            rand();<br>            fgetc(fp);<br>        &#125;<br>        v8++;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">char</span> *key = <span class="hljs-string">&quot;Find_Doraemon&quot;</span>;<br>    <span class="hljs-type">uint8_t</span> S[<span class="hljs-number">512</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br><br>    KSA(S, (<span class="hljs-type">uint8_t</span> *)key);<br>    PRGA(S);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹å¾—åˆ°3æ–‡ä»¶åï¼ŒæŸ¥çœ‹æºç ï¼Œæ˜¯å¯¹2æ–‡ä»¶è¿›è¡Œè§£å¯†ï¼Œä½†æ˜¯è¦è¾“å…¥å¯†é’¥ã€‚å“ˆå“ˆï¼Œå®Œå•¦ï¼Œæ²¡æœ‰ç›´æ¥çš„æç¤ºï¼Œåˆæ˜¯è„‘æ´ï¼Œæˆ‘æ²¡æƒ³åˆ°ã€‚çœ‹äº†WPæ‰çŸ¥é“æ˜¯<code>Doraemon</code>ï¼Œçœ‹æ¥æˆ‘åšé¢˜å¤ªå¤šäº†ï¼Œéƒ½æœ‰ç‚¹è¿Ÿé’äº†ã€‚</p><p>â€‹å¾—åˆ°çš„è§£å¯†æ–‡ä»¶æ˜¯ä¸€ä¸ªgifå›¾ç‰‡ï¼Œæ‰“å¼€å°±å¾—åˆ°äº†flagã€‚</p><h1 id="èˆ”ç‹—å››éƒ¨æ›²â€“æˆ‘çš„ç™½æœˆå…‰"><a href="#èˆ”ç‹—å››éƒ¨æ›²â€“æˆ‘çš„ç™½æœˆå…‰" class="headerlink" title="èˆ”ç‹—å››éƒ¨æ›²â€“æˆ‘çš„ç™½æœˆå…‰"></a>èˆ”ç‹—å››éƒ¨æ›²â€“æˆ‘çš„ç™½æœˆå…‰</h1><p>â€‹è¿™ä¸ªæˆ‘çœŸæ‰¾ä¸åˆ°äº†ï¼ŒåŠ¨è°ƒå’Œæ—¶å…‰æœºä¸€æ ·çš„é€»è¾‘ï¼Œä¸€æ ·çš„flagã€‚ä½†è‚¯å®šä¸æ˜¯è¿™æ ·çš„ï¼Œä½†ä¹Ÿæ²¡æœ‰debugæ£€æµ‹ï¼Œç›´æ¥è¿è¡Œç¨‹åºä¹Ÿæ˜¯é‚£æ ·å­çš„å•Šã€‚æœ‰ç‚¹è¿·äº†ã€‚</p><p>â€‹çœ‹WPå§ï¼Œè‰ï¼ŒåŸæ¥æ˜¯å¹³å°é™„ä»¶é”™äº†â€¦â€¦ã€‚æ–°çš„é™„ä»¶æ˜¯chall.exeã€‚</p><p>â€‹è¿è¡Œç¨‹åºå¾—åˆ°ç¬¬ä¸€æ®µflagï¼š<code>flag&#123;L0v3_</code>ã€‚</p><p>â€‹è¿™é¢˜C++å†™çš„ï¼Œåç¼–è¯‘æœ‰ç‚¹ä¸å¥½çœ‹ï¼Œä¸»è¦æ˜¯éš¾ä»¥æ‰¾åˆ°å…¥æ‰‹ç‚¹ï¼Œè¿˜æ˜¯å­¦ä¹ WPå§ï¼Œå¢é•¿ç»éªŒã€‚</p><p>â€‹é€šè¿‡åœ¨æç¤ºä¿¡æ¯å‰ä¸‹æ–­ç‚¹ï¼Œæ•è·åˆ°æ–­ç‚¹å‰é¢ä¸€ç›´åœ¨æ“ä½œçš„å†…å­˜æ•°æ®ï¼Œæå–å‡ºæ¥å¾—åˆ°è¿™æ ·çš„å­—ç¬¦ä¸²ï¼Œå°±æœ‰äº†ç¬¬äºŒæ®µflagã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">data = [<span class="hljs-number">112</span>, <span class="hljs-number">108</span>, <span class="hljs-number">101</span>, <span class="hljs-number">97</span>, <span class="hljs-number">115</span>, <span class="hljs-number">101</span>, <span class="hljs-number">32</span>, <span class="hljs-number">100</span>, <span class="hljs-number">111</span>, <span class="hljs-number">32</span>, <span class="hljs-number">110</span>, <span class="hljs-number">111</span>, <span class="hljs-number">116</span>, <span class="hljs-number">32</span>, <span class="hljs-number">116</span>, <span class="hljs-number">114</span>, <span class="hljs-number">121</span>, <span class="hljs-number">32</span>, <span class="hljs-number">116</span>, <span class="hljs-number">111</span>, <span class="hljs-number">32</span>, <span class="hljs-number">102</span>, <span class="hljs-number">105</span>, <span class="hljs-number">110</span>, <span class="hljs-number">100</span>, <span class="hljs-number">32</span>, <span class="hljs-number">104</span>, <span class="hljs-number">101</span>, <span class="hljs-number">114</span>, <span class="hljs-number">32</span>, <span class="hljs-number">115</span>, <span class="hljs-number">104</span>, <span class="hljs-number">101</span>, <span class="hljs-number">32</span>, <span class="hljs-number">100</span>, <span class="hljs-number">111</span>, <span class="hljs-number">32</span>, <span class="hljs-number">110</span>, <span class="hljs-number">111</span>, <span class="hljs-number">116</span>, <span class="hljs-number">32</span>, <span class="hljs-number">98</span>, <span class="hljs-number">101</span>, <span class="hljs-number">108</span>, <span class="hljs-number">111</span>, <span class="hljs-number">110</span>, <span class="hljs-number">103</span>, <span class="hljs-number">32</span>, <span class="hljs-number">116</span>, <span class="hljs-number">111</span>, <span class="hljs-number">32</span>, <span class="hljs-number">97</span>, <span class="hljs-number">103</span>, <span class="hljs-number">111</span>, <span class="hljs-number">32</span>, <span class="hljs-number">109</span>, <span class="hljs-number">101</span>, <span class="hljs-number">109</span>, <span class="hljs-number">111</span>, <span class="hljs-number">114</span>, <span class="hljs-number">105</span>, <span class="hljs-number">101</span>, <span class="hljs-number">115</span>, <span class="hljs-number">32</span>, <span class="hljs-number">105</span>, <span class="hljs-number">32</span>, <span class="hljs-number">119</span>, <span class="hljs-number">105</span>, <span class="hljs-number">108</span>, <span class="hljs-number">108</span>, <span class="hljs-number">32</span>, <span class="hljs-number">103</span>, <span class="hljs-number">105</span>, <span class="hljs-number">118</span>, <span class="hljs-number">101</span>, <span class="hljs-number">32</span>, <span class="hljs-number">121</span>, <span class="hljs-number">111</span>, <span class="hljs-number">117</span>, <span class="hljs-number">32</span>, <span class="hljs-number">115</span>, <span class="hljs-number">111</span>, <span class="hljs-number">109</span>, <span class="hljs-number">101</span>, <span class="hljs-number">32</span>, <span class="hljs-number">102</span>, <span class="hljs-number">108</span>, <span class="hljs-number">97</span>, <span class="hljs-number">103</span>, <span class="hljs-number">115</span>, <span class="hljs-number">58</span>, <span class="hljs-number">105</span>, <span class="hljs-number">56</span>, <span class="hljs-number">95</span>, <span class="hljs-number">97</span>, <span class="hljs-number">95</span>, <span class="hljs-number">107</span>, <span class="hljs-number">51</span>, <span class="hljs-number">121</span>, <span class="hljs-number">95</span>, <span class="hljs-number">97</span>, <span class="hljs-number">110</span>, <span class="hljs-number">100</span>, <span class="hljs-number">32</span>, <span class="hljs-number">110</span>, <span class="hljs-number">111</span>, <span class="hljs-number">119</span>, <span class="hljs-number">32</span>, <span class="hljs-number">103</span>, <span class="hljs-number">111</span>, <span class="hljs-number">32</span>, <span class="hljs-number">98</span>, <span class="hljs-number">97</span>, <span class="hljs-number">99</span>, <span class="hljs-number">107</span>, <span class="hljs-number">32</span>, <span class="hljs-number">112</span>, <span class="hljs-number">108</span>, <span class="hljs-number">101</span>, <span class="hljs-number">97</span>, <span class="hljs-number">115</span>, <span class="hljs-number">101</span>, <span class="hljs-number">33</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(data[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><p><code>please do not try to find her she do not belong to ago memories i will give you some flags:i8_a_k3y_and now go back please!</code></p><p>â€‹ç¨‹åºè¿™ä¸ªåœ°æ–¹åŸæœ¬æ˜¯Hookæ‰äº†Messageå‡½æ•°ï¼Œå¯¼è‡´æˆ‘ä»¬ä¸€ç›´åœ¨å¾ªç¯çœ‹å¼¹çª—ã€‚è¦æŠŠè¿™é‡Œnopæ‰ã€‚</p><p><img src="/pictures/XYCTF2024/image-20250602165959876.png" alt="image-20250602165959876"></p><p><img src="/pictures/XYCTF2024/image-20250602170024249.png" alt="image-20250602170024249"></p><p>â€‹ç„¶åè°ƒè¯•çš„æ—¶å€™ï¼Œè¿™é‡Œv24å¾ˆå¤§ï¼Œå¯¼è‡´æˆ‘ä»¬å¾ªç¯åŠå¤©ï¼Œè¦æ‰‹åŠ¨æ”¹æ ‡å¿—ä½è·³å‡ºã€‚</p><p><img src="/pictures/XYCTF2024/image-20250602170144586.png" alt="image-20250602170144586"></p><p>â€‹å†çœ‹ä¸‹é¢1290å‡½æ•°æ˜¯åŠ å¯†éƒ¨åˆ†ï¼ŒåŠ å¯†æ•°æ®æ˜¯ç¨‹åºå†™å¥½çš„ï¼ˆå½“ç„¶æ˜¯é”™çš„ï¼‰ï¼Œæ‰€ä»¥æ²¡æœ‰ç”¨æˆ·è¾“å…¥çš„åœ°æ–¹ã€‚ä¸‹é¢å°±æ˜¯å­—ç¬¦ä¸²æ¯”å¯¹ï¼Œç„¶åå¼¹å‡ºæç¤ºä¿¡æ¯ã€‚æ‰€ä»¥å¯ä»¥çŒœå‡ºè¿™ä¸ªå°±æ˜¯å¯†æ–‡ï¼Œæˆ‘ä»¬è¦å¯¹åŠ å¯†ç®—æ³•é€†å‘ã€‚<img src="/pictures/XYCTF2024/image-20250602170236930.png" alt="image-20250602170236930"></p><p>â€‹åŠ å¯†å‡½æ•°é‡Œé¢æœ‰ä¸€ä¸ªè‡ªå®šä¹‰çš„base64ï¼ˆåç¼–è¯‘æ ¹æœ¬çœ‹ä¸å‡ºæ¥å•Šï¼Œåªèƒ½é çœ‹æ±‡ç¼–å’ŒåŠ¨æ€è°ƒè¯•çœ‹ï¼‰ï¼Œå…¶ç®—æ³•æ˜¯å¯¹äºä¸‰ä½ä¸€ç»„çš„ABCï¼Œå…¶å¯†æ–‡åˆ†åˆ«æ˜¯base[A&amp;0x3f]ã€base[((B&amp;0xf)&lt;&lt;2)|(A&gt;&gt;6)&amp;3]ã€base[(B&gt;&gt;4)&amp;0xf | (C&amp;3)&lt;&lt;4]ã€base[(C&gt;&gt;2)0x3f]ã€‚</p><blockquote><p>â€‹ç›¸å½“äºå¯¹åŸå­—ç¬¦ABCï¼Œå…¶éƒ½æœ‰å…«ä½ã€‚åŠ å¯†æ—¶æ˜¯ï¼š</p><p>ç¬¬ä¸€ä½å¯¹åº”ï¼šA[6] A[5] A[4] A[3] A[2] A[1]</p><p>ç¬¬äºŒä½å¯¹åº”ï¼šB[4] B[3] B[2] B[1] A[8] A[7]</p><p>ç¬¬ä¸‰ä½å¯¹åº”ï¼šC[2] C[1] B[8] B[7] B[6] B[5]</p><p>ç¬¬å››ä½å¯¹åº”ï¼šC[8] C[7] C[6] C[5] C[4] C[3]</p></blockquote><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_custom_base64</span>(<span class="hljs-params">data: <span class="hljs-built_in">str</span>, base: <span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    è‡ªå®šä¹‰ Base64 è§£ç å‡½æ•°ï¼Œè¿”å›è§£ç åçš„å­—èŠ‚ä¸²ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">    è§„åˆ™å¯¹åº”ï¼š</span><br><span class="hljs-string">    - è¾“å…¥4ä¸ªå­—ç¬¦ä¸€ç»„ï¼Œæ˜ å°„åˆ°3ä¸ªå­—èŠ‚ABC</span><br><span class="hljs-string">    - è§£ç ç®—æ³•æ ¹æ®ä½ ç»™å‡ºçš„å¯¹åº”å…³ç³»é€†å‘å®ç°</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    decoded_bytes = <span class="hljs-built_in">bytearray</span>()<br>    base_index = &#123;ch: i <span class="hljs-keyword">for</span> i, ch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(base)&#125;<br><br>    length = <span class="hljs-built_in">len</span>(data)<br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i &lt; length:<br>        <span class="hljs-comment"># å–4ä¸ªå­—ç¬¦ï¼Œå¡«å……ä¸º&#x27;=&#x27;åé¢è¡¥0</span><br>        chunk = data[i:i+<span class="hljs-number">4</span>]<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(chunk) &lt; <span class="hljs-number">4</span>:<br>            chunk += <span class="hljs-string">&#x27;=&#x27;</span> * (<span class="hljs-number">4</span> - <span class="hljs-built_in">len</span>(chunk))<br><br>        vals = []<br>        <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> chunk:<br>            <span class="hljs-keyword">if</span> ch == <span class="hljs-string">&#x27;=&#x27;</span>:<br>                vals.append(<span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">else</span>:<br>                vals.append(base_index[ch])<br><br>        <span class="hljs-comment"># æ ¹æ®ç¼–ç è§„åˆ™ï¼Œé€†æ¨ ABC ä¸‰å­—èŠ‚ï¼š</span><br>        <span class="hljs-comment"># è®¾ç¼–ç å­—ç¬¦å¯¹åº”çš„6ä½æ•°åˆ†åˆ«æ˜¯v0,v1,v2,v3</span><br>        v0, v1, v2, v3 = vals<br><br>        <span class="hljs-comment"># è§£ç å…¬å¼ï¼ˆåæ¨ä½ ç»™å‡ºçš„ç¼–ç æ–¹å¼ï¼‰ï¼š</span><br>        A = (v0 &amp; <span class="hljs-number">0x3F</span>) | ((v1 &amp; <span class="hljs-number">0x03</span>) &lt;&lt; <span class="hljs-number">6</span>)<br>        B = ((v1 &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">0x0F</span>) | ((v2 &amp; <span class="hljs-number">0x0F</span>) &lt;&lt; <span class="hljs-number">4</span>)<br>        C = ((v2 &gt;&gt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0x03</span>) | ((v3 &amp; <span class="hljs-number">0x3F</span>) &lt;&lt; <span class="hljs-number">2</span>)<br><br>        decoded_bytes.append(A)<br>        <span class="hljs-keyword">if</span> chunk[<span class="hljs-number">2</span>] != <span class="hljs-string">&#x27;=&#x27;</span>:<br>            decoded_bytes.append(B)<br>        <span class="hljs-keyword">if</span> chunk[<span class="hljs-number">3</span>] != <span class="hljs-string">&#x27;=&#x27;</span>:<br>            decoded_bytes.append(C)<br><br>        i += <span class="hljs-number">4</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(decoded_bytes)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_custom_base64_to_str</span>(<span class="hljs-params">data: <span class="hljs-built_in">str</span>, base: <span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    è°ƒç”¨è‡ªå®šä¹‰è§£ç å‡½æ•°ï¼Œå°†ç»“æœè½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    decoded_bytes = decode_custom_base64(data, base)<br>    <span class="hljs-keyword">return</span> decoded_bytes.decode(encoding, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br><br><br><span class="hljs-comment"># ç¤ºä¾‹</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    custom_base = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br>    encoded = <span class="hljs-string">&quot;1YmNkZTN2QmNmdjM3kTNmZTZ2UzN2YTN3ITNmZzN2YWNmZDN2YmNlZTN1YmN2YTO2UmNxYzY2M2N5UjZ3QjN4YTM2UmNidTO2Y2N1UjZ3gjN5YTM2Y2N3YTM2UmN3cDN2YmNlZzN3gzN1YTN3QG=&quot;</span>  <br>    decoded = decode_custom_base64_to_str(encoded, custom_base)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(decoded), <span class="hljs-number">2</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(decoded[i:i+<span class="hljs-number">2</span>], <span class="hljs-number">16</span>)), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <br>   <span class="hljs-comment">#_memory_never_go_done_finally_thankyou_xiaowangtongxue&#125;</span><br></code></pre></td></tr></table></figure><p>åˆåœ¨ä¸€èµ·å°±æ˜¯flag{L0v3_i8_a_k3y_and_memory_never_go_done_finally_thankyou_xiaowangtongxue}</p><p>â€‹æœ€ååŠ¨è°ƒçœ‹ä¸€çœ‹æ•…äº‹æœ€åçš„ç»“å±€ï¼Œçœ‹ä¸€çœ‹ä½œè€…æœ€åçš„æ„Ÿæ‚Ÿã€‚</p><p><img src="/pictures/XYCTF2024/image-20250602170833655.png" alt="image-20250602170833655"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;èªæ˜çš„ä¿¡ä½¿&quot;&gt;&lt;a href=&quot;#èªæ˜çš„ä¿¡ä½¿&quot; class=&quot;headerlink&quot; title=&quot;èªæ˜çš„ä¿¡ä½¿&quot;&gt;&lt;/a&gt;èªæ˜çš„ä¿¡ä½¿&lt;/h1&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;</summary>
      
    
    
    
    <category term="CTF" scheme="http://bumak.github.io/categories/CTF/"/>
    
    
    <category term="å¤ç°WP" scheme="http://bumak.github.io/tags/%E5%A4%8D%E7%8E%B0WP/"/>
    
    <category term="Reverse" scheme="http://bumak.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>åˆè¯†Unicorn</title>
    <link href="http://bumak.github.io/2025/06/29/XYCTF2025/%E5%88%9D%E8%AF%86Unicorn/"/>
    <id>http://bumak.github.io/2025/06/29/XYCTF2025/%E5%88%9D%E8%AF%86Unicorn/</id>
    <published>2025-06-29T02:13:21.120Z</published>
    <updated>2025-07-01T06:16:05.943Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Unicornæ¡†æ¶"><a href="#Unicornæ¡†æ¶" class="headerlink" title="Unicornæ¡†æ¶"></a>Unicornæ¡†æ¶</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>â€‹ç¯å¢ƒæ­å»ºæ•™ç¨‹å¯ä»¥çœ‹XYCTF2025ä¸­çš„ezVMï¼Œåªæœ‰ubuntuè™šæ‹Ÿæœºç‰ˆæœ¬çš„ï¼Œæœ‰pythonè¯­è¨€ã€C++è¯­è¨€å’ŒCè¯­è¨€ç‰ˆæœ¬ã€‚</p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>â€‹<strong>unicorn</strong>æ˜¯ä¸€ä¸ªè·¨å¹³å°ã€è½»é‡çº§çš„CPUæŒ‡ä»¤é›†ä»¿çœŸæ¡†æ¶ï¼Œç”¨äºæ¨¡ä»¿CPUæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ï¼Œä¸éœ€è¦çœŸå®ç¡¬ä»¶æˆ–å®Œæ•´æ“ä½œç³»ç»Ÿæ”¯æŒã€‚Unicorn æ˜¯ç”±è‘—åçš„é€†å‘å·¥å…· QEMU çš„ä»£ç è¡ç”Ÿè€Œæ¥ï¼Œä½†å°è£…æˆäº†ä¸€ä¸ªç®€å•çš„åº“ï¼Œæ”¯æŒå¤šè¯­è¨€è°ƒç”¨ï¼Œé‡ç‚¹åœ¨äºæ¨¡æ‹Ÿ CPU æ‰§è¡Œè€Œä¸æ˜¯å®Œæ•´ç³»ç»Ÿè™šæ‹ŸåŒ–ã€‚</p><p>â€‹æ”¯æŒæ¡†æ¶ã€‚</p><table><thead><tr><th>æ¶æ„åç§°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>x86</td><td>32ä½æ¶æ„</td></tr><tr><td>x86_64</td><td>64ä½æ¶æ„ï¼ˆamd64ï¼‰</td></tr><tr><td>ARM</td><td>32ä½ ARM æ¶æ„</td></tr><tr><td>ARM64</td><td>64ä½ ARM æ¶æ„ï¼ˆAArch64ï¼‰</td></tr><tr><td>MIPS</td><td>åŒ…æ‹¬ MIPS32 å’Œ MIPS64</td></tr><tr><td>PowerPC</td><td>Power æ¶æ„çš„ä¸€éƒ¨åˆ†</td></tr><tr><td>SPARC</td><td>è¾ƒå°‘ä½¿ç”¨ï¼Œä½†æ”¯æŒ</td></tr><tr><td>RISC-V</td><td>è¾ƒæ–°çš„å¼€æºæ¶æ„</td></tr></tbody></table><p>â€‹</p><blockquote><p>â€‹Unicorn ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹æ¨¡å—ï¼š</p><ol><li><strong>å†…å­˜ç®¡ç†ï¼ˆMemory Mapï¼‰</strong>ï¼šæ˜ å°„ç¨‹åºè¿è¡Œæ‰€éœ€çš„åœ°å€ç©ºé—´</li><li><strong>å¯„å­˜å™¨æ¥å£</strong>ï¼šè®¾ç½®æˆ–è¯»å–è™šæ‹Ÿ CPU çš„å¯„å­˜å™¨å€¼</li><li><strong>ä»¿çœŸå™¨æ¥å£ï¼ˆEmulatorï¼‰</strong>ï¼šæ§åˆ¶æ‰§è¡Œå¼€å§‹&#x2F;åœæ­¢&#x2F;æ­¥è¿›ç­‰</li><li><strong>é’©å­æœºåˆ¶ï¼ˆHooksï¼‰</strong>ï¼šç”¨æˆ·å¯æ’å…¥å›è°ƒï¼Œæ‹¦æˆªæŒ‡ä»¤ã€å†…å­˜ã€å¼‚å¸¸äº‹ä»¶</li><li><strong>é”™è¯¯å¤„ç†ä¸çŠ¶æ€ç </strong></li></ol></blockquote><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//ä½¿ç”¨æµç¨‹ï¼Œä»¥Cã€C++ä¸ºä¾‹</span><br>uc_engine *uc;<br>uc_open(UC_ARCH_X86, UC_MODE_32, &amp;uc);<br>uc_mem_map(uc, addr, size, UC_PROT_ALL);<br>uc_mem_write(uc, addr, code, code_size);<br>uc_reg_write(uc, UC_X86_REG_EIP, &amp;addr);<br>uc_emu_start(uc, addr, addr + code_size, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>uc_reg_read(uc, UC_X86_REG_EAX, &amp;result);<br>uc_close(uc);<br><br><br><br>uc_open(...)         <span class="hljs-comment">// åˆå§‹åŒ–å¼•æ“</span><br>uc_mem_map(...)      <span class="hljs-comment">// åˆ†é…æ¨¡æ‹Ÿå†…å­˜</span><br>uc_mem_write(...)    <span class="hljs-comment">// å†™å…¥æŒ‡ä»¤æˆ–æ•°æ®</span><br>uc_reg_write(...)    <span class="hljs-comment">// è®¾ç½®å¯„å­˜å™¨çŠ¶æ€</span><br>uc_emu_start(...)    <span class="hljs-comment">// å¯åŠ¨æ¨¡æ‹Ÿæ‰§è¡Œ</span><br>uc_reg_read(...)     <span class="hljs-comment">// è¯»å–å¯„å­˜å™¨ç»“æœ</span><br>uc_close(...)        <span class="hljs-comment">// å…³é—­å¼•æ“é‡Šæ”¾èµ„æº</span><br></code></pre></td></tr></table></figure><h3 id="ä¸»è¦å‡½æ•°"><a href="#ä¸»è¦å‡½æ•°" class="headerlink" title="ä¸»è¦å‡½æ•°"></a>ä¸»è¦å‡½æ•°</h3><p>â€‹<code>uc_err uc_open(uc_arch arch, uc_mode mode, uc_engine **uc);</code></p><p>â€‹<strong>åŠŸèƒ½</strong>ï¼šåˆå§‹åŒ–Unicornå¼•æ“ã€‚</p><p>â€‹<strong>å‚æ•°</strong>ï¼šarchâ€”â€”æ¶æ„ç±»å‹ï¼Œmodeâ€”â€”æ¨¡å¼ï¼Œå¦‚32ä½ã€64ä½ï¼Œucâ€”â€”è¾“å‡ºå‚æ•°ï¼ŒæŒ‡å‘æ–°åˆ›å»ºçš„å¼•æ“å¥æŸ„ã€‚</p><p>â€‹<strong>è¿”å›å€¼</strong>ï¼šé”™è¯¯ç ï¼ˆ<code>UC_ERR_OK</code> è¡¨ç¤ºæˆåŠŸï¼‰</p><p>â€‹</p><p>â€‹<code>uc_err uc_close(uc_engine *uc);</code></p><p>â€‹<strong>åŠŸèƒ½</strong>ï¼šå…³é—­å¹¶ä¸”é‡Šæ”¾Unicornèµ„æºã€‚</p><p>â€‹<strong>å‚æ•°</strong>ï¼šå¼•æ“å¥æŸ„ã€‚</p><p>â€‹<strong>è¿”å›å€¼</strong>ï¼šé”™è¯¯ç ã€‚</p><p>â€‹</p><p>â€‹<code>uc_err uc_mem_map(uc_engine *uc, uint64_t address, size_t size, uint32_t perms);</code></p><p>â€‹<strong>åŠŸèƒ½</strong>ï¼šç»™æ¨¡æ‹Ÿå™¨åˆ†é…ä¸€å—å†…å­˜ã€‚</p><p>â€‹<strong>å‚æ•°</strong>ï¼šaddressâ€”â€”è™šæ‹Ÿå†…å­˜èµ·å§‹åœ°å€ï¼Œsizeâ€”â€”æ˜ å°„å¤§å°ï¼Œpermsâ€”â€”å†…å­˜æƒé™æ ‡å¿—ï¼Œå¦‚<strong>UC_PROT_READ | UC_PROT_WRITE | UC_PROT_EXEC</strong>ã€‚</p><p>â€‹<strong>è¿”å›å€¼</strong>ï¼šé”™è¯¯ç ã€‚</p><p>â€‹<strong>æ³¨è§£</strong>ï¼šæ¨¡æ‹Ÿå™¨æ‰§è¡Œä»£ç å’Œè¯»å†™æ•°æ®çš„å†…å­˜éƒ½éœ€è¦å…ˆæ˜ å°„ã€‚</p><p>â€‹<code>uc_err uc_mem_write(uc_engine *uc, uint64_t address, const void *buffer, size_t size);</code></p><p>â€‹<strong>åŠŸèƒ½</strong>ï¼šå¾€æ¨¡æ‹Ÿå†…å­˜å†™æ•°æ®ï¼ˆä»£ç æˆ–å˜é‡ï¼‰ã€‚</p><p>â€‹<strong>å‚æ•°</strong>ï¼šaddessâ€”â€”å†™å…¥å†…å­˜çš„èµ·å§‹åœ°å€ï¼Œbufferâ€”â€”æ•°æ®ç¼“å†²åŒºï¼Œå¾…å†™å…¥æ•°æ®çš„åœ°å€ï¼Œsizeâ€”â€”æ•°æ®é•¿åº¦ã€‚</p><p>â€‹<strong>æ³¨è§£</strong>ï¼šå¸¸ç”¨æ¥å†™å…¥æœºå™¨ç æˆ–æ¨¡æ‹Ÿæ•°æ®ã€‚</p><p>â€‹<code>uc_err uc_mem_read(uc_engine *uc, uint64_t address, void *buffer, size_t size);</code></p><p>â€‹<strong>åŠŸèƒ½</strong>ï¼šä»æ¨¡æ‹Ÿå†…å­˜è¯»å–æ•°æ®ã€‚</p><p>â€‹<strong>å‚æ•°</strong>ï¼šåŒ uc_mem_writeï¼Œä½† buffer ç”¨æ¥å­˜æ”¾è¯»å‡ºçš„æ•°æ®</p><p>â€‹<strong>æ³¨è§£</strong>ï¼šæ‰§è¡Œåè¯»å–å†…å­˜ä¸­çŠ¶æ€ï¼Œæˆ–è€…è·å¾—è®¡ç®—ç»“æœã€‚</p><p>â€‹<code>uc_err uc_reg_write(uc_engine *uc, int regid, const void *value);</code></p><p>â€‹<strong>åŠŸèƒ½</strong>ï¼šè®¾ç½®æ¨¡æ‹Ÿ CPU å¯„å­˜å™¨çš„å€¼ã€‚</p><p>â€‹<strong>å‚æ•°</strong>ï¼šregidâ€”â€”å¯„å­˜å™¨ IDï¼Œå¦‚ <code>UC_X86_REG_EAX</code>ï¼Œvalueâ€”â€”æŒ‡å‘åŒ…å«å¯„å­˜å™¨å€¼çš„å˜é‡çš„æŒ‡é’ˆï¼ˆä¼ å¾…ä¼ æ•°æ®çš„åœ°å€ï¼‰ã€‚</p><p>â€‹<strong>æ³¨è§£</strong>ï¼šå¯åŠ¨æ‰§è¡Œå‰è®¾ç½®å¯„å­˜å™¨çŠ¶æ€ï¼Œå¦‚ç¨‹åºè®¡æ•°å™¨ï¼ˆPCï¼‰ã€å †æ ˆæŒ‡é’ˆï¼ˆSPï¼‰ç­‰ã€‚</p><p>â€‹<code>uc_err uc_reg_read(uc_engine *uc, int regid, void *value);</code></p><p>â€‹<strong>åŠŸèƒ½</strong>ï¼šè¯»å–æ¨¡æ‹Ÿ CPU å¯„å­˜å™¨çš„å€¼ã€‚</p><p>â€‹<strong>å‚æ•°</strong>ï¼šç±»ä¼¼ <code>uc_reg_write</code>ï¼Œå°†å¯„å­˜å™¨å€¼å†™å…¥ <code>value</code> æŒ‡å‘çš„å˜é‡ã€‚</p><p>â€‹<strong>æ³¨è§£</strong>ï¼šæ‰§è¡Œå®Œæ¯•åè¯»å–å¯„å­˜å™¨çŠ¶æ€ï¼ŒæŸ¥çœ‹ç»“æœæˆ–ä¸‹ä¸€æ­¥æ‰§è¡Œåœ°å€ã€‚</p><p>â€‹<code>uc_err uc_emu_start(uc_engine *uc, uint64_t begin, uint64_t until, uint64_t timeout, uint64_t count);</code></p><p>â€‹<strong>åŠŸèƒ½</strong>ï¼šå¯åŠ¨ä»¿çœŸæ‰§è¡Œï¼Œä» <code>begin</code> åœ°å€å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ° <code>until</code> åœæ­¢</p><p>â€‹<strong>å‚æ•°</strong>ï¼šbeginâ€”â€”ä»£ç å…¥å£åœ°å€ã€‚untilâ€”â€”ç»“æŸåœ°å€ï¼ˆå¯è®¾ç½®ä¸º0è¡¨ç¤ºæ— é™æ‰§è¡Œç›´åˆ°å‡ºé”™ï¼‰ã€‚timeoutâ€”â€”è¶…æ—¶æ—¶é—´ï¼ˆå¾®ç§’ï¼‰ï¼Œ0 è¡¨ç¤ºä¸é™åˆ¶ã€‚countâ€”â€”æœ€å¤§æ‰§è¡ŒæŒ‡ä»¤æ•°ï¼Œ0 è¡¨ç¤ºä¸é™åˆ¶ã€‚</p><p>â€‹<strong>æ³¨è§£</strong>ï¼šè¿™æ˜¯æ‰§è¡ŒæŒ‡ä»¤çš„æ ¸å¿ƒå‡½æ•°ã€‚</p><p>â€‹Hook æ³¨å†Œå‡½æ•°<strong>uc_hook_add</strong>ï¼šæ·»åŠ é’©å­ï¼Œæ‹¦æˆªæŒ‡ä»¤æ‰§è¡Œã€å†…å­˜è¯»å†™ã€å¼‚å¸¸ç­‰äº‹ä»¶ã€‚</p><p>â€‹<code>hook_code_callback</code> æ˜¯ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼Œä¼šåœ¨æŒ‡å®šèŒƒå›´å†…æ¯æ¡æŒ‡ä»¤æ‰§è¡Œæ—¶è°ƒç”¨ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">uc_hook trace;<br>uc_hook_add(uc, &amp;trace, UC_HOOK_CODE, hook_code_callback, <span class="hljs-literal">NULL</span>, ADDRESS, ADDRESS + size);<br></code></pre></td></tr></table></figure><p>â€‹é”™è¯¯ç è¯´æ˜ï¼š<code>UC_ERR_OK</code> &#x3D; 0ï¼ŒæˆåŠŸï¼Œå…¶å®ƒå¦‚ <code>UC_ERR_WRITE_UNMAPPED</code>ã€<code>UC_ERR_READ_UNMAPPED</code> è¡¨ç¤ºå†…å­˜è®¿é—®é”™è¯¯</p><p>ä½¿ç”¨ <code>uc_strerror(err)</code> å¯è·å–é”™è¯¯ä¿¡æ¯å­—ç¬¦ä¸²ã€‚</p><h2 id="ç®€å•ä½¿ç”¨ç¤ºä¾‹"><a href="#ç®€å•ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="ç®€å•ä½¿ç”¨ç¤ºä¾‹"></a>ç®€å•ä½¿ç”¨ç¤ºä¾‹</h2><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">å…ˆå¯¼å…¥ç¯å¢ƒå˜é‡ï¼Œä¸æƒ³æ¯æ¬¡éƒ½æ“ä½œå¯ä»¥å†™å…¥å®¶ç›®å½•çš„.bashrcä¸­ã€‚<br><span class="hljs-built_in">export</span> LD_LIBRARY_PATH=<span class="hljs-variable">$LD_LIBRARY_PATH</span>:/home/ubuntu/desk/unicorn/build<br><br>ç¼–è¯‘å‘½ä»¤ç¤ºä¾‹å¦‚ä¸‹ï¼Œè‡ªè¡Œä¿®æ”¹æºæ–‡ä»¶è·¯å¾„ã€includeè·¯å¾„å’Œbuildè·¯å¾„ã€‚ï¼ˆæ³¨æ„ï¼Œæœ€å¥½ä¸è¦ç”¨ä¸­æ–‡è·¯å¾„ï¼Œè‹¥æœ‰æŠ¥é”™å¯ä»¥æ£€æŸ¥è¿™ä¸ªç‚¹ï¼‰<br><br>gcc -o <span class="hljs-built_in">test</span> /home/ubuntu/desk/test.cpp -I /home/ubuntu/unicorn/include/ -L /home/ubuntu/unicorn/build -l unicorn<br></code></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unicorn/unicorn.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ADDRESS 0x1000</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DATA_ADDR 0x2000<span class="hljs-comment">//æœ€å¥½å®šä¹‰ä¸ºå˜é‡ç±»å‹ï¼Œuint32_t</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> CODE_SIZE 0x1000</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_LEN 64</span><br><br><span class="hljs-comment">// x86 32ä½ä»£ç ï¼Œå®ç°å¼‚æˆ–åŠ å¯†ï¼š</span><br><span class="hljs-comment">// esi æŒ‡å‘è¾“å…¥ï¼Œecx é•¿åº¦</span><br><span class="hljs-comment">// éå†è¾“å…¥å­—èŠ‚ï¼Œå¯¹æ¯å­—èŠ‚å¼‚æˆ–0x55</span><br><span class="hljs-comment">// è¿”å›æ—¶ä¿®æ”¹å†…å­˜ä¸­å†…å®¹ä¸ºåŠ å¯†ç»“æœ</span><br><span class="hljs-type">const</span> <span class="hljs-type">uint8_t</span> CODE[] = &#123;<br>    <span class="hljs-number">0x31</span>, <span class="hljs-number">0xC0</span>,             <span class="hljs-comment">// xor eax, eax</span><br>    <span class="hljs-number">0x31</span>, <span class="hljs-number">0xD2</span>,             <span class="hljs-comment">// xor edx, edx</span><br>    <span class="hljs-comment">// loop_start:</span><br>    <span class="hljs-number">0x8A</span>, <span class="hljs-number">0x06</span>,             <span class="hljs-comment">// mov al, byte ptr [esi]</span><br>    <span class="hljs-number">0x80</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0x55</span>,       <span class="hljs-comment">// xor al, 0x55</span><br>    <span class="hljs-number">0x88</span>, <span class="hljs-number">0x06</span>,             <span class="hljs-comment">// mov byte ptr [esi], al</span><br>    <span class="hljs-number">0x46</span>,                   <span class="hljs-comment">// inc esi</span><br>    <span class="hljs-number">0x42</span>,                   <span class="hljs-comment">// inc edx</span><br>    <span class="hljs-number">0x49</span>,                   <span class="hljs-comment">// dec ecx</span><br>    <span class="hljs-number">0x75</span>, <span class="hljs-number">0xF5</span>,             <span class="hljs-comment">// jne loop_start</span><br>    <span class="hljs-number">0xC3</span>                    <span class="hljs-comment">// ret</span><br>&#125;;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    uc_engine *uc;<br>    uc_err err;<br><br>    <span class="hljs-type">char</span> input[MAX_LEN];<br>    <span class="hljs-type">const</span> <span class="hljs-type">char</span> encrypted_flag[] = &#123;<br>        <span class="hljs-string">&#x27;C&#x27;</span> ^ <span class="hljs-number">0x55</span>, <span class="hljs-string">&#x27;T&#x27;</span> ^ <span class="hljs-number">0x55</span>, <span class="hljs-string">&#x27;F&#x27;</span> ^ <span class="hljs-number">0x55</span>, <span class="hljs-string">&#x27;&#123;&#x27;</span> ^ <span class="hljs-number">0x55</span>, <span class="hljs-string">&#x27;s&#x27;</span> ^ <span class="hljs-number">0x55</span>, <span class="hljs-string">&#x27;e&#x27;</span> ^ <span class="hljs-number">0x55</span>,<br>        <span class="hljs-string">&#x27;c&#x27;</span> ^ <span class="hljs-number">0x55</span>, <span class="hljs-string">&#x27;r&#x27;</span> ^ <span class="hljs-number">0x55</span>, <span class="hljs-string">&#x27;e&#x27;</span> ^ <span class="hljs-number">0x55</span>, <span class="hljs-string">&#x27;t&#x27;</span> ^ <span class="hljs-number">0x55</span>, <span class="hljs-string">&#x27;_&#x27;</span> ^ <span class="hljs-number">0x55</span>, <span class="hljs-string">&#x27;f&#x27;</span> ^ <span class="hljs-number">0x55</span>,<br>        <span class="hljs-string">&#x27;l&#x27;</span> ^ <span class="hljs-number">0x55</span>, <span class="hljs-string">&#x27;a&#x27;</span> ^ <span class="hljs-number">0x55</span>, <span class="hljs-string">&#x27;g&#x27;</span> ^ <span class="hljs-number">0x55</span>, <span class="hljs-string">&#x27;&#125;&#x27;</span> ^ <span class="hljs-number">0x55</span>, <span class="hljs-string">&#x27;\0&#x27;</span><br>    &#125;;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Enter flag: &quot;</span>);<br>    <span class="hljs-keyword">if</span> (!fgets(input, <span class="hljs-keyword">sizeof</span>(input), <span class="hljs-built_in">stdin</span>)) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Input error\n&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>    <span class="hljs-type">size_t</span> len = <span class="hljs-built_in">strlen</span>(input);<br>    <span class="hljs-keyword">if</span> (len &gt; <span class="hljs-number">0</span> &amp;&amp; input[len - <span class="hljs-number">1</span>] == <span class="hljs-string">&#x27;\n&#x27;</span>) &#123;<br>        input[len - <span class="hljs-number">1</span>] = <span class="hljs-string">&#x27;\0&#x27;</span>;<br>        len--;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (len != <span class="hljs-built_in">strlen</span>(encrypted_flag)) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Flag verification failed.\n&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// åˆå§‹åŒ– Unicorn</span><br>    err = uc_open(UC_ARCH_X86, UC_MODE_32, &amp;uc);<br>    <span class="hljs-keyword">if</span> (err) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Failed to initialize Unicorn engine: %u\n&quot;</span>, err);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// åˆ†é…å†…å­˜ï¼Œå†™å…¥ä»£ç å’Œæ•°æ®</span><br>    uc_mem_map(uc, ADDRESS, CODE_SIZE, UC_PROT_ALL);<br>    uc_mem_write(uc, ADDRESS, CODE, <span class="hljs-keyword">sizeof</span>(CODE));<br><br>    uc_mem_map(uc, DATA_ADDR, CODE_SIZE, UC_PROT_ALL);<br>    uc_mem_write(uc, DATA_ADDR, input, len);<br><br>    <span class="hljs-comment">// è®¾ç½®å¯„å­˜å™¨</span><br>    uc_reg_write(uc, UC_X86_REG_ESI, DATA_ADDR);<span class="hljs-comment">//æœ€å¥½ä¼ å…¥æŒ‡é’ˆ&amp;DATA_ADDRï¼Œå‰ææ˜¯æ”¹ä¸ºå˜é‡ç±»å‹äº†</span><br>    uc_reg_write(uc, UC_X86_REG_ECX, len);<span class="hljs-comment">//æœ€å¥½ä¼ å…¥&amp;len</span><br><br>    <span class="hljs-comment">// æ‰§è¡Œä»£ç ï¼ˆåŠ å¯†ï¼‰</span><br>    err = uc_emu_start(uc, ADDRESS, ADDRESS + <span class="hljs-keyword">sizeof</span>(CODE), <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span> (err) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Failed to emulate code: %u\n&quot;</span>, err);<br>        uc_close(uc);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// è¯»å–åŠ å¯†åçš„æ•°æ®</span><br>    <span class="hljs-type">char</span> encrypted_input[MAX_LEN] = &#123;<span class="hljs-number">0</span>&#125;;<br>    uc_mem_read(uc, DATA_ADDR, encrypted_input, len);<br><br>    <span class="hljs-comment">// æ¯”å¯¹</span><br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">memcmp</span>(encrypted_input, encrypted_flag, len) == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Flag verified successfully!\n&quot;</span>);<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Flag verification failed.\n&quot;</span>);<br>    &#125;<br><br>    uc_close(uc);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="ç›¸å…³æ–‡ç« é“¾æ¥"><a href="#ç›¸å…³æ–‡ç« é“¾æ¥" class="headerlink" title="ç›¸å…³æ–‡ç« é“¾æ¥"></a>ç›¸å…³æ–‡ç« é“¾æ¥</h2><p>â€‹<a href="https://www.cnblogs.com/Here-is-SG/p/17080180.html">åšå®¢å›­</a>ã€<a href="https://github.com/unicorn-engine/unicorn">Unicorné¡¹ç›®</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Unicornæ¡†æ¶&quot;&gt;&lt;a href=&quot;#Unicornæ¡†æ¶&quot; class=&quot;headerlink&quot; title=&quot;Unicornæ¡†æ¶&quot;&gt;&lt;/a&gt;Unicornæ¡†æ¶&lt;/h1&gt;&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; </summary>
      
    
    
    
    <category term="Reverse" scheme="http://bumak.github.io/categories/Reverse/"/>
    
    
    <category term="Reverse" scheme="http://bumak.github.io/tags/Reverse/"/>
    
    <category term="æŠ€æœ¯å­¦ä¹ " scheme="http://bumak.github.io/tags/%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>OpenGLåˆå­¦ä¹ </title>
    <link href="http://bumak.github.io/2025/06/25/OpenGL%E5%AD%A6%E4%B9%A0/OpenGL%E5%AD%A6%E4%B9%A0/"/>
    <id>http://bumak.github.io/2025/06/25/OpenGL%E5%AD%A6%E4%B9%A0/OpenGL%E5%AD%A6%E4%B9%A0/</id>
    <published>2025-06-25T08:15:47.399Z</published>
    <updated>2025-06-26T06:36:48.738Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><p>â€‹å­¦ä¹ OpenGLçš„æ ¸å¿ƒæ¨¡å¼ï¼Œ<a href="https://blog.csdn.net/ssunshining/article/details/123767340">VS2022+GLFW+GLADç¯å¢ƒæ­å»ºæ•™ç¨‹</a>ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ–‡ç« ä¸­ä¸‹è½½çš„GLFWæ˜¯ç¼–è¯‘å¥½çš„ï¼Œæˆ‘ä»¬å¯ä»¥è·³è¿‡CMakeç¼–è¯‘çš„é‚£ä¸€æ­¥ï¼Œç›´æ¥å»æ‰¾includeæ–‡ä»¶å’Œlibæ–‡ä»¶ã€‚</p><p>â€‹è¿˜æœ‰å­¦ä¹ èµ„æºï¼Œ<a href="https://learnopengl-cn.github.io/">çŸ¥è¯†ç‚¹å­¦ä¹ </a>ã€‚</p><hr><h3 id="åŸºç¡€çŸ¥è¯†ï¼ˆçŸ¥è¯†ç‚¹å­¦ä¹ ï¼‰"><a href="#åŸºç¡€çŸ¥è¯†ï¼ˆçŸ¥è¯†ç‚¹å­¦ä¹ ï¼‰" class="headerlink" title="åŸºç¡€çŸ¥è¯†ï¼ˆçŸ¥è¯†ç‚¹å­¦ä¹ ï¼‰"></a>åŸºç¡€çŸ¥è¯†ï¼ˆçŸ¥è¯†ç‚¹å­¦ä¹ ï¼‰</h3><blockquote><h3 id="ğŸ”·-OpenGL-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ğŸ”·-OpenGL-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ğŸ”· OpenGL æ˜¯ä»€ä¹ˆï¼Ÿ"></a>ğŸ”· OpenGL æ˜¯ä»€ä¹ˆï¼Ÿ</h3><blockquote><p>OpenGLï¼ˆOpen Graphics Libraryï¼‰æ˜¯ä¸€ä¸ªç”»å›¾çš„æ ‡å‡†å·¥å…·åº“ï¼Œç”¨æ¥ç»˜åˆ¶å›¾å½¢ï¼Œæ¯”å¦‚ 3D æ¨¡å‹ã€åœºæ™¯ã€ç‰¹æ•ˆç­‰ç­‰ã€‚</p></blockquote><ul><li>å®ƒä¸è´Ÿè´£åˆ›å»ºçª—å£ï¼Œä¹Ÿä¸èƒ½å¤„ç†é¼ æ ‡&#x2F;é”®ç›˜ï¼Œåªä¸“æ³¨â€œç”»å›¾â€ã€‚</li><li>æƒ³è±¡ä½ æ˜¯ç”»å®¶ï¼ŒOpenGL å°±æ˜¯ä½ çš„ç”»ç¬”å’Œé¢œæ–™ã€‚</li></ul><hr><h3 id="ğŸ”¶-GLFW-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ğŸ”¶-GLFW-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ğŸ”¶ GLFW æ˜¯ä»€ä¹ˆï¼Ÿ"></a>ğŸ”¶ GLFW æ˜¯ä»€ä¹ˆï¼Ÿ</h3><blockquote><p>GLFW æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥åˆ›å»ºçª—å£ã€å¤„ç†ç”¨æˆ·è¾“å…¥ï¼ˆé”®ç›˜é¼ æ ‡ï¼‰å’Œè®¾ç½® OpenGL çš„åº“ã€‚</p></blockquote><ul><li>å®ƒå¸®ä½ æ‰“å¼€ä¸€ä¸ªçª—å£ã€è®¾ç½® OpenGL çš„ç‰ˆæœ¬ï¼Œå¹¶å“åº”é¼ æ ‡&#x2F;é”®ç›˜äº‹ä»¶ã€‚</li><li>æ²¡æœ‰ GLFWï¼ˆæˆ–ç±»ä¼¼çš„åº“ï¼‰ï¼Œä½ è¿â€œæ‰“å¼€ç”»å¸ƒâ€éƒ½åšä¸åˆ°ã€‚</li></ul><hr><h3 id="ğŸ”¸-GLAD-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ğŸ”¸-GLAD-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ğŸ”¸ GLAD æ˜¯ä»€ä¹ˆï¼Ÿ"></a>ğŸ”¸ GLAD æ˜¯ä»€ä¹ˆï¼Ÿ</h3><blockquote><p>GLAD æ˜¯ä¸€ä¸ª OpenGL çš„â€œåŠ è½½å™¨â€ï¼Œå¸®ä½ æŠŠ OpenGL çš„å‡½æ•°éƒ½å‡†å¤‡å¥½ã€‚</p></blockquote><ul><li>å› ä¸º OpenGL çš„å‡½æ•°ä¸æ˜¯è‡ªåŠ¨æä¾›çš„ï¼Œéœ€è¦æ‰‹åŠ¨â€œåŠ è½½â€æ‰èƒ½ä½¿ç”¨ã€‚</li><li>GLAD å°±åƒä¸€ä¸ªå·¥å…·ç®±æ‰“å¼€å™¨ï¼Œç¡®ä¿ä½ èƒ½æ­£ç¡®ä½¿ç”¨æ‰€æœ‰ç”»å›¾å·¥å…·ã€‚</li></ul><hr><h2 id="ğŸ§ -è®°å¿†å°å£è¯€ï¼š"><a href="#ğŸ§ -è®°å¿†å°å£è¯€ï¼š" class="headerlink" title="ğŸ§  è®°å¿†å°å£è¯€ï¼š"></a>ğŸ§  è®°å¿†å°å£è¯€ï¼š</h2><p><strong>GLFW å¼€çª—å£ï¼ŒGLAD å¼€å·¥å…·ï¼ŒOpenGL å¼€ç”»å›¾ã€‚</strong></p></blockquote><p>â€‹</p><blockquote><h2 id="OpenGL-çš„åæ ‡ç³»ï¼ˆæ ‡å‡†åŒ–è®¾å¤‡åæ ‡-NDCï¼‰"><a href="#OpenGL-çš„åæ ‡ç³»ï¼ˆæ ‡å‡†åŒ–è®¾å¤‡åæ ‡-NDCï¼‰" class="headerlink" title="OpenGL çš„åæ ‡ç³»ï¼ˆæ ‡å‡†åŒ–è®¾å¤‡åæ ‡ NDCï¼‰"></a>OpenGL çš„åæ ‡ç³»ï¼ˆæ ‡å‡†åŒ–è®¾å¤‡åæ ‡ NDCï¼‰</h2><ol><li><strong>åæ ‡èŒƒå›´ï¼š</strong><br> OpenGL åœ¨æ¸²æŸ“ç®¡çº¿æœ€åä¸€æ­¥ï¼Œä¼šæŠŠé¡¶ç‚¹åæ ‡å˜æ¢åˆ°ä¸€ä¸ªå«åš <strong>æ ‡å‡†åŒ–è®¾å¤‡åæ ‡</strong>ï¼ˆNDCï¼ŒNormalized Device Coordinatesï¼‰çš„ç©ºé—´é‡Œã€‚<ul><li>Xè½´èŒƒå›´ï¼šä» <strong>-1 åˆ° 1</strong>ï¼ˆå·¦åˆ°å³ï¼‰</li><li>Yè½´èŒƒå›´ï¼šä» <strong>-1 åˆ° 1</strong>ï¼ˆä¸‹åˆ°ä¸Šï¼‰</li><li>Zè½´èŒƒå›´ï¼šä» <strong>-1 åˆ° 1</strong>ï¼ˆè¿‘åˆ°è¿œï¼Œæ·±åº¦ï¼‰</li></ul></li><li><strong>åæ ‡è½´æ–¹å‘ï¼š</strong><ul><li>Xè½´ï¼šè´Ÿæ–¹å‘æŒ‡å‘å·¦ï¼Œæ­£æ–¹å‘æŒ‡å‘å³</li><li>Yè½´ï¼šè´Ÿæ–¹å‘æŒ‡å‘ä¸‹ï¼Œæ­£æ–¹å‘æŒ‡å‘ä¸Š</li><li>Zè½´ï¼šè´Ÿæ–¹å‘æŒ‡å‘å±å¹•å¤–ï¼ˆè§‚å¯Ÿè€…æ–¹å‘ï¼‰ï¼Œæ­£æ–¹å‘æŒ‡å‘å±å¹•å†…</li></ul></li><li><strong>äºŒç»´ç»˜å›¾æ—¶ï¼ŒZè½´é€šå¸¸ä¸º0</strong></li><li><strong>åŸç‚¹åœ¨æ˜¾ç¤ºçª—å£çš„ä¸­å¿ƒç‚¹</strong></li></ol></blockquote><p>â€‹VBOæ˜¯ä»€ä¹ˆï¼Ÿé¡¶ç‚¹ç¼“å†²å¯¹è±¡ï¼Œç”¨æ¥ç®¡ç†å†…å­˜ã€‚çœ‹ä¸‹é¢çš„ä»£ç ï¼Œå°±æ˜¯ä½¿ç”¨<strong>glGenBuffers</strong>å‡½æ•°ç”Ÿæˆä¸€ä¸ªå¸¦æœ‰ç¼“å†²IDçš„VBOå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">unsigned <span class="hljs-type">int</span> VBO;<br>glGenBuffers(<span class="hljs-number">1</span>, &amp;VBO);<br></code></pre></td></tr></table></figure><blockquote><p>ğŸ§  ä¸ºä»€ä¹ˆ VBO æ˜¯ä¸€ä¸ª <code>unsigned int</code> å˜é‡ï¼Ÿ</p><p>â€”â€”å› ä¸ºåœ¨ OpenGL çš„å†…éƒ¨è®¾è®¡ä¸­ï¼Œæ¯ä¸€ä¸ªâ€œå¯¹è±¡â€ï¼ˆæ¯”å¦‚ç¼“å†²åŒºå¯¹è±¡ã€çº¹ç†å¯¹è±¡ã€ç€è‰²å™¨å¯¹è±¡ï¼‰éƒ½ä¼šè¢«åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„æ•°å­— IDï¼Œè¿™ä¸ª ID å°±æ˜¯ä¸€ä¸ªæ•´æ•°ã€‚OpenGL å¹¶ä¸ç›´æ¥è¿”å›ä¸€ä¸ªâ€œæŒ‡é’ˆâ€æˆ–è€…â€œç»“æ„ä½“â€ï¼Œå®ƒåªè¿”å›ä¸€ä¸ªæ•´æ•°å€¼ï¼Œç„¶åä½ ä»¥ååªè¦ç”¨è¿™ä¸ªæ•°å­—æ¥å¼•ç”¨è¿™ä¸ªå¯¹è±¡å°±è¡Œäº†ã€‚</p><p>â“é‚£ VBO æœ¬èº«æ˜¯ç¼“å†²åŒºå—ï¼Ÿ</p><p>â€”â€”ä¸æ˜¯ã€‚VBOåªæ˜¯ä¸€ä¸ªæ•´æ•°å˜é‡ï¼Œç”¨æ¥å­˜è¿™ä¸ªç¼“å†²åŒºçš„IDï¼ŒçœŸæ­£çš„â€œç¼“å†²åŒºå¯¹è±¡â€æ˜¯åœ¨OpenGLå†…éƒ¨åˆ›å»ºå’Œç®¡ç†çš„ï¼Œä½ åªèƒ½é€šè¿‡è¿™ä¸ªIDæ¥é—´æ¥ä½¿ç”¨å®ƒã€‚</p></blockquote><p>â€‹VAOæ˜¯ä»€ä¹ˆï¼Ÿé¡¶ç‚¹æ•°ç»„å¯¹è±¡ï¼Œå¸®ä½ æŠŠä¸€å †â€œé¡¶ç‚¹å±æ€§è®¾ç½®â€çš„çŠ¶æ€ä¿å­˜èµ·æ¥ï¼Œä¸‹æ¬¡æƒ³ç”¨çš„æ—¶å€™ä¸€ç»‘ä¸Šï¼ŒOpenGL å°±çŸ¥é“ä½ çš„é¡¶ç‚¹æ•°æ®é•¿ä»€ä¹ˆæ ·ï¼Œä¸ç”¨ä½ æ¯æ¬¡éƒ½é‡æ–°è®¾ç½®ã€‚</p><blockquote><h2 id="ä¸ºä»€ä¹ˆè¦æœ‰-VAOï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦æœ‰-VAOï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦æœ‰ VAOï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦æœ‰ VAOï¼Ÿ</h2><p>ä½ ç”»ä¸€ä¸ªå›¾å½¢ï¼Œé¡¶ç‚¹æ•°æ®é™¤äº†é¡¶ç‚¹åæ ‡å¤–ï¼Œè¿˜å¯èƒ½æœ‰é¢œè‰²ã€æ³•çº¿ã€çº¹ç†åæ ‡ç­‰ï¼Œæ¯ç§æ•°æ®éƒ½è¦å‘Šè¯‰ OpenGL æ€ä¹ˆè¯»å–ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><ul><li>ä½ çš„é¡¶ç‚¹åæ ‡æ•°æ®åœ¨ç¼“å†²åŒºé‡Œçš„èµ·å§‹åœ°å€æ˜¯0ï¼Œå¤§å°æ˜¯3ä¸ªfloat</li><li>é¢œè‰²æ•°æ®åœ¨ç¼“å†²åŒºé‡Œçš„èµ·å§‹åœ°å€æ˜¯12å­—èŠ‚ï¼Œå¤§å°æ˜¯3ä¸ªfloat</li></ul><p>æ¯æ¬¡ç»˜åˆ¶ä¹‹å‰ï¼Œä½ å¾—å‘Šè¯‰ OpenGL è¿™äº›æ•°æ®åœ¨å“ªï¼Œæ ¼å¼æ˜¯ä»€ä¹ˆã€‚</p><p>å¦‚æœæ²¡æœ‰ VAOï¼Œä½ æ¯æ¬¡ç»˜å›¾éƒ½è¦é‡å¤è¿™äº›ç¹ççš„è®¾ç½®ï¼Œéå¸¸éº»çƒ¦ã€‚</p><hr><h2 id="VAOçš„ä½œç”¨å°±æ˜¯å¸®ä½ è®°ä½è¿™äº›è®¾ç½®"><a href="#VAOçš„ä½œç”¨å°±æ˜¯å¸®ä½ è®°ä½è¿™äº›è®¾ç½®" class="headerlink" title="VAOçš„ä½œç”¨å°±æ˜¯å¸®ä½ è®°ä½è¿™äº›è®¾ç½®"></a>VAOçš„ä½œç”¨å°±æ˜¯å¸®ä½ è®°ä½è¿™äº›è®¾ç½®</h2><p>ä½ å…ˆåˆ›å»ºä¸€ä¸ª VAOï¼Œç»‘å®šå®ƒï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">unsigned <span class="hljs-type">int</span> VAO;<br>glGenVertexArrays(<span class="hljs-number">1</span>, &amp;VAO);<br>glBindVertexArray(VAO);<br></code></pre></td></tr></table></figure><p>ç„¶åä½ åšå„ç§é¡¶ç‚¹å±æ€§è®¾ç½®ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">glBindBuffer(GL_ARRAY_BUFFER, VBO);<br>glVertexAttribPointer(...);<br>glEnableVertexAttribArray(...);<br></code></pre></td></tr></table></figure><p>è¿™äº›è®¾ç½®éƒ½ä¼šè¢« VAO è®°å½•ã€‚</p><p>ä»¥åä½ åªè¦ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">glBindVertexArray(VAO);<br></code></pre></td></tr></table></figure><p>OpenGLå°±è‡ªåŠ¨çŸ¥é“æ‰€æœ‰é¡¶ç‚¹å±æ€§è®¾ç½®ï¼Œä½ å¯ä»¥ç›´æ¥ç”»å›¾äº†ã€‚</p><hr><h2 id="ç®€å•æ¯”å–»"><a href="#ç®€å•æ¯”å–»" class="headerlink" title="ç®€å•æ¯”å–»"></a>ç®€å•æ¯”å–»</h2><ul><li><strong>æ²¡æœ‰ VAO</strong>ï¼šæ¯æ¬¡ç”»ç”»éƒ½è¦é‡æ–°å‘Šè¯‰ç”»ç¬”é¢œè‰²ã€ç²—ç»†ã€ä½ç½®ï¼Œéº»çƒ¦åˆå®¹æ˜“å‡ºé”™ã€‚</li><li><strong>æœ‰äº† VAO</strong>ï¼šæŠŠç”»ç¬”çš„è®¾ç½®å­˜å¥½ï¼Œä¸‹æ¬¡ç›´æ¥æ‹¿å‡ºæ¥ç”¨ï¼Œç”»ç”»å¿«åˆæ–¹ä¾¿ã€‚</li></ul></blockquote><hr><h3 id="ç¤ºä¾‹ä»£ç è®²è§£ï¼ˆæ³¨é‡Šç‰ˆï¼‰"><a href="#ç¤ºä¾‹ä»£ç è®²è§£ï¼ˆæ³¨é‡Šç‰ˆï¼‰" class="headerlink" title="ç¤ºä¾‹ä»£ç è®²è§£ï¼ˆæ³¨é‡Šç‰ˆï¼‰"></a>ç¤ºä¾‹ä»£ç è®²è§£ï¼ˆæ³¨é‡Šç‰ˆï¼‰</h3><figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;glad/glad.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;GLFW/glfw3.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-comment">//å›è°ƒå‡½æ•°å£°æ˜ï¼Œå½“çª—å£å¤§å°æ”¹å˜å°±ä¼šè°ƒç”¨</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">framebuffer_size_callback</span><span class="hljs-params">(GLFWwindow* window, <span class="hljs-type">int</span> width, <span class="hljs-type">int</span> height)</span></span>;<br><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">glfwInit</span>();<br>    <span class="hljs-comment">//å‘Šè¯‰GLFWæˆ‘ä»¬ä½¿ç”¨OpenGL3.3 Core Profile</span><br>    <span class="hljs-built_in">glfwWindowHint</span>(GLFW_CONTEXT_VERSION_MAJOR, <span class="hljs-number">3</span>);<br>    <span class="hljs-built_in">glfwWindowHint</span>(GLFW_CONTEXT_VERSION_MINOR, <span class="hljs-number">3</span>);<br>    <span class="hljs-built_in">glfwWindowHint</span>(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);<br>    <span class="hljs-comment">//glfwWindowHint(GLFW_OPENGL_FORWARD_COMPAT, GL_TRUE);</span><br><br>    GLFWwindow* window = <span class="hljs-built_in">glfwCreateWindow</span>(<span class="hljs-number">800</span>, <span class="hljs-number">600</span>, <span class="hljs-string">&quot;LearnOpenGL&quot;</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<span class="hljs-comment">//åˆ›å»ºçª—å£</span><br>    <br>    <span class="hljs-keyword">if</span> (window == <span class="hljs-literal">NULL</span>)<span class="hljs-comment">//æ£€æŸ¥çª—å£åˆ›å»ºçŠ¶æ€</span><br>    &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Failed to create GLFW window&quot;</span> &lt;&lt; std::endl;<br>        <span class="hljs-built_in">glfwTerminate</span>();<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>    <span class="hljs-built_in">glfwMakeContextCurrent</span>(window);<span class="hljs-comment">//æŠŠOpenGLä¸Šä¸‹æ–‡è®¾ç½®ä¸ºè¿™ä¸ªçª—å£</span><br><br>    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">gladLoadGLLoader</span>((GLADloadproc)glfwGetProcAddress))<span class="hljs-comment">//åˆå§‹åŒ–GLAD</span><br>    &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Failed to initialize GLAD&quot;</span> &lt;&lt; std::endl;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br><br>    <span class="hljs-built_in">glViewport</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">800</span>, <span class="hljs-number">600</span>);<span class="hljs-comment">//è®¾ç½®è§†å£</span><br><br>    <span class="hljs-built_in">glfwSetFramebufferSizeCallback</span>(window, framebuffer_size_callback);<span class="hljs-comment">//æ³¨å†Œçª—å£å¤§å°å˜åŒ–çš„å›è°ƒå‡½æ•°</span><br><br>    <span class="hljs-keyword">while</span> (!<span class="hljs-built_in">glfwWindowShouldClose</span>(window)) <span class="hljs-comment">// åªè¦çª—å£æ²¡è¢«å…³é—­ï¼Œå°±ä¸€ç›´å¾ªç¯</span><br>    &#123;<br>        <span class="hljs-built_in">glfwSwapBuffers</span>(window);<span class="hljs-comment">// äº¤æ¢é¢œè‰²ç¼“å†²ï¼ˆæŠŠæ¸²æŸ“çš„å›¾åƒæ˜¾ç¤ºåˆ°å±å¹•ä¸Šï¼‰</span><br>        <span class="hljs-built_in">glfwPollEvents</span>();<span class="hljs-comment">// å¤„ç†é”®ç›˜é¼ æ ‡ç­‰äº‹ä»¶</span><br>    &#125;<br>    <span class="hljs-built_in">glfwTerminate</span>();<span class="hljs-comment">// æ¸…ç†å¹¶é€€å‡º GLFW</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">framebuffer_size_callback</span><span class="hljs-params">(GLFWwindow* window, <span class="hljs-type">int</span> width, <span class="hljs-type">int</span> height)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">glViewport</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, width, height);<span class="hljs-comment">// æ ¹æ®æ–°çš„çª—å£å¤§å°é‡æ–°è®¾ç½®è§†å£</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="ä½œä¸šä¸€"><a href="#ä½œä¸šä¸€" class="headerlink" title="ä½œä¸šä¸€"></a>ä½œä¸šä¸€</h3><ul><li><strong>ç»˜åˆ¶æ¸å˜è‰²çš„ä¸‰è§’å½¢</strong></li></ul><figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;glad/glad.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;GLFW/glfw3.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;iostream&gt;</span></span><br><br><span class="hljs-comment">// çª—å£å¤§å°å˜åŒ–æ—¶è°ƒæ•´è§†å£</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">framebuffer_size_callback</span><span class="hljs-params">(GLFWwindow* window, <span class="hljs-type">int</span> width, <span class="hljs-type">int</span> height)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">glViewport</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, width, height);<br>&#125;<br><br><span class="hljs-comment">// æ£€æŸ¥ç€è‰²å™¨ç¼–è¯‘é”™è¯¯</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">checkCompileErrors</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> shader, std::string type)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> success;<br>    <span class="hljs-type">char</span> infoLog[<span class="hljs-number">1024</span>];<br>    <span class="hljs-keyword">if</span> (type != <span class="hljs-string">&quot;PROGRAM&quot;</span>)<br>    &#123;<br>        <span class="hljs-built_in">glGetShaderiv</span>(shader, GL_COMPILE_STATUS, &amp;success);<br>        <span class="hljs-keyword">if</span> (!success)<br>        &#123;<br>            <span class="hljs-built_in">glGetShaderInfoLog</span>(shader, <span class="hljs-number">1024</span>, <span class="hljs-literal">NULL</span>, infoLog);<br>            std::cout &lt;&lt; <span class="hljs-string">&quot;ERROR::SHADER_COMPILATION_ERROR of type: &quot;</span> &lt;&lt; type &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span><br>                &lt;&lt; infoLog &lt;&lt; <span class="hljs-string">&quot;\n -- --------------------------------------------------- -- &quot;</span> &lt;&lt; std::endl;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        <span class="hljs-built_in">glGetProgramiv</span>(shader, GL_LINK_STATUS, &amp;success);<br>        <span class="hljs-keyword">if</span> (!success)<br>        &#123;<br>            <span class="hljs-built_in">glGetProgramInfoLog</span>(shader, <span class="hljs-number">1024</span>, <span class="hljs-literal">NULL</span>, infoLog);<br>            std::cout &lt;&lt; <span class="hljs-string">&quot;ERROR::PROGRAM_LINKING_ERROR of type: &quot;</span> &lt;&lt; type &lt;&lt; <span class="hljs-string">&quot;\n&quot;</span><br>                &lt;&lt; infoLog &lt;&lt; <span class="hljs-string">&quot;\n -- --------------------------------------------------- -- &quot;</span> &lt;&lt; std::endl;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">// 1. åˆå§‹åŒ– GLFW</span><br>    <span class="hljs-built_in">glfwInit</span>();<br>    <span class="hljs-built_in">glfwWindowHint</span>(GLFW_CONTEXT_VERSION_MAJOR, <span class="hljs-number">3</span>); <span class="hljs-comment">// OpenGL 3.x</span><br>    <span class="hljs-built_in">glfwWindowHint</span>(GLFW_CONTEXT_VERSION_MINOR, <span class="hljs-number">3</span>); <span class="hljs-comment">// OpenGL x.3</span><br>    <span class="hljs-built_in">glfwWindowHint</span>(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE); <span class="hljs-comment">// æ ¸å¿ƒæ¨¡å¼</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> __APPLE__</span><br>    <span class="hljs-built_in">glfwWindowHint</span>(GLFW_OPENGL_FORWARD_COMPAT, GL_TRUE); <span class="hljs-comment">// MacOS éœ€è¦è¿™å¥</span><br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br><br>    <span class="hljs-comment">// 2. åˆ›å»ºçª—å£</span><br>    GLFWwindow* window = <span class="hljs-built_in">glfwCreateWindow</span>(<span class="hljs-number">800</span>, <span class="hljs-number">600</span>, <span class="hljs-string">&quot;Colored Triangle&quot;</span>, <span class="hljs-literal">NULL</span>, <span class="hljs-literal">NULL</span>);<br>    <span class="hljs-keyword">if</span> (window == <span class="hljs-literal">NULL</span>)<br>    &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Failed to create GLFW window\n&quot;</span>;<br>        <span class="hljs-built_in">glfwTerminate</span>();<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br>    <span class="hljs-built_in">glfwMakeContextCurrent</span>(window);<br><br>    <span class="hljs-comment">// 3. åˆå§‹åŒ– GLAD</span><br>    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">gladLoadGLLoader</span>((GLADloadproc)glfwGetProcAddress))<br>    &#123;<br>        std::cout &lt;&lt; <span class="hljs-string">&quot;Failed to initialize GLAD\n&quot;</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// 4. è®¾ç½®è§†å£å’Œçª—å£å¤§å°å›è°ƒ</span><br>    <span class="hljs-built_in">glViewport</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">800</span>, <span class="hljs-number">600</span>);<br>    <span class="hljs-built_in">glfwSetFramebufferSizeCallback</span>(window, framebuffer_size_callback);<br><br>    <span class="hljs-comment">// 5. å®šä¹‰é¡¶ç‚¹æ•°æ®ï¼ˆä½ç½® + é¢œè‰²ï¼‰</span><br>    <span class="hljs-type">float</span> vertices[] = &#123;<br>        <span class="hljs-comment">// ä½ç½®           // é¢œè‰²(R, G, B)</span><br>         <span class="hljs-number">0.0f</span>,  <span class="hljs-number">0.5f</span>, <span class="hljs-number">0.0f</span>,  <span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">1.0f</span>,  <span class="hljs-comment">// é¡¶ç‚¹1 è“è‰²</span><br>        <span class="hljs-number">-0.5f</span>, <span class="hljs-number">-0.5f</span>, <span class="hljs-number">0.0f</span>,  <span class="hljs-number">0.0f</span>, <span class="hljs-number">1.0f</span>, <span class="hljs-number">0.0f</span>,  <span class="hljs-comment">// é¡¶ç‚¹2 ç»¿è‰²</span><br>         <span class="hljs-number">0.5f</span>, <span class="hljs-number">-0.5f</span>, <span class="hljs-number">0.0f</span>,  <span class="hljs-number">1.0f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span>   <span class="hljs-comment">// é¡¶ç‚¹3 çº¢è‰²</span><br>    &#125;;<br><br>    <span class="hljs-comment">// 6. ç¼–å†™é¡¶ç‚¹ç€è‰²å™¨æºç </span><br>    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* vertexShaderSource = <span class="hljs-string">R&quot;glsl(</span><br><span class="hljs-string">        #version 330 core</span><br><span class="hljs-string">        layout (location = 0) in vec3 aPos;   // ä½ç½®å±æ€§</span><br><span class="hljs-string">        layout (location = 1) in vec3 aColor; // é¢œè‰²å±æ€§</span><br><span class="hljs-string"></span><br><span class="hljs-string">        out vec3 ourColor; // è¾“å‡ºç»™ç‰‡å…ƒç€è‰²å™¨çš„é¢œè‰²å˜é‡</span><br><span class="hljs-string"></span><br><span class="hljs-string">        void main()</span><br><span class="hljs-string">        &#123;</span><br><span class="hljs-string">            gl_Position = vec4(aPos, 1.0); // è®¾ç½®é¡¶ç‚¹ä½ç½®</span><br><span class="hljs-string">            ourColor = aColor;              // ä¼ é€’é¢œè‰²åˆ°ç‰‡å…ƒç€è‰²å™¨</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">    )glsl&quot;</span>;<br><br>    <span class="hljs-comment">// 7. ç¼–å†™ç‰‡å…ƒç€è‰²å™¨æºç </span><br>    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* fragmentShaderSource = <span class="hljs-string">R&quot;glsl(</span><br><span class="hljs-string">        #version 330 core</span><br><span class="hljs-string">        in vec3 ourColor;       // ä»é¡¶ç‚¹ç€è‰²å™¨ä¼ æ¥çš„é¢œè‰²</span><br><span class="hljs-string"></span><br><span class="hljs-string">        out vec4 FragColor;     // è¾“å‡ºé¢œè‰²</span><br><span class="hljs-string"></span><br><span class="hljs-string">        void main()</span><br><span class="hljs-string">        &#123;</span><br><span class="hljs-string">            FragColor = vec4(ourColor, 1.0); // è®¾ç½®ç‰‡å…ƒé¢œè‰²ï¼Œalphaä¸º1ï¼ˆä¸é€æ˜ï¼‰</span><br><span class="hljs-string">        &#125;</span><br><span class="hljs-string">    )glsl&quot;</span>;<br><br>    <span class="hljs-comment">// 8. ç¼–è¯‘é¡¶ç‚¹ç€è‰²å™¨</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> vertexShader = <span class="hljs-built_in">glCreateShader</span>(GL_VERTEX_SHADER);<br>    <span class="hljs-built_in">glShaderSource</span>(vertexShader, <span class="hljs-number">1</span>, &amp;vertexShaderSource, <span class="hljs-literal">NULL</span>);<br>    <span class="hljs-built_in">glCompileShader</span>(vertexShader);<br>    <span class="hljs-built_in">checkCompileErrors</span>(vertexShader, <span class="hljs-string">&quot;VERTEX&quot;</span>);<br><br>    <span class="hljs-comment">// 9. ç¼–è¯‘ç‰‡å…ƒç€è‰²å™¨</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> fragmentShader = <span class="hljs-built_in">glCreateShader</span>(GL_FRAGMENT_SHADER);<br>    <span class="hljs-built_in">glShaderSource</span>(fragmentShader, <span class="hljs-number">1</span>, &amp;fragmentShaderSource, <span class="hljs-literal">NULL</span>);<br>    <span class="hljs-built_in">glCompileShader</span>(fragmentShader);<br>    <span class="hljs-built_in">checkCompileErrors</span>(fragmentShader, <span class="hljs-string">&quot;FRAGMENT&quot;</span>);<br><br>    <span class="hljs-comment">// 10. é“¾æ¥ç€è‰²å™¨ç¨‹åº</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> shaderProgram = <span class="hljs-built_in">glCreateProgram</span>();<br>    <span class="hljs-built_in">glAttachShader</span>(shaderProgram, vertexShader);<br>    <span class="hljs-built_in">glAttachShader</span>(shaderProgram, fragmentShader);<br>    <span class="hljs-built_in">glLinkProgram</span>(shaderProgram);<br>    <span class="hljs-built_in">checkCompileErrors</span>(shaderProgram, <span class="hljs-string">&quot;PROGRAM&quot;</span>);<br><br>    <span class="hljs-comment">// 11. åˆ é™¤ç€è‰²å™¨å¯¹è±¡ï¼Œå·²ç»é“¾æ¥åˆ°ç¨‹åºé‡Œäº†</span><br>    <span class="hljs-built_in">glDeleteShader</span>(vertexShader);<br>    <span class="hljs-built_in">glDeleteShader</span>(fragmentShader);<br><br>    <span class="hljs-comment">// 12. åˆ›å»ºé¡¶ç‚¹ç¼“å†²å’Œé¡¶ç‚¹æ•°ç»„å¯¹è±¡</span><br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> VBO, VAO;<br>    <span class="hljs-built_in">glGenVertexArrays</span>(<span class="hljs-number">1</span>, &amp;VAO);<br>    <span class="hljs-built_in">glGenBuffers</span>(<span class="hljs-number">1</span>, &amp;VBO);<br><br>    <span class="hljs-comment">// ç»‘å®š VAO</span><br>    <span class="hljs-built_in">glBindVertexArray</span>(VAO);<br><br>    <span class="hljs-comment">// ç»‘å®šå¹¶å¡«å…… VBO</span><br>    <span class="hljs-built_in">glBindBuffer</span>(GL_ARRAY_BUFFER, VBO);<br>    <span class="hljs-built_in">glBufferData</span>(GL_ARRAY_BUFFER, <span class="hljs-built_in">sizeof</span>(vertices), vertices, GL_STATIC_DRAW);<br><br>    <span class="hljs-comment">// ä½ç½®å±æ€§</span><br>    <span class="hljs-built_in">glVertexAttribPointer</span>(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>, GL_FLOAT, GL_FALSE, <span class="hljs-number">6</span> * <span class="hljs-built_in">sizeof</span>(<span class="hljs-type">float</span>), (<span class="hljs-type">void</span>*)<span class="hljs-number">0</span>);<br>    <span class="hljs-built_in">glEnableVertexAttribArray</span>(<span class="hljs-number">0</span>);<br><br>    <span class="hljs-comment">// é¢œè‰²å±æ€§</span><br>    <span class="hljs-built_in">glVertexAttribPointer</span>(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, GL_FLOAT, GL_FALSE, <span class="hljs-number">6</span> * <span class="hljs-built_in">sizeof</span>(<span class="hljs-type">float</span>), (<span class="hljs-type">void</span>*)(<span class="hljs-number">3</span> * <span class="hljs-built_in">sizeof</span>(<span class="hljs-type">float</span>)));<br>    <span class="hljs-built_in">glEnableVertexAttribArray</span>(<span class="hljs-number">1</span>);<br><br>    <span class="hljs-comment">// è§£ç»‘</span><br>    <span class="hljs-built_in">glBindBuffer</span>(GL_ARRAY_BUFFER, <span class="hljs-number">0</span>);<br>    <span class="hljs-built_in">glBindVertexArray</span>(<span class="hljs-number">0</span>);<br><br>    <span class="hljs-comment">// 13. æ¸²æŸ“å¾ªç¯</span><br>    <span class="hljs-keyword">while</span> (!<span class="hljs-built_in">glfwWindowShouldClose</span>(window))<br>    &#123;<br>        <span class="hljs-comment">// å¤„ç†è¾“å…¥ï¼ˆè¿™é‡Œæ²¡å†™è¾“å…¥ï¼Œåç»­å¯ä»¥åŠ ï¼‰</span><br><br>        <span class="hljs-comment">// æ¸…å±ï¼Œè®¾ç½®èƒŒæ™¯é¢œè‰²</span><br>        <span class="hljs-built_in">glClearColor</span>(<span class="hljs-number">0.2f</span>, <span class="hljs-number">0.3f</span>, <span class="hljs-number">0.3f</span>, <span class="hljs-number">1.0f</span>);<br>        <span class="hljs-built_in">glClear</span>(GL_COLOR_BUFFER_BIT);<br><br>        <span class="hljs-comment">// ä½¿ç”¨ç€è‰²å™¨ç¨‹åº</span><br>        <span class="hljs-built_in">glUseProgram</span>(shaderProgram);<br><br>        <span class="hljs-comment">// ç»‘å®š VAO</span><br>        <span class="hljs-built_in">glBindVertexArray</span>(VAO);<br><br>        <span class="hljs-comment">// ç»˜åˆ¶ä¸‰è§’å½¢</span><br>        <span class="hljs-built_in">glDrawArrays</span>(GL_TRIANGLES, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>);<br><br>        <span class="hljs-comment">// äº¤æ¢ç¼“å†²åŒºå’Œè½®è¯¢äº‹ä»¶</span><br>        <span class="hljs-built_in">glfwSwapBuffers</span>(window);<br>        <span class="hljs-built_in">glfwPollEvents</span>();<br>    &#125;<br><br>    <span class="hljs-comment">// 14. é‡Šæ”¾èµ„æº</span><br>    <span class="hljs-built_in">glDeleteVertexArrays</span>(<span class="hljs-number">1</span>, &amp;VAO);<br>    <span class="hljs-built_in">glDeleteBuffers</span>(<span class="hljs-number">1</span>, &amp;VBO);<br>    <span class="hljs-built_in">glDeleteProgram</span>(shaderProgram);<br><br>    <span class="hljs-comment">// 15. é€€å‡º GLFW</span><br>    <span class="hljs-built_in">glfwTerminate</span>();<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/pictures/OpenGL/image-20250625101600766.png" alt="image-20250625101600766"></p><h3 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h3><ul><li>æ·»åŠ æ›´å¤šé¡¶ç‚¹åˆ°æ•°æ®ä¸­ï¼Œä½¿ç”¨glDrawArraysï¼Œå°è¯•ç»˜åˆ¶ä¸¤ä¸ªå½¼æ­¤ç›¸è¿çš„ä¸‰è§’å½¢ã€‚</li></ul><p>â€‹ç›¸è¾ƒäºä¸Šé¢çš„ä»£ç ï¼Œåªéœ€ä¿®æ”¹ä¸¤å¤„å³å¯ï¼šæ·»åŠ é¡¶ç‚¹ï¼ˆåæ ‡å’Œé¢œè‰²å±æ€§ï¼‰ã€ç»˜åˆ¶6ä¸ªé¡¶ç‚¹ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-type">float</span> vertices[] = &#123;<br>-<span class="hljs-number">0.9f</span>, -<span class="hljs-number">0.5f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">1.0f</span>,<br>-<span class="hljs-number">0.0f</span>, -<span class="hljs-number">0.5f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">1.0f</span>, <span class="hljs-number">0.0f</span>,<br>-<span class="hljs-number">0.45f</span>, <span class="hljs-number">0.5f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">1.0f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span>,<br> <span class="hljs-number">0.0f</span>, -<span class="hljs-number">0.5f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">1.0f</span>, <br> <span class="hljs-number">0.9f</span>, -<span class="hljs-number">0.5f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">1.0f</span>, <span class="hljs-number">0.0f</span>,<br> <span class="hljs-number">0.45f</span>, <span class="hljs-number">0.5f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">1.0f</span>, <span class="hljs-number">0.0f</span>, <span class="hljs-number">0.0f</span><br>&#125;;<br><br>glDrawArrays(GL_TRIANGLES, <span class="hljs-number">0</span>, <span class="hljs-number">6</span>);<span class="hljs-comment">//ç”¨é¡¶ç‚¹æ•°ç»„ä»ç¬¬ 0 ä¸ªé¡¶ç‚¹å¼€å§‹ï¼ŒæŒ‰ä¸‰è§’å½¢æ–¹å¼ï¼Œç»˜åˆ¶ 6ä¸ªé¡¶ç‚¹ç»„æˆçš„ä¸¤ä¸ªä¸‰è§’å½¢ã€‚</span><br></code></pre></td></tr></table></figure><p><img src="/pictures/OpenGL/image-20250626135154793.png" alt="image-20250626135154793"></p><ul><li>åˆ›å»ºç›¸åŒçš„ä¸¤ä¸ªä¸‰è§’å½¢ï¼Œä½†å¯¹å®ƒä»¬çš„æ•°æ®ä½¿ç”¨ä¸åŒçš„VAOå’ŒVBOã€‚</li></ul><p>â€‹å…¶ä»–éƒ¨åˆ†ä¸å˜ï¼Œæ”¹åŠ¨å¦‚ä¸‹ï¼šåˆ›å»ºæ—¶ä½¿ç”¨æ•°ç»„å­˜å‚¨å¤šä¸ªVAOå’ŒVBOã€ä¸¤ä¸ªä¸‰è§’å½¢é¡¶ç‚¹æ•°æ®åˆ†ä¸ºä¸åŒæ•°ç»„å­˜å‚¨ã€åˆ†å¼€ç»‘å®šå¹¶ä¸”ä¼ è¾“æ•°æ®è§£ææ•°æ®ã€åˆ†å¼€ç»˜åˆ¶ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">unsigned <span class="hljs-type">int</span> VBOs[<span class="hljs-number">2</span>], VAOs[<span class="hljs-number">2</span>];<br>glGenVertexArrays(<span class="hljs-number">2</span>, VAOs); <span class="hljs-comment">// we can also generate multiple VAOs or buffers at the same time</span><br>glGenBuffers(<span class="hljs-number">2</span>, VBOs);<br><br><span class="hljs-type">float</span> firstTriangle[] = &#123;<br>    -<span class="hljs-number">0.9f</span>, -<span class="hljs-number">0.5f</span>, <span class="hljs-number">0.0f</span>,  <span class="hljs-comment">// left </span><br>    -<span class="hljs-number">0.0f</span>, -<span class="hljs-number">0.5f</span>, <span class="hljs-number">0.0f</span>,  <span class="hljs-comment">// right</span><br>    -<span class="hljs-number">0.45f</span>, <span class="hljs-number">0.5f</span>, <span class="hljs-number">0.0f</span>,  <span class="hljs-comment">// top </span><br>&#125;;<br><span class="hljs-type">float</span> secondTriangle[] = &#123;<br>     <span class="hljs-number">0.0f</span>, -<span class="hljs-number">0.5f</span>, <span class="hljs-number">0.0f</span>,  <span class="hljs-comment">// left</span><br>     <span class="hljs-number">0.9f</span>, -<span class="hljs-number">0.5f</span>, <span class="hljs-number">0.0f</span>,  <span class="hljs-comment">// right</span><br>     <span class="hljs-number">0.45f</span>, <span class="hljs-number">0.5f</span>, <span class="hljs-number">0.0f</span>   <span class="hljs-comment">// top </span><br>&#125;;<br><br>glBindVertexArray(VAOs[<span class="hljs-number">0</span>]);<br>glBindBuffer(GL_ARRAY_BUFFER, VBOs[<span class="hljs-number">0</span>]);<br>glBufferData(GL_ARRAY_BUFFER, sizeof(firstTriangle), firstTriangle, GL_STATIC_DRAW);<br>glVertexAttribPointer(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>, GL_FLOAT, GL_FALSE, <span class="hljs-number">3</span> * sizeof(<span class="hljs-type">float</span>), (<span class="hljs-keyword">void</span>*)<span class="hljs-number">0</span>);<span class="hljs-comment">// Vertex attributes stay the same</span><br>glEnableVertexAttribArray(<span class="hljs-number">0</span>);<br><br>glBindVertexArray(VAOs[<span class="hljs-number">1</span>]);<span class="hljs-comment">// ç»‘å®šæ–°çš„VAO</span><br>glBindBuffer(GL_ARRAY_BUFFER, VBOs[<span class="hljs-number">1</span>]);<span class="hljs-comment">//ç»‘å®šæ–°çš„VBO</span><br>glBufferData(GL_ARRAY_BUFFER, sizeof(secondTriangle), secondTriangle, GL_STATIC_DRAW); <span class="hljs-comment">//ä¼ è¾“æ•°æ®åˆ°VBOä»£è¡¨çš„ç¼“å†²åŒº</span><br>glVertexAttribPointer(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>, GL_FLOAT, GL_FALSE, <span class="hljs-number">0</span>, (<span class="hljs-keyword">void</span>*)<span class="hljs-number">0</span>); <span class="hljs-comment">//æŒ‡å®šè¯»å–æ–¹å¼</span><br>glEnableVertexAttribArray(<span class="hljs-number">0</span>);<span class="hljs-comment">//å¯ç”¨é¡¶ç‚¹å±æ€§</span><br><br>glBindVertexArray(VAOs[<span class="hljs-number">0</span>]);<br>glDrawArrays(GL_TRIANGLES, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>);<br>        <span class="hljs-comment">// then we draw the second triangle using the data from the second VAO</span><br>glBindVertexArray(VAOs[<span class="hljs-number">1</span>]);<br>glDrawArrays(GL_TRIANGLES, <span class="hljs-number">0</span>, <span class="hljs-number">3</span>);<br></code></pre></td></tr></table></figure><p>â€‹<strong>glVertexAttribPointer</strong>å‡½æ•°çš„å‚æ•°è›®å¤šï¼Œå»ºè®®è¾¹çœ‹LearnOpenGLé¡¹ç›®ã€‚</p><ul><li>åˆ›å»ºä¸¤ä¸ªç€è‰²å™¨ç¨‹åºï¼Œç¬¬äºŒä¸ªç¨‹åºä½¿ç”¨ä¸€ä¸ªä¸åŒçš„ç‰‡æ®µç€è‰²å™¨ï¼Œè¾“å‡ºé»„è‰²ï¼›å†æ¬¡ç»˜åˆ¶è¿™ä¸¤ä¸ªä¸‰è§’å½¢ï¼Œè®©å…¶ä¸­ä¸€ä¸ªè¾“å‡ºä¸ºé»„è‰²ã€‚</li></ul><p>â€‹</p><p>â€‹åœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šï¼Œåˆ›å»ºä¸¤ä¸ª<strong>shaderProgram</strong>ã€<strong>fragmentshader</strong>ï¼Œç„¶åç¼–è¯‘å¥½ä¸‰ä¸ªç€è‰²å™¨ï¼ˆåŒ…æ‹¬ä¸€ä¸ªå…±ç”¨çš„é¡¶ç‚¹ç€è‰²å™¨ï¼‰ï¼Œä¹‹ååˆ†ç»„é“¾æ¥åˆ°<strong>shaderProgram</strong>ä¸­ï¼Œæœ€å<strong>while</strong>å¾ªç¯ä¸­ï¼Œåˆ†åˆ«ä½¿ç”¨<strong>glUseProgram</strong>å‡½æ•°æŒ‡å®šæ¸²æŸ“ç¨‹åºè¿›è¡Œç»˜ç”»ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ç¯å¢ƒæ­å»º&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒæ­å»º&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒæ­å»º&quot;&gt;&lt;/a&gt;ç¯å¢ƒæ­å»º&lt;/h3&gt;&lt;p&gt;â€‹	å­¦ä¹ OpenGLçš„æ ¸å¿ƒæ¨¡å¼ï¼Œ&lt;a href=&quot;https://blog.csdn.net/ssunshining/art</summary>
      
    
    
    
    <category term="å¼€å‘" scheme="http://bumak.github.io/categories/%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="OpenGL" scheme="http://bumak.github.io/tags/OpenGL/"/>
    
  </entry>
  
  <entry>
    <title>é˜…è¯»APPé¡¹ç›®å­¦ä¹ â€”â€”4</title>
    <link href="http://bumak.github.io/2025/06/24/%E9%98%85%E8%AF%BB%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0/%E5%AE%89%E5%8D%93%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A04/"/>
    <id>http://bumak.github.io/2025/06/24/%E9%98%85%E8%AF%BB%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0/%E5%AE%89%E5%8D%93%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A04/</id>
    <published>2025-06-24T01:35:00.000Z</published>
    <updated>2025-06-24T02:58:44.647Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h3><p>â€‹</p><p>â€‹<strong>BaseFragment</strong>æŠ½è±¡ç±»ï¼Œæ˜¯ä¸€ä¸ªåŸºç¡€çš„Fragmentç±»å®ç°ï¼Œç»§æ‰¿è‡ª <code>RxFragment</code>ï¼ˆè¿™æ˜¯ä¸€ä¸ªæ”¯æŒ RxJava ç”Ÿå‘½å‘¨æœŸç®¡ç†çš„ Fragmentï¼‰ï¼Œç”±äºè¯¥çˆ¶ç±»å®ç°äº†IViewçš„æ–¹æ³•ï¼Œæ‰€ä»¥å¯ä»¥ä¸å†å®ç°ã€‚</p><p>â€‹<strong>BaseFragment<T extends IPresenter></strong>ï¼šè¿™æ˜¯ä¸€ä¸ªæ³›å‹ç±»ï¼Œæ³›å‹å‚æ•° <code>T</code> å¿…é¡»æ˜¯ <strong>IPresenter</strong> æ¥å£çš„å­ç±»ã€‚è¯´æ˜è¿™ä¸ª Fragment ä¼šå’ŒæŸä¸ª Presenter å…³è”ï¼Œç¬¦åˆ MVP æ¶æ„è®¾è®¡æ¨¡å¼ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">protected</span> View view;<span class="hljs-comment">//ä¿å­˜å½“å‰Fragmentçš„æ ¹å¸ƒå±€è§†å›¾</span><br><span class="hljs-keyword">protected</span> Bundle savedInstanceState;<span class="hljs-comment">//ä¿å­˜ Fragment çŠ¶æ€æ•°æ®</span><br><span class="hljs-meta">@Nullable</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> View <span class="hljs-title function_">onCreateView</span><span class="hljs-params">(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)</span> &#123;<br><span class="hljs-built_in">this</span>.savedInstanceState = savedInstanceState;<br>initSDK();<br>view = createView(inflater, container);<br>initData();<br>bindView();<br>bindEvent();<br>firstRequest();<br><span class="hljs-keyword">return</span> view;<br>&#125;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * äº‹ä»¶è§¦å‘ç»‘å®š</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">bindEvent</span><span class="hljs-params">()</span> &#123;<br><br>    &#125;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ§ä»¶ç»‘å®š</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">bindView</span><span class="hljs-params">()</span> &#123;<br><br>    &#125;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ•°æ®åˆå§‹åŒ–</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initData</span><span class="hljs-params">()</span> &#123;<br><br>    &#125;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é¦–æ¬¡é€»è¾‘æ“ä½œ</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">firstRequest</span><span class="hljs-params">()</span> &#123;<br><br>    &#125;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åŠ è½½å¸ƒå±€</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> View <span class="hljs-title function_">createView</span><span class="hljs-params">(LayoutInflater inflater, ViewGroup container)</span>;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * ç¬¬ä¸‰æ–¹SDKåˆå§‹åŒ–</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">initSDK</span><span class="hljs-params">()</span> &#123;<br><br>    &#125;<br></code></pre></td></tr></table></figure><p>â€‹<code>onCreateView</code> æ˜¯ Fragment åˆ›å»ºè§†å›¾æ—¶è°ƒç”¨çš„å›è°ƒæ–¹æ³•ï¼ˆç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼‰ï¼Œå®ƒè´Ÿè´£åŠ è½½å¹¶è¿”å› Fragment çš„å¸ƒå±€è§†å›¾ã€‚</p><p>â€‹<strong>BaseModelImpl</strong>ç±»ç”¨æ¥åˆ›å»ºç½‘ç»œè¯·æ±‚å®¢æˆ·ç«¯çš„åŸºç¡€æ¨¡å‹ç±»ï¼Œå®ƒä¸»è¦è´Ÿè´£é…ç½®å¹¶ç”Ÿæˆ Retrofit å®ä¾‹ï¼Œæ–¹ä¾¿å…¶ä»–æ¨¡å—è°ƒç”¨ç½‘ç»œæ¥å£ã€‚ä½¿ç”¨OkHttpçš„<strong>OkHttpClient.Builder</strong>æ¥åˆ›å»ºå®¢æˆ·ç«¯ï¼Œè®¾ç½®äº†è¿æ¥è¶…æ—¶ã€å†™è¶…æ—¶ã€è¯»è¶…æ—¶ï¼Œå’Œä¸€ä¸ªè‡ªå®šä¹‰çš„ç½‘ç»œæ‹¦æˆªå™¨ï¼Œç”¨äºè¯·æ±‚å¤±è´¥åçš„é‡è¯•é€»è¾‘ã€‚</p><p>â€‹<strong>getRetrofitObject</strong>æ–¹æ³•ç”¨æ¥åˆ›å»ºä¸€ä¸ªRetrofitå®ä¾‹ï¼Œä¼ å…¥åŸºç¡€çš„URLã€‚</p><p>â€‹<strong>getRetrofitString</strong>å’Œä¸Šé¢çš„æ–¹æ³•ç±»ä¼¼ï¼Œç”¨æ¥å¤„ç†ä¸åŒç¼–ç ï¼ˆ<code>encode</code>ï¼‰çš„å­—ç¬¦ä¸²è½¬æ¢ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BaseModelImpl</span> &#123;<br><br>    <span class="hljs-keyword">protected</span> OkHttpClient.<span class="hljs-type">Builder</span> <span class="hljs-variable">clientBuilder</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">OkHttpClient</span>.Builder()<br>            .connectTimeout(<span class="hljs-number">10</span>, TimeUnit.SECONDS)<br>            .writeTimeout(<span class="hljs-number">10</span>, TimeUnit.SECONDS)<br>            .readTimeout(<span class="hljs-number">10</span>, TimeUnit.SECONDS)<br>            .addNetworkInterceptor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RetryIntercepter</span>(<span class="hljs-number">1</span>));<br><br>    <span class="hljs-keyword">protected</span> Retrofit <span class="hljs-title function_">getRetrofitObject</span><span class="hljs-params">(String url)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Retrofit</span>.Builder().baseUrl(url)<br>                <span class="hljs-comment">//å¢åŠ è¿”å›å€¼ä¸ºå­—ç¬¦ä¸²çš„æ”¯æŒ(ä»¥å®ä½“ç±»è¿”å›)</span><br>                .addConverterFactory(ScalarsConverterFactory.create())<br>                <span class="hljs-comment">//å¢åŠ è¿”å›å€¼ä¸ºOservable&lt;T&gt;çš„æ”¯æŒ</span><br>                .addCallAdapterFactory(RxJava2CallAdapterFactory.create())<br>                .client(clientBuilder.build())<br>                .build();<br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> Retrofit <span class="hljs-title function_">getRetrofitString</span><span class="hljs-params">(String url, String encode)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Retrofit</span>.Builder().baseUrl(url)<br>                <span class="hljs-comment">//å¢åŠ è¿”å›å€¼ä¸ºå­—ç¬¦ä¸²çš„æ”¯æŒ(ä»¥å®ä½“ç±»è¿”å›)</span><br>                .addConverterFactory(EncodoConverter.create(encode))<br>                <span class="hljs-comment">//å¢åŠ è¿”å›å€¼ä¸ºOservable&lt;T&gt;çš„æ”¯æŒ</span><br>                .addCallAdapterFactory(RxJava2CallAdapterFactory.create())<br>                .client(clientBuilder.build())<br>                .build();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><blockquote><ol><li>Retrofit æ˜¯ä»€ä¹ˆï¼Ÿ</li></ol><ul><li>Retrofit æ˜¯ç”± Square å…¬å¸å¼€å‘çš„ä¸€ä¸ª <strong>Android å’Œ Java</strong> å¹³å°ä¸Šçš„ç½‘ç»œè¯·æ±‚åº“ã€‚</li><li>å®ƒå¸®åŠ©ä½ å¾ˆæ–¹ä¾¿åœ°è°ƒç”¨ç½‘ç»œä¸Šçš„ <strong>HTTP æ¥å£</strong>ï¼ˆAPIï¼‰ï¼Œä»æœåŠ¡å™¨æ‹¿æ•°æ®ã€‚</li><li>å®ƒå¸®ä½ æŠŠç½‘ç»œè¯·æ±‚å’Œå“åº”å˜å¾—â€œåƒè°ƒç”¨æœ¬åœ°æ–¹æ³•â€ä¸€æ ·ç®€å•ã€‚</li></ul></blockquote><p>â€‹<strong>BasePresenterImpl</strong>æŠ½è±¡ç±»å®ç°äº†attachViewåŠŸèƒ½ï¼Œå¹¶ä¸”é€šè¿‡æ¨¡æ¿Tæ¥è¿›è¡Œç±»å‹è½¬æ¢ï¼Œæ˜¯ä¸€ä¸ªPresenteråŸºç±»ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BasePresenterImpl</span>&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">IView</span>&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IPresenter</span>&#123;<br>    <span class="hljs-keyword">protected</span> T mView;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attachView</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> IView iView)</span> &#123;<br>        mView = (T) iView;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹<strong>RetryIntercepter</strong>ç±»æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ <strong>OkHttp æ‹¦æˆªå™¨</strong>ï¼Œå…¶ä¸­<code>Request</code> ä»£è¡¨è¿™æ¬¡ç½‘ç»œè¯·æ±‚çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚è¯·æ±‚çš„åœ°å€ã€è¯·æ±‚æ–¹æ³•ï¼ˆGETã€POSTï¼‰ã€è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ç­‰ç­‰ã€‚</p><blockquote><h2 id="ä¸ºä»€ä¹ˆè¦è¿™æ ·å†™ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆè¦è¿™æ ·å†™ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦è¿™æ ·å†™ï¼Ÿ"></a>ä¸ºä»€ä¹ˆè¦è¿™æ ·å†™ï¼Ÿ</h2><p>æ‹¦æˆªå™¨å°±æ˜¯â€œè¯·æ±‚å’Œå“åº”ä¹‹é—´çš„ä¸­é—´äººâ€ï¼Œå®ƒèƒ½ï¼š</p><ul><li><strong>æ‹¿åˆ°è¯·æ±‚</strong>ï¼ˆ<code>chain.request()</code>ï¼‰</li><li><strong>å¯¹è¯·æ±‚åšç‚¹äº‹</strong>ï¼ˆæ¯”å¦‚åŠ ä¸ªå¤´ï¼Œæ”¹æ”¹å‚æ•°ï¼Œæˆ–è€…æ‰“å°æ—¥å¿—ï¼‰</li><li><strong>å‘å‡ºè¯·æ±‚</strong>ï¼ˆ<code>chain.proceed(request)</code>ï¼‰</li><li><strong>æ‹¿åˆ°å“åº”</strong>ï¼Œè¿˜å¯ä»¥å¯¹å“åº”åšç‚¹äº‹ï¼ˆæ¯”å¦‚åˆ¤æ–­å¤±è´¥é‡è¯•ï¼‰</li></ul></blockquote><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RetryIntercepter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Interceptor</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> maxRetry;<span class="hljs-comment">//æœ€å¤§é‡è¯•æ¬¡æ•°</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> <span class="hljs-variable">retryNum</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<span class="hljs-comment">//å‡å¦‚è®¾ç½®ä¸º3æ¬¡é‡è¯•çš„è¯ï¼Œåˆ™æœ€å¤§å¯èƒ½è¯·æ±‚4æ¬¡ï¼ˆé»˜è®¤1æ¬¡+3æ¬¡é‡è¯•ï¼‰</span><br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">RetryIntercepter</span><span class="hljs-params">(<span class="hljs-type">int</span> maxRetry)</span> &#123;<br>        <span class="hljs-built_in">this</span>.maxRetry = maxRetry;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Response <span class="hljs-title function_">intercept</span><span class="hljs-params">(Chain chain)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">Request</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> chain.request();<br>        <span class="hljs-type">Response</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> chain.proceed(request);<br>        <span class="hljs-keyword">while</span> (!response.isSuccessful() &amp;&amp; retryNum &lt; maxRetry) &#123;<br>            retryNum++;<br>            response = chain.proceed(request);<br>        &#125;<br>        <span class="hljs-keyword">return</span> response;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹basemvplibåˆ†æå®Œäº†ï¼Œä¸‹ä¸€æ­¥è¦åˆ†æmonkyåŒ…ã€‚å…ˆå¤§ä½“é€šè¿‡AIé¢„æµ‹ä¸€æ³¢å„ä¸ªæ–‡ä»¶å¤¹çš„å«ä¹‰å’Œå…¶ä¸­ç±»çš„ä½œç”¨ã€‚</p><blockquote><p>â€‹<strong>base</strong>æ–‡ä»¶å¤¹é¡¹ç›®æ˜¯åŸºç¡€ä»£ç ï¼Œæ¯”å¦‚åŸºç±»ï¼ˆBaseActivityã€BaseFragmentã€BasePresenterç­‰ï¼‰ï¼Œå…¬å…±æŠ½è±¡å±‚ï¼Œç”¨æ¥å¤ç”¨å’Œç»Ÿä¸€è§„èŒƒã€‚</p><p>â€‹<strong>bean</strong>æ–‡ä»¶å¤¹å­˜æ”¾æ•°æ®æ¨¡å‹ç±»ï¼ˆå®ä½“ç±»ï¼‰ï¼Œç”¨æ¥è¡¨ç¤ºä¸šåŠ¡æ•°æ®ï¼Œæ¯”å¦‚ä¹¦ç±ä¿¡æ¯ã€ç”¨æˆ·ä¿¡æ¯ç­‰ã€‚é€šå¸¸å’Œæ•°æ®åº“è¡¨ç»“æ„æˆ–è€…æ¥å£è¿”å›æ•°æ®å¯¹åº”ã€‚</p><p>â€‹<strong>cache</strong>ç¼“å­˜ç›¸å…³çš„ä»£ç ï¼Œè´Ÿè´£æ•°æ®ç¼“å­˜é€»è¾‘ã€‚</p><p>â€‹<strong>common</strong>é…ç½®çš„æ˜¯è®¿é—®å°è¯´ç½‘ç«™çš„APIæ¥å£ã€‚</p><p>â€‹<strong>dao</strong>æ˜¯ Data Access Objectï¼ˆæ•°æ®è®¿é—®å¯¹è±¡ï¼‰ çš„ç¼©å†™ï¼Œæ•°æ®è®¿é—®å±‚ï¼Œå°è£…æ•°æ®åº“æ“ä½œï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰ï¼Œé€šå¸¸å¯¹åº”å®ä½“beanï¼Œæœ‰ä¸“é—¨çš„æ¥å£æˆ–ç±»å¤„ç†æ•°æ®å­˜å–ã€‚</p><p>â€‹<strong>listener</strong>å®šä¹‰è·å–ç« èŠ‚åˆ—è¡¨çš„å›è°ƒé€šçŸ¥ã€‚</p><p>â€‹<strong>model</strong>ä¸šåŠ¡é€»è¾‘å±‚ï¼Œå¤„ç†å…·ä½“çš„æ•°æ®æ“ä½œå’Œä¸šåŠ¡è§„åˆ™ã€‚</p><p>â€‹<strong>presenter</strong>è¿™é‡Œæ˜¯ Presenter å±‚ï¼Œè´Ÿè´£è¿æ¥ View å’Œ Modelï¼Œå®ç°ä¸šåŠ¡é€»è¾‘ï¼Œå¤„ç†ç•Œé¢å’Œæ•°æ®çš„äº¤äº’ã€‚</p><p>â€‹<strong>service</strong>ä¸€èˆ¬æ”¾åå°æœåŠ¡ç›¸å…³ä»£ç ï¼Œæ¯”å¦‚ Android çš„ Service ç±»ï¼ŒåšæŒç»­åå°ä»»åŠ¡ï¼Œæˆ–è€…å°è£…ç½‘ç»œè¯·æ±‚ã€ç³»ç»ŸæœåŠ¡æ“ä½œç­‰ã€‚</p><p>â€‹<strong>utils</strong>å·¥å…·ç±»åŒ…ï¼Œå­˜æ”¾å„ç§è¾…åŠ©ç±»å’Œé™æ€æ–¹æ³•ã€‚</p><p>â€‹<strong>view</strong>è‡ªå®šä¹‰çš„è§†å›¾ç±»ï¼Œæˆ–è€…è·Ÿç•Œé¢ç›¸å…³çš„ç±»ï¼ˆä¸åŒ…æ‹¬ç‰¹æ®Šæ§ä»¶ï¼‰ï¼Œä¸€èˆ¬ç”¨æ¥å°è£…ç•Œé¢é€»è¾‘æˆ–å¤ç”¨ç•Œé¢ç»„ä»¶ã€‚</p><p>â€‹<strong>widget</strong>è‡ªå®šä¹‰æ§ä»¶æˆ–è€… UI ç»„ä»¶ï¼Œæ¯”å¦‚è‡ªå®šä¹‰æŒ‰é’®ã€åˆ—è¡¨ã€åŠ¨ç”»æ§ä»¶ç­‰ï¼Œæ‰©å±•ç³»ç»Ÿæ§ä»¶åŠŸèƒ½ã€‚</p></blockquote><p>â€‹<strong>BitIntentDataManager</strong>ç®¡ç† Intent ä¼ é€’çš„æ•°æ®ï¼Œå°è£… Intent æ•°æ®å¤„ç†é€»è¾‘ï¼Œæ–¹ä¾¿ Activity&#x2F;Fragment ä¹‹é—´ä¼ å‚ã€‚</p><p>â€‹<strong>ErrorAnalyContentManager</strong>é”™è¯¯å†…å®¹åˆ†æç®¡ç†å™¨ï¼Œå¯èƒ½æ˜¯æ—¥å¿—æ”¶é›†ã€é”™è¯¯ä¿¡æ¯å¤„ç†æˆ–è€…é”™è¯¯æŠ¥å‘Šç”Ÿæˆç›¸å…³çš„ç±»ã€‚</p><p>â€‹<strong>MApplication</strong>è‡ªå®šä¹‰çš„ Application ç±»ï¼Œåº”ç”¨å…¥å£ï¼Œåˆå§‹åŒ–å…¨å±€å˜é‡ã€SDKã€å•ä¾‹ç­‰ã€‚</p><p>â€‹<strong>ProxyManager</strong>ä»£ç†ç®¡ç†å™¨ï¼Œå¯èƒ½ç”¨æ¥å®ç°æŸç§ä»£ç†æ¨¡å¼ï¼ŒåŠ¨æ€ä»£ç†å¯¹è±¡ï¼Œæˆ–è€…è´Ÿè´£ç½‘ç»œä»£ç†ã€è¯·æ±‚ä»£ç†ç­‰åŠŸèƒ½ã€‚</p><p>â€‹<strong>ReadBookControl</strong>è¯»ä¹¦æ§åˆ¶å™¨ï¼Œè´Ÿè´£ä¹¦ç±é˜…è¯»ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘ï¼Œæ¯”å¦‚ç¿»é¡µã€å­—ä½“å¤§å°ã€é˜…è¯»è¿›åº¦ç®¡ç†ç­‰ã€‚</p><p>â€‹æ”¹å¤©å†ç³»ç»Ÿåˆ†æå§ï¼Œä¸‹é¢åœ¨AIé—®åˆ°äº†ä¸€å¥—æ¯”è¾ƒç³»ç»Ÿçš„åˆ†ææµç¨‹ã€‚</p><blockquote><h2 id="ğŸ§­-ä¸€å¥—ç³»ç»Ÿçš„-MVP-é¡¹ç›®åˆ†ææµç¨‹ï¼ˆä»-UI-åˆ°æ•°æ®ï¼‰"><a href="#ğŸ§­-ä¸€å¥—ç³»ç»Ÿçš„-MVP-é¡¹ç›®åˆ†ææµç¨‹ï¼ˆä»-UI-åˆ°æ•°æ®ï¼‰" class="headerlink" title="ğŸ§­ ä¸€å¥—ç³»ç»Ÿçš„ MVP é¡¹ç›®åˆ†ææµç¨‹ï¼ˆä» UI åˆ°æ•°æ®ï¼‰"></a>ğŸ§­ ä¸€å¥—ç³»ç»Ÿçš„ MVP é¡¹ç›®åˆ†ææµç¨‹ï¼ˆä» UI åˆ°æ•°æ®ï¼‰</h2><hr><h3 id="âœ…-ç¬¬ä¸€é˜¶æ®µï¼šææ¸…æ¥šç»“æ„å’Œé¡µé¢å…¥å£"><a href="#âœ…-ç¬¬ä¸€é˜¶æ®µï¼šææ¸…æ¥šç»“æ„å’Œé¡µé¢å…¥å£" class="headerlink" title="âœ… ç¬¬ä¸€é˜¶æ®µï¼šææ¸…æ¥šç»“æ„å’Œé¡µé¢å…¥å£"></a>âœ… <strong>ç¬¬ä¸€é˜¶æ®µï¼šææ¸…æ¥šç»“æ„å’Œé¡µé¢å…¥å£</strong></h3><h4 id="æ­¥éª¤-1ï¼šæ‰“å¼€é¡¹ç›®ï¼Œçœ‹-åŒ…ç»“æ„"><a href="#æ­¥éª¤-1ï¼šæ‰“å¼€é¡¹ç›®ï¼Œçœ‹-åŒ…ç»“æ„" class="headerlink" title="æ­¥éª¤ 1ï¼šæ‰“å¼€é¡¹ç›®ï¼Œçœ‹ åŒ…ç»“æ„"></a>æ­¥éª¤ 1ï¼šæ‰“å¼€é¡¹ç›®ï¼Œçœ‹ <code>åŒ…ç»“æ„</code></h4><ul><li>çœ‹åŒ…åä¸‹æœ‰å“ªäº›æ¨¡å—ï¼ˆä½ å‰é¢æåˆ°çš„ <code>view/</code>, <code>presenter/</code>, <code>model/</code>, <code>dao/</code> ç­‰ç­‰ï¼‰ã€‚</li><li>äº†è§£é¡¹ç›®æ˜¯ä¸æ˜¯ä½¿ç”¨äº† MVP&#x2F;MVVM æ¶æ„ï¼ˆä» <code>presenter/</code> å’Œ <code>model/</code> ç›®å½•å¯ä»¥çœ‹å‡ºï¼‰ã€‚</li></ul><h4 id="æ­¥éª¤-2ï¼šæ‰¾â€œé¦–é¡µ-Activityâ€æˆ–ä¸»å…¥å£é¡µé¢"><a href="#æ­¥éª¤-2ï¼šæ‰¾â€œé¦–é¡µ-Activityâ€æˆ–ä¸»å…¥å£é¡µé¢" class="headerlink" title="æ­¥éª¤ 2ï¼šæ‰¾â€œé¦–é¡µ Activityâ€æˆ–ä¸»å…¥å£é¡µé¢"></a>æ­¥éª¤ 2ï¼šæ‰¾â€œé¦–é¡µ Activityâ€æˆ–ä¸»å…¥å£é¡µé¢</h4><ul><li>æ‰¾ <code>MainActivity</code>, <code>LauncherActivity</code>, <code>SplashActivity</code> ç­‰ã€‚</li><li>å®ƒä¸€èˆ¬ä¼šæ˜¯ä½ å¯åŠ¨ App åçœ‹åˆ°çš„ç¬¬ä¸€ä¸ªé¡µé¢ã€‚</li></ul><hr><h3 id="âœ…-ç¬¬äºŒé˜¶æ®µï¼šä»-View-å±‚å…¥æ‰‹åˆ†æä¸€ä¸ªé¡µé¢"><a href="#âœ…-ç¬¬äºŒé˜¶æ®µï¼šä»-View-å±‚å…¥æ‰‹åˆ†æä¸€ä¸ªé¡µé¢" class="headerlink" title="âœ… ç¬¬äºŒé˜¶æ®µï¼šä» View å±‚å…¥æ‰‹åˆ†æä¸€ä¸ªé¡µé¢"></a>âœ… <strong>ç¬¬äºŒé˜¶æ®µï¼šä» View å±‚å…¥æ‰‹åˆ†æä¸€ä¸ªé¡µé¢</strong></h3><h4 id="æ­¥éª¤-3ï¼šä»-Activity-æˆ–-Fragment-å¼€å§‹çœ‹"><a href="#æ­¥éª¤-3ï¼šä»-Activity-æˆ–-Fragment-å¼€å§‹çœ‹" class="headerlink" title="æ­¥éª¤ 3ï¼šä» Activity æˆ– Fragment å¼€å§‹çœ‹"></a>æ­¥éª¤ 3ï¼šä» <code>Activity</code> æˆ– <code>Fragment</code> å¼€å§‹çœ‹</h4><ul><li><p>å…³æ³¨ <code>onCreate()</code> æˆ– <code>onCreateView()</code> æ–¹æ³•ã€‚</p></li><li><p>çœ‹å®ƒç»‘å®šäº†å“ªä¸ª Presenterï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">presenter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReadBookPresenter</span>();<br>presenter.attachView(<span class="hljs-built_in">this</span>);<br></code></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹å“ªäº›ç”¨æˆ·æ“ä½œï¼ˆæŒ‰é’®ç‚¹å‡»ã€æ»‘åŠ¨ç­‰ï¼‰è§¦å‘äº†å“ªäº›é€»è¾‘ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">button.setOnClickListener(v -&gt; presenter.doSomething());<br></code></pre></td></tr></table></figure></li></ul><h4 id="æ­¥éª¤-4ï¼šæŸ¥æ‰¾ç»‘å®šçš„-View-å’Œè‡ªå®šä¹‰æ§ä»¶"><a href="#æ­¥éª¤-4ï¼šæŸ¥æ‰¾ç»‘å®šçš„-View-å’Œè‡ªå®šä¹‰æ§ä»¶" class="headerlink" title="æ­¥éª¤ 4ï¼šæŸ¥æ‰¾ç»‘å®šçš„ View å’Œè‡ªå®šä¹‰æ§ä»¶"></a>æ­¥éª¤ 4ï¼šæŸ¥æ‰¾ç»‘å®šçš„ View å’Œè‡ªå®šä¹‰æ§ä»¶</h4><ul><li>æŸ¥çœ‹ XML å¸ƒå±€æ–‡ä»¶å’Œ <code>findViewById()</code> ç»‘å®šäº†å“ªäº›æ§ä»¶ã€‚</li><li>å¦‚æœå‘ç°æœ‰ <code>PageWidget</code>ã€<code>ReadSettingView</code> è¿™ç±»è‡ªå®šä¹‰æ§ä»¶ï¼š<ul><li>å…ˆäº†è§£å®ƒçš„å¤§è‡´ä½œç”¨ï¼ˆæ¯”å¦‚ç¿»é¡µã€æ˜¾ç¤ºæ–‡å­—ï¼‰</li><li>å†å†³å®šæ˜¯å¦æ·±å…¥çœ‹å®ƒçš„ç»˜å›¾æˆ–æ‰‹åŠ¿é€»è¾‘ï¼ˆå¾ˆå¤šæ—¶å€™å¯ä»¥ç•¥è¿‡ï¼‰</li></ul></li></ul><hr><h3 id="âœ…-ç¬¬ä¸‰é˜¶æ®µï¼šæ·±å…¥-Presenter-å±‚ï¼Œåˆ†æä¸šåŠ¡é€»è¾‘"><a href="#âœ…-ç¬¬ä¸‰é˜¶æ®µï¼šæ·±å…¥-Presenter-å±‚ï¼Œåˆ†æä¸šåŠ¡é€»è¾‘" class="headerlink" title="âœ… ç¬¬ä¸‰é˜¶æ®µï¼šæ·±å…¥ Presenter å±‚ï¼Œåˆ†æä¸šåŠ¡é€»è¾‘"></a>âœ… <strong>ç¬¬ä¸‰é˜¶æ®µï¼šæ·±å…¥ Presenter å±‚ï¼Œåˆ†æä¸šåŠ¡é€»è¾‘</strong></h3><h4 id="æ­¥éª¤-5ï¼šæ‰“å¼€å¯¹åº”çš„-Presenter-ç±»"><a href="#æ­¥éª¤-5ï¼šæ‰“å¼€å¯¹åº”çš„-Presenter-ç±»" class="headerlink" title="æ­¥éª¤ 5ï¼šæ‰“å¼€å¯¹åº”çš„ Presenter ç±»"></a>æ­¥éª¤ 5ï¼šæ‰“å¼€å¯¹åº”çš„ <code>Presenter</code> ç±»</h4><ul><li>çœ‹è¿™ä¸ª Presenter çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ</li><li>ä½ åœ¨ View å±‚ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œæ˜¯è°ƒç”¨çš„å“ªä¸ªæ–¹æ³•ï¼Ÿ</li></ul><p>ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">loadBook</span><span class="hljs-params">()</span> &#123;<br>    model.getBookData(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Callback</span>() &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">success</span><span class="hljs-params">(BookShelfBean bean)</span> &#123;<br>            view.showContent(bean);<br>        &#125;<br>    &#125;);<br>&#125;<br><br></code></pre></td></tr></table></figure><ul><li>Presenter æ˜¯ <strong>æ ¸å¿ƒé€»è¾‘ä¸­æ¢</strong>ï¼Œè¿æ¥ View å’Œ Modelã€‚</li></ul><hr><h3 id="âœ…-ç¬¬å››é˜¶æ®µï¼šæŸ¥çœ‹-Model-å±‚ï¼Œæ•°æ®ä»å“ªæ¥ï¼Ÿ"><a href="#âœ…-ç¬¬å››é˜¶æ®µï¼šæŸ¥çœ‹-Model-å±‚ï¼Œæ•°æ®ä»å“ªæ¥ï¼Ÿ" class="headerlink" title="âœ… ç¬¬å››é˜¶æ®µï¼šæŸ¥çœ‹ Model å±‚ï¼Œæ•°æ®ä»å“ªæ¥ï¼Ÿ"></a>âœ… <strong>ç¬¬å››é˜¶æ®µï¼šæŸ¥çœ‹ Model å±‚ï¼Œæ•°æ®ä»å“ªæ¥ï¼Ÿ</strong></h3><h4 id="æ­¥éª¤-6ï¼šæ‰“å¼€-Model-æˆ–-ModelImpl-ç±»"><a href="#æ­¥éª¤-6ï¼šæ‰“å¼€-Model-æˆ–-ModelImpl-ç±»" class="headerlink" title="æ­¥éª¤ 6ï¼šæ‰“å¼€ Model æˆ– ModelImpl ç±»"></a>æ­¥éª¤ 6ï¼šæ‰“å¼€ <code>Model</code> æˆ– <code>ModelImpl</code> ç±»</h4><ul><li><p>çœ‹å®ƒæ˜¯ä» <strong>å“ªé‡Œæ‹¿æ•°æ®</strong> çš„ï¼š</p><ul><li>ç½‘ç»œè¯·æ±‚ï¼Ÿï¼ˆæ¯”å¦‚ç”¨ Retrofitï¼‰</li><li>æ•°æ®åº“ï¼Ÿï¼ˆæ¯”å¦‚ç”¨ Daoã€GreenDAOï¼‰</li><li>ç¼“å­˜ï¼Ÿï¼ˆæ¯”å¦‚ç”¨ CacheManagerï¼‰</li></ul></li><li><p>æŸ¥çœ‹å…·ä½“çš„æ•°æ®æ¥æºï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs plaintext">RetrofitHelper.getApi().getChapters(bookId);<br></code></pre></td></tr></table></figure></li></ul><hr><h3 id="âœ…-ç¬¬äº”é˜¶æ®µï¼šå¾€ä¸‹çœ‹æ•°æ®æ”¯æ’‘å±‚ï¼ˆå¯é€‰ï¼‰"><a href="#âœ…-ç¬¬äº”é˜¶æ®µï¼šå¾€ä¸‹çœ‹æ•°æ®æ”¯æ’‘å±‚ï¼ˆå¯é€‰ï¼‰" class="headerlink" title="âœ… ç¬¬äº”é˜¶æ®µï¼šå¾€ä¸‹çœ‹æ•°æ®æ”¯æ’‘å±‚ï¼ˆå¯é€‰ï¼‰"></a>âœ… <strong>ç¬¬äº”é˜¶æ®µï¼šå¾€ä¸‹çœ‹æ•°æ®æ”¯æ’‘å±‚ï¼ˆå¯é€‰ï¼‰</strong></h3><h4 id="æ­¥éª¤-7ï¼šæŸ¥çœ‹-Beanã€Daoã€Utils-å·¥å…·ç±»"><a href="#æ­¥éª¤-7ï¼šæŸ¥çœ‹-Beanã€Daoã€Utils-å·¥å…·ç±»" class="headerlink" title="æ­¥éª¤ 7ï¼šæŸ¥çœ‹ Beanã€Daoã€Utils å·¥å…·ç±»"></a>æ­¥éª¤ 7ï¼šæŸ¥çœ‹ Beanã€Daoã€Utils å·¥å…·ç±»</h4><ul><li><code>bean/</code>ï¼šå®šä¹‰äº†å“ªäº›æ•°æ®ç»“æ„ï¼Œæ¯”å¦‚ <code>BookShelfBean</code>, <code>ChapterBean</code>ï¼Ÿ</li><li><code>dao/</code>ï¼šä½ å¯ä»¥çœ‹çœ‹ <code>BookShelfBeanDao</code> æ˜¯å¦‚ä½•å­˜&#x2F;å–ä¹¦çš„æ•°æ®çš„ã€‚</li><li><code>utils/</code>ï¼šåªåœ¨ä½ çœ‹åˆ°ç”¨åˆ°çš„æ—¶å€™å†æ·±å…¥çœ‹ï¼Œæ¯”å¦‚å¤„ç†æ—¥æœŸã€æ–‡ä»¶ã€ç½‘ç»œçŠ¶æ€ç­‰ã€‚</li></ul><hr><h3 id="âœ…-ç¬¬å…­é˜¶æ®µï¼šæŸ¥æ‰¾å›è°ƒæœºåˆ¶ä¸äº‹ä»¶æµ"><a href="#âœ…-ç¬¬å…­é˜¶æ®µï¼šæŸ¥æ‰¾å›è°ƒæœºåˆ¶ä¸äº‹ä»¶æµ" class="headerlink" title="âœ… ç¬¬å…­é˜¶æ®µï¼šæŸ¥æ‰¾å›è°ƒæœºåˆ¶ä¸äº‹ä»¶æµ"></a>âœ… <strong>ç¬¬å…­é˜¶æ®µï¼šæŸ¥æ‰¾å›è°ƒæœºåˆ¶ä¸äº‹ä»¶æµ</strong></h3><ul><li>é¡¹ç›®ä¸­å¯èƒ½ä¼šæœ‰ä¸€äº›å›è°ƒæ¥å£ï¼ˆåƒä½ ä¹‹å‰æåˆ°çš„ <code>OnGetChapterListListener</code>ï¼‰</li><li>åˆ†æå®ƒä»¬æ˜¯æ€ä¹ˆä¼ å€¼ã€è§¦å‘é€»è¾‘çš„ã€‚</li></ul></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;æ­£æ–‡&quot;&gt;&lt;a href=&quot;#æ­£æ–‡&quot; class=&quot;headerlink&quot; title=&quot;æ­£æ–‡&quot;&gt;&lt;/a&gt;æ­£æ–‡&lt;/h3&gt;&lt;p&gt;â€‹	&lt;/p&gt;
&lt;p&gt;â€‹	&lt;strong&gt;BaseFragment&lt;/strong&gt;æŠ½è±¡ç±»ï¼Œæ˜¯ä¸€ä¸ªåŸºç¡€çš„Fragmentç±»å®ç°ï¼Œç»§æ‰¿è‡ª &lt;co</summary>
      
    
    
    
    <category term="å¼€å‘" scheme="http://bumak.github.io/categories/%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="å®‰å“å¼€å‘å­¦ä¹ " scheme="http://bumak.github.io/tags/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>é˜…è¯»APPé¡¹ç›®å­¦ä¹ â€”â€”3</title>
    <link href="http://bumak.github.io/2025/06/23/%E9%98%85%E8%AF%BB%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0/%E5%AE%89%E5%8D%93%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A03/"/>
    <id>http://bumak.github.io/2025/06/23/%E9%98%85%E8%AF%BB%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0/%E5%AE%89%E5%8D%93%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A03/</id>
    <published>2025-06-23T04:52:54.775Z</published>
    <updated>2025-06-23T04:51:59.729Z</updated>
    
    <content type="html"><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>â€‹åˆ†æå¤æ‚ä¸€ç‚¹çš„åŠŸèƒ½ï¼Œéœ€è¦ç†Ÿæ‚‰é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ€æƒ³ï¼Œç†Ÿæ‚‰æ›´åŠ åŸºç¡€çš„ä»£ç ï¼Œæˆ‘æ„Ÿè§‰æœ‰ç‚¹åŠ›ä¸ä»å¿ƒï¼Œååˆ†éš¾ä»¥ä¸‹æ‰‹ï¼Œè€ƒè™‘è¦ä¸è¦ä»åŸºç¡€ç±»ä¸€ç‚¹ç‚¹å­¦ä¹ ï¼Œåˆ†æå…¶ä½œç”¨ã€ä¸ºä»€ä¹ˆè¦è¿™æ ·å†™ä¹‹ç±»çš„é—®é¢˜ï¼Œèƒ½å­¦åˆ°å¾ˆå¤šçŸ¥è¯†ç‚¹ï¼Œè¿™æ ·æ˜¯ä¸æ˜¯ä¼šæ›´åŠ æœ‰åˆ©äºæˆ‘çš„å¼€å‘ç»éªŒå­¦ä¹ ï¼Œæ¯•ç«Ÿâ€œè½®å­â€çš„ä»£ç éƒ½è¿˜æ²¡ææ˜ç™½ä¸ºä»€ä¹ˆè¿™ä¹ˆå†™ï¼Œç›´æ¥å»è§£æåœ¨æ­¤åŸºç¡€ä¸Šçš„å…¶ä»–åŠŸèƒ½ä¼šè®©æˆ‘æœ‰ç‚¹ä¸è„šè¸å®åœ°çš„æ„Ÿè§‰ã€‚</p><p>â€‹å¦å¤–ï¼Œå› ä¸ºé”™è¯¯çš„æ“ä½œï¼ŒæŠŠèµ„æºæ–‡ä»¶ç»™æä¹±äº†ï¼Œåˆå¾—æ–°å»ºé¡¹ç›®é‡æ–°copyäº†ï¼Œæœ‰ç‚¹çƒ¦ã€‚</p><p>â€‹</p><h3 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h3><p>â€‹å…ˆä»basemvplibçš„æ–‡ä»¶å¼€å§‹å§ï¼ŒIViewå’ŒIPresenterçš„åŸºç¡€æ€æƒ³å·²ç»å­¦ä¹ è¿‡äº†ï¼Œå†ä»<strong>AppActivityManager</strong>ã€<strong>BaseApplication</strong>ã€<strong>EncodoConverter</strong>è¿™ä¸‰ä¸ªç±»å¼€å§‹å§ã€‚</p><p>â€‹</p><p>â€‹<strong>AppActivityManager</strong>ç±»æ˜¯ç®¡ç†é¡¹ç›®ä¸­æ‰€æœ‰Activityçš„å·¥å…·ç±»ï¼Œæ–¹ä¾¿åœ¨åº”ç”¨ä¸­ç»Ÿä¸€æ§åˆ¶ Activity ç”Ÿå‘½å‘¨æœŸï¼Œæ¯”å¦‚æ‰¹é‡å…³é—­æŸç±» Activity æˆ–æ£€æµ‹ Activity æ˜¯å¦åœ¨æ ˆä¸­ã€‚</p><p>â€‹<code>private static List&lt;WeakReference&lt;Activity&gt;&gt; activities;</code>ä½¿ç”¨å¼±å¼•ç”¨å­˜å‚¨Activityï¼Œå½“ Activity è¢«ç³»ç»Ÿå›æ”¶æ—¶ï¼Œå¼±å¼•ç”¨ä¸ä¼šé˜»æ­¢å®ƒçš„å›æ”¶ï¼Œé¿å…å¼ºå¼•ç”¨å¯¼è‡´å†…å­˜æ³„æ¼ã€‚</p><p>â€‹é€šè¿‡åŒé‡æ£€æŸ¥å®ç°çº¿ç¨‹å®‰å…¨çš„å•ä¾‹æ¨¡å¼ï¼Œä¿è¯AppActivityManageråœ¨æ•´ä¸ªåº”ç”¨ä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> AppActivityManager <span class="hljs-title function_">getInstance</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span> == instance)&#123;<br>            <span class="hljs-keyword">synchronized</span> (AppActivityManager.class)&#123;<br>                <span class="hljs-keyword">if</span>(<span class="hljs-literal">null</span> == instance)&#123;<br>                    instance = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AppActivityManager</span>();<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> instance;<br>    &#125;<br><br></code></pre></td></tr></table></figure><p>â€‹æä¾›äº†addã€removeæ–¹æ³•ï¼Œå…¶ä¸­æœ‰ä¸¤ç§ç§»é™¤æ–¹å¼ï¼šæä¾›Activityå®ä¾‹å’ŒActivityç±»åã€‚</p><p>â€‹æä¾›äº†finishæ–¹æ³•ï¼Œå¯ä»¥å…³é—­æŒ‡å®šçš„Activityå®ä¾‹æˆ–å…³é—­æŒ‡å®šç±»å‹çš„Activityã€‚</p><p>â€‹æä¾›isExistæ–¹æ³•ï¼Œèƒ½å¤Ÿåˆ¤æ–­æŸä¸ªActivityç±»æ˜¯å¦å­˜åœ¨ã€‚</p><blockquote><h3 id="ç®€å•ç†è§£ï¼š"><a href="#ç®€å•ç†è§£ï¼š" class="headerlink" title="ç®€å•ç†è§£ï¼š"></a>ç®€å•ç†è§£ï¼š</h3><ul><li><strong>Application.onCreate()</strong><br> æ˜¯æ•´ä¸ªåº”ç”¨ç¨‹åºçš„â€œå¯åŠ¨å…¥å£â€ï¼Œåœ¨åº”ç”¨ä¸€å¯åŠ¨æ—¶è°ƒç”¨ï¼Œåªè°ƒç”¨ä¸€æ¬¡ã€‚<br> ä½ å¯ä»¥åœ¨è¿™é‡Œåšä¸€äº›<strong>å…¨å±€åˆå§‹åŒ–</strong>ï¼Œæ¯”å¦‚åˆå§‹åŒ–æ•°æ®åº“ã€ç½‘ç»œåº“ã€ç¬¬ä¸‰æ–¹SDKç­‰ï¼Œæ‰€æœ‰é¡µé¢éƒ½èƒ½ç”¨ã€‚</li><li><strong>Activity.onCreate()</strong><br> æ˜¯æŸä¸ªå…·ä½“é¡µé¢ï¼ˆActivityï¼‰åˆ›å»ºæ—¶è°ƒç”¨ã€‚æ¯æ‰“å¼€ä¸€ä¸ªæ–°é¡µé¢ï¼Œå°±ä¼šè°ƒç”¨å®ƒã€‚<br> ä½ å¯ä»¥åœ¨è¿™é‡Œåšè¿™ä¸ªé¡µé¢ä¸“å±çš„åˆå§‹åŒ–ï¼Œæ¯”å¦‚åŠ è½½å¸ƒå±€ã€è®¾ç½®æŒ‰é’®äº‹ä»¶ç­‰ã€‚</li></ul></blockquote><p>â€‹<strong>BaseApplication</strong>æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„Applicationç±»ï¼Œæ˜¯å®‰å“åº”ç”¨çš„å…¥å£ç±»ï¼Œæ˜¯åº”ç”¨å¯åŠ¨æ—¶åˆ›å»ºçš„å…¨å±€å…¥å£ï¼Œç”¨æ¥åšå…¨å±€åˆå§‹åŒ–å’Œç®¡ç†ã€‚è¿™æ˜¯ä¸€ä¸ªåŸºç¡€æ¡†æ¶ç±»ï¼Œåªå®ç°äº†onCreateæ–¹æ³•ï¼Œè°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ã€‚</p><p>â€‹<strong>EncodoConverter</strong>ç»§æ‰¿äº† <code>retrofit2.Converter.Factory</code>ï¼Œç”¨äºåˆ›å»ºæ•°æ®è½¬æ¢å™¨ï¼›æœ‰ä¸€ä¸ªç§æœ‰å­—æ®µ <code>encode</code>ï¼Œé»˜è®¤ç¼–ç æ˜¯ <code>&quot;utf-8&quot;</code>ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä¼ å…¥ç¼–ç ï¼›æä¾›äº†ä¸¤ä¸ªé™æ€æ–¹æ³• <code>create()</code> ç”¨äºåˆ›å»ºè¯¥è½¬æ¢å™¨å®ä¾‹ï¼Œå¯ä»¥ç”¨é»˜è®¤ç¼–ç ï¼Œä¹Ÿå¯ä»¥ç”¨è‡ªå®šä¹‰ç¼–ç ï¼›é‡å†™äº† <code>responseBodyConverter()</code> æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ª <code>Converter&lt;ResponseBody, String&gt;</code>ï¼Œè¿™ä¸ªè½¬æ¢å™¨å°±æ˜¯æŠŠå“åº”ä½“æ•°æ®è¯»å–ä¸ºæŒ‡å®šç¼–ç çš„å­—ç¬¦ä¸²ã€‚</p><p>â€‹è¿™æ®µä»£ç å°±æ˜¯ç»™ Retrofit å®šåˆ¶ä¸€ä¸ªå“åº”ä½“çš„ç¼–ç è½¬æ¢å™¨ï¼Œè®©å®ƒå¯ä»¥ç”¨æŒ‡å®šç¼–ç æŠŠæœåŠ¡å™¨è¿”å›çš„å­—èŠ‚æµè½¬æˆå­—ç¬¦ä¸²ã€‚</p><p>â€‹<strong>Retrofit</strong> æ˜¯ä¸€ä¸ªç”¨äº Android å’Œ Java çš„ç½‘ç»œè¯·æ±‚åº“ï¼Œå®ƒå¸®ä½ å¾ˆæ–¹ä¾¿åœ°å‘æœåŠ¡å™¨å‘é€ HTTP è¯·æ±‚ï¼Œè·å–æ•°æ®ï¼Œç„¶åè‡ªåŠ¨æŠŠæœåŠ¡å™¨è¿”å›çš„ JSON æˆ– XML è½¬æ¢æˆä½ å®šä¹‰çš„ Java å¯¹è±¡ï¼Œçœå»äº†ä½ è‡ªå·±å†™å¾ˆå¤šè§£æä»£ç ã€‚</p><p>â€‹å†çœ‹<strong>BaseActivity</strong>ç±»ï¼Œå®ƒæ˜¯æ‰€æœ‰Activityçš„åŸºç±»ï¼Œç»Ÿä¸€å°è£…ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å’ŒPresenterç®¡ç†ï¼Œä½¿ç”¨äº†æ³›å‹<T extends IPresenter> è¡¨ç¤ºä¼ å…¥çš„ Presenter ç±»å‹ï¼Œå®ç°äº†IViewã€‚</p><p>â€‹é¡µé¢åˆå§‹åŒ–æµç¨‹ï¼Œä¸éœ€è¦çš„æ–¹æ³•å¯ä»¥ä¸å®ç°ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * ç”Ÿå‘½å‘¨æœŸ onCreateï¼ŒActivity å¯åŠ¨æ—¶è°ƒç”¨ã€‚</span><br><span class="hljs-comment"> * è¿™é‡Œç»Ÿä¸€è°ƒç”¨äº†ä¸€ç³»åˆ—åˆå§‹åŒ–æ–¹æ³•ï¼Œä¸‹é¢ä¼šè§£é‡Šæ¯ä¸ªæ–¹æ³•ä½œç”¨ã€‚</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>    <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>    <span class="hljs-built_in">this</span>.savedInstanceState = savedInstanceState;<br><br>    <span class="hljs-comment">// è·å–æ˜¯å¦ä½¿ç”¨è½¬åœºåŠ¨ç”»</span><br>    <span class="hljs-keyword">if</span>(getIntent()!=<span class="hljs-literal">null</span>)&#123;<br>        startShareAnim = getIntent().getBooleanExtra(start_share_ele,<span class="hljs-literal">false</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// æ·»åŠ åˆ°å…¨å±€Activityç®¡ç†å™¨ä¸­ï¼ˆæ–¹ä¾¿ç»Ÿä¸€å…³é—­ã€ç®¡ç†Activityï¼‰</span><br>    AppActivityManager.getInstance().add(<span class="hljs-built_in">this</span>);<br><br>    <span class="hljs-comment">// ç¬¬ä¸€æ­¥ï¼šåˆå§‹åŒ–ç¬¬ä¸‰æ–¹SDKï¼ˆå¯é€‰ï¼‰</span><br>    initSDK();<br><br>    <span class="hljs-comment">// ç¬¬äºŒæ­¥ï¼šè®¾ç½®å¸ƒå±€ï¼Œæ¯”å¦‚ setContentView(R.layout.xxx)</span><br>    onCreateActivity();<br><br>    <span class="hljs-comment">//ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º Presenter å¯¹è±¡</span><br>    mPresenter = initInjector();<br><br>    <span class="hljs-comment">// ç¬¬å››æ­¥ï¼šå°†å½“å‰Viewç»‘å®šåˆ°Presenterä¸Šï¼ˆç”¨äºé€šçŸ¥åˆ·æ–°ï¼‰</span><br>    attachView();<br><br>    <span class="hljs-comment">// ç¬¬äº”æ­¥ï¼šåˆå§‹åŒ–æ•°æ®ï¼ˆå¦‚é€‚é…å™¨ã€å˜é‡ç­‰ï¼‰</span><br>    initData();<br><br>    <span class="hljs-comment">// ç¬¬å…­æ­¥ï¼šç»‘å®šæ§ä»¶ï¼ˆfindViewByIdï¼‰</span><br>    bindView();<br><br>    <span class="hljs-comment">// ç¬¬ä¸ƒæ­¥ï¼šç»‘å®šäº‹ä»¶ï¼ˆç‚¹å‡»ã€åˆ·æ–°ç­‰é€»è¾‘ï¼‰</span><br>    bindEvent();<br><br>    <span class="hljs-comment">// ç¬¬å…«æ­¥ï¼šå‘èµ·é¦–æ¬¡è¯·æ±‚ï¼Œæ¯”å¦‚ç½‘ç»œåŠ è½½ä¹¦æ¶</span><br>    firstRequest();<br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹è¿˜å†™å¥½äº†é¡µé¢çš„è·³è½¬åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯å¯åŠ¨æ–°Activityå¹¶å¸¦åŠ¨ç”»æ•ˆæœçš„æ–¹æ³•ï¼Œæœ‰å¤šç§ï¼Œé€‚é…å¤šç§æƒ…å†µä¸‹çš„ä½¿ç”¨éœ€æ±‚ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">////////////////////////////////å¯åŠ¨Activityè½¬åœºåŠ¨ç”»/////////////////////////////////////////////</span><br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startActivityForResultByAnim</span><span class="hljs-params">(Intent intent, <span class="hljs-type">int</span> requestCode, <span class="hljs-type">int</span> animIn, <span class="hljs-type">int</span> animExit)</span> &#123;<br>        startActivityForResult(intent, requestCode);<br>        overridePendingTransition(animIn, animExit);<br>    &#125;<br><br><br><br>    <span class="hljs-comment">//protectedä»£è¡¨å®ƒçš„å­ç±»å¯ä»¥è°ƒç”¨</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startActivityByAnim</span><span class="hljs-params">(Intent intent, <span class="hljs-type">int</span> animIn, <span class="hljs-type">int</span> animExit)</span> &#123;<br>        startActivity(intent);<br>        overridePendingTransition(animIn, animExit);<br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startActivityForResultByAnim</span><span class="hljs-params">(Intent intent, <span class="hljs-type">int</span> requestCode, <span class="hljs-meta">@NonNull</span> View view, <span class="hljs-meta">@NonNull</span> String transitionName, <span class="hljs-type">int</span> animIn, <span class="hljs-type">int</span> animExit)</span> &#123;<br>        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) &#123;<br>            startActivityForResult(intent, requestCode, ActivityOptions.makeSceneTransitionAnimation(<span class="hljs-built_in">this</span>, view, transitionName).toBundle());<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            startActivityForResultByAnim(intent, requestCode, animIn, animExit);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">startActivityByAnim</span><span class="hljs-params">(Intent intent, <span class="hljs-meta">@NonNull</span> View view, <span class="hljs-meta">@NonNull</span> String transitionName, <span class="hljs-type">int</span> animIn, <span class="hljs-type">int</span> animExit)</span> &#123;<br>        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) &#123;<br>            intent.putExtra(start_share_ele,<span class="hljs-literal">true</span>);<br>            startActivity(intent, ActivityOptions.makeSceneTransitionAnimation(<span class="hljs-built_in">this</span>, view, transitionName).toBundle());<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            startActivityByAnim(intent, animIn, animExit);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Context <span class="hljs-title function_">getContext</span><span class="hljs-params">()</span>&#123;<span class="hljs-comment">//å®ç°çš„IViewæ–¹æ³•</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Boolean <span class="hljs-title function_">getStart_share_ele</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> startShareAnim;<br>    &#125;<br></code></pre></td></tr></table></figure><p>â€‹ä»€ä¹ˆæ˜¯â€œå…±äº«å…ƒç´ åŠ¨ç”»â€ï¼Ÿç®€å•è¯´ï¼Œå°±æ˜¯ä¸¤ä¸ªé¡µé¢**â€œå…±ç”¨ä¸€ä¸ªä¸œè¥¿â€<strong>ï¼Œè¿™ä¸ªä¸œè¥¿åœ¨åˆ‡æ¢é¡µé¢æ—¶ä¼š</strong>åŠ¨èµ·æ¥ï¼Œçœ‹èµ·æ¥å¾ˆè‡ªç„¶ã€é…·ç‚«**ã€‚æ›´åŠ è¯¦ç»†çš„è®²è§£å¯ä»¥ç™¾åº¦ã€‚</p><p>â€‹åé¢è¿˜æœ‰<strong>BaseFragment</strong>ã€<strong>BaseModelImpl</strong>ã€<strong>BasePresenterImpl</strong>ã€<strong>RetryIntercepter</strong>ç±»ï¼Œæ”¹å¤©å†è§£æï¼Œä»Šå¤©å­¦ä¹ ä»»åŠ¡ç»“æŸï¼</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h3&gt;&lt;p&gt;â€‹	åˆ†æå¤æ‚ä¸€ç‚¹çš„åŠŸèƒ½ï¼Œéœ€è¦ç†Ÿæ‚‰é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ€æƒ³ï¼Œç†Ÿæ‚‰æ›´åŠ åŸºç¡€çš„ä»£ç ï¼Œæˆ‘æ„Ÿè§‰æœ‰ç‚¹åŠ›ä¸ä»å¿ƒï¼Œååˆ†éš¾ä»¥ä¸‹æ‰‹ï¼Œè€ƒè™‘è¦ä¸è¦ä»åŸºç¡€ç±»ä¸€ç‚¹ç‚¹å­¦ä¹ ï¼Œåˆ†æ</summary>
      
    
    
    
    <category term="å¼€å‘" scheme="http://bumak.github.io/categories/%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="å®‰å“å¼€å‘å­¦ä¹ " scheme="http://bumak.github.io/tags/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>é˜…è¯»APPé¡¹ç›®å­¦ä¹ â€”â€”2</title>
    <link href="http://bumak.github.io/2025/06/22/%E9%98%85%E8%AF%BB%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0/%E5%AE%89%E5%8D%93%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A02/"/>
    <id>http://bumak.github.io/2025/06/22/%E9%98%85%E8%AF%BB%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0/%E5%AE%89%E5%8D%93%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A02/</id>
    <published>2025-06-22T04:39:16.235Z</published>
    <updated>2025-06-23T01:58:48.011Z</updated>
    
    <content type="html"><![CDATA[<p>â€‹æ¬¢è¿é¡µå¼€å§‹åï¼Œå°±è¿›å…¥ä¸»ä½“<strong>MainActivity</strong>ä¸­ï¼ŒæŸ¥çœ‹æºç å¯ä»¥å‘ç°ï¼Œå…¶ä½¿ç”¨äº†ä¼—å¤šè‡ªå®šä¹‰çš„å…¶ä»–ç±»ã€‚</p><p>â€‹</p><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>â€‹å…ˆå¤§ä½“é€šè¿‡AIåˆ†æä¸€æ³¢ï¼Œçœ‹çœ‹è¿™ä¸ªä¸»é¡µé¢åœ¨å¹²ä»€ä¹ˆã€‚</p><ul><li><p>é¡µé¢åˆå§‹åŒ–å’Œå¸ƒå±€è®¾ç½®ï¼šç»§æ‰¿è‡ª <strong>MBaseActivity<IMainPresenter></strong>ï¼Œé‡‡ç”¨ MVP æ¶æ„è®¾è®¡ï¼ˆè§†å›¾å±‚ <strong>MainActivity</strong> è´Ÿè´£UIï¼Œ<strong>IMainPresenter</strong> è´Ÿè´£ä¸šåŠ¡é€»è¾‘ï¼‰ã€‚åˆå§‹åŒ–é¡µé¢ä¸Šçš„æ§ä»¶ï¼Œå¦‚åº”ç”¨logoã€å‡ ä¸ªåŠŸèƒ½æŒ‰é’®ï¼ˆæ‰“èµã€è®¾ç½®ã€ä¹¦åº“ã€æ·»åŠ ä¹¦ç±ã€ä¸‹è½½ï¼‰ã€åˆ·æ–°åˆ—è¡¨æ§ä»¶ï¼ˆ<strong>RefreshRecyclerView</strong>ï¼‰ç­‰ã€‚</p></li><li><p>æ˜¾ç¤ºä¹¦æ¶åˆ—è¡¨ï¼šä½¿ç”¨<strong>RefreshRecyclerView</strong>æ¥å±•ç¤ºä¹¦æ¶å†…å®¹ï¼Œä½¿ç”¨è‡ªå®šä¹‰çš„<strong>BookShelfAdapter</strong>ä½œä¸ºåˆ—è¡¨çš„é€‚é…å™¨ï¼Œå†é€šè¿‡å¸ƒå±€ç®¡ç†å™¨<strong>LinearLayoutManager</strong>æ¥æ§åˆ¶<strong>RecyclerView</strong>å¸ƒå±€ã€‚</p></li><li><p>åˆ·æ–°å’ŒåŠ è½½æ•°æ®ï¼šç»‘å®šåˆ·æ–°ç›‘å¬å™¨ï¼ˆ<strong>OnRefreshWithProcessListener</strong>ï¼‰æ¥å®ç°ä¸‹æ‹‰åˆ·æ–°ä¹¦æ¶æ•°æ®ï¼Œåˆ·æ–°æ—¶è°ƒç”¨**mPresenter.queryBookShelf(true)**è¯·æ±‚æœ€æ–°æ•°æ®ã€‚åŒæ—¶å¤„ç†åˆ·æ–°å®Œæˆå’Œåˆ·æ–°é”™è¯¯çš„å›è°ƒï¼Œå¹¶æ›´æ–°UIå’Œè¿›åº¦æ¡ã€‚</p></li><li><p>äº‹ä»¶å¤„ç†ï¼šç»™é¦–é¡µçš„å„ä¸ªæŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼šè®¾ç½®æŒ‰é’®å¼¹å‡ºä»£ç†è®¾ç½®çª—å£ï¼›ä¸‹è½½æŒ‰é’®å¼¹å‡ºä¸‹è½½åˆ—è¡¨çª—å£ï¼›ä¹¦åº“æŒ‰é’®è·³è½¬åˆ°ä¹¦åº“ç•Œé¢ï¼ˆ<strong>LibraryActivity</strong>ï¼‰ï¼›æ·»åŠ ä¹¦ç±æŒ‰é’®è·³è½¬åˆ°å¯¼å…¥ä¹¦ç±ç•Œé¢ï¼›æ‰“èµæŒ‰é’®é¢„ç•™äº†ç‚¹å‡»äº‹ä»¶ï¼Œå…·ä½“é€»è¾‘æ²¡å†™ã€‚ç»™ä¹¦æ¶åˆ—è¡¨çš„æ¯ä¸ªä¹¦ç±ç»‘å®šäº†ç‚¹å‡»äº‹ä»¶ï¼šç‚¹å‡»è·³è½¬åˆ°é˜…è¯»ç•Œé¢ï¼›é•¿æŒ‰è·³è½¬åˆ°ä¹¦ç±è¯¦æƒ…ç•Œé¢ï¼Œå¹¶å¸¦åŠ¨ç”»æ•ˆæœã€‚ä¹¦æ¶ä¸­ç‚¹å‡»â€œå»é€‰ä¹¦â€ä¼šè·³è½¬åˆ°ä¹¦åº“ã€‚</p></li><li><p>ç®¡ç†è­¦å‘Šä¿¡æ¯å¼¹çª—ï¼šé¡µé¢ä¸Šæœ‰ä¸€ä¸ªè­¦å‘Šä¿¡æ¯åŒºåŸŸï¼ˆ<strong>flWarn</strong>ï¼‰ï¼Œå¯ä»¥é€šè¿‡å…³é—­æŒ‰é’®éšè—ã€‚</p></li><li><p>å¤„ç†ç³»ç»ŸæŒ‰é”®äº‹ä»¶ï¼šæ•è·è¿”å›é”®ï¼Œå®ç°â€œè¿ç»­ä¸¤æ¬¡æŒ‰è¿”å›é”®é€€å‡ºåº”ç”¨â€çš„äº¤äº’é€»è¾‘ã€‚</p></li><li><p>ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼šåœ¨ <strong>onDestroy</strong> é‡Œåšèµ„æºé”€æ¯ï¼Œæ¯”å¦‚å…³é—­å¼¹çª—ã€‚</p></li></ul><blockquote><p>â€‹ä¸Šé¢æ¯”è¾ƒé™Œç”Ÿçš„æ¦‚å¿µæœ‰â€œé€‚é…å™¨â€ï¼Œè¿™æ˜¯ä»€ä¹ˆä¸œè¥¿å•Šï¼Ÿ</p><p>â€‹ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼šä½ æƒ³åœ¨å®¶é‡Œçš„ä¹¦æ¶ä¸Šæ‘†ä¹¦ï¼ŒRecyclerViewå°±æ˜¯ä¹¦æ¶ï¼Œé€‚é…å™¨å°±æ˜¯æŒ‰é¡ºåºæ‹¿ä¹¦ï¼Œä¸€æœ¬ä¸€æœ¬æ‘†æ”¾ä¹¦ç±çš„äººï¼Œä¹¦æœ¬çš„æ•°æ®å°±æ˜¯ä½ æ‰‹é‡Œçš„ä¹¦ã€‚æ²¡æœ‰é€‚é…å™¨ï¼Œä½ çš„ä¹¦æ¶å°±ä¸çŸ¥é“æ‘†å“ªäº›ä¹¦ï¼Œä¹Ÿä¸çŸ¥é“æ€ä¹ˆæ‘†ã€‚</p></blockquote><h3 id="é€»è¾‘è§£è¯»"><a href="#é€»è¾‘è§£è¯»" class="headerlink" title="é€»è¾‘è§£è¯»"></a>é€»è¾‘è§£è¯»</h3><p>â€‹</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//æˆå‘˜å˜é‡å£°æ˜</span><br>    <span class="hljs-keyword">private</span> ImageView ivLogo;           <span class="hljs-comment">//åº”ç”¨logoå›¾æ ‡</span><br>    <span class="hljs-keyword">private</span> ImageButton ibMoney;        <span class="hljs-comment">//æ‰“èµæŒ‰é’®</span><br>    <span class="hljs-keyword">private</span> ImageButton ibSettings;     <span class="hljs-comment">//è®¾ç½®æŒ‰é’®</span><br>    <span class="hljs-keyword">private</span> ImageButton ibLibrary;      <span class="hljs-comment">//ä¹¦åº“æŒ‰é’®</span><br>    <span class="hljs-keyword">private</span> ImageButton ibAdd;          <span class="hljs-comment">//æ·»åŠ ä¹¦ç±æŒ‰é’®</span><br>    <span class="hljs-keyword">private</span> ImageButton ibDownload;     <span class="hljs-comment">//ä¸‹è½½æŒ‰é’®</span><br><br>    <span class="hljs-keyword">private</span> RefreshRecyclerView rfRvShelf;<br>    <span class="hljs-keyword">private</span> BookShelfAdapter bookShelfAdapter;<br><br>    <span class="hljs-keyword">private</span> FrameLayout flWarn;         <span class="hljs-comment">//è­¦å‘Šä¿¡æ¯å¸ƒå±€ï¼ˆå¼¹å‡ºæ¡†ï¼‰</span><br>    <span class="hljs-keyword">private</span> ImageView ivWarnClose;      <span class="hljs-comment">//å…³é—­è­¦å‘ŠæŒ‰é’®</span><br><br>    <span class="hljs-keyword">private</span> DownloadListPop downloadListPop;        <span class="hljs-comment">//ä¸‹è½½åˆ—è¡¨å¼¹çª—å¯¹è±¡</span><br>    <span class="hljs-keyword">private</span> ProxyPop proxyPop;          <span class="hljs-comment">//ä»£ç†è®¾ç½®å¼¹çª—å¯¹è±¡</span><br></code></pre></td></tr></table></figure><p>â€‹ImageViewæ˜¯å®‰å“é‡Œé¢ç”¨æ¥æ˜¾ç¤ºå›¾ç‰‡çš„æ§ä»¶ï¼Œå°±æ˜¯ä¸€ä¸ªâ€å›¾ç‰‡æ¡†â€œï¼Œä¸“é—¨ç”¨æ¥åœ¨ç•Œé¢ä¸Šå±•ç¤ºå›¾ç‰‡ï¼Œæ¯”å¦‚åº”ç”¨å›¾æ ‡ã€ç…§ç‰‡ã€æŒ‰é’®å›¾æ ‡ç­‰ç­‰ï¼Œåªè´Ÿè´£æ˜¾ç¤ºå›¾ç‰‡ï¼Œä¸å“åº”ç‚¹å‡»äº‹ä»¶ï¼ˆå½“ç„¶ï¼Œä½ å¯ä»¥ç»™å®ƒåŠ ç‚¹å‡»äº‹ä»¶ï¼Œè®©å®ƒåƒæŒ‰é’®ä¸€æ ·ç”¨ï¼‰ã€‚</p><p>â€‹ImageButtonå°±æ˜¯æœ‰å›¾ç‰‡çš„æŒ‰é’®ã€‚</p><p>â€‹å…¶ä»–å°±æ˜¯è‡ªå®šä¹‰çš„ç»„ä»¶äº†ã€‚</p><p>â€‹</p><p>â€‹çœ‹åˆ°å…·ä½“çš„æ–¹æ³•ï¼Œ<strong>initInjector</strong>æ˜¯åœ¨åˆå§‹åŒ–ä¸€ä¸ªPresenterå¯¹è±¡ï¼Œç„¶åè¿”å›ä¸€ä¸ª<strong>MainPresenterImpl</strong>å®ä¾‹ï¼Œè´Ÿè´£ä¸ç•Œé¢ä¸šåŠ¡é€»è¾‘äº¤äº’ã€‚</p><p>â€‹<strong>onCreateActivity</strong>è®¾ç½®ç•Œé¢çš„å¸ƒå±€æ–‡ä»¶ã€‚</p><p>â€‹<strong>initData</strong>åˆå§‹åŒ–æ•°æ®ï¼Œåˆ›å»ºä¹¦æ¶é€‚é…å™¨å®ä¾‹ã€‚</p><p>â€‹<strong>dispatchTouchEvent</strong>å¤„ç†è§¦æ‘¸äº‹ä»¶ï¼Œè°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ï¼Œå¥—å£³å‡½æ•°ã€‚</p><p>â€‹<strong>bindView</strong>ç»‘å®šç•Œé¢æ§ä»¶ï¼ˆæ‰¾æ§ä»¶ã€å®ä¾‹åŒ–ï¼‰ï¼Œæ‰¾åˆ°å¸ƒå±€é‡Œçš„å„ç§æ§ä»¶ï¼ˆæŒ‰é’®ã€åˆ—è¡¨ã€å¼¹çª—ç­‰ï¼‰ï¼Œå¹¶å…³è”åˆ°å˜é‡ï¼Œç»™ä¹¦æ¶åˆ—è¡¨ <code>RecyclerView</code> è®¾ç½®é€‚é…å™¨å’Œå¸ƒå±€ç®¡ç†å™¨ã€‚</p><p>â€‹<strong>bindEvent</strong>ç»‘å®šå„ç§äº‹ä»¶ç›‘å¬å™¨ã€‚</p><p>â€‹<strong>bindRvShelfEvent</strong>ç»™ä¹¦æ¶çš„åˆ·æ–°æ§ä»¶ç»‘å®šåˆ·æ–°ç›‘å¬ã€‚</p><p>â€‹<strong>firstRequest</strong>é¦–æ¬¡åŠ è½½æ•°æ®ï¼Œåº”ç”¨æ‰“å¼€æ—¶è°ƒç”¨ã€‚</p><p>â€‹<strong>refreshBookShelf</strong>å°†æ–°çš„ä¹¦ç±åˆ—è¡¨æ•°æ®ä¼ ç»™é€‚é…å™¨ï¼Œæ›´æ–°æ˜¾ç¤ºã€‚</p><p>â€‹<strong>activityRefreshView</strong>è§¦å‘ä¹¦æ¶åˆ·æ–°åŠ¨ä½œï¼Œè®©åˆ·æ–°æ§ä»¶å¼€å§‹åˆ·æ–°åŠ¨ç”»å¹¶è°ƒç”¨åˆ·æ–°é€»è¾‘ã€‚</p><p>â€‹<strong>refreshFinish</strong>åˆ·æ–°ç»“æŸï¼Œéšè—åˆ·æ–°åŠ¨ç”»ã€‚</p><p>â€‹<strong>refreshError</strong>åˆ·æ–°é”™è¯¯æ—¶è°ƒç”¨ã€‚</p><p>â€‹<strong>refreshRecyclerViewItemAdd</strong>åˆ·æ–°æ—¶è¿›åº¦æ¡+1ã€‚</p><p>â€‹<strong>setRecyclerMaxProgress</strong>è®¾ç½®åˆ·æ–°è¿›åº¦æ¡çš„æœ€å¤§å€¼ã€‚</p><p>â€‹<strong>onKeyDown</strong>æŒ‰é”®äº‹ä»¶å¤„ç†ï¼Œç”¨æˆ·æŒ‰è¿”å›é”®æ—¶ï¼Œè°ƒç”¨ <code>exit()</code> æ–¹æ³•ï¼Œå®ç°â€œå†æŒ‰ä¸€æ¬¡é€€å‡ºç¨‹åºâ€çš„é€»è¾‘ã€‚</p><p>â€‹<strong>onDestroy</strong>èµ„æºé”€æ¯æ—¶è°ƒç”¨ï¼Œæ¸…ç†ä¸€äº›å¼¹çª—çš„èµ„æºï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚</p><p>â€‹<strong>exit</strong>é€€å‡ºç¨‹åºçš„é€»è¾‘ï¼Œå¦‚æœ2ç§’å†…ç¬¬äºŒæ¬¡æŒ‰è¿”å›é”®ï¼Œåˆ™é€€å‡ºç¨‹åºï¼Œå¦åˆ™æç¤ºâ€œå†æŒ‰ä¸€æ¬¡é€€å‡ºç¨‹åºâ€ã€‚</p><h3 id="å‰ç«¯é¡µé¢å¤ç°"><a href="#å‰ç«¯é¡µé¢å¤ç°" class="headerlink" title="å‰ç«¯é¡µé¢å¤ç°"></a>å‰ç«¯é¡µé¢å¤ç°</h3><p>â€‹çœ‹åˆ°XMLæ–‡ä»¶ï¼Œé‡Œé¢ä½¿ç”¨åˆ°ä¸€ä¸ªè‡ªå®šä¹‰çš„ç»„ä»¶<strong>com.monke.monkeybook.widget.refreshview.RefreshRecyclerView</strong>ï¼Œ</p><p>ä¸‹å›¾ä¸­çš„ç©ºç™½åŒºåŸŸå°±æ˜¯è¿™ä¸ªç»„ä»¶çš„ä½ç½®ã€‚å½“ç„¶ä¹ŸåŒ…æ‹¬ä¸€ä¸ªä½œè€…è‡ªå·±å¼€æºçš„æ²‰æµ¸æ¡†ï¼Œéœ€è¦å¼•ç”¨ä¾èµ–ã€‚</p><p>â€‹é‡Œé¢çš„å¸ƒå±€å¾ˆæ¸…æ™°æ˜äº†ï¼Œæ²‰æµ¸æ¡†åŒ…è£¹æœ€å¤–å±‚ï¼Œç„¶åä¸€ä¸ªå‚ç›´æ–¹å‘çš„çº¿æ€§å¸ƒå±€æ¥éš”åˆ†ä¸Šä¸‹é¡µé¢ï¼Œé‡Œé¢å†ç”±æ°´å¹³çš„çº¿æ€§å¸ƒå±€æ¥å±•ç¤ºé¡¶éƒ¨ï¼Œä¸‹é¢å°±æ˜¯ä¹¦æ¶åŒºã€‚</p><p><img src="/pictures/novelReader_app/image-20250622115453885.png" alt="image-20250622115453885"></p><p>â€‹éœ€è¦å¯¼å…¥å¯¹åº”çš„drawableé‡Œé¢çš„XMLæ–‡ä»¶ã€layouté‡Œé¢çš„å…¶ä»–XMLæ–‡ä»¶ã€valuesé‡Œé¢çš„XMLæ–‡ä»¶ã€‚ç„¶åå†™å…¥<strong>RefreshRecyclerView</strong>ç±»ã€<strong>RefreshProgressBar</strong>ç±»ã€<strong>RefreshRecyclerViewAdapter</strong>æŠ½è±¡ç±»ã€<strong>OnRefreshWithProgressListener</strong>æ¥å£ã€<strong>OnLoadMoreListener</strong>æ¥å£ã€<strong>BaseRefreshListener</strong>æ¥å£ï¼Œè¿˜æœ‰<strong>BookContentView</strong>ç±»ï¼Œå› ä¸ºè¿™ä¸ªç±»åˆå¼•å‡ºä¸€å †å…¶ä»–çš„ç±»å’Œæ¥å£ã€‚å¤ªéº»çƒ¦äº†ã€‚</p><p>â€‹å…ˆæ”¾ç€BookContentViewä¸ç®¡å§ï¼Œè¿˜æœ‰å…¶ä»–å‡ ä¸ª<strong>BitIntentDataManager</strong>ã€<strong>MApplication</strong>ã€<strong>ReadBookControl</strong>éƒ½æœ‰ç‚¹é—®é¢˜å•Šï¼è¿™æ ·åˆ†æä¹Ÿå¤ªéº»çƒ¦äº†ã€‚ä¸èƒ½æŒ‰ç…§è¿™ä¸ªé€»è¾‘æä¸‹å»ã€‚</p><h3 id="å…·ä½“åŠŸèƒ½æµç¨‹åˆ†æ"><a href="#å…·ä½“åŠŸèƒ½æµç¨‹åˆ†æ" class="headerlink" title="å…·ä½“åŠŸèƒ½æµç¨‹åˆ†æ"></a>å…·ä½“åŠŸèƒ½æµç¨‹åˆ†æ</h3><p>â€‹å…ˆä»æœ€ç®€å•çš„é€€å‡ºåŠŸèƒ½æ¥è¯´å§ï¼Œä¸ç„¶éƒ½æ²¡æ³•è¯»ä¸‹å»äº†ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br>   <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">onKeyDown</span><span class="hljs-params">(<span class="hljs-type">int</span> keyCode, KeyEvent event)</span> &#123;<br>       <span class="hljs-keyword">if</span> (keyCode == KeyEvent.KEYCODE_BACK) &#123;<br>           exit();<br>           <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>       &#125;<br>       <span class="hljs-keyword">return</span> <span class="hljs-built_in">super</span>.onKeyDown(keyCode, event);<br>   &#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-type">long</span> <span class="hljs-variable">exitTime</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">exit</span><span class="hljs-params">()</span> &#123;<br>       <span class="hljs-keyword">if</span> ((System.currentTimeMillis() - exitTime) &gt; <span class="hljs-number">2000</span>) &#123;<br>           Toast.makeText(getApplicationContext(), <span class="hljs-string">&quot;å†æŒ‰ä¸€æ¬¡é€€å‡ºç¨‹åº&quot;</span>,<br>                   Toast.LENGTH_SHORT).show();<br>           exitTime = System.currentTimeMillis();<br>       &#125; <span class="hljs-keyword">else</span> &#123;<br>           finish();<br>           System.exit(<span class="hljs-number">0</span>);<br>       &#125;<br>   &#125;<br></code></pre></td></tr></table></figure><p>â€‹å½“ç”¨æˆ·æ‘ä¸‹â€è¿”å›é”®â€œï¼Œè§¦å‘onKeyDownæ–¹æ³•ï¼Œä¼šè°ƒç”¨exitæ–¹æ³•ï¼Œå¯¼è‡´é€€å‡ºç¨‹åºã€‚keyCodeè¡¨ç¤ºå½“å‰è¢«æŒ‰ä¸‹çš„æŒ‰é”®çš„ä»£ç ï¼ˆç¼–å·ï¼‰ï¼ŒKeyEvent.KEYCODE_BACKæ˜¯å®‰å“ç³»ç»Ÿå®šä¹‰çš„å¸¸é‡ï¼Œä»£è¡¨â€è¿”å›é”®â€œçš„æŒ‰é”®ä»£ç ã€‚System.currentTimeMillisæ–¹æ³•è¿”å›ä¸€ä¸ªâ€longâ€œç±»å‹çš„æ•°å­—ï¼Œè¡¨ç¤ºä»â€œ1970å¹´1æœˆ1æ—¥åˆå¤œâ€ï¼ˆç§°ä¸ºâ€œUnixçºªå…ƒâ€ï¼‰å¼€å§‹ï¼Œåˆ°å½“å‰æ—¶åˆ»æ‰€ç»è¿‡çš„æ¯«ç§’æ•°ã€‚</p><p>â€‹ç¬¬ä¸€æ¬¡æ‘ä¸‹â€è¿”å›é”®â€œä¼šè®¾ç½®exitTimeä¸ºå½“å‰æ—¶é—´ï¼Œç„¶åéœ€è¦åœ¨ä¸¤ç§’å†…å†æ‘ä¸€æ¬¡ï¼Œæ‰è¿›å…¥elseé‡Œé¢ã€‚</p><p>â€‹finishæ–¹æ³•ï¼Œ<strong>åªæ˜¯å‘Šè¯‰ç³»ç»Ÿâ€œå…³é—­è¿™ä¸ªActivityâ€ï¼Œä½†å®ƒæ˜¯å¼‚æ­¥çš„ï¼Œä¸ä¼šç«‹å³åœæ­¢å½“å‰æ–¹æ³•çš„æ‰§è¡Œ</strong>ã€‚<code>finish()</code> ä¼šè¯·æ±‚ç³»ç»Ÿå»é”€æ¯Activityï¼ˆè§¦å‘ç”Ÿå‘½å‘¨æœŸ<code>onPause() -&gt; onStop() -&gt; onDestroy()</code>ï¼‰ï¼Œä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹æ˜¯åœ¨ç³»ç»Ÿæ¶ˆæ¯é˜Ÿåˆ—ä¸­æ’é˜Ÿæ‰§è¡Œçš„ï¼Œå¹¶ä¸ä¼šé©¬ä¸Šè·³å‡ºå½“å‰æ–¹æ³•æˆ–ç»ˆæ­¢çº¿ç¨‹ï¼Œä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹æ˜¯åœ¨ç³»ç»Ÿæ¶ˆæ¯é˜Ÿåˆ—ä¸­æ’é˜Ÿæ‰§è¡Œçš„ï¼Œå¹¶ä¸ä¼šé©¬ä¸Šè·³å‡ºå½“å‰æ–¹æ³•æˆ–ç»ˆæ­¢çº¿ç¨‹ã€‚</p><h3 id="AIæ€»ç»“ä¸»é¡µé¢åŠŸèƒ½"><a href="#AIæ€»ç»“ä¸»é¡µé¢åŠŸèƒ½" class="headerlink" title="AIæ€»ç»“ä¸»é¡µé¢åŠŸèƒ½"></a>AIæ€»ç»“ä¸»é¡µé¢åŠŸèƒ½</h3><p>â€‹åé¢å°±æ ¹æ®è¿™äº›åŠŸèƒ½ï¼Œå¼€å§‹è¿›è¡Œåˆ†å—è®²è§£ï¼ŒåŒ…æ‹¬ä»£ç è·Ÿè¸ªè®²è§£ï¼Œè¿™æ ·ä¼šæ›´åŠ è®©æˆ‘ä¸“æ³¨äºåŠŸèƒ½çš„å®ç°ã€‚</p><blockquote><h3 id="1-ç•Œé¢åˆå§‹åŒ–å’Œè§†å›¾ç»‘å®š"><a href="#1-ç•Œé¢åˆå§‹åŒ–å’Œè§†å›¾ç»‘å®š" class="headerlink" title="1. ç•Œé¢åˆå§‹åŒ–å’Œè§†å›¾ç»‘å®š"></a>1. ç•Œé¢åˆå§‹åŒ–å’Œè§†å›¾ç»‘å®š</h3><ul><li><strong>åŠ è½½ç•Œé¢å¸ƒå±€</strong>ï¼ˆ<code>setContentView</code>ï¼‰ï¼Œè®©é¡µé¢æ˜¾ç¤ºå‡ºæ¥</li><li><strong>æŸ¥æ‰¾å¹¶ç»‘å®šæ§ä»¶</strong>ï¼Œæ¯”å¦‚logoå›¾æ ‡ã€æŒ‰é’®ã€ä¹¦æ¶åˆ—è¡¨ç­‰</li><li><strong>åˆå§‹åŒ–ä¹¦æ¶é€‚é…å™¨</strong>ï¼Œç®¡ç†ä¹¦ç±åˆ—è¡¨çš„æ˜¾ç¤º</li></ul><h3 id="2-æ•°æ®å±•ç¤ºå’Œåˆ·æ–°"><a href="#2-æ•°æ®å±•ç¤ºå’Œåˆ·æ–°" class="headerlink" title="2. æ•°æ®å±•ç¤ºå’Œåˆ·æ–°"></a>2. æ•°æ®å±•ç¤ºå’Œåˆ·æ–°</h3><ul><li><strong>å±•ç¤ºä¹¦æ¶åˆ—è¡¨æ•°æ®</strong>ï¼ŒæŠŠæ•°æ®åŠ è½½åˆ°ä¹¦æ¶é€‚é…å™¨é‡Œï¼Œæ˜¾ç¤ºåœ¨åˆ—è¡¨ä¸­</li><li><strong>æ”¯æŒä¸‹æ‹‰åˆ·æ–°</strong>ï¼Œç”¨æˆ·ä¸‹æ‹‰åˆ—è¡¨æ—¶ï¼Œé‡æ–°è¯·æ±‚æ•°æ®ï¼Œåˆ·æ–°ä¹¦æ¶å†…å®¹</li><li><strong>åˆ·æ–°è¿›åº¦åé¦ˆ</strong>ï¼Œé€šè¿‡è¿›åº¦æ¡æ˜¾ç¤ºåˆ·æ–°è¿›åº¦ï¼Œæé«˜ç”¨æˆ·ä½“éªŒ</li></ul><h3 id="3-ç”¨æˆ·äº¤äº’å¤„ç†"><a href="#3-ç”¨æˆ·äº¤äº’å¤„ç†" class="headerlink" title="3. ç”¨æˆ·äº¤äº’å¤„ç†"></a>3. ç”¨æˆ·äº¤äº’å¤„ç†</h3><ul><li><strong>æŒ‰é’®ç‚¹å‡»äº‹ä»¶</strong><ul><li>ç‚¹å‡»â€œè®¾ç½®â€æŒ‰é’®å¼¹å‡ºä»£ç†è®¾ç½®çª—å£</li><li>ç‚¹å‡»â€œä¸‹è½½â€æŒ‰é’®å¼¹å‡ºä¸‹è½½åˆ—è¡¨</li><li>ç‚¹å‡»â€œæ‰“èµâ€æŒ‰é’®è§¦å‘æ‰“èµæ“ä½œï¼ˆè¿™é‡Œæ²¡å®ç°å…·ä½“é€»è¾‘ï¼‰</li><li>ç‚¹å‡»â€œä¹¦åº“â€æŒ‰é’®è¿›å…¥ä¹¦åº“é¡µé¢</li><li>ç‚¹å‡»â€œæ·»åŠ ä¹¦ç±â€æŒ‰é’®è¿›å…¥å¯¼å…¥ä¹¦ç±é¡µé¢</li></ul></li><li><strong>ä¹¦æ¶ä¹¦ç±ç‚¹å‡»</strong><ul><li>ç‚¹å‡»ä¹¦ç±è·³è½¬åˆ°é˜…è¯»é¡µé¢ï¼Œæ‰“å¼€ä¹¦ç±</li><li>é•¿æŒ‰ä¹¦ç±è·³è½¬åˆ°ä¹¦ç±è¯¦æƒ…é¡µé¢ï¼Œå¸¦åŠ¨ç”»æ•ˆæœ</li></ul></li></ul><h3 id="4-å¼¹çª—ä¸æç¤º"><a href="#4-å¼¹çª—ä¸æç¤º" class="headerlink" title="4. å¼¹çª—ä¸æç¤º"></a>4. å¼¹çª—ä¸æç¤º</h3><ul><li>å¼¹å‡ºä»£ç†è®¾ç½®å’Œä¸‹è½½åˆ—è¡¨å¼¹çª—ï¼Œæ–¹ä¾¿ç”¨æˆ·æ“ä½œ</li><li>è­¦å‘Šä¿¡æ¯æ¡†çš„æ˜¾ç¤ºå’Œå…³é—­ï¼Œæé†’ç”¨æˆ·é‡è¦ä¿¡æ¯</li></ul><h3 id="5-ç”Ÿå‘½å‘¨æœŸä¸é€€å‡º"><a href="#5-ç”Ÿå‘½å‘¨æœŸä¸é€€å‡º" class="headerlink" title="5. ç”Ÿå‘½å‘¨æœŸä¸é€€å‡º"></a>5. ç”Ÿå‘½å‘¨æœŸä¸é€€å‡º</h3><ul><li>ç›‘å¬æ‰‹æœºè¿”å›é”®ï¼Œé˜²æ­¢è¯¯æ“ä½œé€€å‡º</li><li>å®ç°â€œåŒå‡»è¿”å›é”®é€€å‡ºç¨‹åºâ€çš„é€»è¾‘ï¼Œæé«˜ç”¨æˆ·ä½“éªŒ</li><li>é€€å‡ºæ—¶é‡Šæ”¾èµ„æºï¼Œé˜²æ­¢å†…å­˜æ³„æ¼</li></ul><p>â€‹</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;â€‹	æ¬¢è¿é¡µå¼€å§‹åï¼Œå°±è¿›å…¥ä¸»ä½“&lt;strong&gt;MainActivity&lt;/strong&gt;ä¸­ï¼ŒæŸ¥çœ‹æºç å¯ä»¥å‘ç°ï¼Œå…¶ä½¿ç”¨äº†ä¼—å¤šè‡ªå®šä¹‰çš„å…¶ä»–ç±»ã€‚&lt;/p&gt;
&lt;p&gt;â€‹	&lt;/p&gt;
&lt;h3 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°</summary>
      
    
    
    
    <category term="å¼€å‘" scheme="http://bumak.github.io/categories/%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="å®‰å“å¼€å‘å­¦ä¹ " scheme="http://bumak.github.io/tags/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>é˜…è¯»APPé¡¹ç›®å­¦ä¹ â€”â€”1</title>
    <link href="http://bumak.github.io/2025/06/21/%E9%98%85%E8%AF%BB%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0/%E5%AE%89%E5%8D%93%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A01/"/>
    <id>http://bumak.github.io/2025/06/21/%E9%98%85%E8%AF%BB%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0/%E5%AE%89%E5%8D%93%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A01/</id>
    <published>2025-06-21T13:41:02.267Z</published>
    <updated>2025-06-23T04:55:07.314Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>â€‹è¯¥é˜…è¯»é¡¹ç›®æ˜¯<a href="https://github.com/ZhangQinhao/MONKOVEL">MONKOVEL</a>ï¼Œæˆ‘å°†åˆ†æå­¦ä¹ å…¶é¡¹ç›®è®¾è®¡å’ŒJAVAä»£ç ï¼Œæˆ‘æ²¡ä»€ä¹ˆè¯­è¨€åŸºç¡€ï¼Œä¹Ÿæ²¡æœ‰å¼€å‘ç»éªŒï¼Œæ­¤ç³»åˆ—å°†è®°å½•æˆ‘åœ¨è¿™ä¸ªé¡¹ç›®ä¸­è‡ªå­¦åˆ°çš„çŸ¥è¯†ã€‚</p><p>â€‹</p><h1 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h1><p>â€‹å…ˆçœ‹åˆ°<code>AndroidManifest.xml</code>æ–‡ä»¶ï¼ŒæŸ¥çœ‹APPå­˜åœ¨å¤šå°‘ä¸ªActivityï¼ˆç•Œé¢ï¼‰ï¼š<code>WelcomeActivity</code>ç±»è´Ÿè´£æ¬¢è¿ç•Œé¢ï¼Œå®ç°ä¸€ä¸ªåŠ¨ç”»çš„æ•ˆæœã€‚</p><figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">activity</span></span><br><span class="hljs-tag">            <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;.view.impl.WelcomeActivity&quot;</span></span><br><span class="hljs-tag">            <span class="hljs-attr">android:screenOrientation</span>=<span class="hljs-string">&quot;portrait&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">intent-filter</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">action</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.intent.action.MAIN&quot;</span> /&gt;</span><br><br>                <span class="hljs-tag">&lt;<span class="hljs-name">category</span> <span class="hljs-attr">android:name</span>=<span class="hljs-string">&quot;android.intent.category.LAUNCHER&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">intent-filter</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">activity</span>&gt;</span><br></code></pre></td></tr></table></figure><p>â€‹ä¹‹åä¼šè·³è½¬åˆ°ä¸»ç•Œé¢ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onAnimationEnd</span><span class="hljs-params">(Animator animation)</span> &#123;<br>                startActivityByAnim(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(WelcomeActivity.<span class="hljs-built_in">this</span>, MainActivity.class), android.R.anim.fade_in, android.R.anim.fade_out);<br>                finish();<br>            &#125;<br></code></pre></td></tr></table></figure><p>â€‹<code>MainActivity</code>è´Ÿè´£ä¸»é¡µé¢çš„å‘ˆç°ï¼Œå±•ç¤ºä»å„ä¸ªç½‘ç«™è§£ææ¥çš„ä¹¦ç±ï¼›<code>SearchActivity</code>ç±»è´Ÿè´£å…³é”®è¯æœç´¢ï¼Œå¯èƒ½ä¼šè°ƒç”¨ç½‘ç»œæ¥å£æˆ–æœ¬åœ°æ•°æ®åº“æŸ¥è¯¢ï¼›<code>DownloadService</code>è´Ÿè´£åå°ä¸‹è½½ä»»åŠ¡ï¼Œé€šå¸¸æ˜¯serviceç±»å‹ï¼Œä¸é˜»å¡UIï¼Œç®¡ç†ä¸‹è½½é˜Ÿåˆ—ï¼Œå¤„ç†æ–­ç‚¹ç»­ä¼ ç­‰ç­‰ï¼›è¿˜æœ‰<code>LibraryActivity</code>ä¹¦æ¶é¡µé¢ã€<code>ChoiceBookActivity</code>ä¹¦ç±é€‰æ‹©é¡µé¢ã€<code>BookDetailActivity</code>ä¹¦çš„è¯¦ç»†è¯¦ç»†ã€<code>ReadBookActivity</code>è´Ÿè´£é˜…è¯»ç•Œé¢ã€<code>ImportBookActivity</code>è´Ÿè´£æœ¬åœ°å¯¼å…¥ä¹¦ç±ã€‚</p><h2 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h2><p>â€‹é¦–å…ˆå¯ä»¥å•ç‹¬å¤ç°å‡ºwelcomeç•Œé¢ï¼Œå…ˆå¤„ç†å¥½xmlæ–‡ä»¶ï¼Œä¼šéœ€è¦å¯¼å…¥åŒ…ï¼šæ³¨æ„æ–°çš„å†™æ³•æ˜¯<code>implementation(&quot;...&quot;)</code>ã€‚å†™å…¥<code>activity_welcome.xml</code>æ–‡ä»¶ï¼Œå¤åˆ¶å›¾ç‰‡èµ„æºåˆ°resç›®å½•ä¸‹ï¼Œæ”¹å†™ç³»ç»Ÿé»˜è®¤çš„<code>AndroidManifest.xml</code>æ–‡ä»¶ï¼Œåˆ é™¤ç³»ç»Ÿç»™çš„<code>MainActivity</code>éƒ¨åˆ†ã€‚åé¢ä»<code>view.impl.WelcomeActivity</code>å¼€å§‹æ…¢æ…¢æŠ„å…¥å…¶ä»–æ–‡ä»¶ï¼Œæš‚æ—¶ä¸éœ€è¦çš„åŠŸèƒ½å¯ä»¥æ³¨é‡Šæ‰ã€‚</p><p>â€‹</p><h3 id="MVPæ¶æ„"><a href="#MVPæ¶æ„" class="headerlink" title="MVPæ¶æ„"></a>MVPæ¶æ„</h3><p>â€‹å®ç°<code>IView</code>å’Œ<code>IPresenter</code>æ¥å£ï¼Œè¿™æ˜¯MVPè®¾è®¡æ¶æ„ä¸­å¸¸è§çš„åŸºç¡€æ¥å£ã€‚</p><blockquote><p>MVPçš„æ€æƒ³æ˜¯ï¼šViewï¼ˆè§†å›¾ï¼‰ï¼šè´Ÿè´£â€œæ˜¾ç¤ºâ€å’Œâ€œç”¨æˆ·äº¤äº’â€ã€‚</p><p>â€‹Presenterï¼ˆä¸­é—´äººï¼‰ï¼šè´Ÿè´£â€œå¤„ç†é€»è¾‘â€å’Œâ€œæ²Ÿé€šâ€ã€‚</p><p>â€‹Modelï¼ˆæ¨¡å‹ï¼‰ï¼šè´Ÿè´£â€œæ•°æ®å’Œä¸šåŠ¡é€»è¾‘â€ã€‚</p><p>MVP å°±æ˜¯æŠŠâ€œæ˜¾ç¤ºç•Œé¢â€å’Œâ€œä¸šåŠ¡é€»è¾‘â€æ‹†å¼€ï¼Œè®©ä»£ç æ›´æ•´æ´ã€æ›´å®¹æ˜“ç»´æŠ¤</p></blockquote><blockquote><h4 id="çœŸå®å¼€å‘ä¸­ï¼š"><a href="#çœŸå®å¼€å‘ä¸­ï¼š" class="headerlink" title="çœŸå®å¼€å‘ä¸­ï¼š"></a>çœŸå®å¼€å‘ä¸­ï¼š</h4><ul><li>ä½ çš„æ‰‹æœºç•Œé¢å°±æ˜¯ Viewï¼Œè´Ÿè´£æ˜¾ç¤ºæŒ‰é’®ã€åˆ—è¡¨ç­‰</li><li>ä»£ç é‡Œå†™çš„ Presenter è´Ÿè´£ç›‘å¬æŒ‰é’®ï¼Œå¤„ç†ä¸šåŠ¡é€»è¾‘</li><li>Model è´Ÿè´£æ•°æ®å­˜å–ï¼Œæ¯”å¦‚ä»æ•°æ®åº“æ‹¿æ•°æ®ï¼Œæˆ–è€…è°ƒç”¨ç½‘ç»œæ¥å£</li></ul></blockquote><p>â€‹</p><p>â€‹</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IView</span> &#123;<br>    <span class="hljs-keyword">public</span> Context <span class="hljs-title function_">getContext</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹çœ‹åˆ°<code>IView</code>çš„æ¥å£æ–¹æ³•ï¼Œ<code>getContext</code>æ–¹æ³•ï¼Œä»€ä¹ˆæ˜¯Contextï¼Ÿçœ‹ä¸€ä¸‹ChatGptçš„çœ‹æ³•ã€‚</p><blockquote><ul><li><strong>Context å°±åƒæ‰‹æœºé‡Œçš„â€œä¸‡èƒ½é’¥åŒ™â€æˆ–è€…â€œå·¥å…·ç®±â€</strong>ï¼Œå®ƒå‘Šè¯‰ä½ â€œç°åœ¨åœ¨å“ªä¸ªç¯å¢ƒä¸‹â€ï¼Œå¯ä»¥å¸®ä½ è®¿é—®å¾ˆå¤šç³»ç»ŸæœåŠ¡ã€èµ„æºï¼Œç”šè‡³æ‰“å¼€æ–°é¡µé¢ã€æ˜¾ç¤ºæç¤ºæ¶ˆæ¯ã€‚</li><li>å‡è®¾ä½ åœ¨ä¸€ä¸ªå¤§å•†åœºé‡Œï¼ŒContext å°±åƒä½ çš„å•†åœºä¼šå‘˜å¡ï¼Œä½ æ‹¿ç€ä¼šå‘˜å¡ï¼Œå•†åœºæ‰çŸ¥é“ä½ æ˜¯è°ã€ä½ åœ¨å“ªä¸ªåº—é“ºã€ä½ å¯ä»¥ç”¨å“ªäº›ä¼˜æƒ ï¼Œé€šè¿‡ä¼šå‘˜å¡ï¼Œä½ å¯ä»¥å»ä¸åŒçš„æŸœå°ï¼ˆæœåŠ¡ï¼‰åŠäº‹æƒ…ï¼Œæ¯”å¦‚ä¹°ä¸œè¥¿ã€é€€è´§ã€æŸ¥ä½™é¢ã€‚</li><li>åœ¨ä»£ç é‡Œ Context èƒ½åšä»€ä¹ˆï¼Ÿæ‰“å¼€æ–°ç•Œé¢ã€æ˜¾ç¤ºå¼¹çª—ã€è®¿é—®èµ„æºã€è·å–ç³»ç»ŸæœåŠ¡ï¼ˆæ¯”å¦‚ç½‘ç»œã€ä¼ æ„Ÿå™¨ï¼‰ã€è®¿é—®æ–‡ä»¶ã€æ•°æ®åº“ç­‰ç­‰ã€‚</li><li>ä¸¾ä¸ªç®€å•ä¾‹å­ï¼Œ<code>Toast.makeText(context, &quot;Hello!&quot;, Toast.LENGTH_SHORT).show();</code>ï¼Œè¿™å¥è¯çš„ <code>context</code> å°±å‘Šè¯‰ç³»ç»Ÿï¼Œâ€œä½ ç°åœ¨åœ¨å“ªä¸ªç¯å¢ƒä¸‹æ˜¾ç¤ºè¿™ä¸ªå¼¹çª—â€ï¼Œç³»ç»Ÿæ‰èƒ½æ­£ç¡®åœ°æŠŠå¼¹çª—æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚</li><li>å¸¸è§çš„ Context ç±»å‹ï¼š<strong>Activity</strong>ï¼Œå®ƒæœ¬èº«å°±æ˜¯ä¸€ä¸ª Contextï¼Œä»£è¡¨ä¸€ä¸ªç•Œé¢ï¼›<strong>Application</strong>ï¼Œæ•´ä¸ªåº”ç”¨ç¨‹åºçš„å…¨å±€ Contextï¼›<strong>Service</strong>ï¼Œåå°æœåŠ¡çš„ Contextã€‚</li></ul></blockquote><p>â€‹<code>getContext</code>æ˜¯ç»™è°ç”¨çš„ï¼Ÿâ€”â€”â€”â€”ç»™ <strong>Presenterï¼ˆä¸šåŠ¡é€»è¾‘å±‚ï¼‰ç”¨çš„</strong>ï¼ŒPresenter é€šè¿‡ <code>IView.getContext()</code> æ‹¿åˆ°è¿™ä¸ªç¯å¢ƒï¼ˆContextï¼‰ï¼Œå°±èƒ½åšå¾ˆå¤šäº‹æƒ…ã€‚</p><p>â€‹çœ‹çœ‹ä¾‹å­ï¼Œå¾ˆæ¸…æ¥šã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainPresenter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IPresenter</span> &#123;<br>    <span class="hljs-keyword">private</span> IView view;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">attachView</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> IView iView)</span> &#123;<br>        <span class="hljs-built_in">this</span>.view = iView;<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">detachView</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">this</span>.view = <span class="hljs-literal">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">showMessage</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// é€šè¿‡viewæ‹¿Contextæ¥æ˜¾ç¤ºToast</span><br>        Toast.makeText(view.getContext(), <span class="hljs-string">&quot;Hello MVP!&quot;</span>, Toast.LENGTH_SHORT).show();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IPresenter</span> &#123;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ³¨å…¥Viewï¼Œä½¿ä¹‹èƒ½å¤Ÿä¸Viewç›¸äº’å“åº”</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">attachView</span><span class="hljs-params">(<span class="hljs-meta">@NonNull</span> IView iView)</span>;<br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * é‡Šæ”¾èµ„æºï¼Œå¦‚æœä½¿ç”¨äº†ç½‘ç»œè¯·æ±‚ å¯ä»¥åœ¨æ­¤æ‰§è¡ŒIModel.cancelRequest()</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">detachView</span><span class="hljs-params">()</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹çœ‹åˆ°<code>IPresenter</code>æ¥å£ï¼Œ<code>attachview</code>å°±æ˜¯æä¾›çš„ç”¨æ¥ç»‘å®šviewå’Œpresenterçš„æ–¹æ³•ã€‚</p><p>â€‹ä»€ä¹ˆæ—¶å€™ä¼šè°ƒç”¨ï¼Ÿ  ä¸€èˆ¬æ˜¯åœ¨ç•Œé¢åˆšåˆ›å»ºæˆ–åˆšå‡†å¤‡å¥½è·Ÿ Presenter äº¤äº’çš„æ—¶å€™è°ƒç”¨ï¼Œæ¯”å¦‚ <code>Activity</code> çš„ <code>onCreate()</code> æˆ– <code>onStart()</code> é‡Œã€‚</p><p>â€‹è°æ¥è°ƒç”¨ï¼Ÿ  é€šå¸¸æ˜¯ <strong>Viewï¼ˆç•Œé¢å±‚ï¼Œæ¯”å¦‚ Activityï¼‰è‡ªå·±è°ƒç”¨</strong>ï¼Œæˆ–è€…æœ‰æ—¶æ˜¯åœ¨åˆ›å»º Presenter çš„æ—¶å€™ç”±æ¡†æ¶æˆ–ä»£ç è°ƒç”¨ã€‚</p><p>â€‹ä¸ºä»€ä¹ˆï¼Ÿ  å› ä¸º Presenter éœ€è¦çŸ¥é“å®ƒæœåŠ¡çš„æ˜¯å“ªä¸ª Viewï¼Œæ‰èƒ½è®© View æ˜¾ç¤ºæ•°æ®æˆ–è€…å“åº”ç”¨æˆ·æ“ä½œã€‚</p><p>â€‹ä¸‹é¢æ˜¯AIä¸¾å¾—å°ä¾‹å­ï¼Œå¾ˆäº†ç„¶äº†ã€‚</p><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IView</span> &#123;<br>    <span class="hljs-keyword">private</span> IPresenter presenter;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> &#123;<br>        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);<br>        setContentView(R.layout.activity_main);<br>        presenter = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MainPresenter</span>();<br>        presenter.attachView(<span class="hljs-built_in">this</span>);  <span class="hljs-comment">// æŠŠè‡ªå·±ï¼ˆViewï¼‰ä¼ ç»™Presenterï¼Œç»‘å®šå…³ç³»å»ºç«‹</span><br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onDestroy</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">super</span>.onDestroy();<br>        presenter.detachView();  <span class="hljs-comment">// è§£ç»‘ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼</span><br>    &#125;<br>    <span class="hljs-comment">// å®ç°IViewçš„æ–¹æ³•</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Context <span class="hljs-title function_">getContext</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>â€‹æˆ‘ä»¬æŸ¥çœ‹presenterå’Œviewæ–‡ä»¶å¤¹ä¹Ÿå‘ç°äº†è¿™ä¸ªä¸€ä¸€å¯¹åº”çš„å…³ç³»ï¼Œé™¤äº†æ¬¢è¿ç•Œé¢ï¼ˆå› ä¸ºæ²¡æœ‰äº¤äº’ï¼Œæ‰€ä»¥ä¸éœ€è¦ï¼‰ã€‚</p><p><img src="/pictures/novelReader_app/image-20250621210554075.png" alt="image-20250621210554075"></p><h3 id="å…¶ä»–å­ç±»è®¾è®¡"><a href="#å…¶ä»–å­ç±»è®¾è®¡" class="headerlink" title="å…¶ä»–å­ç±»è®¾è®¡"></a>å…¶ä»–å­ç±»è®¾è®¡</h3><p>â€‹<code>BaseApplication</code>åŸºç¡€ç±»ã€‚</p><p>â€‹<code>AppActivityManager</code>æ˜¯ä¸€ä¸ªâ€œActivityç®¡ç†å·¥å…·ç±»â€ï¼šè®°å½•ã€ç®¡ç†å½“å‰æ‰€æœ‰çš„Activityï¼Œèƒ½å…³é—­æŒ‡å®šçš„Activityã€èƒ½åˆ¤æ–­Activityæ˜¯å¦å­˜åœ¨ã€é€šè¿‡å¼±å¼•ç”¨é¿å…å†…å­˜æ³„éœ²ã€‚</p><p>â€‹<code>BaseActivity</code>æ˜¯â€œé€šç”¨Activityæ¨¡æ¿â€ï¼Œå®ƒå°è£…äº† Activity å¸¸ç”¨çš„åŠŸèƒ½ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€å’Œ Presenter çš„ç»‘å®šé€»è¾‘ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯ï¼šæŠŠæ¯ä¸ªé¡µé¢éƒ½è¦é‡å¤å†™çš„ä»£ç ï¼ˆå¦‚å›ºå®šçš„æ–¹æ³•è°ƒç”¨ï¼ŒActivityè½¬åœºåŠ¨ç”»è°ƒç”¨ç­‰ç­‰ï¼‰ï¼Œç»Ÿä¸€å†™åœ¨è¿™ä¸ªâ€œçˆ¶ç±»â€é‡Œï¼Œå­ç±»åªéœ€è¦å…³æ³¨é¡µé¢è‡ªå·±çš„åŠŸèƒ½å®ç°ï¼Œçœæ—¶çœåŠ›ï¼</p><p>â€‹<code>MBaseActivity</code>æ˜¯ç»§ç»­æ·»åŠ å‹ç›Ÿç»Ÿè®¡çš„ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œèƒ½å¤Ÿç»Ÿè®¡ç”¨æˆ·çš„ä½¿ç”¨æƒ…å†µã€‚</p><p>â€‹</p><p>â€‹å†æŠ„ä¸‹<code>activity_welcome.xml</code>å¸ƒå±€æ–‡ä»¶ï¼Œåº”è¯¥å°±å¯ä»¥å±•ç¤ºç¬¬ä¸€ä¸ªç•Œé¢çš„æ•ˆæœäº†ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;â€‹	è¯¥é˜…è¯»é¡¹ç›®æ˜¯&lt;a href=&quot;https://github.com/ZhangQinhao/MONKOVEL&quot;&gt;MONKOVEL&lt;/a&gt;</summary>
      
    
    
    
    <category term="å¼€å‘" scheme="http://bumak.github.io/categories/%E5%BC%80%E5%8F%91/"/>
    
    
    <category term="å®‰å“å¼€å‘å­¦ä¹ " scheme="http://bumak.github.io/tags/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>ISCTF2024</title>
    <link href="http://bumak.github.io/2025/06/05/ISCTF2024/RE/"/>
    <id>http://bumak.github.io/2025/06/05/ISCTF2024/RE/</id>
    <published>2025-06-05T03:42:59.000Z</published>
    <updated>2025-07-01T06:15:32.766Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Ezre"><a href="#Ezre" class="headerlink" title="Ezre"></a>Ezre</h1><blockquote><p>â€‹ä¸€ä¸ªç®€å•çš„ç»´å‰å°¼äºšåŠ å¯†ï¼Œçœ‹äº†åŠå¤©æ²¡çœ‹å‡ºæ¥ï¼Œåœ¨å¼ºè¡Œå†™è§£å¯†ç®—æ³•åï¼Œæ‰çªç„¶å‘ç°ã€‚</p></blockquote><hr><h1 id="ã€Šå›å¿†å®‰é­‚æ›²ã€‹ä¸‰â€”â€”mainn-exe"><a href="#ã€Šå›å¿†å®‰é­‚æ›²ã€‹ä¸‰â€”â€”mainn-exe" class="headerlink" title="ã€Šå›å¿†å®‰é­‚æ›²ã€‹ä¸‰â€”â€”mainn.exe"></a>ã€Šå›å¿†å®‰é­‚æ›²ã€‹ä¸‰â€”â€”mainn.exe</h1><blockquote><p>â€‹è¿·å®«ç±»é¢˜ç›®ï¼Œæ— å£³64ä½ã€‚æ§½ç‚¹å°±æ˜¯å°†ç§»åŠ¨é”®æ¢æˆäº†â€œloveâ€å››ä¸ªå­—ç¬¦ï¼Œç„¶åè¿·å®«å¯¹åº”çš„å­—ç¬¦ä¸²åœ¨ç»“å°¾å¤šç»™äº†å‡ ä¸ªï¼Œèµ·åˆ°è¿·æƒ‘æ€§æ•ˆæœï¼Œå·®ç‚¹è®©æˆ‘æä¸æ¸…è¡Œåˆ—æ•°ï¼Œè¿˜æœ‰è¡Œåæ ‡ä»0å¼€å§‹ï¼Œåˆ—åæ ‡ä»0å¼€å§‹ï¼Œèµ·å§‹ç‚¹åæ ‡ï¼ˆ1ï¼Œ1ï¼‰ã€‚å¼€å§‹ç›´æ¥æŠŠæˆ‘ç»•æ™•ã€‚</p><p>â€‹ç¡®å®šè¿·å®«åï¼Œåˆå¤ä¹ äº†DFSç®—æ³•ã€‚æ”¶è·ä¸å°‘ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">maze_str = <span class="hljs-string">&quot;&quot;&quot;###############################P#...............#...#.......#.#####.###.#####.#.###.#####.#.....#...#.#.....#...#.#...#.#####.#.###.#.#######.#.#.###.#C..#.#.#...#.#...#...#.#.#...#.#.#.#.#.###.#.#.#.###.#.#.#.#.#.#.#.#...#...#.#.......#.#.#.###.#.###.#####.#########.###.#...#...#.....#.#.......#...#.#.#####.#####.#.#.#####.###.#...#...#...#...#...#...#.#...#.###.#.###.#.#######.#.#.#.#.#...#.#.#...#.#...#...#...#.#.###.#.#.#####.#.#.#.#######.###.#...#.....#...#.#.#...#.....#.#########.#####.#.###.#.###.#.#.....#.#...#...#...#...#.#.#.#.#.#.#.###.#.#####.###.#.#.#...#.#...#.#...#...#...#...#.#.###.###.#.#####.#.###.###.#.#...#.#.#.......#.#...#.#...#.#####.#.#######.#.#####.#.###.#...#.#.......#.#...#...#.#..E#.#.#.#.#######.###.#.#####.#.#.#...#.............#.....#.#.#.###############.#######.#.#.#.........#...#...#.....#...#.#.#######.#.#.#####.#.#######.#.......#...#.......#.........&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>        <span class="hljs-built_in">print</span>(maze_str[i*<span class="hljs-number">30</span>+j], end=<span class="hljs-string">&#x27; &#x27;</span>)<br>    <span class="hljs-built_in">print</span>()<br><br><br>maze = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>    maze_row = []<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>        maze_row.append(maze_str[i*<span class="hljs-number">30</span>+j])<br>    maze.append(maze_row)<br><br>start = (<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dfs</span>(<span class="hljs-params">maze, x, y,path</span>):<br>    <span class="hljs-keyword">if</span> maze[x][y] == <span class="hljs-string">&#x27;E&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">if</span> x &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> x &gt;= <span class="hljs-built_in">len</span>(maze) <span class="hljs-keyword">or</span> y &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> y &gt;= <span class="hljs-built_in">len</span>(maze[<span class="hljs-number">0</span>]) <span class="hljs-keyword">or</span> maze[x][y] == <span class="hljs-string">&#x27;#&#x27;</span> <span class="hljs-keyword">or</span> maze[x][y] == <span class="hljs-string">&#x27;C&#x27;</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br>    maze[x][y] = <span class="hljs-string">&#x27;#&#x27;</span><br><br>    directions = [(-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>), (<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>), (<span class="hljs-number">1</span>,<span class="hljs-number">0</span>), (<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)]<br>    directions_str = [<span class="hljs-string">&#x27;l&#x27;</span>, <span class="hljs-string">&#x27;v&#x27;</span>, <span class="hljs-string">&#x27;o&#x27;</span>, <span class="hljs-string">&#x27;e&#x27;</span>]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>        dx = directions[i][<span class="hljs-number">0</span>]<br>        dy = directions[i][<span class="hljs-number">1</span>]<br>        path.append(directions_str[i])<br>        <span class="hljs-keyword">if</span> dfs(maze, x+dx, y+dy,path):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        path.pop()<br><br>    maze[x][y] = <span class="hljs-string">&#x27;.&#x27;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_path</span>():<br>    path = []<br>    <span class="hljs-keyword">if</span> dfs(maze, start[<span class="hljs-number">0</span>], start[<span class="hljs-number">1</span>], path):<br>        <span class="hljs-keyword">return</span> path<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;No path found&quot;</span><br><br>ans = find_path()<br>ans = <span class="hljs-string">&#x27;&#x27;</span>.join(ans)<br><span class="hljs-built_in">print</span>(ans)<br></code></pre></td></tr></table></figure><hr><h1 id="æ‰¾å•Šæ‰¾â€”â€”zhao-exe"><a href="#æ‰¾å•Šæ‰¾â€”â€”zhao-exe" class="headerlink" title="æ‰¾å•Šæ‰¾â€”â€”zhao.exe"></a><strong>æ‰¾å•Šæ‰¾</strong>â€”â€”zhao.exe</h1><blockquote><p>â€‹ç›´æ¥æ‹–å…¥IDAå‘ç°åªæœ‰å¾ˆå°‘å‡ ä¸ªå‡½æ•°ï¼Œäºæ˜¯å»æŸ¥å£³å‘ç°UPXå£³ï¼Œç„¶åç›´æ¥-dè„±å£³å¤±è´¥ï¼Œæ‹–å…¥HxDå‘ç°æ ‡å¿—ä½è¢«æ”¹æˆAPKäº†ï¼Œæ”¹å›æ¥å°±æˆåŠŸè„±å£³äº†ã€‚</p><p>â€‹å†æ‹–å…¥IDAä¸­å°±æ­£å¸¸äº†ï¼Œé€»è¾‘å¾ˆç®€å•ï¼ŒæŸ¥çœ‹åŠ å¯†é€»è¾‘ï¼Œå…ˆå¤§å°å†™å­—æ¯æ›¿æ¢ï¼Œå†å¼‚æˆ–ä¸€ä¸‹ã€‚é™æ€åˆ†ææ—¶ç›´æ¥å»æ•°æ®èŠ‚æŸ¥çœ‹æ—¶ï¼Œå¾—åˆ°ä¸€ç»„æ•°æ®ï¼Œç„¶åå†™pythonä»£ç ï¼Œè·‘å‡ºæ¥æç¤ºä¸ºé”™è¯¯çš„flagï¼Œæ˜¯å‡ºé¢˜äººæŒ–çš„ä¸€ä¸ªå‘ã€‚</p><p>â€‹åå¤æŸ¥çœ‹åŠ å¯†é€»è¾‘å‘ç°æ²¡æœ‰é—®é¢˜ï¼Œæœ€ååŠ¨æ€è°ƒè¯•ï¼Œåœ¨æ¯”è¾ƒä¹‹å‰æŸ¥çœ‹æ•°æ®ï¼Œå‘ç°ç¨‹åºé‡Œå­˜å‚¨çš„åŠ å¯†æ•°æ®è¢«æ”¹äº†ï¼Œçœ‹æ¥æ˜¯ç¨‹åºåœ¨è¿è¡Œåˆå§‹åŒ–æ—¶æ‰ç»™å‡ºçœŸæ­£çš„åŠ å¯†flagã€‚å–å‡ºæ•°æ®ï¼Œè·‘è§£å¯†è„šæœ¬å°±okäº†ã€‚</p><p>â€‹è¿˜æ˜¯åŠ¨è°ƒå‘ç°é—®é¢˜ã€‚</p></blockquote><hr><h1 id="pyä¸å¥½ï¼Œä¼šè¢«ban"><a href="#pyä¸å¥½ï¼Œä¼šè¢«ban" class="headerlink" title="pyä¸å¥½ï¼Œä¼šè¢«ban"></a>pyä¸å¥½ï¼Œä¼šè¢«ban</h1><blockquote><p>â€‹pythonçš„exeç¨‹åºã€‚å…ˆä½¿ç”¨Pyinstxtractorè§£å‡ºpycï¼Œç„¶åç›´æ¥æ‰˜åœ¨çº¿å¹³å°è§£å‡ºpyã€‚æˆ‘å¼€å§‹æ‰¾çš„å¹³å°è§£ä¸å‡ºæ¥ï¼Œæˆ‘è¿˜åœ¨çŒœæ˜¯ä¸æ˜¯é¢˜ç›®åŠ éš¾åº¦äº†ï¼Œå¯¼è‡´æ–‡ä»¶è¿›è¡Œäº†ä¸€å®šçš„ä¿®æ”¹ï¼Œä¸èƒ½ç›´æ¥è§£å‡ºæ¥ã€‚åŸæ¥æ˜¯å·¥å…·ä¸è¡Œï¼æœ€åçœ‹wpæ‰å‘ç°è¿™ä¸ªç½‘ç«™ã€‚</p><p>â€‹è§£å‡ºpyåç›´æ¥åå‘å†™è§£å¯†é€»è¾‘å³å¯è§£å¯†ã€‚</p></blockquote><hr><h1 id="ä½ çŸ¥é“-elfæ–‡ä»¶å—"><a href="#ä½ çŸ¥é“-elfæ–‡ä»¶å—" class="headerlink" title="ä½ çŸ¥é“.elfæ–‡ä»¶å—"></a>ä½ çŸ¥é“.elfæ–‡ä»¶å—</h1><blockquote><p>â€‹è·‘ä¸èµ·æ¥ï¼Œç­¾åˆ°é¢˜ï¼Œæ²¡æœ‰æŠ€æœ¯å«é‡ï¼Œç®—äº†ã€‚</p></blockquote><hr><h1 id="ã€Šå›å¿†å®‰é­‚æ›²ã€‹äºŒâ€”â€”test11"><a href="#ã€Šå›å¿†å®‰é­‚æ›²ã€‹äºŒâ€”â€”test11" class="headerlink" title="ã€Šå›å¿†å®‰é­‚æ›²ã€‹äºŒâ€”â€”test11"></a>ã€Šå›å¿†å®‰é­‚æ›²ã€‹äºŒâ€”â€”test11</h1><blockquote><p>â€‹ä¸€ä¸ªELFæ–‡ä»¶ï¼Œä½¿ç”¨IDAè¿œç¨‹è°ƒè¯•ï¼Œæ”¶è·åˆ°äº†IDAè°ƒè¯•ELFç¨‹åºçš„æ–¹æ³•ï¼Œè¿›ä¸€æ­¥å¢åŠ äº†åŠ¨æ€è°ƒè¯•çš„ç»éªŒï¼Œè®¤è¯†åˆ°ä¸€ç§å¹²æ‰°ç¼–è¯‘çš„æ–¹æ³•ï¼Œå°±æ˜¯åœ¨è°ƒç”¨ç¨‹åºæ—¶ï¼Œä¸ç›´æ¥ä½¿ç”¨callï¼Œè€Œæ˜¯å°†å‡½æ•°é¦–åœ°å€åŠ è½½è¿›å¯„å­˜å™¨ï¼Œç„¶åä½¿ç”¨callå¯„å­˜å™¨è°ƒç”¨ï¼Œè¿™æ ·IDAåˆ†æä¸å‡ºæ¥ï¼Œåªæœ‰åŠ¨è°ƒèƒ½çœ‹åˆ°å…¶ä¸­çš„è·³è½¬é€»è¾‘ã€‚</p><p>â€‹æŸ¥é˜…çŸ¥é“ï¼Œè¿™æ˜¯ä¸€ç§â€œæ§åˆ¶æµå¹³å¦åŒ–â€çš„åç¼–è¯‘æŠ€æœ¯ï¼Œé€šè¿‡ä¸»åˆ†å‘å™¨æ¥æ§åˆ¶ç¨‹åºåŸºæœ¬å—çš„æ‰§è¡Œæµç¨‹ã€‚</p><p>â€‹å¾—çŸ¥flagé•¿åº¦ä¸º36ä½ï¼Œç„¶åencåŠ å¯†ï¼ŒåŠ¨æ€è°ƒè¯•åˆ†æåŠ å¯†é€»è¾‘ã€‚ç¡®å®šæ˜¯é€å­—èŠ‚åŠ å¯†ï¼Œå‡è®¾å½“å‰å­—ç¬¦ä¸‹æ ‡ä¸ºiï¼Œå­—ç¬¦ä¸²æ•°ç»„ä¸ºstrã€‚æœ‰ä¸ªå¯†é’¥keyä¸ºå­—ç¬¦ä¸²â€œi_can_reverse_but_i_can_not_have_youâ€œã€‚</p><p>â€‹æœ€ç»ˆå¾—åˆ°çš„åŠ å¯†æ•°æ®ä¸ºï¼š[234, 12, 26, 17, 246, 44, 29, 62, 23, 53, 49, 41, 244, 57, 57, 211, 195, 45, 0, 16, 48, 61, 204, 0, 211, 192, 75, 198, 17, 199, 41, 62, 186, 96, 144, 52]</p><ul><li>str[i] &#x3D; str[i] ^ (0x66 + i) ^ 0x52</li><li>str[i] &#x3D; str[i] + 6</li><li>str[i] &#x3D; str[i] ^ (key[i] + i)</li></ul></blockquote><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc = [<span class="hljs-number">234</span>, <span class="hljs-number">12</span>, <span class="hljs-number">26</span>, <span class="hljs-number">17</span>, <span class="hljs-number">246</span>, <span class="hljs-number">44</span>, <span class="hljs-number">29</span>, <span class="hljs-number">62</span>, <span class="hljs-number">23</span>, <span class="hljs-number">53</span>, <span class="hljs-number">49</span>, <span class="hljs-number">41</span>, <span class="hljs-number">244</span>, <span class="hljs-number">57</span>, <span class="hljs-number">57</span>, <span class="hljs-number">211</span>, <span class="hljs-number">195</span>, <span class="hljs-number">45</span>, <span class="hljs-number">0</span>, <span class="hljs-number">16</span>, <span class="hljs-number">48</span>, <span class="hljs-number">61</span>, <span class="hljs-number">204</span>, <span class="hljs-number">0</span>, <span class="hljs-number">211</span>, <span class="hljs-number">192</span>, <span class="hljs-number">75</span>, <span class="hljs-number">198</span>, <span class="hljs-number">17</span>, <span class="hljs-number">199</span>, <span class="hljs-number">41</span>, <span class="hljs-number">62</span>, <span class="hljs-number">186</span>, <span class="hljs-number">96</span>, <span class="hljs-number">144</span>, <span class="hljs-number">52</span>]<br>key = <span class="hljs-string">&#x27;i_can_reverse_but_i_can_not_have_you&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    enc[i] = (enc[i] ^ (<span class="hljs-built_in">ord</span>(key[i]) + i)) &amp; <span class="hljs-number">0xff</span><br>    enc[i] = (enc[i] - <span class="hljs-number">6</span>) &amp; <span class="hljs-number">0xff</span><br>    enc[i] = (enc[i] ^ <span class="hljs-number">0x52</span> ^(<span class="hljs-number">0x66</span> + i)) &amp; <span class="hljs-number">0xff</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>    <span class="hljs-comment">#ISCTF&#123;as_her_never_will_come_back!!&#125;</span><br></code></pre></td></tr></table></figure><hr><h1 id="ã€Šå›å¿†å®‰é­‚æ›²ã€‹å››â€”â€”æ–‡ä»¶å¤¹ï¼šåˆè¯†é£ä»™å„¿"><a href="#ã€Šå›å¿†å®‰é­‚æ›²ã€‹å››â€”â€”æ–‡ä»¶å¤¹ï¼šåˆè¯†é£ä»™å„¿" class="headerlink" title="ã€Šå›å¿†å®‰é­‚æ›²ã€‹å››â€”â€”æ–‡ä»¶å¤¹ï¼šåˆè¯†é£ä»™å„¿"></a>ã€Šå›å¿†å®‰é­‚æ›²ã€‹å››â€”â€”æ–‡ä»¶å¤¹ï¼šåˆè¯†é£ä»™å„¿</h1><blockquote><p>â€‹è§£å‹å¾—åˆ°ä¸€ä¸ªmain.pyå’Œsoæ–‡ä»¶ã€‚è¿™æ˜¯ä¸€ä¸ª<code>Cpython</code>é€†å‘é¢˜ï¼Œæˆ‘æ˜¯ç¬¬ä¸€æ¬¡é‡è§ï¼Œå…ˆè·Ÿç€WPå­¦ä¹ ï¼Œä½†æ˜¯ç¬¬ä¸€æ­¥é€šè¿‡pythonä¸­çš„<code>helpå‡½æ•°</code>æŸ¥çœ‹æ¨¡å—å°±å‡ºé—®é¢˜äº†ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Œå› ä¸ºå‡ ä¸ªè™šæ‹Ÿæœºçš„pythonç‰ˆæœ¬ä¸å¯¹ï¼Œéœ€è¦3.10çš„ï¼Œè€Œä¸”æœ¬æœºæ˜¯windowsç³»ç»Ÿï¼Œä¸€ç›´æ˜¯è¦ä¹ˆå¯¼å…¥é”™ç³»ç»Ÿtestæ¨¡å—ï¼Œè¦ä¹ˆå¯¼å…¥ä¸è¿›ï¼Œå”‰ï¼Œç¯å¢ƒæ„æ­»äººï¼ä¸‹è½½python3.10è¿˜æŠŠæˆ‘çš„ubuntu20.04ç»™å¹²å´©äº†ï¼Œè¢«æˆ‘ç›´æ¥åˆ äº†ã€‚<strong>ä¹‹åå†å¹²è¿™ç§æ´»è¦æ‹å¿«ç…§äº†</strong>ï¼æœ€ååœ¨ubuntu24.04ä¸­ä¸‹è½½å¥½äº†ï¼Œç„¶åå°±å¯¼å…¥è¿›å»äº†ã€‚çœŸçš„è¢«ç¯å¢ƒæŠ˜ç£¨æƒ¨äº†å•Šã€‚</p><p>â€‹çœ‹äº†æ•™ç¨‹ï¼Œéƒ½æ˜¯ç¥ä»™ï¼Œæœ‰çš„ç›´æ¥çŒœå‡ºåŠ å¯†ç®—æ³•ï¼Œæœ‰çš„ä¸€ç‚¹ç‚¹æ­»çœ‹IDAä¸­çš„å‡ åƒè¡Œ<code>Cythonä»£ç </code>ï¼Œæœ‰çš„å‡­ç©ºç”Ÿæˆäº†soå¯¹åº”çš„pythonæºä»£ç ã€‚ä¸€ä¸ªéƒ½è¡Œä¸é€šï¼Œæœ€ååœ¨ç½‘ä¸Šæ‰¾äº†ä¸ªAIä»£ç è°ƒæ•´ï¼ŒæŠŠåŸæœ¬çš„å‡ åƒè¡Œ<code>Cython</code>ç»™ä¼˜åŒ–äº†ï¼Œå‡ºäº†ä¸€ä¸ªç®€åŒ–çš„Cè¯­è¨€ç‰ˆï¼Œå¹¶ä¸”æ•´ç†å‡ºäº†æ ¸å¿ƒé€»è¾‘ï¼Œäºæ˜¯æˆ‘ç›´æ¥çœ‹æ ¸å¿ƒåŠ å¯†é€»è¾‘ï¼Œå¾ˆæ¸…æ™°ï¼Œç„¶åå†™è§£å¯†å°±å‡ºäº†ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">hack_data = [<span class="hljs-number">27</span>, <span class="hljs-number">16</span>, <span class="hljs-number">43</span>, <span class="hljs-number">29</span>, <span class="hljs-number">127</span>, <span class="hljs-number">46</span>, <span class="hljs-number">51</span>, <span class="hljs-number">102</span>, <span class="hljs-number">50</span>, <span class="hljs-number">1</span>, <span class="hljs-number">112</span>, <span class="hljs-number">50</span>, <span class="hljs-number">53</span>, <span class="hljs-number">101</span>, <span class="hljs-number">57</span>, <span class="hljs-number">1</span>] <br>key = <span class="hljs-string">&#x27;H1m&#x27;</span> sbox = [<span class="hljs-number">1</span>, <span class="hljs-number">14</span>, <span class="hljs-number">4</span>, <span class="hljs-number">13</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">7</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span>, <span class="hljs-number">12</span>, <span class="hljs-number">15</span>, <span class="hljs-number">3</span>, <span class="hljs-number">11</span>, <span class="hljs-number">0</span>]  <br>flag_list = [<span class="hljs-number">0</span>] * <span class="hljs-number">16</span>  <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(sbox)):<br>    tmp = hack_data[i] ^ <span class="hljs-built_in">ord</span>(key[i % <span class="hljs-built_in">len</span>(key)])<br>    flag_list[sbox[i]] = tmp<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag_list)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag_list[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure><hr><h1 id="MIPS"><a href="#MIPS" class="headerlink" title="MIPS"></a>MIPS</h1><blockquote><p>â€‹ä¸€ç§æ–°çš„æŒ‡ä»¤é›†ï¼Œå¯¹åº”çš„æ±‡ç¼–è¯­è¨€ä¹Ÿä¸ä¸€æ ·ï¼Œéœ€è¦é‡æ–°å­¦ä¹ ã€‚</p></blockquote><p>â€‹å•ç‹¬å‡ºä¸€ä¸ªwpæ¥è®°å½•å­¦ä¹ è¿‡ç¨‹ä¸­å¾—åˆ°çš„çŸ¥è¯†ã€‚</p><hr><h1 id="æ¡€æ¡€æ¡€"><a href="#æ¡€æ¡€æ¡€" class="headerlink" title="æ¡€æ¡€æ¡€"></a>æ¡€æ¡€æ¡€</h1><blockquote><p>â€‹<code>rep stosdæ˜¯ä¸€æ¡é«˜æ•ˆçš„å­—ç¬¦ä¸²æ“ä½œæŒ‡ä»¤ï¼Œé€‚ç”¨äºå¿«é€Ÿåˆå§‹åŒ–æˆ–å¡«å……å†…å­˜åŒºåŸŸï¼Œediä¿å­˜å¡«å……åœ°å€ï¼Œecxä¿å­˜å¡«å……æ¬¡æ•°ï¼Œeaxä¿å­˜å•æ¬¡å¡«å……å€¼ã€‚</code></p><p>â€‹è¿™ä¸€é¢˜å¾ˆæœ‰æ„æ€å•Šï¼Œæœ‰èŠ±æŒ‡ä»¤ã€TLSã€ä¼ªéšæœºæ•°å’Œé­”æ”¹teaï¼Œæœ‰å¾ˆå¤šå¯å­¦çš„ç‚¹ï¼Œåœ¨åšé¢˜çš„æ—¶å€™ï¼Œç”±äºå¯¹èŠ±æŒ‡ä»¤çš„ä¸å¤Ÿå…¨é¢çš„äº†è§£ï¼Œå’Œå¯¹TLSçš„ä¸å…¨é¢äº†è§£ï¼Œå¯¼è‡´æˆ‘ä¸€ç›´å›°åœ¨å¯¹éæ ¸å¿ƒéƒ¨åˆ†çš„æ¢ç´¢å­¦ä¹ ä¸­ï¼Œå§‹ç»ˆæœªèƒ½æŠ“ä½ä¸»è¦é€»è¾‘ï¼Œæœ€åå¯¼è‡´èº«å¿ƒç–²æƒ«ã€‚</p><p>â€‹äºæ˜¯å†³å®šå‚ç…§WPå’Œç½‘ä¸Šçš„èµ„æ–™ï¼Œå¥½å¥½æ¶è¡¥ä¸€ä¸‹è¿™äº›æ–¹é¢çš„çŸ¥è¯†ï¼Œå¹¶ä¸”è®°å½•ä¸‹æ¥ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0x4119E2</span>, <span class="hljs-number">0x4119E7</span>):<span class="hljs-comment">#IDAçš„patchè„šæœ¬ï¼Œè®°ä½ä½¿ç”¨åˆ°çš„å‡½æ•°åå°±å¥½ã€‚</span><br>    idc.patch_byte(i, <span class="hljs-number">0x90</span>)<br></code></pre></td></tr></table></figure><p>ä¸“é—¨å‡ºä¸€ä¸ªWPï¼Œè®°å½•ä¸€ä¸‹è¿™äº›éš¾é¢˜ã€‚</p><hr><h1 id="å˜¿å˜¿å˜¿"><a href="#å˜¿å˜¿å˜¿" class="headerlink" title="å˜¿å˜¿å˜¿"></a>å˜¿å˜¿å˜¿</h1><p>â€‹æ— å£³ï¼ŒéªŒè¯é•¿åº¦32ä½ï¼Œç„¶åè¿›å…¥140001850ï¼Œæœ‰SMCä¿æŠ¤æŠ€æœ¯ï¼Œæˆ‘ä»¬ä¿®æ”¹æ ‡å¿—ä½ç»•è¿‡åè°ƒè¯•ï¼Œ</p><p><img src="/pictures/ISCTF2024/image-20250521110206759.png" alt="image-20250521110206759"></p><p><img src="/pictures/ISCTF2024/image-20250521110250703.png" alt="image-20250521110250703"></p><p>â€‹è¿™é‡Œä¹Ÿæ²¡æœ‰è°ƒç”¨ï¼Œæˆ‘ä»¬å…ˆä¸ç”¨ç®¡140001A0å‡½æ•°ï¼Œç»§ç»­å»mainå‡½æ•°ä¸­çœ‹ç¨‹åºé€»è¾‘ã€‚çœ‹åˆ°1400017B0å‡½æ•°ï¼Œé©¬ä¸Šå°±è°ƒç”¨äº†è§£å¯†å‡ºçš„å‡½æ•°ï¼Œå‚æ•°åˆ†åˆ«æ˜¯å­—ç¬¦ä¸²â€Welcome_to_ISCTFâ€ï¼Œè¿˜æœ‰ä¸¤ä¸ªç©ºæ•°ç»„ã€‚</p><p><img src="/pictures/ISCTF2024/image-20250521110613803.png" alt="image-20250521110613803"></p><p>â€‹å…ˆçœ‹140001440ï¼Œå¯¹å­—ç¬¦ä¸²è¿›è¡Œå¼‚æˆ–ï¼Œå­˜å‚¨åˆ°a2ä¸­ï¼Œ140003270æ•°æ®å¯ä»¥ç›´æ¥çœ‹åˆ°ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨IDAä¸­æ•°æ®ä»¥å°ç«¯ä¿å­˜ï¼Œå°½ç®¡å­—ç¬¦ä¸²æ˜¾ç¤ºçš„é¡ºåºæ˜¯â€œWelcome_to_ISCTFâ€ï¼Œä½†åœ¨æ ˆå¸§ä¸­ä¿å­˜çš„é¡ºåºå…¶å®æ˜¯cleWâ€¦â€¦ï¼Œéœ€è¦æ¯4ä¸ªå­—èŠ‚é€†åºï¼Œè¿™æ ·æ‰æ˜¯a1[i]çš„å€¼ã€‚</p><p><img src="/pictures/ISCTF2024/image-20250521110827346.png" alt="image-20250521110827346"></p><p><img src="/pictures/ISCTF2024/image-20250521110918291.png" alt="image-20250521110918291"></p><p>â€‹æ¥ç€è¿›å…¥1400014A0å‡½æ•°ï¼Œa1æ˜¯ç©ºæ•°ç»„ï¼Œa2æ˜¯æ‰åŠ å¯†çš„ä¸­é—´å¯†é’¥çš„æŒ‡é’ˆã€‚å¦‚æœåªæ˜¯å‡ºflagçš„è¯ï¼Œè¿™é‡Œæ²¡æœ‰å¿…è¦æ·±å…¥åˆ†æäº†ï¼Œç›´æ¥å–æœ€ç»ˆå¯†é’¥å°±è¡Œäº†ã€‚</p><p><img src="/pictures/ISCTF2024/image-20250521104520689.png" alt="image-20250521104520689"></p><p>â€‹å›åˆ°ä¸»å‡½æ•°ï¼Œ1400017B0å‡½æ•°æ‰æ˜¯åŠ å¯†çš„åœ°æ–¹ï¼Œç»§ç»­çœ‹140001630ï¼Œç”±äºæ˜¯å¯¹æ˜æ–‡è¿›è¡Œäº†åˆ†å—çš„ï¼Œåˆ†æˆ2ä¸ª16å­—èŠ‚åŠ å¯†çš„ã€‚</p><p><img src="/pictures/ISCTF2024/image-20250521113825145.png" alt="image-20250521113825145"></p><p>â€‹é‡Œé¢ä¸¤ä¸ªå‡½æ•°ï¼Œä¸€ä¸ªåŠ å¯†ï¼Œä¸€ä¸ªé€†åºå¤åˆ¶ã€‚</p><p><img src="/pictures/ISCTF2024/image-20250521112328705.png" alt="image-20250521112328705"></p><p>â€‹åŠ å¯†ä»¥4å­—èŠ‚ä¸ºä¸€ä¸ªå•ä½ï¼Œå°†16å­—èŠ‚åˆ†ä¸º4ä¸ªå…ƒç´ ï¼ŒåŠ å¯†32è½®ï¼Œæ•´ä½“åŠ å¯†32&#x2F;4&#x3D;8è½®ã€‚åŠ å¯†æ–¹å¼å°±æ˜¯å¼‚æˆ–1400013F0çš„è¿”å›å€¼ã€‚</p><p><img src="/pictures/ISCTF2024/image-20250521112403260.png" alt="image-20250521112403260"></p><p>â€‹a2ç¡®å®šæ˜¯1ã€‚a1æ˜¯é‚£ç¾¤å¼‚æˆ–å¾—åˆ°çš„å€¼ã€‚</p><p><img src="/pictures/ISCTF2024/image-20250521113204681.png" alt="image-20250521113204681"></p><p>â€‹è¿™é‡Œæœ‰ä¸€ä¸ªæ˜ å°„è¡¨ï¼Œ256å­—èŠ‚ã€‚</p><p><img src="/pictures/ISCTF2024/image-20250521113218351.png" alt="image-20250521113218351"></p><p>â€‹æ˜ å°„åçš„å€¼ä¸ºa1.</p><p><img src="/pictures/ISCTF2024/image-20250521113233640.png" alt="image-20250521113233640"></p><p>â€‹è¿™é‡Œå…¶å®æ˜¯ä¸€ç§æ‰©å±•çš„å·¦ç§»å¹¶è®°å½•æº¢å‡ºä½çš„æ“ä½œã€‚</p><p><img src="/pictures/ISCTF2024/image-20250521113401853.png" alt="image-20250521113401853"></p><p>å†çœ‹è¿™ä¸ªå‡½æ•°ï¼Œä»¥4å­—èŠ‚ä¸ºæ•´ä½“è¿›è¡Œé€†åºï¼Œå› ä¸ºæ¯æ¬¡åŠ å¯†åªæœ‰16å­—èŠ‚å‚ä¸ï¼Œæ‰€ä»¥åªéœ€è¦ç§»åŠ¨4æ¬¡ã€‚</p><p><img src="/pictures/ISCTF2024/image-20250521113539461.png" alt="image-20250521113539461"></p><p>çœ‹å›ä¸»å‡½æ•°ï¼Œé€šè¿‡è°ƒè¯•ç¡®å®šï¼Œæ¯”å¯¹çš„æ—¶å€™å¯†æ–‡ç«¯åºä¸å˜ï¼Œè§£å¯†è„šæœ¬ä¸­å°±ç›´æ¥ä½¿ç”¨æ•°æ®ã€‚</p><p><img src="/pictures/ISCTF2024/image-20250521113646251.png" alt="image-20250521113646251"></p><p>æœ€åå®Œå…¨ä¸çœ‹WPï¼Œè‡ªå·±å†™å‡ºæ¥äº†ï¼ŒExpå¦‚ä¸‹ã€‚èŠ±äº†4ä¸ªå°æ—¶å§ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span> </span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-comment">//å¯†é’¥åœ¨åŠ¨è°ƒçš„æ—¶å€™å–å‡ºå°±è¡Œäº†ã€‚</span><br><span class="hljs-type">uint8_t</span> key[<span class="hljs-number">128</span>] = &#123;<span class="hljs-number">64</span>, <span class="hljs-number">219</span>, <span class="hljs-number">65</span>, <span class="hljs-number">24</span>, <span class="hljs-number">40</span>, <span class="hljs-number">193</span>, <span class="hljs-number">230</span>, <span class="hljs-number">145</span>, <span class="hljs-number">203</span>, <span class="hljs-number">169</span>, <span class="hljs-number">18</span>, <span class="hljs-number">125</span>, <span class="hljs-number">170</span>, <span class="hljs-number">192</span>, <span class="hljs-number">199</span>, <span class="hljs-number">159</span>, <span class="hljs-number">157</span>, <span class="hljs-number">38</span>, <span class="hljs-number">46</span>, <span class="hljs-number">6</span>, <span class="hljs-number">157</span>, <span class="hljs-number">90</span>, <span class="hljs-number">123</span>, <span class="hljs-number">166</span>, <span class="hljs-number">146</span>, <span class="hljs-number">16</span>, <span class="hljs-number">175</span>, <span class="hljs-number">171</span>, <span class="hljs-number">169</span>, <span class="hljs-number">249</span>, <span class="hljs-number">251</span>, <span class="hljs-number">160</span>, <span class="hljs-number">135</span>, <span class="hljs-number">168</span>, <span class="hljs-number">171</span>, <span class="hljs-number">240</span>, <span class="hljs-number">25</span>, <span class="hljs-number">222</span>, <span class="hljs-number">93</span>, <span class="hljs-number">91</span>, <span class="hljs-number">231</span>, <span class="hljs-number">26</span>, <span class="hljs-number">172</span>, <span class="hljs-number">17</span>, <span class="hljs-number">30</span>, <span class="hljs-number">69</span>, <span class="hljs-number">73</span>, <span class="hljs-number">82</span>, <span class="hljs-number">201</span>, <span class="hljs-number">42</span>, <span class="hljs-number">246</span>, <span class="hljs-number">134</span>, <span class="hljs-number">66</span>, <span class="hljs-number">49</span>, <span class="hljs-number">108</span>, <span class="hljs-number">95</span>, <span class="hljs-number">150</span>, <span class="hljs-number">236</span>, <span class="hljs-number">129</span>, <span class="hljs-number">102</span>, <span class="hljs-number">94</span>, <span class="hljs-number">24</span>, <span class="hljs-number">255</span>, <span class="hljs-number">27</span>, <span class="hljs-number">69</span>, <span class="hljs-number">188</span>, <span class="hljs-number">182</span>, <span class="hljs-number">179</span>, <span class="hljs-number">250</span>, <span class="hljs-number">225</span>, <span class="hljs-number">54</span>, <span class="hljs-number">233</span>, <span class="hljs-number">113</span>, <span class="hljs-number">90</span>, <span class="hljs-number">12</span>, <span class="hljs-number">164</span>, <span class="hljs-number">92</span>, <span class="hljs-number">131</span>, <span class="hljs-number">61</span>, <span class="hljs-number">232</span>, <span class="hljs-number">59</span>, <span class="hljs-number">85</span>, <span class="hljs-number">99</span>, <span class="hljs-number">174</span>, <span class="hljs-number">230</span>, <span class="hljs-number">155</span>, <span class="hljs-number">235</span>, <span class="hljs-number">1</span>, <span class="hljs-number">32</span>, <span class="hljs-number">36</span>, <span class="hljs-number">55</span>, <span class="hljs-number">178</span>, <span class="hljs-number">65</span>, <span class="hljs-number">89</span>, <span class="hljs-number">177</span>, <span class="hljs-number">99</span>, <span class="hljs-number">76</span>, <span class="hljs-number">98</span>, <span class="hljs-number">54</span>, <span class="hljs-number">100</span>, <span class="hljs-number">188</span>, <span class="hljs-number">139</span>, <span class="hljs-number">221</span>, <span class="hljs-number">165</span>, <span class="hljs-number">68</span>, <span class="hljs-number">157</span>, <span class="hljs-number">191</span>, <span class="hljs-number">115</span>, <span class="hljs-number">242</span>, <span class="hljs-number">75</span>, <span class="hljs-number">56</span>, <span class="hljs-number">38</span>, <span class="hljs-number">65</span>, <span class="hljs-number">13</span>, <span class="hljs-number">123</span>, <span class="hljs-number">99</span>, <span class="hljs-number">220</span>, <span class="hljs-number">204</span>, <span class="hljs-number">61</span>, <span class="hljs-number">124</span>, <span class="hljs-number">51</span>, <span class="hljs-number">252</span>, <span class="hljs-number">15</span>, <span class="hljs-number">10</span>, <span class="hljs-number">176</span>, <span class="hljs-number">107</span>, <span class="hljs-number">255</span>, <span class="hljs-number">109</span>&#125;;<br><br><br><span class="hljs-comment">//å–å‡ºå°±è¡Œäº†ã€‚</span><br><span class="hljs-type">uint8_t</span> <span class="hljs-built_in">map</span>[<span class="hljs-number">256</span>] = &#123;<span class="hljs-number">214</span>, <span class="hljs-number">144</span>, <span class="hljs-number">233</span>, <span class="hljs-number">254</span>, <span class="hljs-number">204</span>, <span class="hljs-number">225</span>, <span class="hljs-number">61</span>, <span class="hljs-number">183</span>, <span class="hljs-number">22</span>, <span class="hljs-number">182</span>, <span class="hljs-number">20</span>, <span class="hljs-number">194</span>, <span class="hljs-number">40</span>, <span class="hljs-number">251</span>, <span class="hljs-number">44</span>, <span class="hljs-number">5</span>, <span class="hljs-number">43</span>, <span class="hljs-number">103</span>, <span class="hljs-number">154</span>, <span class="hljs-number">118</span>, <span class="hljs-number">42</span>, <span class="hljs-number">190</span>, <span class="hljs-number">4</span>, <span class="hljs-number">195</span>, <span class="hljs-number">170</span>, <span class="hljs-number">68</span>, <span class="hljs-number">19</span>, <span class="hljs-number">38</span>, <span class="hljs-number">73</span>, <span class="hljs-number">134</span>, <span class="hljs-number">6</span>, <span class="hljs-number">153</span>, <span class="hljs-number">156</span>, <span class="hljs-number">66</span>, <span class="hljs-number">80</span>, <span class="hljs-number">244</span>, <span class="hljs-number">145</span>, <span class="hljs-number">239</span>, <span class="hljs-number">152</span>, <span class="hljs-number">122</span>, <span class="hljs-number">51</span>, <span class="hljs-number">84</span>, <span class="hljs-number">11</span>, <span class="hljs-number">67</span>, <span class="hljs-number">237</span>, <span class="hljs-number">207</span>, <span class="hljs-number">172</span>, <span class="hljs-number">98</span>, <span class="hljs-number">228</span>, <span class="hljs-number">179</span>, <span class="hljs-number">28</span>, <span class="hljs-number">169</span>, <span class="hljs-number">201</span>, <span class="hljs-number">8</span>, <span class="hljs-number">232</span>, <span class="hljs-number">149</span>, <span class="hljs-number">128</span>, <span class="hljs-number">223</span>, <span class="hljs-number">148</span>, <span class="hljs-number">250</span>, <span class="hljs-number">117</span>, <span class="hljs-number">143</span>, <span class="hljs-number">63</span>, <span class="hljs-number">166</span>, <span class="hljs-number">71</span>, <span class="hljs-number">7</span>, <span class="hljs-number">167</span>, <span class="hljs-number">252</span>, <span class="hljs-number">243</span>, <span class="hljs-number">115</span>, <span class="hljs-number">23</span>, <span class="hljs-number">186</span>, <span class="hljs-number">131</span>, <span class="hljs-number">89</span>, <span class="hljs-number">60</span>, <span class="hljs-number">25</span>, <span class="hljs-number">230</span>, <span class="hljs-number">133</span>, <span class="hljs-number">79</span>, <span class="hljs-number">168</span>, <span class="hljs-number">104</span>, <span class="hljs-number">107</span>, <span class="hljs-number">129</span>, <span class="hljs-number">178</span>, <span class="hljs-number">113</span>, <span class="hljs-number">100</span>, <span class="hljs-number">218</span>, <span class="hljs-number">139</span>, <span class="hljs-number">248</span>, <span class="hljs-number">235</span>, <span class="hljs-number">15</span>, <span class="hljs-number">75</span>, <span class="hljs-number">112</span>, <span class="hljs-number">86</span>, <span class="hljs-number">157</span>, <span class="hljs-number">53</span>, <span class="hljs-number">30</span>, <span class="hljs-number">36</span>, <span class="hljs-number">14</span>, <span class="hljs-number">94</span>, <span class="hljs-number">99</span>, <span class="hljs-number">88</span>, <span class="hljs-number">209</span>, <span class="hljs-number">162</span>, <span class="hljs-number">37</span>, <span class="hljs-number">34</span>, <span class="hljs-number">124</span>, <span class="hljs-number">59</span>, <span class="hljs-number">1</span>, <span class="hljs-number">33</span>, <span class="hljs-number">120</span>, <span class="hljs-number">135</span>, <span class="hljs-number">212</span>, <span class="hljs-number">0</span>, <span class="hljs-number">70</span>, <span class="hljs-number">87</span>, <span class="hljs-number">159</span>, <span class="hljs-number">211</span>, <span class="hljs-number">39</span>, <span class="hljs-number">82</span>, <span class="hljs-number">76</span>, <span class="hljs-number">54</span>, <span class="hljs-number">2</span>, <span class="hljs-number">231</span>, <span class="hljs-number">160</span>, <span class="hljs-number">196</span>, <span class="hljs-number">200</span>, <span class="hljs-number">158</span>, <span class="hljs-number">234</span>, <span class="hljs-number">191</span>, <span class="hljs-number">138</span>, <span class="hljs-number">210</span>, <span class="hljs-number">64</span>, <span class="hljs-number">199</span>, <span class="hljs-number">56</span>, <span class="hljs-number">181</span>, <span class="hljs-number">163</span>, <span class="hljs-number">247</span>, <span class="hljs-number">242</span>, <span class="hljs-number">206</span>, <span class="hljs-number">249</span>, <span class="hljs-number">97</span>, <span class="hljs-number">21</span>, <span class="hljs-number">161</span>, <span class="hljs-number">224</span>, <span class="hljs-number">174</span>, <span class="hljs-number">93</span>, <span class="hljs-number">164</span>, <span class="hljs-number">155</span>, <span class="hljs-number">52</span>, <span class="hljs-number">26</span>, <span class="hljs-number">85</span>, <span class="hljs-number">173</span>, <span class="hljs-number">147</span>, <span class="hljs-number">50</span>, <span class="hljs-number">48</span>, <span class="hljs-number">245</span>, <span class="hljs-number">140</span>, <span class="hljs-number">177</span>, <span class="hljs-number">227</span>, <span class="hljs-number">29</span>, <span class="hljs-number">246</span>, <span class="hljs-number">226</span>, <span class="hljs-number">46</span>, <span class="hljs-number">130</span>, <span class="hljs-number">102</span>, <span class="hljs-number">202</span>, <span class="hljs-number">96</span>, <span class="hljs-number">192</span>, <span class="hljs-number">41</span>, <span class="hljs-number">35</span>, <span class="hljs-number">171</span>, <span class="hljs-number">13</span>, <span class="hljs-number">83</span>, <span class="hljs-number">78</span>, <span class="hljs-number">111</span>, <span class="hljs-number">213</span>, <span class="hljs-number">219</span>, <span class="hljs-number">55</span>, <span class="hljs-number">69</span>, <span class="hljs-number">222</span>, <span class="hljs-number">253</span>, <span class="hljs-number">142</span>, <span class="hljs-number">47</span>, <span class="hljs-number">3</span>, <span class="hljs-number">255</span>, <span class="hljs-number">106</span>, <span class="hljs-number">114</span>, <span class="hljs-number">109</span>, <span class="hljs-number">108</span>, <span class="hljs-number">91</span>, <span class="hljs-number">81</span>, <span class="hljs-number">141</span>, <span class="hljs-number">27</span>, <span class="hljs-number">175</span>, <span class="hljs-number">146</span>, <span class="hljs-number">187</span>, <span class="hljs-number">221</span>, <span class="hljs-number">188</span>, <span class="hljs-number">127</span>, <span class="hljs-number">17</span>, <span class="hljs-number">217</span>, <span class="hljs-number">92</span>, <span class="hljs-number">65</span>, <span class="hljs-number">31</span>, <span class="hljs-number">16</span>, <span class="hljs-number">90</span>, <span class="hljs-number">216</span>, <span class="hljs-number">10</span>, <span class="hljs-number">193</span>, <span class="hljs-number">49</span>, <span class="hljs-number">136</span>, <span class="hljs-number">165</span>, <span class="hljs-number">205</span>, <span class="hljs-number">123</span>, <span class="hljs-number">189</span>, <span class="hljs-number">45</span>, <span class="hljs-number">116</span>, <span class="hljs-number">208</span>, <span class="hljs-number">18</span>, <span class="hljs-number">184</span>, <span class="hljs-number">229</span>, <span class="hljs-number">180</span>, <span class="hljs-number">176</span>, <span class="hljs-number">137</span>, <span class="hljs-number">105</span>, <span class="hljs-number">151</span>, <span class="hljs-number">74</span>, <span class="hljs-number">12</span>, <span class="hljs-number">150</span>, <span class="hljs-number">119</span>, <span class="hljs-number">126</span>, <span class="hljs-number">101</span>, <span class="hljs-number">185</span>, <span class="hljs-number">241</span>, <span class="hljs-number">9</span>, <span class="hljs-number">197</span>, <span class="hljs-number">110</span>, <span class="hljs-number">198</span>, <span class="hljs-number">132</span>, <span class="hljs-number">24</span>, <span class="hljs-number">240</span>, <span class="hljs-number">125</span>, <span class="hljs-number">236</span>, <span class="hljs-number">58</span>, <span class="hljs-number">220</span>, <span class="hljs-number">77</span>, <span class="hljs-number">32</span>, <span class="hljs-number">121</span>, <span class="hljs-number">238</span>, <span class="hljs-number">95</span>, <span class="hljs-number">62</span>, <span class="hljs-number">215</span>, <span class="hljs-number">203</span>, <span class="hljs-number">57</span>, <span class="hljs-number">72</span>&#125;;<br><br><br><span class="hljs-type">uint32_t</span> <span class="hljs-title function_">sub_1400012F0</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> a1, <span class="hljs-type">int16_t</span> a2)</span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int16_t</span> i=<span class="hljs-number">0</span>;i&lt;a2;i++)&#123;<br>        a1 = a1 / <span class="hljs-number">0x80000000</span> + <span class="hljs-number">2</span> * a1;<br>    &#125;<br>    <span class="hljs-keyword">return</span> a1;<br>&#125;<br><br><span class="hljs-type">uint32_t</span> <span class="hljs-title function_">sub_140001340</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> a1)</span>&#123;<br>    <span class="hljs-keyword">return</span> sub_1400012F0(a1,<span class="hljs-number">24</span>) ^ sub_1400012F0(a1, <span class="hljs-number">18</span>) ^ sub_1400012F0(a1, <span class="hljs-number">10</span>) ^ sub_1400012F0(a1, <span class="hljs-number">2</span>) ^ a1;<br>&#125;<br><br><span class="hljs-comment">//å®Œå…¨ç…§æŠ„åŠ å¯†æ—¶çš„é€»è¾‘å°±è¡Œï¼Œè¿™é‡Œæ˜¯æ±‚å¼‚æˆ–å€¼çš„åœ°æ–¹ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯è¦æ‰¾å‡ºä¸€æ ·çš„å¼‚æˆ–å€¼ï¼Œæ‰€ä»¥è¦å’ŒåŠ å¯†æ—¶çš„é€»è¾‘ä¸€æ ·ã€‚</span><br><span class="hljs-type">uint32_t</span> <span class="hljs-title function_">get_xor</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> seed)</span>&#123;<br>    <span class="hljs-type">uint32_t</span> t = <span class="hljs-built_in">map</span>[(<span class="hljs-type">uint8_t</span>)seed] + (<span class="hljs-built_in">map</span>[(<span class="hljs-type">uint8_t</span>)(seed&gt;&gt;<span class="hljs-number">8</span>)] &lt;&lt; <span class="hljs-number">8</span>) + (<span class="hljs-built_in">map</span>[(<span class="hljs-type">uint8_t</span>)(seed&gt;&gt;<span class="hljs-number">16</span>)] &lt;&lt; <span class="hljs-number">16</span>) + (<span class="hljs-built_in">map</span>[(<span class="hljs-type">uint8_t</span>)(seed&gt;&gt;<span class="hljs-number">24</span>)] &lt;&lt; <span class="hljs-number">24</span>);<br>    <span class="hljs-keyword">return</span> sub_140001340(t);<br><br>&#125;<br><br><br><span class="hljs-comment">//ä»¿ç…§åŠ å¯†è¿‡ç¨‹ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªå¼‚æˆ–æ“ä½œï¼Œåªæ˜¯è¿™ä¸ªå¼‚æˆ–çš„å¯†é’¥ç»è¿‡å¤æ‚çš„è¿ç®—å¾—å‡ºçš„</span><br><span class="hljs-type">void</span>  <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *enc, <span class="hljs-type">uint8_t</span> *key)</span>&#123;<br>    <span class="hljs-type">uint32_t</span> *k = (<span class="hljs-type">uint32_t</span>*)key;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">31</span>;i&gt;=<span class="hljs-number">0</span>;i--)&#123;<br>        enc[i%<span class="hljs-number">4</span>] ^= get_xor(k[i] ^ enc[(i+<span class="hljs-number">3</span>)%<span class="hljs-number">4</span>] ^ enc[(i+<span class="hljs-number">2</span>)%<span class="hljs-number">4</span>] ^ enc[(i+<span class="hljs-number">1</span>)%<span class="hljs-number">4</span>]);<br>    &#125;<br>&#125;<br><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <br>    <span class="hljs-comment">//å¯†æ–‡æœ€å¥½æ˜¯è°ƒè¯•çš„æ—¶å€™çœ‹ï¼Œæ–­ç‚¹ä¸‹åœ¨æ¯”è¾ƒçš„åœ°æ–¹ã€‚</span><br>    <span class="hljs-type">uint32_t</span> enc[] = &#123;<span class="hljs-number">0xA8F44759</span>,<span class="hljs-number">0xCDB824F2</span>,<span class="hljs-number">0x32FB3C01</span>,<span class="hljs-number">0x42BEFFE1</span>,<span class="hljs-number">0x3EC30B40</span>,<span class="hljs-number">0xE094AA46</span>,<span class="hljs-number">0x2AEA2B</span>,<span class="hljs-number">0x362C0888</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> enc1[<span class="hljs-number">8</span>];<br>    <br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">8</span>;i++)&#123;<br>        <span class="hljs-type">int</span> j = i % <span class="hljs-number">4</span>;<br>        enc1[i] = enc[(i/<span class="hljs-number">4</span>)*<span class="hljs-number">4</span> + (<span class="hljs-number">3</span>-j)];<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">2</span>;i++)&#123;<br>        decrypt(enc1+i*<span class="hljs-number">4</span>,key);<br>    &#125;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">8</span>;i++)&#123;<span class="hljs-comment">//è¿™é‡Œå¼€å§‹æ˜¯åçš„ï¼Œè¿˜æé”™äº†ã€‚å­—ç¬¦ä¸²çš„å¤§å°ç«¯æ€»æ˜¯è®©æˆ‘æ‘¸ä¸ç€å¤´è„‘ã€‚</span><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,enc1[i]&amp;<span class="hljs-number">0xFF</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,enc1[i]&gt;&gt;<span class="hljs-number">8</span>&amp;<span class="hljs-number">0xFF</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,enc1[i]&gt;&gt;<span class="hljs-number">16</span>&amp;<span class="hljs-number">0xFF</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,enc1[i]&gt;&gt;<span class="hljs-number">24</span>&amp;<span class="hljs-number">0xFF</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><hr><h1 id="èåœå­çš„èƒèŸ¹"><a href="#èåœå­çš„èƒèŸ¹" class="headerlink" title="èåœå­çš„èƒèŸ¹"></a>èåœå­çš„èƒèŸ¹</h1><p>â€‹RUSTè¯­è¨€ç¨‹åºï¼Œå¯ä»¥ä½¿ç”¨IDAåç¼–è¯‘æ‰“å¼€ï¼Œéš¾ç‚¹å°±æ˜¯åç¼–è¯‘ä»£ç å¾ˆéš¾çœ‹ï¼Œéœ€è¦é…åˆåŠ¨è°ƒç¡®å®šç¨‹åºçš„è¿è¡Œé€»è¾‘ã€‚æœ‰ç‚¹ç´¯äº†ï¼Œæ”¹å¤©å†å†™ã€‚</p><p>â€‹åŠ¨è°ƒè¿˜æ˜¯ç»éªŒå¤ªå°‘äº†ï¼Œè¶æ­¤æœºä¼šï¼Œå¥½å¥½ç…§ç€WPå­¦ä¹ ä¸€ä¸‹åŠ¨è°ƒçš„ç»éªŒã€‚ä¸‹é¢åªæ€»ç»“äº†æ”¶è·çš„ç»éªŒï¼Œå®Œæ•´WPéƒ½æœ‰ã€‚</p><ul><li><h4 id="é€šè¿‡æç¤ºå­—ç¬¦ä¸²çš„äº¤å‰å¼•ç”¨æ‰¾åˆ°ç¨‹åºçš„ä¸»è¦é€»è¾‘å‡½æ•°ã€‚"><a href="#é€šè¿‡æç¤ºå­—ç¬¦ä¸²çš„äº¤å‰å¼•ç”¨æ‰¾åˆ°ç¨‹åºçš„ä¸»è¦é€»è¾‘å‡½æ•°ã€‚" class="headerlink" title="é€šè¿‡æç¤ºå­—ç¬¦ä¸²çš„äº¤å‰å¼•ç”¨æ‰¾åˆ°ç¨‹åºçš„ä¸»è¦é€»è¾‘å‡½æ•°ã€‚"></a>é€šè¿‡æç¤ºå­—ç¬¦ä¸²çš„äº¤å‰å¼•ç”¨æ‰¾åˆ°ç¨‹åºçš„ä¸»è¦é€»è¾‘å‡½æ•°ã€‚</h4></li><li><h4 id="çœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„è¿™ç§ä¹±ä¸ƒå…«ç³Ÿçš„å‡½æ•°åï¼Œçœ‹åˆ°å¦‚æ­¤éš¾ä»¥è¯»æ‡‚çš„ä¼ªä»£ç ï¼Œå…ˆå•æ­¥è°ƒè¯•æ‰¾åˆ°inputå‡½æ•°ã€‚å¹¶ä¸”ï¼Œæ ¹æ®inputå‡½æ•°ä¸­çš„å‚æ•°å€¼ï¼Œæ‰¾åˆ°å­˜å‚¨è¾“å…¥flagçš„åœ°å€ã€‚å‚æ•°æ˜¯æŒ‡é’ˆï¼Œè¦é€šè¿‡Gé”®è·³è½¬åˆ°å¯¹åº”çš„å†…å­˜åœ°å€å¤„æŸ¥çœ‹ã€‚"><a href="#çœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„è¿™ç§ä¹±ä¸ƒå…«ç³Ÿçš„å‡½æ•°åï¼Œçœ‹åˆ°å¦‚æ­¤éš¾ä»¥è¯»æ‡‚çš„ä¼ªä»£ç ï¼Œå…ˆå•æ­¥è°ƒè¯•æ‰¾åˆ°inputå‡½æ•°ã€‚å¹¶ä¸”ï¼Œæ ¹æ®inputå‡½æ•°ä¸­çš„å‚æ•°å€¼ï¼Œæ‰¾åˆ°å­˜å‚¨è¾“å…¥flagçš„åœ°å€ã€‚å‚æ•°æ˜¯æŒ‡é’ˆï¼Œè¦é€šè¿‡Gé”®è·³è½¬åˆ°å¯¹åº”çš„å†…å­˜åœ°å€å¤„æŸ¥çœ‹ã€‚" class="headerlink" title="çœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„è¿™ç§ä¹±ä¸ƒå…«ç³Ÿçš„å‡½æ•°åï¼Œçœ‹åˆ°å¦‚æ­¤éš¾ä»¥è¯»æ‡‚çš„ä¼ªä»£ç ï¼Œå…ˆå•æ­¥è°ƒè¯•æ‰¾åˆ°inputå‡½æ•°ã€‚å¹¶ä¸”ï¼Œæ ¹æ®inputå‡½æ•°ä¸­çš„å‚æ•°å€¼ï¼Œæ‰¾åˆ°å­˜å‚¨è¾“å…¥flagçš„åœ°å€ã€‚å‚æ•°æ˜¯æŒ‡é’ˆï¼Œè¦é€šè¿‡Gé”®è·³è½¬åˆ°å¯¹åº”çš„å†…å­˜åœ°å€å¤„æŸ¥çœ‹ã€‚"></a>çœ‹åˆ°å¦‚ä¸‹å›¾æ‰€ç¤ºçš„è¿™ç§ä¹±ä¸ƒå…«ç³Ÿçš„å‡½æ•°åï¼Œçœ‹åˆ°å¦‚æ­¤éš¾ä»¥è¯»æ‡‚çš„ä¼ªä»£ç ï¼Œå…ˆå•æ­¥è°ƒè¯•æ‰¾åˆ°inputå‡½æ•°ã€‚å¹¶ä¸”ï¼Œæ ¹æ®inputå‡½æ•°ä¸­çš„å‚æ•°å€¼ï¼Œæ‰¾åˆ°å­˜å‚¨è¾“å…¥flagçš„åœ°å€ã€‚å‚æ•°æ˜¯æŒ‡é’ˆï¼Œè¦é€šè¿‡Gé”®è·³è½¬åˆ°å¯¹åº”çš„å†…å­˜åœ°å€å¤„æŸ¥çœ‹ã€‚</h4></li></ul><p><img src="/pictures/ISCTF2024/image-20250522122253781.png" alt="image-20250522122253781"></p><ul><li><h4 id="æ‰¾åˆ°INPUTä¹‹åï¼Œå†é…Œæƒ…åˆ†æç¨‹åºè¿˜æœ‰å“ªäº›é‡è¦éƒ¨åˆ†ã€‚ç„¶åå¿½ç•¥å…¶ä»–æ“ä½œï¼Œé™¤å¼€ä¸è¾“å…¥flagç›¸å…³çš„éƒ¨åˆ†ï¼Œå…¶ä»–éƒ½å¯ä»¥ä¸ç®¡ï¼Œéœ€è¦ä»€ä¹ˆå¯ä»¥é åŠ¨è°ƒç›´æ¥è¯»å–å€¼ã€‚"><a href="#æ‰¾åˆ°INPUTä¹‹åï¼Œå†é…Œæƒ…åˆ†æç¨‹åºè¿˜æœ‰å“ªäº›é‡è¦éƒ¨åˆ†ã€‚ç„¶åå¿½ç•¥å…¶ä»–æ“ä½œï¼Œé™¤å¼€ä¸è¾“å…¥flagç›¸å…³çš„éƒ¨åˆ†ï¼Œå…¶ä»–éƒ½å¯ä»¥ä¸ç®¡ï¼Œéœ€è¦ä»€ä¹ˆå¯ä»¥é åŠ¨è°ƒç›´æ¥è¯»å–å€¼ã€‚" class="headerlink" title="æ‰¾åˆ°INPUTä¹‹åï¼Œå†é…Œæƒ…åˆ†æç¨‹åºè¿˜æœ‰å“ªäº›é‡è¦éƒ¨åˆ†ã€‚ç„¶åå¿½ç•¥å…¶ä»–æ“ä½œï¼Œé™¤å¼€ä¸è¾“å…¥flagç›¸å…³çš„éƒ¨åˆ†ï¼Œå…¶ä»–éƒ½å¯ä»¥ä¸ç®¡ï¼Œéœ€è¦ä»€ä¹ˆå¯ä»¥é åŠ¨è°ƒç›´æ¥è¯»å–å€¼ã€‚"></a>æ‰¾åˆ°INPUTä¹‹åï¼Œå†é…Œæƒ…åˆ†æç¨‹åºè¿˜æœ‰å“ªäº›é‡è¦éƒ¨åˆ†ã€‚ç„¶åå¿½ç•¥å…¶ä»–æ“ä½œï¼Œé™¤å¼€ä¸è¾“å…¥flagç›¸å…³çš„éƒ¨åˆ†ï¼Œå…¶ä»–éƒ½å¯ä»¥ä¸ç®¡ï¼Œéœ€è¦ä»€ä¹ˆå¯ä»¥é åŠ¨è°ƒç›´æ¥è¯»å–å€¼ã€‚</h4></li><li><h4 id="çœ‹åˆ°é•¿åº¦æ¯”è¾ƒå’Œèµ‹å€¼éƒ¨åˆ†ï¼Œè¿™ä¸€å¤§å †æ•°æ®å¾ˆå¯èƒ½å°±æ˜¯å¯†æ–‡ï¼Œä½†æ˜¯ä¸èƒ½ç€æ€¥ï¼Œå¯†æ–‡ä¹Ÿæ˜¯å¯ä»¥åšå¤„ç†çš„ï¼Œä¸åˆ°æœ€åæ¯”å¯¹çš„æ—¶å€™éƒ½ä¸è¦å®Œå…¨ç¡®å®šå¯†æ–‡ã€‚"><a href="#çœ‹åˆ°é•¿åº¦æ¯”è¾ƒå’Œèµ‹å€¼éƒ¨åˆ†ï¼Œè¿™ä¸€å¤§å †æ•°æ®å¾ˆå¯èƒ½å°±æ˜¯å¯†æ–‡ï¼Œä½†æ˜¯ä¸èƒ½ç€æ€¥ï¼Œå¯†æ–‡ä¹Ÿæ˜¯å¯ä»¥åšå¤„ç†çš„ï¼Œä¸åˆ°æœ€åæ¯”å¯¹çš„æ—¶å€™éƒ½ä¸è¦å®Œå…¨ç¡®å®šå¯†æ–‡ã€‚" class="headerlink" title="çœ‹åˆ°é•¿åº¦æ¯”è¾ƒå’Œèµ‹å€¼éƒ¨åˆ†ï¼Œè¿™ä¸€å¤§å †æ•°æ®å¾ˆå¯èƒ½å°±æ˜¯å¯†æ–‡ï¼Œä½†æ˜¯ä¸èƒ½ç€æ€¥ï¼Œå¯†æ–‡ä¹Ÿæ˜¯å¯ä»¥åšå¤„ç†çš„ï¼Œä¸åˆ°æœ€åæ¯”å¯¹çš„æ—¶å€™éƒ½ä¸è¦å®Œå…¨ç¡®å®šå¯†æ–‡ã€‚"></a>çœ‹åˆ°é•¿åº¦æ¯”è¾ƒå’Œèµ‹å€¼éƒ¨åˆ†ï¼Œè¿™ä¸€å¤§å †æ•°æ®å¾ˆå¯èƒ½å°±æ˜¯å¯†æ–‡ï¼Œä½†æ˜¯ä¸èƒ½ç€æ€¥ï¼Œå¯†æ–‡ä¹Ÿæ˜¯å¯ä»¥åšå¤„ç†çš„ï¼Œä¸åˆ°æœ€åæ¯”å¯¹çš„æ—¶å€™éƒ½ä¸è¦å®Œå…¨ç¡®å®šå¯†æ–‡ã€‚</h4></li></ul><p><img src="/pictures/ISCTF2024/image-20250522122710905.png" alt="image-20250522122710905"></p><ul><li><h4 id="çœ‹åˆ°ä¸‹é¢å‰ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯å¯¹å¯†æ–‡è¿›è¡Œæ“ä½œï¼Œv35-v40-v36ï¼Œä¸ç”¨ç®¡ã€‚æˆ‘ä»¬åªéœ€è¦é”å®šä½æˆ‘ä»¬çš„è¾“å…¥å³å¯ï¼Œv29å°±æ˜¯è¾“å…¥å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œæˆ‘ä»¬çœ‹åˆ°v29åªåœ¨405F80å‚æ•°å¤„å‡ºç°äº†ï¼Œè€Œä¸”ä¸‹é¢å°±æ˜¯æ¯”å¯¹äº†ã€‚æ‰€ä»¥è¯¥é¢˜åº”è¯¥åªåœ¨è¿™ä¸ªå‡½æ•°é‡Œé¢è¿›è¡Œäº†å¤„ç†ã€‚"><a href="#çœ‹åˆ°ä¸‹é¢å‰ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯å¯¹å¯†æ–‡è¿›è¡Œæ“ä½œï¼Œv35-v40-v36ï¼Œä¸ç”¨ç®¡ã€‚æˆ‘ä»¬åªéœ€è¦é”å®šä½æˆ‘ä»¬çš„è¾“å…¥å³å¯ï¼Œv29å°±æ˜¯è¾“å…¥å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œæˆ‘ä»¬çœ‹åˆ°v29åªåœ¨405F80å‚æ•°å¤„å‡ºç°äº†ï¼Œè€Œä¸”ä¸‹é¢å°±æ˜¯æ¯”å¯¹äº†ã€‚æ‰€ä»¥è¯¥é¢˜åº”è¯¥åªåœ¨è¿™ä¸ªå‡½æ•°é‡Œé¢è¿›è¡Œäº†å¤„ç†ã€‚" class="headerlink" title="çœ‹åˆ°ä¸‹é¢å‰ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯å¯¹å¯†æ–‡è¿›è¡Œæ“ä½œï¼Œv35-&gt;v40-&gt;v36ï¼Œä¸ç”¨ç®¡ã€‚æˆ‘ä»¬åªéœ€è¦é”å®šä½æˆ‘ä»¬çš„è¾“å…¥å³å¯ï¼Œv29å°±æ˜¯è¾“å…¥å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œæˆ‘ä»¬çœ‹åˆ°v29åªåœ¨405F80å‚æ•°å¤„å‡ºç°äº†ï¼Œè€Œä¸”ä¸‹é¢å°±æ˜¯æ¯”å¯¹äº†ã€‚æ‰€ä»¥è¯¥é¢˜åº”è¯¥åªåœ¨è¿™ä¸ªå‡½æ•°é‡Œé¢è¿›è¡Œäº†å¤„ç†ã€‚"></a>çœ‹åˆ°ä¸‹é¢å‰ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯å¯¹å¯†æ–‡è¿›è¡Œæ“ä½œï¼Œv35-&gt;v40-&gt;v36ï¼Œä¸ç”¨ç®¡ã€‚æˆ‘ä»¬åªéœ€è¦é”å®šä½æˆ‘ä»¬çš„è¾“å…¥å³å¯ï¼Œv29å°±æ˜¯è¾“å…¥å­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œæˆ‘ä»¬çœ‹åˆ°v29åªåœ¨405F80å‚æ•°å¤„å‡ºç°äº†ï¼Œè€Œä¸”ä¸‹é¢å°±æ˜¯æ¯”å¯¹äº†ã€‚æ‰€ä»¥è¯¥é¢˜åº”è¯¥åªåœ¨è¿™ä¸ªå‡½æ•°é‡Œé¢è¿›è¡Œäº†å¤„ç†ã€‚</h4></li></ul><p><img src="/pictures/ISCTF2024/image-20250522122830052.png" alt="image-20250522122830052"></p><ul><li><h4 id="ä¸‹é¢çš„æ¯”å¯¹æ“ä½œï¼Œéœ€è¦ç®€å•è·Ÿè¸ªå˜é‡å€¼ç¡®å®šå˜é‡ä»£è¡¨çš„å«ä¹‰ï¼Œåœ¨è¿›å…¥406AA0æ—¶ä¸‹æ–­ç‚¹å–å‡ºå¯†æ–‡å€¼å³å¯ã€‚"><a href="#ä¸‹é¢çš„æ¯”å¯¹æ“ä½œï¼Œéœ€è¦ç®€å•è·Ÿè¸ªå˜é‡å€¼ç¡®å®šå˜é‡ä»£è¡¨çš„å«ä¹‰ï¼Œåœ¨è¿›å…¥406AA0æ—¶ä¸‹æ–­ç‚¹å–å‡ºå¯†æ–‡å€¼å³å¯ã€‚" class="headerlink" title="ä¸‹é¢çš„æ¯”å¯¹æ“ä½œï¼Œéœ€è¦ç®€å•è·Ÿè¸ªå˜é‡å€¼ç¡®å®šå˜é‡ä»£è¡¨çš„å«ä¹‰ï¼Œåœ¨è¿›å…¥406AA0æ—¶ä¸‹æ–­ç‚¹å–å‡ºå¯†æ–‡å€¼å³å¯ã€‚"></a>ä¸‹é¢çš„æ¯”å¯¹æ“ä½œï¼Œéœ€è¦ç®€å•è·Ÿè¸ªå˜é‡å€¼ç¡®å®šå˜é‡ä»£è¡¨çš„å«ä¹‰ï¼Œåœ¨è¿›å…¥406AA0æ—¶ä¸‹æ–­ç‚¹å–å‡ºå¯†æ–‡å€¼å³å¯ã€‚</h4></li></ul><p><img src="/pictures/ISCTF2024/image-20250522123228352.png" alt="image-20250522123228352"></p><ul><li><h4 id="é‡ç‚¹æ˜¯æ€ä¹ˆçŸ¥é“å¯¹è¾“å…¥çš„æ“ä½œæ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œåœ¨ä¸Šé¢çš„v29å¤„æ‰¾åˆ°è¾“å…¥çš„flagï¼Œæ‰“ä¸‹å†…å­˜æ–­ç‚¹ï¼Œè¿™æ ·æ¯å½“ç¨‹åºå»è®¿é—®è¿™ä¸ªåœ°å€æ—¶å°±ä¼šè§¦å‘æ–­ç‚¹ï¼Œåˆ†åˆ«æˆ‘ä»¬åˆ†æç¨‹åºå¯¹flagåšäº†ä»€ä¹ˆå¤„ç†ã€‚å…·ä½“æ“ä½œå°±æ˜¯åœ¨æ•°æ®å¤´æ‘ä¸‹F2ä¸‹æ–­ç‚¹ï¼Œç„¶åå¡«ä¸‹æ•°æ®é•¿åº¦å°±è¡Œã€‚"><a href="#é‡ç‚¹æ˜¯æ€ä¹ˆçŸ¥é“å¯¹è¾“å…¥çš„æ“ä½œæ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œåœ¨ä¸Šé¢çš„v29å¤„æ‰¾åˆ°è¾“å…¥çš„flagï¼Œæ‰“ä¸‹å†…å­˜æ–­ç‚¹ï¼Œè¿™æ ·æ¯å½“ç¨‹åºå»è®¿é—®è¿™ä¸ªåœ°å€æ—¶å°±ä¼šè§¦å‘æ–­ç‚¹ï¼Œåˆ†åˆ«æˆ‘ä»¬åˆ†æç¨‹åºå¯¹flagåšäº†ä»€ä¹ˆå¤„ç†ã€‚å…·ä½“æ“ä½œå°±æ˜¯åœ¨æ•°æ®å¤´æ‘ä¸‹F2ä¸‹æ–­ç‚¹ï¼Œç„¶åå¡«ä¸‹æ•°æ®é•¿åº¦å°±è¡Œã€‚" class="headerlink" title="é‡ç‚¹æ˜¯æ€ä¹ˆçŸ¥é“å¯¹è¾“å…¥çš„æ“ä½œæ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œåœ¨ä¸Šé¢çš„v29å¤„æ‰¾åˆ°è¾“å…¥çš„flagï¼Œæ‰“ä¸‹å†…å­˜æ–­ç‚¹ï¼Œè¿™æ ·æ¯å½“ç¨‹åºå»è®¿é—®è¿™ä¸ªåœ°å€æ—¶å°±ä¼šè§¦å‘æ–­ç‚¹ï¼Œåˆ†åˆ«æˆ‘ä»¬åˆ†æç¨‹åºå¯¹flagåšäº†ä»€ä¹ˆå¤„ç†ã€‚å…·ä½“æ“ä½œå°±æ˜¯åœ¨æ•°æ®å¤´æ‘ä¸‹F2ä¸‹æ–­ç‚¹ï¼Œç„¶åå¡«ä¸‹æ•°æ®é•¿åº¦å°±è¡Œã€‚"></a>é‡ç‚¹æ˜¯æ€ä¹ˆçŸ¥é“å¯¹è¾“å…¥çš„æ“ä½œæ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œåœ¨ä¸Šé¢çš„v29å¤„æ‰¾åˆ°è¾“å…¥çš„flagï¼Œæ‰“ä¸‹å†…å­˜æ–­ç‚¹ï¼Œè¿™æ ·æ¯å½“ç¨‹åºå»è®¿é—®è¿™ä¸ªåœ°å€æ—¶å°±ä¼šè§¦å‘æ–­ç‚¹ï¼Œåˆ†åˆ«æˆ‘ä»¬åˆ†æç¨‹åºå¯¹flagåšäº†ä»€ä¹ˆå¤„ç†ã€‚å…·ä½“æ“ä½œå°±æ˜¯åœ¨æ•°æ®å¤´æ‘ä¸‹F2ä¸‹æ–­ç‚¹ï¼Œç„¶åå¡«ä¸‹æ•°æ®é•¿åº¦å°±è¡Œã€‚</h4></li></ul><p><img src="/pictures/ISCTF2024/image-20250522123655696.png" alt="image-20250522123655696"></p><ul><li><h4 id="ä¹‹åå°±å¯ä»¥çœ‹æƒ…å†µF9ç­–é©¬å¥”è…¾äº†ï¼Œæ³¨æ„ntdllæœ‰æ—¶å€™å›è®¿é—®è¿™ä¸ªå†…å­˜åœ°å€çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹æ–­ç‚¹è¡¨ï¼Œéšæ—¶å¼€å¯æˆ–å…³é—­æ–­ç‚¹ï¼Œè®°å¾—é…åˆç¨‹åºæ–­ç‚¹ï¼Œå…³é—­å†…å­˜æ–­ç‚¹ï¼Œç›´æ¥F9æ¥è·³è¿‡ntdllçš„è®¿é—®ï¼Œæˆ‘ä»¬åªå…³å¿ƒä¸»è¦é€»è¾‘å¯¹è¯¥åœ°å€çš„è®¿é—®ã€‚è·³å‡ºntdllåï¼Œå†å¼€å¯å†…å­˜æ–­ç‚¹ã€‚"><a href="#ä¹‹åå°±å¯ä»¥çœ‹æƒ…å†µF9ç­–é©¬å¥”è…¾äº†ï¼Œæ³¨æ„ntdllæœ‰æ—¶å€™å›è®¿é—®è¿™ä¸ªå†…å­˜åœ°å€çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹æ–­ç‚¹è¡¨ï¼Œéšæ—¶å¼€å¯æˆ–å…³é—­æ–­ç‚¹ï¼Œè®°å¾—é…åˆç¨‹åºæ–­ç‚¹ï¼Œå…³é—­å†…å­˜æ–­ç‚¹ï¼Œç›´æ¥F9æ¥è·³è¿‡ntdllçš„è®¿é—®ï¼Œæˆ‘ä»¬åªå…³å¿ƒä¸»è¦é€»è¾‘å¯¹è¯¥åœ°å€çš„è®¿é—®ã€‚è·³å‡ºntdllåï¼Œå†å¼€å¯å†…å­˜æ–­ç‚¹ã€‚" class="headerlink" title="ä¹‹åå°±å¯ä»¥çœ‹æƒ…å†µF9ç­–é©¬å¥”è…¾äº†ï¼Œæ³¨æ„ntdllæœ‰æ—¶å€™å›è®¿é—®è¿™ä¸ªå†…å­˜åœ°å€çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹æ–­ç‚¹è¡¨ï¼Œéšæ—¶å¼€å¯æˆ–å…³é—­æ–­ç‚¹ï¼Œè®°å¾—é…åˆç¨‹åºæ–­ç‚¹ï¼Œå…³é—­å†…å­˜æ–­ç‚¹ï¼Œç›´æ¥F9æ¥è·³è¿‡ntdllçš„è®¿é—®ï¼Œæˆ‘ä»¬åªå…³å¿ƒä¸»è¦é€»è¾‘å¯¹è¯¥åœ°å€çš„è®¿é—®ã€‚è·³å‡ºntdllåï¼Œå†å¼€å¯å†…å­˜æ–­ç‚¹ã€‚"></a>ä¹‹åå°±å¯ä»¥çœ‹æƒ…å†µF9ç­–é©¬å¥”è…¾äº†ï¼Œæ³¨æ„ntdllæœ‰æ—¶å€™å›è®¿é—®è¿™ä¸ªå†…å­˜åœ°å€çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŸ¥çœ‹æ–­ç‚¹è¡¨ï¼Œéšæ—¶å¼€å¯æˆ–å…³é—­æ–­ç‚¹ï¼Œè®°å¾—é…åˆç¨‹åºæ–­ç‚¹ï¼Œå…³é—­å†…å­˜æ–­ç‚¹ï¼Œç›´æ¥F9æ¥è·³è¿‡ntdllçš„è®¿é—®ï¼Œæˆ‘ä»¬åªå…³å¿ƒä¸»è¦é€»è¾‘å¯¹è¯¥åœ°å€çš„è®¿é—®ã€‚è·³å‡ºntdllåï¼Œå†å¼€å¯å†…å­˜æ–­ç‚¹ã€‚</h4></li></ul><p><img src="/pictures/ISCTF2024/image-20250522123845878.png" alt="image-20250522123845878"></p><p><img src="/pictures/ISCTF2024/image-20250522123934610.png" alt="image-20250522123934610"></p><p>â€‹æœ€åå¤ç°WPï¼Œè‡ªå·±æ‰‹åŠ¨æ‰¾åˆ°æ•°æ®ï¼Œè§£å¯†æˆåŠŸã€‚</p><p>â€‹é€šè¿‡æœ¬é¢˜ï¼Œæˆ‘å­¦ä¹ åˆ°äº†å†…å­˜æ–­ç‚¹æ‰¾åŠ å¯†æ“ä½œçš„æ–¹æ³•ï¼Œå‘ç°äº†é€šè¿‡Gé”®è¿›è¡Œå†…å­˜è·³è½¬çš„åŠŸèƒ½ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">data = <span class="hljs-string">&quot;A&quot;</span> * <span class="hljs-number">52</span><br>enc_data = [<span class="hljs-number">105</span>, <span class="hljs-number">170</span>, <span class="hljs-number">63</span>, <span class="hljs-number">98</span>, <span class="hljs-number">219</span>, <span class="hljs-number">177</span>, <span class="hljs-number">5</span>, <span class="hljs-number">252</span>, <span class="hljs-number">176</span>, <span class="hljs-number">134</span>, <span class="hljs-number">189</span>, <span class="hljs-number">146</span>, <span class="hljs-number">177</span>, <span class="hljs-number">222</span>, <span class="hljs-number">70</span>, <span class="hljs-number">219</span>, <span class="hljs-number">183</span>, <span class="hljs-number">31</span>, <span class="hljs-number">150</span>, <span class="hljs-number">151</span>, <span class="hljs-number">6</span>, <span class="hljs-number">229</span>, <span class="hljs-number">101</span>, <span class="hljs-number">231</span>, <span class="hljs-number">47</span>, <span class="hljs-number">223</span>, <span class="hljs-number">159</span>, <span class="hljs-number">159</span>, <span class="hljs-number">159</span>, <span class="hljs-number">228</span>, <span class="hljs-number">116</span>, <span class="hljs-number">102</span>, <span class="hljs-number">218</span>, <span class="hljs-number">205</span>, <span class="hljs-number">139</span>, <span class="hljs-number">51</span>, <span class="hljs-number">99</span>, <span class="hljs-number">178</span>, <span class="hljs-number">172</span>, <span class="hljs-number">136</span>, <span class="hljs-number">66</span>, <span class="hljs-number">138</span>, <span class="hljs-number">47</span>, <span class="hljs-number">12</span>, <span class="hljs-number">150</span>, <span class="hljs-number">246</span>, <span class="hljs-number">201</span>, <span class="hljs-number">34</span>, <span class="hljs-number">207</span>, <span class="hljs-number">27</span>, <span class="hljs-number">86</span>, <span class="hljs-number">152</span>]<br><br>xor_key = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">52</span>):<br>    xor_key.append(enc_data[i] ^ <span class="hljs-built_in">ord</span>(data[i]))<br><br><br>enc_flag =[<span class="hljs-number">97</span>, <span class="hljs-number">184</span>, <span class="hljs-number">61</span>, <span class="hljs-number">119</span>, <span class="hljs-number">220</span>, <span class="hljs-number">139</span>, <span class="hljs-number">54</span>, <span class="hljs-number">200</span>, <span class="hljs-number">130</span>, <span class="hljs-number">179</span>, <span class="hljs-number">163</span>, <span class="hljs-number">226</span>, <span class="hljs-number">196</span>, <span class="hljs-number">192</span>, <span class="hljs-number">106</span>, <span class="hljs-number">255</span>, <span class="hljs-number">155</span>, <span class="hljs-number">110</span>, <span class="hljs-number">165</span>, <span class="hljs-number">175</span>, <span class="hljs-number">20</span>, <span class="hljs-number">197</span>, <span class="hljs-number">66</span>, <span class="hljs-number">195</span>, <span class="hljs-number">49</span>, <span class="hljs-number">242</span>, <span class="hljs-number">191</span>, <span class="hljs-number">144</span>, <span class="hljs-number">185</span>, <span class="hljs-number">250</span>, <span class="hljs-number">19</span>, <span class="hljs-number">1</span>, <span class="hljs-number">196</span>, <span class="hljs-number">245</span>, <span class="hljs-number">165</span>, <span class="hljs-number">7</span>, <span class="hljs-number">125</span>, <span class="hljs-number">179</span>, <span class="hljs-number">159</span>, <span class="hljs-number">172</span>, <span class="hljs-number">92</span>, <span class="hljs-number">140</span>, <span class="hljs-number">94</span>, <span class="hljs-number">34</span>, <span class="hljs-number">179</span>, <span class="hljs-number">232</span>, <span class="hljs-number">200</span>, <span class="hljs-number">60</span>, <span class="hljs-number">220</span>, <span class="hljs-number">57</span>, <span class="hljs-number">35</span>, <span class="hljs-number">164</span>]<br>flag = <span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">52</span>):<br>    flag += <span class="hljs-built_in">chr</span>(enc_flag[i] ^ xor_key[i])<br><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Ezre&quot;&gt;&lt;a href=&quot;#Ezre&quot; class=&quot;headerlink&quot; title=&quot;Ezre&quot;&gt;&lt;/a&gt;Ezre&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;â€‹	ä¸€ä¸ªç®€å•çš„ç»´å‰å°¼äºšåŠ å¯†ï¼Œçœ‹äº†åŠå¤©æ²¡çœ‹å‡ºæ¥ï¼Œåœ¨å¼ºè¡Œå†™è§£å¯†ç®—æ³•åï¼Œæ‰çªç„¶å‘ç°ã€‚&lt;/p&gt;
&lt;/blo</summary>
      
    
    
    
    <category term="CTF" scheme="http://bumak.github.io/categories/CTF/"/>
    
    
    <category term="å¤ç°WP" scheme="http://bumak.github.io/tags/%E5%A4%8D%E7%8E%B0WP/"/>
    
    <category term="Reverse" scheme="http://bumak.github.io/tags/Reverse/"/>
    
  </entry>
  
  <entry>
    <title>BaseCTF2024</title>
    <link href="http://bumak.github.io/2025/06/04/BaseCTF/BaseCTF2024_RE/"/>
    <id>http://bumak.github.io/2025/06/04/BaseCTF/BaseCTF2024_RE/</id>
    <published>2025-06-04T14:30:00.000Z</published>
    <updated>2025-07-01T06:14:59.427Z</updated>
    
    <content type="html"><![CDATA[<hr><blockquote><p><strong>UPX mimiï¼š</strong></p><p>â€‹åˆæ­¥æ¥è§¦åˆ°äº†UPXåŠ å£³ä¿æŠ¤çš„çŸ¥è¯†å’Œå¯¹åº”çš„è„±å£³å·¥å…·ï¼Œè¿™æ˜¯ä¸€ç§â€œå‹ç¼©â€ä¿æŠ¤å£³ï¼Œå³å°†æºç¨‹åºä»£ç è¿›è¡Œå‹ç¼©ï¼Œç„¶åé…ä¸Šè§£å‹ç¼©ä»£ç ï¼Œç»„æˆæ–°çš„ç¨‹åºï¼Œå³â€œUPXè§£å‹ä»£ç â€+â€œå‹ç¼©çš„æºæ–‡ä»¶â€ã€‚åœ¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œä¼šå…ˆæ‰§è¡ŒUPXçš„è§£å‹ä»£ç ï¼Œå¾—åˆ°è§£å‹åçš„æºæ–‡ä»¶ï¼Œç„¶åå°†æ§åˆ¶æµè½¬ç§»åˆ°æºæ–‡ä»¶ã€‚</p></blockquote><blockquote><p><strong>ez_maze:</strong></p><p>â€‹æœ€åŸºç¡€çš„è¿·å®«é¢˜ç›®ï¼Œä»IDAä¸­å¯ä»¥ç›´æ¥çœ‹åˆ°è¿·å®«ï¼Œäººå·¥å°±èƒ½å¾—åˆ°è·¯å¾„ã€‚</p></blockquote><blockquote><p><strong>BasePlus:</strong></p><p>â€‹æ— ä¿æŠ¤ï¼Œç›´æ¥æ‹–å…¥IDAï¼Œè€ƒå¯ŸåŸºç¡€çš„é˜…è¯»ä»£ç çš„èƒ½åŠ›ï¼ŒåŠ å¯†å‡½æ•°ä¸ºBase64çš„ä¸€ç‚¹ç‚¹å˜åŒ–ï¼Œå¯¹Base64åŠ å¯†åç»§ç»­å¼‚æˆ–ä¸€ä¸‹ã€‚å¾ˆåŸºç¡€ã€‚ç¬¬ä¸€æ¬¡è®¤çœŸæ“Base64çš„cè¯­è¨€ä»£ç ï¼Œæ”¶è·ä¸å°‘ã€‚</p></blockquote><blockquote><p><strong>Ez_Xor:</strong></p><p>â€‹å¤ä¹ äº†å¤§å°ç«¯åºçš„çŸ¥è¯†ã€‚</p><p>â€‹â€œå°ç«¯åºâ€ï¼šä½ä½æœ‰æ•ˆå­—èŠ‚ä¿å­˜åœ¨å°åœ°å€ã€‚å¦‚0xDEADBEEFåœ¨å†…å­˜ä¸­çš„é¡ºåºæ˜¯ï¼ˆå°åœ°å€ï¼‰EF BE AD DEï¼ˆå¤§åœ°å€ï¼‰ã€‚â€œå¤§ç«¯åºâ€ç›¸åã€‚</p><p>â€‹æœ¬é¢˜å°±æ˜¯ç®€å•çš„æµåŠ å¯†ï¼Œç”Ÿæˆå¯†é’¥æµç„¶ååŠ å¯†ã€‚å¯¹åº”è§£å¯†å³å¯ã€‚</p></blockquote><blockquote><p><strong>UPX:</strong></p><p>â€‹æœ‰å£³ï¼Œç›´æ¥è„±å£³æŠ¥é”™ã€‚å­¦ä¹ åˆ°äº†ï¼Œæ”¹æ ‡å¿—ä½æ¥ä¿æŠ¤åŠ å£³ç¨‹åºçš„æ‰‹æ®µï¼Œæˆ‘ä»¬çš„ååˆ¶æ“ä½œå°±æ˜¯æ‰“å¼€æ–‡ä»¶ï¼Œå°†å¯¹åº”çš„æ ‡å¿—ä½ä»å°å†™æ”¹å›å¤§å†™ã€‚ä¹‹åå°±å¯ä»¥æ­£å¸¸è„±å£³äº†ã€‚</p><p>â€‹æ‹–å…¥IDAåï¼Œè€ƒå¯Ÿçš„æ˜¯æ¢è¡¨çš„Base64ã€‚å”¯ä¸€éœ€è¦æ³¨æ„çš„ç‚¹å°±æ˜¯å› ä¸ºé¢˜ç›®æºç æ˜¯Cè¯­è¨€ï¼Œåœ¨IDAå­—ç¬¦ä¸²æ˜¾ç¤ºä¸­ç»™åŒå¼•å·å…¨é¢åŠ äº†è½¬ä¹‰ç¬¦å·çš„ï¼Œä¸è¦æé”™äº†ã€‚</p></blockquote><p><img src="/pictures/BaseCTF2024/image-20250425170632940.png" alt="image-20250425170632940"></p><blockquote><p><strong>lk:</strong></p><p>â€‹æ¯”è¾ƒå¤§çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼Œè€ƒå¯Ÿpythonçš„z3solveråº“ä½¿ç”¨ã€‚</p></blockquote><blockquote><p><strong>å–æ¯ä¸‹åˆèŒ¶ï¼š</strong></p><p>â€‹æ ‡å‡†çš„TeaåŠ å¯†ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨Cè¯­è¨€å®ç°äº†è¯¥ç®—æ³•ï¼Œæ”¶è·ä¸å°‘ã€‚</p></blockquote><blockquote><p><strong>Ezpy:</strong></p><p>â€‹è€ƒå¯Ÿpythonæ‰“åŒ…å‡ºçš„EXEç¨‹åºã€‚åç¼–è¯‘å‡ºæºç ã€‚</p><p>â€‹å†è€ƒå¯ŸRC4åŠ å¯†ã€‚</p></blockquote><blockquote><p><strong>æœ€ç®€å•çš„ç¼–ç ï¼š</strong></p><p>â€‹æ— ä¿æŠ¤æŠ€æœ¯ï¼Œçº¯è€ƒéªŒä¼ªä»£ç çš„é˜…è¯»æ°´å¹³ï¼Œè€ä¸‹å¿ƒæ¥åˆ†æå°±å¥½äº†ã€‚</p></blockquote><blockquote><p><strong>neuroçˆ±æ•°å­¦ï¼š</strong></p><p>â€‹</p></blockquote><blockquote><p><strong>RivestCipher:</strong></p><p>â€‹è€ƒå¯Ÿæ ‡å‡†RC4åŠ å¯†ç®—æ³•ã€‚</p></blockquote><blockquote><p><strong>ezAndroid:</strong></p><p>â€‹æ”¶è·åˆ°äº†é€†å‘apkå®‰è£…åŒ…çš„è½¯ä»¶jadxï¼Œæ¥è§¦åˆ°äº†soæ–‡ä»¶ï¼ˆå…±äº«åº“ï¼‰é€†å‘ï¼Œæ˜¯ä¸€äº›æ²¡æœ‰æ¥è§¦è¿‡çš„æ“ä½œã€‚åˆè¦è¯»å¥‡æ€ªçš„ä»£ç ã€‚å”‰ï¼</p></blockquote><hr><h1 id="UPX-PRO-MAX"><a href="#UPX-PRO-MAX" class="headerlink" title="UPX PRO MAX"></a><strong>UPX PRO MAX</strong></h1><p>â€‹ç›´æ¥è¿è¡ŒEXEç¨‹åºï¼Œä¼šå‡ºç°ä¸‹å›¾çš„æ˜¾ç¤ºã€‚</p><p><img src="/pictures/BaseCTF2024/image-20250506132159230.png" alt="image-20250506132159230"></p><p>DIEä¹Ÿçœ‹åˆ°UPXå£³ã€‚</p><p><img src="/pictures/BaseCTF2024/image-20250506132311405.png" alt="image-20250506132311405"></p><p>ç›´æ¥ä¸Šå·¥å…·æ˜¯ä¸è¡Œçš„å•Šï¼ŒæŠ¥é”™äº†ã€‚</p><p>è·Ÿç€WPå­¦ä¹ â€”â€”<strong>åˆ©ç”¨ESPå®šå¾‹x64dbgæ‰‹è„±UPXå£³</strong>ã€‚</p><blockquote><p>â€œESPå®šå¾‹â€ä¹Ÿç§°â€œå †æ ˆå¹³è¡¡å®šå¾‹â€</p><p>ç”±äºåœ¨ç¨‹åºè‡ªè§£å¯†æˆ–è€…è‡ªè§£å‹è¿‡ç¨‹ä¸­, å¤šæ•°å£³ä¼šå…ˆå°†å½“å‰å¯„å­˜å™¨çŠ¶æ€å‹æ ˆ, å¦‚ä½¿ç”¨<code>pushad</code>, è€Œåœ¨è§£å‹ç»“æŸå, ä¼šå°†ä¹‹å‰çš„å¯„å­˜å™¨å€¼å‡ºæ ˆ, å¦‚ä½¿ç”¨<code>popad</code>. å› æ­¤åœ¨å¯„å­˜å™¨å‡ºæ ˆæ—¶, å¾€å¾€ç¨‹åºä»£ç è¢«æ¢å¤, æ­¤æ—¶ç¡¬ä»¶æ–­ç‚¹è§¦å‘ï¼ˆè¿™å°±æ˜¯æˆ‘ä»¬è¦ä¸‹ç¡¬ä»¶æ–­ç‚¹çš„åŸå› ï¼‰ï¼Œç„¶ååœ¨ç¨‹åºå½“å‰ä½ç½®, åªéœ€è¦ä¸€äº›å•æ­¥æ“ä½œ, å°±ä¼šåˆ°è¾¾æ­£ç¡®çš„OEPä½ç½®ã€‚</p><ol><li>ç¨‹åºåˆšè½½å…¥å¼€å§‹ <code>pushad/pushfd</code></li><li>å°†å…¨éƒ¨å¯„å­˜å™¨å‹æ ˆåå°±è®¾å¯¹ ESP å¯„å­˜å™¨è®¾ç¡¬ä»¶æ–­ç‚¹</li><li>è¿è¡Œç¨‹åº, è§¦å‘æ–­ç‚¹</li><li>åˆ é™¤ç¡¬ä»¶æ–­ç‚¹å¼€å§‹åˆ†æ</li></ol></blockquote><p>åœ¨x64dbgä¸­ï¼ŒF9ä¸¤æ¬¡åæ¥åˆ°è¿™ä¸ªå‹æ ˆçš„æ“ä½œå¤„ã€‚æ¥ç€å•æ­¥è¿è¡Œä¸€æ¬¡ï¼Œçœ‹åˆ°ESPçš„å€¼ä¸ºçº¢è‰²ï¼Œä»£è¡¨å…¶å€¼è¢«ä¿®æ”¹äº†ï¼Œæˆ‘ä»¬å³é”®é€‰æ‹©â€œåœ¨å†…å­˜çª—å£ä¸­è½¬åˆ°â€ï¼Œç„¶ååœ¨æ ˆä¸­æ‰“ä¸‹ç¡¬ä»¶æ–­ç‚¹ã€‚</p><p><img src="/pictures/BaseCTF2024/image-20250506133643545.png" alt="image-20250506133643545"></p><p><img src="/pictures/BaseCTF2024/image-20250506134057787.png" alt="image-20250506134057787"></p><p><img src="/pictures/BaseCTF2024/image-20250506134312068.png" alt="image-20250506134312068"></p><p>ä¹‹åF9ï¼Œè§¦å‘æ–­ç‚¹åå•æ­¥è¿è¡Œå‡ ä¸‹å°±æ‰¾åˆ°OEPäº†ï¼Œå³ç¨‹åºå…¥å£ç‚¹ã€‚å¯ä»¥çœ‹åˆ°è¿™ä¸ªåœ°æ–¹çš„å¤šæ¬¡popæŒ‡ä»¤ã€‚</p><p>æ ¹æ®wpä¸­çš„æç¤ºï¼Œ0X41CF65è·³è½¬çš„åœ°æ–¹å°±æ˜¯ç¨‹åºçš„å…¥å£ç‚¹äº†ã€‚åº”è¯¥æ˜¯äº†ã€‚</p><p><img src="/pictures/BaseCTF2024/image-20250506134519180.png" alt="image-20250506134519180"></p><p>ä¸‹é¢æ ¹æ®WPä¸­çš„æ“ä½œä»‹ç»ä¸€æ­¥æ­¥å°±å¯ä»¥è„±å‡ºæ— å£³çš„ç¨‹åºäº†ï¼Œå«UPX_PRO_MAX_dump_SCY.exeã€‚</p><blockquote><p><code>scylla</code>æ’ä»¶ï¼šåœ¨ x64dbg ä¸­å†…ç½®çš„ Scylla æ’ä»¶å¯ç”¨äº dump è¿›ç¨‹ï¼Œ<strong>å³å°†å†…å­˜ä¸­çš„ç¨‹åºæ•°æ®è½¬å‚¨åˆ°ç£ç›˜ä¸Š</strong>ï¼Œå½¢æˆä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶çš„å‰¯æœ¬ï¼Œæ–¹ä¾¿åç»­å¯¹ç¨‹åºçš„åˆ†æå’Œç ”ç©¶ã€‚</p><p><code>IAT AutoSearch</code>ï¼š åœ¨åˆ†æç»è¿‡åŠ å£³æˆ–åŠ å¯†çš„ç¨‹åºæ—¶ï¼Œç¨‹åºçš„å¯¼å…¥è¡¨å¯èƒ½è¢«ç ´åæˆ–éšè—ï¼ŒIAT AutoSearch å¯ä»¥è‡ªåŠ¨æ‰«æå†…å­˜æˆ–ä»£ç æ®µï¼Œå¯»æ‰¾å¯èƒ½çš„å¯¼å…¥å‡½æ•°åœ°å€ï¼Œå¸®åŠ©é€†å‘å·¥ç¨‹å¸ˆå¿«é€Ÿæ‰¾åˆ°ç¨‹åºæ‰€è°ƒç”¨çš„å¤–éƒ¨å‡½æ•°ã€‚</p></blockquote><blockquote><p>ç¨‹åºçš„å¯¼å…¥è¡¨æ˜¯ç¨‹åºçš„å…³é”®æ•°æ®ç»“æ„ï¼Œç”¨äºåˆ—å‡ºç¨‹åºè¿è¡Œæ—¶éœ€è¦ä»å…¶ä»–æ¨¡å—ï¼ˆé€šå¸¸æ˜¯ DLLï¼‰ä¸­å¯¼å…¥çš„å‡½æ•°å’Œå˜é‡ã€‚ä»¥ä¸‹æ˜¯å¯¼å…¥è¡¨çš„è¯¦ç»†ä»‹ç»ï¼š</p><ul><li><p>å¯¼å…¥è¡¨æ˜¯ç¨‹åºçš„ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œå®ƒåŒ…å«äº†ä¸€ç³»åˆ—çš„å¼•ç”¨ä¿¡æ¯ï¼ŒæŒ‡å‘ç¨‹åºè¿è¡Œæ—¶éœ€è¦è°ƒç”¨çš„å¤–éƒ¨å‡½æ•°å’Œå˜é‡æ‰€åœ¨çš„æ¨¡å—åŠå…¶å…·ä½“åœ°å€ã€‚</p></li><li><p><strong>ä¾¿äºè°ƒç”¨å¤–éƒ¨æ¨¡å—åŠŸèƒ½</strong> ï¼šç¨‹åºé€šå¸¸ä¸ä¼šå°†æ‰€æœ‰åŠŸèƒ½éƒ½è‡ªå·±å®ç°ï¼Œè€Œæ˜¯é€šè¿‡è°ƒç”¨ç³»ç»Ÿæˆ–ç¬¬ä¸‰æ–¹æä¾›çš„ DLL ä¸­çš„å‡½æ•°å’Œå˜é‡æ¥å®ç°å¤æ‚çš„åŠŸèƒ½ã€‚å¯¼å…¥è¡¨å°±åƒä¸€ä¸ªç›®å½•ï¼Œå‘Šè¯‰æ“ä½œç³»ç»Ÿç¨‹åºéœ€è¦ä»å“ªäº› DLL ä¸­ä½¿ç”¨å“ªäº›åŠŸèƒ½ã€‚</p></li><li><p><strong>ä¾¿äºç¨‹åºçš„åŠ¨æ€é“¾æ¥</strong> ï¼šå®ƒæ”¯æŒç¨‹åºçš„åŠ¨æ€é“¾æ¥æœºåˆ¶ã€‚ç¨‹åºåœ¨ç¼–è¯‘æ—¶ä¸ä¼šç›´æ¥å°† DLL ä¸­çš„å‡½æ•°å’Œå˜é‡ä»£ç åŒ…å«è¿›æ¥ï¼Œè€Œæ˜¯åœ¨è¿è¡Œæ—¶è£…è½½æ‰€éœ€çš„ DLLï¼Œå¹¶é€šè¿‡å¯¼å…¥è¡¨æ‰¾åˆ°å…·ä½“çš„å‡½æ•°å’Œå˜é‡åœ°å€ï¼Œè¿™æ ·å¯ä»¥å‡å°‘ç¨‹åºè‡ªèº«çš„ä½“ç§¯ï¼ŒåŒæ—¶æ–¹ä¾¿å¯¹ DLL è¿›è¡Œæ›´æ–°å’Œå…±äº«ã€‚</p></li><li><p><strong>å¯¼å…¥æ¨¡å—åè¡¨</strong> ï¼šå­˜æ”¾äº†ç¨‹åºéœ€è¦å¯¼å…¥çš„å„ä¸ªæ¨¡å—çš„åå­—ï¼Œæ¯”å¦‚ â€œkernel32.dllâ€â€œuser32.dllâ€ ç­‰ã€‚</p></li><li><p><strong>å¯¼å…¥å‡½æ•°åè¡¨</strong> ï¼šå¯¹äºæ¯ä¸ªå¯¼å…¥æ¨¡å—ï¼Œéƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„å¯¼å…¥å‡½æ•°åè¡¨ï¼Œåˆ—å‡ºäº†ä»è¯¥æ¨¡å—ä¸­å¯¼å…¥çš„å…·ä½“å‡½æ•°åç§°ï¼Œå¦‚ â€œMessageBoxAâ€â€œCreateFileAâ€ ç­‰ã€‚</p></li><li><p><strong>å¯¼å…¥å‡½æ•°åœ°å€è¡¨ï¼ˆIATï¼‰</strong> ï¼šåœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå°†æ¯ä¸ªå¯¼å…¥å‡½æ•°çš„å®é™…å†…å­˜åœ°å€å¡«å…¥è¿™ä¸ªè¡¨ä¸­ï¼Œç¨‹åºé€šè¿‡è¿™ä¸ªè¡¨ä¸­çš„åœ°å€æ¥è°ƒç”¨ç›¸åº”çš„å‡½æ•°ã€‚</p></li></ul></blockquote><p>è„±å£³åçš„ç¨‹åºå¯¼å…¥IDAä¸­ï¼Œå¾ˆæ¸…æ™°çš„åŠ å¯†é€»è¾‘ã€‚ç›´æ¥é€†å‘å†™è„šæœ¬å°±è¡Œã€‚</p><p><img src="/pictures/BaseCTF2024/image-20250506141212651.png" alt="image-20250506141212651"></p><p>ä½†æ˜¯è¿™é‡Œå‡ºç°äº†ä¸€ä¸ªå‘ï¼š<code>sub_401550</code>å‡½æ•°å…¶å®å°±æ˜¯ä¸€äº›åŠ å¯†å­—ç¬¦ä¸²ç§»åŠ¨æ“ä½œï¼Œåˆ†æˆå‡ éƒ¨åˆ†å­˜å‚¨åœ¨å‡ ä¸ªå˜é‡ä¸­ã€‚ä½†æ˜¯åœ¨éªŒè¯å‡½æ•°ä¸­ï¼Œå…¨ç¨‹åªç”¨åˆ°äº†a1å’Œa2éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯sub_401550ä¸­çš„a2å’Œa3ï¼Œä¸æ˜¯å®Œæ•´çš„å¯†æ–‡ï¼Œæˆ‘è§‰å¾—è¿™é‡Œæ˜¯ä¸­é—´å‡ºäº†é—®é¢˜ï¼Œè€Œä¸”è¿™ä¸ªæå–å‡ºæ¥çš„exeç¨‹åºæ— æ³•æ­£å¸¸è¿è¡Œï¼ŒIDAä¸­ä¹Ÿè°ƒè¯•ä¸è¡Œï¼Œåªèƒ½é™æ€åˆ†æã€‚æ‰€ä»¥è¿˜æ˜¯æœ‰ç‚¹ä¸é è°±çš„ä¸œè¥¿å­˜åœ¨ã€‚</p><p><img src="/pictures/BaseCTF2024/image-20250506142108769.png" alt="image-20250506142108769"></p><p><img src="/pictures/BaseCTF2024/image-20250506141429954.png" alt="image-20250506141429954"></p><hr><h1 id="EZ-VM"><a href="#EZ-VM" class="headerlink" title="EZ_VM"></a>EZ_VM</h1><p>â€‹åŸºæœ¬ä¿¡æ¯ï¼š<code>pyinstaller</code>æ‰“åŒ…çš„<code>ELF64</code>ä½ç¨‹åºï¼Œä½¿ç”¨<code>pydumpck</code>è§£åŒ…å¾—åˆ°<code>py</code>æ–‡ä»¶ã€‚</p><p>â€‹åŠ å¯†é€»è¾‘åœ¨<code>what.py</code>æ–‡ä»¶ï¼Œæ‰“å¼€ï¼Œé‡Œé¢å‡½æ•°åç§°å’Œå˜é‡åéƒ½æ˜¯ç”¨æ•°å­—ä»£æ›¿çš„ï¼Œè¿˜æœ‰ä¸€äº›å°é”™è¯¯ï¼Œæ¯”å¦‚æœ¬æ¥çš„â€œwhileâ€è¯­å¥å˜æˆâ€œifâ€ï¼Œéœ€è¦æ”¹è¿‡æ¥ã€‚</p><p>â€‹ä»£ç çš„é€»è¾‘å°±æ˜¯ï¼šåˆ†åˆ«ä½¿ç”¨ä¸€ä¸ªæ•°ç»„å˜é‡å’Œä¸€ä¸ªå­—å…¸æ¥æ¨¡æ‹Ÿä¸€ä¸ªæ ˆå’Œå†…å­˜ï¼Œä½¿ç”¨å˜é‡æ¨¡æ‹Ÿå¯„å­˜å™¨ï¼Œé€šè¿‡æ•°ç»„çš„<code>pop</code>å’Œ<code>push</code>æ¨¡æ‹Ÿæ ˆçš„æ“ä½œï¼Œä½¿ç”¨å‡½æ•°å®šä¹‰å„ç§æ±‡ç¼–æŒ‡ä»¤ï¼Œå¦‚pushã€popã€addã€subç­‰ç­‰ï¼Œéƒ½æ˜¯ç»Ÿä¸€æ“ä½œæ•°é•¿åº¦ã€‚å°±è¿™æ ·å®šä¹‰äº†ä¸€ä¸ªèƒ½å¤Ÿé€šè¿‡æ±‡ç¼–æŒ‡ä»¤è¿›è¡Œè¿è¡Œçš„â€œè™šæ‹Ÿæœºâ€ï¼Œé‡Œé¢å­˜åœ¨å‡ºé¢˜äººé¢„å…ˆå†™å¥½çš„ä¸€æ®µé™æ€æ±‡ç¼–ä»£ç ï¼Œä½œä¸ºåŠ å¯†å‡½æ•°ã€‚</p><blockquote><ol><li>æˆ‘ä»¬é¦–è¦ä»»åŠ¡å°±æ˜¯ç»™æºpythonä»£ç è¿›è¡Œé‡å‘½åå’Œæ˜æ˜¾çš„é”™è¯¯çº æ­£ã€‚ï¼ˆéœ€è¦è¶³å¤Ÿç†Ÿæ‚‰æ±‡ç¼–æŒ‡ä»¤ï¼Œèµ·ç çš„è¦çŸ¥é“ã€‚è½¬ç§»æŒ‡ä»¤è¿˜æ²¡é‚£ä¹ˆé‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å…³å¿ƒç¨‹åºçš„æ‰§è¡Œæµç¨‹ï¼Œæˆ‘ä»¬åªéœ€è¦æ³¨æ„å¯†æ–‡çš„æ¥å¤„å³å¯ã€‚ï¼‰</li><li>ç„¶ååœ¨å…¶ä¸­æ’å…¥printè°ƒè¯•è¯­å¥è¾“å‡ºæ“ä½œæŒ‡ä»¤ã€æ ˆå’Œå†…å­˜çš„å€¼ï¼Œé”å®šå¯†æ–‡çš„å­˜å‚¨åœ°æ–¹ï¼Œè§‚å¯ŸåŠ å¯†æ–¹æ³•ã€‚</li><li>æ ¹æ®åŠ å¯†æ–¹æ³•å†™é€†å‘è„šæœ¬ã€‚</li></ol></blockquote><p>â€‹</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc_flag = [<br>    <span class="hljs-number">35</span>,<br>    <span class="hljs-number">18</span>,<br>    <span class="hljs-number">22</span>,<br>    <span class="hljs-number">38</span>,<br>    <span class="hljs-number">23</span>,<br>    <span class="hljs-number">18</span>,<br>    <span class="hljs-number">61</span>,<br>    <span class="hljs-number">25</span>,<br>    <span class="hljs-number">83</span>,<br>    <span class="hljs-number">4</span>,<br>    <span class="hljs-number">0</span>,<br>    <span class="hljs-number">5</span>,<br>    <span class="hljs-number">5</span>,<br>    <span class="hljs-number">83</span>,<br>    <span class="hljs-number">95</span>,<br>    <span class="hljs-number">20</span>,<br>    <span class="hljs-number">29</span>,<br>    <span class="hljs-number">83</span>,<br>    <span class="hljs-number">82</span>,<br>    <span class="hljs-number">1</span>,<br>    <span class="hljs-number">29</span>,<br>    <span class="hljs-number">25</span>,<br>    <span class="hljs-number">0</span>,<br>    <span class="hljs-number">0</span>,<br>    <span class="hljs-number">81</span>,<br>    <span class="hljs-number">72</span>,<br>    <span class="hljs-number">76</span>,<br>    <span class="hljs-number">85</span>,<br>    <span class="hljs-number">3</span>,<br>    <span class="hljs-number">85</span>,<br>    <span class="hljs-number">79</span>,<br>    <span class="hljs-number">73</span>,<br>    <span class="hljs-number">83</span>,<br>    <span class="hljs-number">0</span>,<br>    <span class="hljs-number">15</span>,<br>    <span class="hljs-number">9</span>,<br>    <span class="hljs-number">85</span>,<br>    <span class="hljs-number">7</span>,<br>    <span class="hljs-number">80</span>,<br>    <span class="hljs-number">82</span>,<br>    <span class="hljs-number">0</span>,<br>    <span class="hljs-number">5</span>,<br>    <span class="hljs-number">84</span>,<br>    <span class="hljs-number">77</span>,<br>    <span class="hljs-number">130</span>]<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Opcode</span>:<br>    vm_push = <span class="hljs-number">240</span><br>    vm_pop = <span class="hljs-number">241</span><br>    vm_and = <span class="hljs-number">242</span><br>    vm_or = <span class="hljs-number">243</span><br>    vm_not = <span class="hljs-number">244</span><br>    vm_xor = <span class="hljs-number">245</span><br>    vm_jmp = <span class="hljs-number">246</span><br>    vm_jz = <span class="hljs-number">247</span><br>    vm_label = <span class="hljs-number">248</span><br>    vm_strlen = <span class="hljs-number">249</span><br>    vm_loadchar = <span class="hljs-number">250</span><br>    vm_store = <span class="hljs-number">251</span><br>    vm_load = <span class="hljs-number">252</span><br>    vm_add = <span class="hljs-number">253</span><br>    vm_sub = <span class="hljs-number">254</span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">VM</span>:<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-variable language_">self</span>.stack = []<br>        <span class="hljs-variable language_">self</span>.bytecode = []<br>        <span class="hljs-variable language_">self</span>.pc = <span class="hljs-number">0</span><br>        <span class="hljs-variable language_">self</span>.labels = &#123;&#125;<br>        <span class="hljs-variable language_">self</span>.memory = &#123;&#125;<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">push</span>(<span class="hljs-params">self, value</span>):<br>        <span class="hljs-variable language_">self</span>.stack.append(value)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">pop</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> <span class="hljs-variable language_">self</span>.stack:<br>            <span class="hljs-keyword">raise</span> IndexError(<span class="hljs-string">&#x27;something wrong..&#x27;</span>)<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.stack.pop()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">_scan_labels</span>(<span class="hljs-params">self</span>):<br>        labels = &#123;&#125;<br>        pc = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">while</span> pc &lt; <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.bytecode):<br>            <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.bytecode[pc] == Opcode.vm_label:<br>                label_name = <span class="hljs-variable language_">self</span>.bytecode[pc + <span class="hljs-number">1</span>]<br>                labels[label_name] = pc<br>                pc += <span class="hljs-number">2</span><br>            <span class="hljs-keyword">else</span>:<br>                pc += <span class="hljs-number">1</span><br><br>        <span class="hljs-keyword">return</span> labels<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">vm_and</span>(<span class="hljs-params">self</span>):<br>        a = <span class="hljs-variable language_">self</span>.pop()<br>        b = <span class="hljs-variable language_">self</span>.pop()<br>        <span class="hljs-variable language_">self</span>.push(b &amp; a)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">vm_or</span>(<span class="hljs-params">self</span>):<br>        a = <span class="hljs-variable language_">self</span>.pop()<br>        b = <span class="hljs-variable language_">self</span>.pop()<br>        <span class="hljs-variable language_">self</span>.push(b | a)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">vm_not</span>(<span class="hljs-params">self</span>):<br>        b = <span class="hljs-variable language_">self</span>.pop()<br>        <span class="hljs-variable language_">self</span>.push(~b)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">vm_xor</span>(<span class="hljs-params">self</span>):<br>        a = <span class="hljs-variable language_">self</span>.pop()<br>        b = <span class="hljs-variable language_">self</span>.pop()<br>        <span class="hljs-variable language_">self</span>.push(b ^ a)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">vm_jmp</span>(<span class="hljs-params">self</span>):<br>        label_name = <span class="hljs-variable language_">self</span>.bytecode[<span class="hljs-variable language_">self</span>.pc]<br>        <span class="hljs-variable language_">self</span>.pc = <span class="hljs-variable language_">self</span>.labels[label_name]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">vm_jz</span>(<span class="hljs-params">self</span>):<br>        label_name = <span class="hljs-variable language_">self</span>.bytecode[<span class="hljs-variable language_">self</span>.pc]<br>        <span class="hljs-variable language_">self</span>.pc += <span class="hljs-number">1</span><br>        a = <span class="hljs-variable language_">self</span>.pop()<br>        b = <span class="hljs-variable language_">self</span>.pop()<br>        <span class="hljs-keyword">if</span> a == b:<br>            <span class="hljs-variable language_">self</span>.pc = <span class="hljs-variable language_">self</span>.labels[label_name]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">vm_strlen</span>(<span class="hljs-params">self</span>):<br>        string = <span class="hljs-variable language_">self</span>.pop()<br>        <span class="hljs-variable language_">self</span>.push(<span class="hljs-built_in">len</span>(string))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">vm_loadchar</span>(<span class="hljs-params">self</span>):<br>        string = <span class="hljs-variable language_">self</span>.pop()<br>        index = <span class="hljs-variable language_">self</span>.pop()<br>        <span class="hljs-variable language_">self</span>.push(<span class="hljs-built_in">ord</span>(string[index]))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">vm_store</span>(<span class="hljs-params">self</span>):<br>        value = <span class="hljs-variable language_">self</span>.pop()<br>        key = <span class="hljs-variable language_">self</span>.bytecode[<span class="hljs-variable language_">self</span>.pc]<br>        <span class="hljs-keyword">if</span> key == <span class="hljs-string">&#x27;r&#x27;</span>:<br>            <span class="hljs-keyword">if</span> key <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> <span class="hljs-variable language_">self</span>.memory:<br>                <span class="hljs-variable language_">self</span>.memory[key] = []<br>            <span class="hljs-variable language_">self</span>.memory[key].append(value)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-variable language_">self</span>.memory[key] = value<br>        <span class="hljs-variable language_">self</span>.pc += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">vm_load</span>(<span class="hljs-params">self</span>):<br>        key = <span class="hljs-variable language_">self</span>.bytecode[<span class="hljs-variable language_">self</span>.pc]<br>        <span class="hljs-variable language_">self</span>.push(<span class="hljs-variable language_">self</span>.memory[key])<br>        <span class="hljs-variable language_">self</span>.pc += <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">vm_add</span>(<span class="hljs-params">self</span>):<br>        a = <span class="hljs-variable language_">self</span>.pop()<br>        b = <span class="hljs-variable language_">self</span>.pop()<br>        <span class="hljs-variable language_">self</span>.push(b + a)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">vm_sub</span>(<span class="hljs-params">self</span>):<br>        a = <span class="hljs-variable language_">self</span>.pop()<br>        b = <span class="hljs-variable language_">self</span>.pop()<br>        <span class="hljs-variable language_">self</span>.push(b - a)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self, bytecode</span>):<br>        <span class="hljs-variable language_">self</span>.bytecode = bytecode<br>        <span class="hljs-variable language_">self</span>.pc = <span class="hljs-number">0</span><br>        <span class="hljs-variable language_">self</span>.labels = <span class="hljs-variable language_">self</span>._scan_labels()<br>        <span class="hljs-keyword">while</span> <span class="hljs-variable language_">self</span>.pc &lt; <span class="hljs-built_in">len</span>(<span class="hljs-variable language_">self</span>.bytecode):<br>            opcode = <span class="hljs-variable language_">self</span>.bytecode[<span class="hljs-variable language_">self</span>.pc]<br>            <span class="hljs-variable language_">self</span>.pc += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">if</span> opcode == Opcode.vm_push:<br>                value = <span class="hljs-variable language_">self</span>.bytecode[<span class="hljs-variable language_">self</span>.pc]<br>                <span class="hljs-variable language_">self</span>.pc += <span class="hljs-number">1</span><br>                <span class="hljs-variable language_">self</span>.push(value)<br>            <span class="hljs-keyword">elif</span> opcode == Opcode.vm_pop:<br>                <span class="hljs-variable language_">self</span>.pop()<br>            <span class="hljs-keyword">elif</span> opcode == Opcode.vm_and:<br>                <span class="hljs-variable language_">self</span>.vm_and()<br>            <span class="hljs-keyword">elif</span> opcode == Opcode.vm_or:<br>                <span class="hljs-variable language_">self</span>.vm_or()<br>            <span class="hljs-keyword">elif</span> opcode == Opcode.vm_not:<br>                <span class="hljs-variable language_">self</span>.vm_not()<br>            <span class="hljs-keyword">elif</span> opcode == Opcode.vm_xor:<br>                <span class="hljs-variable language_">self</span>.vm_xor()<br>            <span class="hljs-keyword">elif</span> opcode == Opcode.vm_jmp:<br>                <span class="hljs-variable language_">self</span>.vm_jmp()<br>            <span class="hljs-keyword">elif</span> opcode == Opcode.vm_jz:<br>                <span class="hljs-variable language_">self</span>.vm_jz()<br>            <span class="hljs-keyword">elif</span> opcode == Opcode.vm_label:<br>                <span class="hljs-variable language_">self</span>.pc += <span class="hljs-number">1</span><br>            <span class="hljs-keyword">elif</span> opcode == Opcode.vm_strlen:<br>                <span class="hljs-variable language_">self</span>.vm_strlen()<br>            <span class="hljs-keyword">elif</span> opcode == Opcode.vm_loadchar:<br>                <span class="hljs-variable language_">self</span>.vm_loadchar()<br>            <span class="hljs-keyword">elif</span> opcode == Opcode.vm_store:<br>                <span class="hljs-variable language_">self</span>.vm_store()<br>            <span class="hljs-keyword">elif</span> opcode == Opcode.vm_load:<br>                <span class="hljs-variable language_">self</span>.vm_load()<br>            <span class="hljs-keyword">elif</span> opcode == Opcode.vm_add:<br>                <span class="hljs-variable language_">self</span>.vm_add()<br>            <span class="hljs-keyword">elif</span> opcode == Opcode.vm_sub:<br>                <span class="hljs-variable language_">self</span>.vm_sub()<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&#x27;something wrong&#x27;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;pc: <span class="hljs-subst">&#123;self.pc&#125;</span>| opcode: <span class="hljs-subst">&#123;get_opcode_name(opcode)&#125;</span>, stack: <span class="hljs-subst">&#123;self.stack&#125;</span>, memory: <span class="hljs-subst">&#123;self.memory&#125;</span>&quot;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">self, serial</span>):<br>        bytecode = [<br>            Opcode.vm_push, serial,<br>            Opcode.vm_strlen,<br>            Opcode.vm_store, <span class="hljs-string">&#x27;l1&#x27;</span>,<br>            Opcode.vm_push, <span class="hljs-number">0</span>,<br>            Opcode.vm_store, <span class="hljs-string">&#x27;i&#x27;</span>,<br>            Opcode.vm_label, <span class="hljs-string">&#x27;s&#x27;</span>,<br>            Opcode.vm_load, <span class="hljs-string">&#x27;l1&#x27;</span>,<br>            Opcode.vm_push, <span class="hljs-number">1</span>,<br>            Opcode.vm_sub,<br>            Opcode.vm_load, <span class="hljs-string">&#x27;i&#x27;</span>,<br>            Opcode.vm_jz, <span class="hljs-string">&#x27;e&#x27;</span>,<br>            Opcode.vm_load, <span class="hljs-string">&#x27;i&#x27;</span>,<br>            Opcode.vm_push, serial,<br>            Opcode.vm_loadchar,<br>            Opcode.vm_load, <span class="hljs-string">&#x27;i&#x27;</span>,<br>            Opcode.vm_push, <span class="hljs-number">1</span>,<br>            Opcode.vm_add,<br>            Opcode.vm_push, serial,<br>            Opcode.vm_loadchar,<br>            Opcode.vm_xor,<br>            Opcode.vm_store, <span class="hljs-string">&#x27;r&#x27;</span>,<br>            Opcode.vm_load, <span class="hljs-string">&#x27;i&#x27;</span>,<br>            Opcode.vm_push, <span class="hljs-number">1</span>,<br>            Opcode.vm_add,<br>            Opcode.vm_store, <span class="hljs-string">&#x27;i&#x27;</span>,<br>            Opcode.vm_jmp, <span class="hljs-string">&#x27;s&#x27;</span>,<br>            Opcode.vm_label, <span class="hljs-string">&#x27;e&#x27;</span>,<br>            Opcode.vm_load, <span class="hljs-string">&#x27;i&#x27;</span>,<br>            Opcode.vm_push, serial,<br>            Opcode.vm_loadchar,<br>            Opcode.vm_push, <span class="hljs-number">255</span>,<br>            Opcode.vm_xor,<br>            Opcode.vm_store, <span class="hljs-string">&#x27;r&#x27;</span><br>        ]<br>        <span class="hljs-variable language_">self</span>.run(bytecode)<br>        enc = <span class="hljs-variable language_">self</span>.memory[<span class="hljs-string">&#x27;r&#x27;</span>]<br>        <span class="hljs-keyword">return</span> enc<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_opcode_name</span>(<span class="hljs-params">opcode</span>):<br>    <span class="hljs-keyword">for</span> name, value <span class="hljs-keyword">in</span> Opcode.__dict__.items():<br>        <span class="hljs-keyword">if</span> value == opcode:<br>            <span class="hljs-keyword">return</span> name<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span><br><br>vm = VM()<br>test_flag = <span class="hljs-string">&quot;BaseCTF&#123;VM_is_awesome&#125;&quot;</span><br>enc = vm.encrypt(test_flag)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;encrypted test_flag: <span class="hljs-subst">&#123;enc&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;original flag: <span class="hljs-subst">&#123;enc_flag&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>æ ¹æ®WPæç¤ºé‡å‘½ååï¼Œè§‚å¯Ÿä¼ è¾“çš„è°ƒè¯•ä¿¡æ¯ã€‚çœ‹ä¸€ä¸‹å¼€å¤´å’Œç»“å°¾å°±è¡Œã€‚</p><p><img src="/pictures/BaseCTF2024/image-20250509160138052.png" alt="image-20250509160138052"></p><p><img src="/pictures/BaseCTF2024/image-20250509160305470.png" alt="image-20250509160305470"></p><p>â€‹æ‰€ä»¥çŒœåˆ°åŠ å¯†é€»è¾‘æ˜¯ï¼šä»å‰å¾€åï¼Œç›¸é‚»ä¸¤ä½å¼‚æˆ–ï¼Œå°¾éƒ¨å’Œ255å¼‚æˆ–ã€‚</p><p>è¿™é‡Œç»™å‡ºæˆ‘çš„è§£å¯†è„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc_flag = [<span class="hljs-number">35</span>, <span class="hljs-number">18</span>, <span class="hljs-number">22</span>, <span class="hljs-number">38</span>, <span class="hljs-number">23</span>,  <span class="hljs-number">18</span>,<span class="hljs-number">61</span>, <span class="hljs-number">25</span>,  <span class="hljs-number">83</span>,<span class="hljs-number">4</span>,<span class="hljs-number">0</span>, <span class="hljs-number">5</span>, <span class="hljs-number">5</span>,<span class="hljs-number">83</span>,<span class="hljs-number">95</span>,  <span class="hljs-number">20</span>,  <span class="hljs-number">29</span>, <span class="hljs-number">83</span>,<span class="hljs-number">82</span>,  <span class="hljs-number">1</span>, <span class="hljs-number">29</span>, <span class="hljs-number">25</span>, <span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">81</span>,<span class="hljs-number">72</span>,<span class="hljs-number">76</span>,<span class="hljs-number">85</span>,<span class="hljs-number">3</span>,<span class="hljs-number">85</span>,<span class="hljs-number">79</span>,<span class="hljs-number">73</span>,<span class="hljs-number">83</span>,<span class="hljs-number">0</span>,<span class="hljs-number">15</span>,<span class="hljs-number">9</span>,<span class="hljs-number">85</span>,<span class="hljs-number">7</span>,<span class="hljs-number">80</span>,<span class="hljs-number">82</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>,<span class="hljs-number">84</span>,<span class="hljs-number">77</span>,<span class="hljs-number">130</span>,<span class="hljs-number">255</span>]<br><br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc_flag)):<br>    char = enc_flag[i]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i+<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(enc_flag)):<br>        char = char ^ enc_flag[j]<br><br>    flag += <span class="hljs-built_in">chr</span>(char)<br><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><hr><h1 id="Microgame"><a href="#Microgame" class="headerlink" title="Microgame"></a>Microgame</h1><p>â€‹ä¸ç†è§£ï¼Œä¸ä¼šæ¸¸æˆé€†å‘ï¼Œåé¢å¾—å­¦å•Šã€‚ä¸“é—¨åšäº†ä¸€ä¸ªCEçš„å­¦ä¹ ã€‚</p><p>â€‹å­¦ä¹ å®ŒCEï¼Œä¸“é—¨å‡ºä¸ªWPæ¥åšã€‚</p><hr><h1 id="neuroçˆ±æ•°å­¦"><a href="#neuroçˆ±æ•°å­¦" class="headerlink" title="neuroçˆ±æ•°å­¦"></a>neuroçˆ±æ•°å­¦</h1><p>â€‹ç›´æ¥æ‰“å¼€IDAçœ‹çœ‹<code>main</code>å‡½æ•°ï¼Œç¨‹åºæ— å£³ï¼Œå°±æ˜¯è€ƒå¯Ÿæ•°å­¦é—®é¢˜ã€‚</p><p><img src="/pictures/BaseCTF2024/image-20250512120720066.png" alt="image-20250512120720066"></p><p><img src="/pictures/BaseCTF2024/image-20250512130852846.png" alt="image-20250512130852846"></p><p><img src="/pictures/BaseCTF2024/image-20250512130953971.png" alt="image-20250512130953971"></p><figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;intrin.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<span class="hljs-comment">//æ³¨æ„ï¼šå„ä¸ªå˜é‡å’Œå‡½æ•°çš„ç±»å‹æ˜¯å…³é”®ï¼Œä¸èƒ½æé”™ï¼Œéœ€è¦å¯¹ç…§IDAä¼ªä»£ç </span><br>    <span class="hljs-type">int64_t</span> v5=<span class="hljs-number">0x400C0210000001</span>;<span class="hljs-comment">//è¿™ä¸ªå€¼æ˜¯å›ºå®šçš„ï¼Œä½†æ˜¯éœ€è¦åŠ¨è°ƒç¨‹åºå¾—åˆ°è¿™ä¸ªå€¼ã€‚</span><br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">-60</span>; i&lt;=<span class="hljs-number">59</span>; i++)&#123;<br>        <span class="hljs-keyword">if</span>(i == <span class="hljs-number">44</span> || i == <span class="hljs-number">58</span>)&#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ç¬¦åˆæ¡ä»¶çš„iå€¼ä½ï¼š%d/n&quot;</span>, i);<br>            <span class="hljs-keyword">continue</span>;<br>        &#125;<br><br>        <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v12 = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)(i + <span class="hljs-number">37</span>);<br>        <span class="hljs-keyword">if</span>(v12 &lt;= <span class="hljs-number">54</span> &amp;&amp; _bittest64((<span class="hljs-type">int64_t</span>*)&amp;v5,(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)v12) != <span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;ç¬¦åˆæ¡ä»¶çš„iå€¼ä¸ºï¼š%d/n&quot;</span>, i);<br>        &#125;<br><br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="/pictures/BaseCTF2024/image-20250512131328904.png" alt="image-20250512131328904"></p><p>ç„¶åä½¿ç”¨pythonè„šæœ¬å±•å¼€å¤šé¡¹å¼å¾—åˆ°ç³»æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> symbols, expand<br><br><span class="hljs-comment"># å®šä¹‰ç¬¦å·å˜é‡</span><br>x = symbols(<span class="hljs-string">&#x27;x&#x27;</span>)<br><br><span class="hljs-comment"># æ„é€ å¤šé¡¹å¼</span><br>polynomial = (x - <span class="hljs-number">44</span>) * (x - <span class="hljs-number">58</span>) * (x - <span class="hljs-number">5</span>) * (x + <span class="hljs-number">37</span>) * (x - <span class="hljs-number">17</span>) * (x + <span class="hljs-number">9</span>) * (x - <span class="hljs-number">6</span>) * (x + <span class="hljs-number">4</span>)<br><br><span class="hljs-comment"># å±•å¼€å¤šé¡¹å¼</span><br>expanded_polynomial = expand(polynomial)<br><br><span class="hljs-comment"># æå–å¹¶æ‰“å°ç³»æ•°</span><br>standard_form = expanded_polynomial.as_poly()  <span class="hljs-comment"># è·å–æ ‡å‡†å½¢å¼çš„å¤šé¡¹å¼</span><br>coefficients = standard_form.all_coeffs()    <span class="hljs-comment"># è·å–æ‰€æœ‰ç³»æ•°</span><br><br><span class="hljs-comment"># æ‰“å°ç³»æ•°é€†åºï¼ˆä»å¸¸æ•°é¡¹åˆ°æœ€é«˜æ¬¡é¡¹ï¼‰ã€‚å› ä¸ºæ­£å¸¸æ˜¯ä»é«˜æ¬¡é¡¹åˆ°ä½æ¬¡é¡¹ã€‚</span><br><span class="hljs-built_in">print</span>(coefficients[::-<span class="hljs-number">1</span>])<br><span class="hljs-comment">#[-1733624640, 134045088, 122783468, -12168520, -1364231, 121272, -358, -80, 1]</span><br></code></pre></td></tr></table></figure><p><img src="/pictures/BaseCTF2024/image-20250512131708984.png" alt="æµ‹è¯•å›¾ç‰‡"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;UPX mimiï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;â€‹	åˆæ­¥æ¥è§¦åˆ°äº†UPXåŠ å£³ä¿æŠ¤çš„çŸ¥è¯†å’Œå¯¹åº”çš„è„±å£³å·¥å…·ï¼Œè¿™æ˜¯ä¸€ç§â€œå‹ç¼©â€ä¿æŠ¤å£³ï¼Œå³å°†æºç¨‹åºä»£ç è¿›è¡Œå‹ç¼©ï¼Œç„¶åé…ä¸Šè§£å‹ç¼©ä»£ç ï¼Œç»„æˆæ–°çš„ç¨‹åºï¼Œå³â€œUPXè§£å‹ä»£ç â€+â€œå‹ç¼©çš„æºæ–‡</summary>
      
    
    
    
    <category term="CTF" scheme="http://bumak.github.io/categories/CTF/"/>
    
    
    <category term="å¤ç°WP" scheme="http://bumak.github.io/tags/%E5%A4%8D%E7%8E%B0WP/"/>
    
    <category term="Reverse" scheme="http://bumak.github.io/tags/Reverse/"/>
    
  </entry>
  
</feed>
