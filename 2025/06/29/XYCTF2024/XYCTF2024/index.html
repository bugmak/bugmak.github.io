<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>XYCTF2024 | bugmak's_blog</title><meta name="keywords" content="复现WP,Reverse"><meta name="author" content="zhike w"><meta name="copyright" content="zhike w"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="XYCTF2024"><meta name="application-name" content="XYCTF2024"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="XYCTF2024"><meta property="og:url" content="http://bumak.github.io/2025/06/29/XYCTF2024/XYCTF2024/index.html"><meta property="og:site_name" content="bugmak's_blog"><meta property="og:description" content="聪明的信使enc &amp;#x3D; &amp;quot;oujp&amp;#123;H0d_TwXf_Lahyc0_14_e3ah_Rvy0ac@wc!&amp;#125;&amp;quot;for i in range(len(enc)):    if enc[i].isalpha():        if ord(enc[i]) &amp;gt;&amp;#x3D;"><meta property="og:locale" content="en"><meta property="og:image" content="https://w.wallhaven.cc/full/l3/wallhaven-l3lq12.png"><meta property="article:author" content="zhike w"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://w.wallhaven.cc/full/l3/wallhaven-l3lq12.png"><meta name="description" content="聪明的信使enc &amp;#x3D; &amp;quot;oujp&amp;#123;H0d_TwXf_Lahyc0_14_e3ah_Rvy0ac@wc!&amp;#125;&amp;quot;for i in range(len(enc)):    if enc[i].isalpha():        if ord(enc[i]) &amp;gt;&amp;#x3D;"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://bumak.github.io/2025/06/29/XYCTF2024/XYCTF2024/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🔍 分享与热心帮助","🔨 设计开发一条龙","🏃 脚踏实地行动派"]},
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"Author: zhike w","link":"Link: ","source":"Source: bugmak's_blog","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.","copySuccess":"Copy success, copy and reprint please mark the address of this article"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'bugmak's_blog',
  title: 'XYCTF2024',
  postAI: '',
  pageFillDescription: '聪明的信使, easy language, 喵喵喵的flag碎了一地, 给阿姨倒一杯卡布奇诺, 你是真的大学生吗？, 砸核桃, DebugMe（APK）, 舔狗四部曲–简爱, 何须相思煮余年, ez_enc, baby unity, ez unity（未做环境不行）, ezmath, 舔狗四部曲–相逢已是上上签, Trustme（APK）, 馒头, What’s this, ez_rand, 舔狗四部曲–记忆的时光机, ez_cube, 今夕是何年, Findme, 舔狗四部曲–我的白月光聪明的信使自己分析不出来说还是得下插件今天晚上最大的收获下载好了绿色版本免安装的下载即用还能适配易语言反编译器插件还配置好了设置中文函数名的配置文件问题和文件问题用大佬的都能用太适配了没有奇怪的环境问题我太爱了还顺带遇到一个分享皮肤的大佬我的又升级了太爽了也下载了一个反制控制流平坦化的插件也太棒了简单记录一下我的分析先根据易语言插件反编译的函数名找到真正的输入框所在的逻辑函数这里先是通过读取组件的属性来获取文本框的内容然后使用加密一次在函数中调用了函数进行了似于的移位与或操作回到原函数后面进行了字符比对和提示信息输出虽然代码没有过多的混淆但是还是太难看了上都是猜出来的我只能先就这样了取密文和解密即可去找字符串即可赛博厨子解密如下喵喵喵的碎了一地给阿姨倒一杯卡布奇诺逻辑很清晰没什么新知识就是又重新熟悉了一般的逆向算法至于老问题大小端的问题我的认识是先做都试一遍魔改你是真的大学生吗第一次见这种东西记录一下这个代码是一个使用实模式和中断编写的可执行程序结构上很典型文件极小只有不到第一次看这种还没很适应有点靠注释和猜反编译源码如下你是真的大学生吗砸核桃新壳国产壳北斗通常是病毒使用的壳还以为网上能找到现成的脱壳工具经过只有一个年的老东西还用不了了看也是手动脱壳我也手撕吧还以为能和获得新工具了哎这也是个压缩壳堆栈平衡同样适用位程序很明显的指令然后就是最基础的异或加密直接看脚本逆向先放一边打开没有可以看的代码不知道怎么回事很多乱码我之前的文件都能显示工具没有问题那就是有防护手段了不会不想去搜了直接看学习先找资源下载付费软件得破解版下载好了使用和差不多生成的项目文件都是和原文件保存在一起这一点特别好不需要我们自己去设置路径了也不容易盘爆了需要修改中的可调式属性使用解包修改好后使用命令重新打包但是好像没有这么简单最后成功了记录一下环境配置的过程首先要使用管理器直接在模拟器中修改文件添加修改之后保存文件然后使用自动打包成新的将新的通过模拟器的共享文件夹传回到电脑上使用打开反编译之后就是开始调试了注意先要将添加到环境变量里面就是通过来找到模拟器设备的然后使用命令查看设备然后使用命令启动待调试的进程其中后面是待调试的包名等等再在中打开调试器选择好对应的模拟器和进程就可以成功调试了正常调试注意加断点再连接程序舔狗四部曲简爱一开始吧分析是程序就直接打开但实际上是文件使用链接当然反编译出来代码都差不多最后是对数组和数组进行比较但是很奇怪的是数据就是没有变化这里是对数组加密两次后再使用函数加密所以正常的逆向逻辑也应该是三次逆向函数解密但是看可以分析知程序的源码就是对密文和输入的都进行了加密然后调用然后才比对比对对象是和而加密的是也就是说比对就是假比对那一层加密完全没有必要就相当于在输入字符串和假进行明文比对这个程序中的比对就不是正常的我们不能按照正常的逻辑取预期我们输入正确就会输出正确的提示信息不难猜出作者想要告诉我们函数才是加密的逻辑算了不想多说了我怀疑源码就是错的版本怎么能这样验证啊分析半天一调试就发现是指向的副本是指向和同样内容的但是是指向的副本的后面的才是真正对数组进行加密的所以实际上最后比对就是数组和得到的数组狗日的反编译一点看不出来看着就是对指针进行操作指向的就是同一个数组啊再也不信反编译的伪代码了当然后面问又想到一些函数一般是对两个不同地址的数组进行复制操作如果和指针相同的话那处理的就是同一块内存了那复制还有什么意义呢这里可能能到一些异常之处开始没有这个理解下面自己写的代码附上这里就是错误之处这个错误语句等价于是错误的啊我们要的实际上是这里同理无用的何须相思煮余年给了个纯文本看着应该是机器码和密文结果跪了位都不行看使用了一个库来进行反汇编是的下面是反汇编的代码这个题还是一点难度的需要擅长汇编代码或者擅长哈哈取符号位和最低位结果非负跳转按位与但不保存结果只设置标志位跳转数组取值设数组是符号位为跳转需要是整除向下取整用上一个字符求出来的必满足在到之间的限制第一个就不用算了游戏是做的输入验证文本框哈这么搞是吧小游戏都不给玩不会逆直接学和都被压缩了一下师傅说单纯为了减少附件的大小哈还得先去壳先使用恢复符号信息先选文件再选文件然后使用打开文件使用脚本加载刚刚得到的和文件再使用去查看文件看其中可疑的类名方法名但是里面是没办法看源码的所以要回到中查看反编译的源码由于恢复了符号信息所以我们使用直接搜索函数名就行了看到我们换个主题颜色之前的有点看腻了看到明显的和异或比较奇怪的是密文居然是在注释里难不成这个字节保存的是一个指针指向其他文件中的字符串这里能看到是因为恢复了符号信息这里自动把字符串取出放在这里了之后赛博厨子解密就好未做环境不行这种的逆向完全没有接触过现在都是实行学习大法配环境就花了好长时间下面记录一下我踩的坑首先将能够生成脚本的方法先通过下载好和工具然后通过命令下载下来框架然后配置文件具体内容根据需要配置当然去抄详细的教程文章就是这个就是其中的方法在一切准备就绪后我执行第一个注入命令就报错了我反复更换文件更换环境到和也重下了题目附件在虚拟机和本机上都试过了但是都是报出同样一个错误我完全不理解是为什么后面使用教程的第一种方法编译项目后也是没能解决问题逆向一个二次多项式求解问题学习求解器解包出来是以这种形式来表示乘积的强行使用破解耗时很长我等了十几分钟都没结果不知道还要算多久直接看有一个很巧妙的思路因为这个二次多项式而且式子中每个二次项的系数都是我们知道那么所有的这些式子展开就会得到该题的的式子也就是说附件中给出的二次多项式就是将二次平方项展开的结果这样就有一个规律了所有的一次项系数除以就是对应的常数值对应的码值应该说这是一个数学推导技巧在数学题中也会使用的技巧初中生都会大学生想不到一点正则表达式中不需要转义啊舔狗四部曲相逢已是上上签又是系列直接打开还不行算了乱七八糟的直接看有标志位被修改了如下图正常情况下上面的红框应该是下面的头的地址这里被改了要改回也就是之后就能正常识别了破解定义变量假设是整数变量范围假设比如字节可打印字符范围或者添加方程这个币题有怪东西脚本绝对有怪东西今天就让我碰上了真晦气下面是我照着改了一点能跑的脚本解密保存加密位的后一位保存加密位的前一位保存加密位的后一位保存加密位的前一位第一个问题看这个循环体的内容上面能跑下面就是错的差别就在于的情况是放在循环体内部还是放在循环体外部了结果详细信息分析我得到一种可能解释因为是无符号位整数永远大于等于所以下面的情况应该是无限循环在编译器优化的情况后这个地方应该被识别出是无限循环直接中断程序了在循环里面插入根本不输出啊保存加密位的后一位保存加密位的前一位保存加密位的后一位保存加密位的前一位保存加密位的后一位保存加密位的前一位第二个问题来了按照第一个能跑的版本我将的类型改为型为什么就又不行了第二个问题也有了答案看到这个参数的代码无论是有符号位整数还是无符号在机器内的表示都是通过格式化字符输出都是这样的而分别通过输出却是和再看在通过输出的时候却分别是也就是说在有符号数中无符号数模是等于的所以会导致的取值时的索引值不一样综上总结出无符号数当索引值要特殊处理等于的情况有符号数的模运算中负数模正数还是负数又是放一边还是学习这个倒是挺正常可以使用打开分析中有假的判断对其进行解密出来得到用户名输入密文十六进制和密钥解密原文密码是原文密码是但是没有其他信息了我们翻看到类看到其中创建了一个新的是对中的数据进行提取操作的对每个字节异或取末尾个字节读取长度字节大端跟默认一样取出数据解密写入解密后的文件示例调用假设是你整个文件得到后看到了密文比对的逻辑就是使用语句验证用户名和密码是否正确但是解压后得到的文件是无法正常读取的仔细读源码看到类中有创建文件的方法是对文件异或解密得到的打开解密文件就看到了这题还有注入漏洞密码为就能得到馒头无壳打开代码很清晰考察的是哈夫曼树数据结构好久之前学的数据结构了现在都忘了重新温习一下看不懂啊真的难这题就认真分析一遍完整写思路当作是学习新知识了通过学习知道了中通过自定义结构体然后通过键修改反编译的函数参数类型为自定义的结构体指针这样就能自动识别了先看结构初始化函数这里哈夫曼树是通过数组保存的啊而就是这个指向这个数组的指针这个数组中的每个元素都是一个结构体这里并不是指针数组而是结构体数组就是第个节点而其就是其在原字符串中的下标看到函数是构建哈夫曼树的看到函数这里很巧妙的对左叶子节点进行了值和下标的比对而对右叶子节点只进行了下标的比对这样就不必把所有的字符值全保存在变量中显的太简单同时也可以标注字符在中的位置理清逻辑后我开始是手动解密就像是下面这样在手动操作的过程中我找到了规律就是可打印字符的数字在到之间那么从到的数字一定是表示下标的并且由于哈夫曼树是满二叉树即除叶子节点外的其他节点都有两个孩子节点我举个例子假设有两个子节点且都是叶子节点左右孩子分别为那么扫描到的时候根据程序就会判断一下的权值字符值然后递归进入到节点这时候又会比较一次下标值然后从叶子节点返回接着到右叶子节点继续比较下标然后返回到的兄弟节点去比对所以我们就可以根据循环数组的值检测到下标就可以利用前几位的权值计算出原字符串中该下标对于的码值是多少下面是自动处理的脚本新东西第一次碰见文件头是节约时间学习的解释是是一个字节码文件编译后的文件的文件头即不是普通的源代码文件而是已经编译成虚拟机可执行的二进制文件所以我们要反编译看源代码中给出了在线工具我们上网站反编译好了也是有幸接触到了一下脚本这是游戏开发非常流行的语言又是垃圾题思路很简单爆破就行了对应好参数类型的中直接无语了的我又一直爆破不出来明明是照着变量类型抄的连算式都是照着抄的麻痹的改了一下异或值的计算就好了还忘了之前错的是什么样子的了现在怎么改都是对的真的是玄学错误消失了完全找不到之前错的是什么样子的了无语逆天了再也不想碰这个煞笔语言了别人的脚本舔狗四部曲记忆的时光机高级的反编译类似花指令一样的反编译方式方法为先把要跳转的地址保存到寄存器上然后通过寄存器跳转或者搞个指令影响反编译直接学习说是可以通过跳转表修复反编译但是没演示具体操作对小白太不友好了其他人也都是看汇编或者动调的那就干吧动调看看首先一个长度检验位然后每一位加密后和密文比对个字符全部相同就是成功函数首先有个变化值从开始的再固定值再减然后密文的对应位这题会动调其实很简单只是反编译做做样子有点吓人罢了打开真是个做魔方的题还得有点空间想象力才行初始状态如下给出的在线网站没办法做到限制旋转就无法按照题目中的方式解出可以使用写一个求解脚本只使用四种目标旋转限制步数就是很可行的但是我不想在这样一个非专业逆向的题目耗这么多时间所以直接过了附上别人的脚本今夕是何年打开哇都反编译不了第一次碰见这种查壳还没有壳又是语言写的学习原来这是架构的二进制文件我们需要一个架构的环境来运行这个程序按照的命令在上面下载好了命令为然后就可以直接运行程序了为什么这么便捷啊背后的机制有个内核功能叫做它能让系统识别不同格式的可执行文件当你运行一个非本机架构的可执行文件时内核通过找到对应的解释器比如自动调用它来运行程序这样你就感觉直接运行不用额外命令其实是系统帮你自动转发了幸好有教程不然我去网上找又得花大把时间错误率还高各种环境问题给了三个二进制文件不知道是什么东西也查不出来新东西还是直接看原来是有隐藏的我还以为这几个文件是一样的东西结果一看文件确实比较迷但是就是文件文件啊文件头就能看出来还去掉了后缀名先看程序先是一个类的初始化盒并用密钥打乱密钥为然后是伪随机数流加密对文件读取字符异或加密后写入文件并且跟着若干个随机数所以我们对文件进行读取逆向处理就行先造出盒然后再次异或即可并且使用盒中的数进行伪随机生成去掉中间的若干字符后到达下一个加密字符直至文件读取完我现在写代码的能力有点差经常有遗忘的点改起来花很多时间还得练得到文件后查看源码是对文件进行解密但是要输入密钥哈哈完啦没有直接的提示又是脑洞我没想到看了才知道是看来我做题太多了都有点迟钝了得到的解密文件是一个图片打开就得到了舔狗四部曲我的白月光这个我真找不到了动调和时光机一样的逻辑一样的但肯定不是这样的但也没有检测直接运行程序也是那样子的啊有点迷了看吧草原来是平台附件错了新的附件是运行程序得到第一段这题写的反编译有点不好看主要是难以找到入手点还是学习吧增长经验通过在提示信息前下断点捕获到断点前面一直在操作的内存数据提取出来得到这样的字符串就有了第二段程序这个地方原本是掉了函数导致我们一直在循环看弹窗要把这里掉然后调试的时候这里很大导致我们循环半天要手动改标志位跳出再看下面函数是加密部分加密数据是程序写好的当然是错的所以没有用户输入的地方下面就是字符串比对然后弹出提示信息所以可以猜出这个就是密文我们要对加密算法逆向加密函数里面有一个自定义的反编译根本看不出来啊只能靠看汇编和动态调试看其算法是对于三位一组的其密文分别是相当于对原字符其都有八位加密时是第一位对应第二位对应第三位对应第四位对应自定义解码函数返回解码后的字节串规则对应输入个字符一组映射到个字节解码算法根据你给出的对应关系逆向实现取个字符填充为后面补根据编码规则逆推三字节设编码字符对应的位数分别是解码公式反推你给出的编码方式调用自定义解码函数将结果转换为字符串示例合在一起就是最后动调看一看故事最后的结局看一看作者最后的感悟',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2025-07-01 14:12:49',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><script src="/static/js/index_media.js"></script><link rel="stylesheet" href="/static/css/index_media.css"><link rel="stylesheet" href="/css/music.css"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/rss.xml" title="bugmak's_blog" type="application/atom+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><!-- 优先级控制逻辑（独立作用域）--><!-- 路径处理（保留原有逻辑）--><!-- 首页专用路径（网页3）--><header class="post-bg" id="page-header"><!--导航栏（nav）的实现--><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">bugmak's_blog</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><!--生成导航菜单的 Pug 代码片段--><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=1708664797&amp;server=tencent"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> Newest Comments</span></div><div class="aside-list"><span>loading...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/OpenGL/" style="font-size: 1.05rem;">OpenGL<sup>1</sup></a><a href="/tags/Reverse/" style="font-size: 1.05rem;">Reverse<sup>6</sup></a><a href="/tags/%E5%A4%8D%E7%8E%B0WP/" style="font-size: 1.05rem;">复现WP<sup>5</sup></a><a href="/tags/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">安卓开发学习<sup>4</sup></a><a href="/tags/%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">技术学习<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>Archives</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/07/"><span class="card-archive-list-date">July 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/06/"><span class="card-archive-list-date">June 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">10</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/" itemprop="url">CTF</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E5%A4%8D%E7%8E%B0WP/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>复现WP</span></a><a class="article-meta__tags" href="/tags/Reverse/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Reverse</span></a></span></div></div><h1 class="post-title" itemprop="name headline">XYCTF2024</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-06-29T02:25:00.000Z" title="Created 2025-06-29 10:25:00">2025-06-29</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-07-01T06:12:49.830Z" title="Updated 2025-07-01 14:12:49">2025-07-01</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="XYCTF2024"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">Post View:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为天门"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>天门</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://w.wallhaven.cc/full/l3/wallhaven-l3lq12.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://bumak.github.io/2025/06/29/XYCTF2024/XYCTF2024/"><header><a class="post-meta-categories" href="/categories/CTF/" itemprop="url">CTF</a><a href="/tags/%E5%A4%8D%E7%8E%B0WP/" tabindex="-1" itemprop="url">复现WP</a><a href="/tags/Reverse/" tabindex="-1" itemprop="url">Reverse</a><h1 id="CrawlerTitle" itemprop="name headline">XYCTF2024</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">zhike w</span><time itemprop="dateCreated datePublished" datetime="2025-06-29T02:25:00.000Z" title="Created 2025-06-29 10:25:00">2025-06-29</time><time itemprop="dateCreated datePublished" datetime="2025-07-01T06:12:49.830Z" title="Updated 2025-07-01 14:12:49">2025-07-01</time></header><h1 id="聪明的信使"><a href="#聪明的信使" class="headerlink" title="聪明的信使"></a>聪明的信使</h1><figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc = <span class="hljs-string">&quot;oujp&#123;H0d_TwXf_Lahyc0_14_e3ah_Rvy0ac@wc!&#125;&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    <span class="hljs-keyword">if</span> enc[i].isalpha():<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(enc[i]) &gt;= <span class="hljs-number">97</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">ord</span>(enc[i]) &lt;= <span class="hljs-number">122</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(enc[i]) - <span class="hljs-number">97</span> - <span class="hljs-number">9</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">97</span>), end=<span class="hljs-string">&quot;&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(enc[i]) - <span class="hljs-number">65</span> - <span class="hljs-number">9</span>) % <span class="hljs-number">26</span> + <span class="hljs-number">65</span>), end=<span class="hljs-string">&quot;&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(enc[i], end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure>



<h1 id="easy-language"><a href="#easy-language" class="headerlink" title="easy language"></a>easy language</h1><p>​	自己分析不出来，WP说还是得下插件。</p>
<p>​	今天晚上最大的收获：下载好了<code>IDA PRO 7.5</code>绿色版本，免安装的，下载即用，还能适配易语言反编译器插件，还配置好了设置中文函数名的配置文件问题和DLL文件问题（用大佬的），都能用，太适配了，没有奇怪的环境问题，我太爱了，还顺带遇到一个分享IDA“皮肤”的大佬，我的IDA又升级了，太爽了！</p>
<p>​	IDA9.0也下载了一个反制控制流平坦化的插件，也太棒了！</p>
<p>​	简单记录一下我的分析，先根据易语言插件反编译的函数名找到真正的输入框所在的逻辑函数。这里先是通过读取组件的属性来获取文本框的内容，然后使用AES-ECB加密一次，</p>
<p><img src="/pictures/XYCTF2024/image-20250604094838934.png" alt="image-20250604094838934"></p>
<p>​	在SUB_403E67函数中调用了SUB_403EE7函数，进行了似于base64的移位、与或操作。</p>
<p><img src="/pictures/XYCTF2024/image-20250604095033633.png" alt="image-20250604095033633"></p>
<p>​	回到原函数，后面进行了字符比对和提示信息输出。虽然代码没有过多的混淆，但是还是太难看了，WP上都是猜出来的。我只能先就这样了，取密文base64和AES-ECB解密即可，去找字符串即可。</p>
<p><img src="/pictures/XYCTF2024/image-20250604095318810.png" alt="image-20250604095318810"></p>
<p>​	赛博厨子解密如下。</p>
<p><img src="/pictures/XYCTF2024/image-20250604100537143.png" alt="image-20250604100537143"></p>
<h1 id="喵喵喵的flag碎了一地"><a href="#喵喵喵的flag碎了一地" class="headerlink" title="喵喵喵的flag碎了一地"></a>喵喵喵的flag碎了一地</h1><p><code>flag&#123;My_fl@g_h4s_br0ken_4parT_Bu7_Y0u_c@n_f1x_1t!&#125;</code></p>
<h1 id="给阿姨倒一杯卡布奇诺"><a href="#给阿姨倒一杯卡布奇诺" class="headerlink" title="给阿姨倒一杯卡布奇诺"></a>给阿姨倒一杯卡布奇诺</h1><p>​	逻辑很清晰，没什么新知识，就是又重新熟悉了一般tea的逆向算法。</p>
<p>​	至于老问题，IDA，大小端的问题，我的认识是：先做，都试一遍。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-comment">//魔改tea</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">detea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">uint32_t</span> *k, <span class="hljs-type">int</span> i)</span>;<br><span class="hljs-comment">//uint32_t data1 = 0x7472795f;</span><br><span class="hljs-type">uint32_t</span> data1 = <span class="hljs-number">0x5F797274</span>;<br><span class="hljs-type">uint32_t</span> data2 = <span class="hljs-number">0x64726168</span>;<br><span class="hljs-comment">//uint32_t data2 = 0x68617264;</span><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> enc[<span class="hljs-number">8</span>] = &#123;<span class="hljs-number">0x9B28ED45</span>, <span class="hljs-number">0x145EC6E9</span>, <span class="hljs-number">0x5B27A6C3</span>, <span class="hljs-number">0xE59E75D5</span>, <span class="hljs-number">0xE82C2500</span>,<span class="hljs-number">0xA4211D92</span>,<span class="hljs-number">0xCD8A4B62</span>,<span class="hljs-number">0xA668F440</span>&#125;;<br>    <span class="hljs-comment">//uint32_t enc[8] = &#123;0x45ed289b, 0xe9c65e14, 0xc3a6275b, 0xd5759ee5,0x00252ce8,0x921d21a4,0x624b8acd,0x40f468a6&#125;;</span><br>    <span class="hljs-type">char</span> key[<span class="hljs-number">16</span>] = <span class="hljs-string">&quot;give_you_cup_tea&quot;</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">6</span>; i&gt;=<span class="hljs-number">0</span>; i=i<span class="hljs-number">-2</span>)<br>    &#123;<br>        detea(enc, (<span class="hljs-type">uint32_t</span>*)key, i);<br>    &#125;<br><br>    <span class="hljs-type">char</span> *flag = (<span class="hljs-type">char</span>*)enc;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">32</span>; i++)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, flag[i]);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">detea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">uint32_t</span> *k, <span class="hljs-type">int</span> i)</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> v0 = v[i], v1 = v[i+<span class="hljs-number">1</span>];<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x6E75316C</span>;<br>    <span class="hljs-type">uint32_t</span> sum = delta * <span class="hljs-number">32</span>;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i =<span class="hljs-number">31</span>; i &gt;= <span class="hljs-number">0</span>; i--)<br>    &#123;<br>        v1 -= ((v0 &gt;&gt; <span class="hljs-number">5</span>) + k[<span class="hljs-number">3</span>]) ^ (v0 + sum) ^ ((v0 &lt;&lt; <span class="hljs-number">4</span>) + k[<span class="hljs-number">2</span>]) ^ (sum + i);<br>        v0 -= ((v1 &gt;&gt; <span class="hljs-number">5</span>) + k[<span class="hljs-number">1</span>]) ^ (v1 + sum) ^ ((v1 &lt;&lt; <span class="hljs-number">4</span>) + k[<span class="hljs-number">0</span>]) ^ (sum + i);<br>        sum = sum - delta;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(i != <span class="hljs-number">0</span>)<br>    &#123;<br>        v0 ^= v[i<span class="hljs-number">-2</span>];<br>        v1 ^= v[i<span class="hljs-number">-1</span>];<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        v0 ^= data1;<br>        v1 ^= data2;<br>    &#125;<br>    v[i] = v0;<br>    v[i+<span class="hljs-number">1</span>] = v1;<br>&#125;<br></code></pre></td></tr></table></figure>





<h1 id="你是真的大学生吗？"><a href="#你是真的大学生吗？" class="headerlink" title="你是真的大学生吗？"></a>你是真的大学生吗？</h1><p>​	第一次见这种东西，记录一下。这个代码是一个使用 <strong>8086实模式</strong> 和 <strong>MS-DOS中断</strong> 编写的可执行程序，结构上很典型。</p>
<p>文件极小，只有1kb不到，第一次看这种还没很适应，有点靠注释和猜。IDA反编译源码如下。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs assembly">dseg:0000 ;<br>dseg:0000 ; +-------------------------------------------------------------------------+<br>dseg:0000 ; |      This file was generated by The Interactive Disassembler (IDA)      |<br>dseg:0000 ; |           Copyright (c) 2024 Hex-Rays, &lt;support@hex-rays.com&gt;           |<br>dseg:0000 ; |                      License info: 48-FCB4-5471-8F                      |<br>dseg:0000 ; |                                 TOM_RUS                                 |<br>dseg:0000 ; +-------------------------------------------------------------------------+<br>dseg:0000 ;<br>dseg:0000 ; Input SHA256 : DE9713F39D770A61E966FDA9C0A9DDF6C3EF5B4037FF5AD4C7ABB962123AFEA3<br>dseg:0000 ; Input MD5    : B64AACBF6ED401B5AE4EB32A63A8E65F<br>dseg:0000 ; Input CRC32  : DF414641<br>dseg:0000 ; Compiler     : Visual C++ (guessed)<br>dseg:0000<br>dseg:0000 ; File Name   : F:\StudyFiles\CTF\Review_CTF\XYCTF2024\RE\你是真的大学生吗？.EXE<br>dseg:0000 ; Format      : MS-DOS executable (EXE)<br>dseg:0000 ; Base Address: 1000h Range: 10000h-100AEh Loaded length: AEh<br>dseg:0000 ; Entry Point : 1005:0<br>dseg:0000<br>dseg:0000                 .686p<br>dseg:0000                 .mmx<br>dseg:0000                 .model large<br>dseg:0000<br>dseg:0000 ; ===========================================================================<br>dseg:0000<br>dseg:0000 ; Segment type: Pure data<br>dseg:0000 dseg            segment para stack &#x27;DATA&#x27; use16<br>dseg:0000                 assume cs:dseg<br>dseg:0000 unk_10000       db  0Dh                 ; DATA XREF: start+5↓o<br>dseg:0001                 db  0Ah<br>dseg:0002                 db  69h ; i<br>dseg:0003                 db  6Eh ; n<br>dseg:0004                 db  70h ; p<br>dseg:0005                 db  75h ; u<br>dseg:0006                 db  74h ; t<br>dseg:0007                 db  20h<br>dseg:0008                 db  73h ; s<br>dseg:0009                 db  74h ; t<br>dseg:000A                 db  72h ; r<br>dseg:000B                 db  69h ; i<br>dseg:000C                 db  6Eh ; n<br>dseg:000D                 db  67h ; g<br>dseg:000E                 db  3Ah ; :<br>dseg:000F                 db  24h ; $<br>dseg:0010 unk_10010       db  0Dh                 ; DATA XREF: start+15↓o<br>dseg:0011                 db  0Ah<br>dseg:0012                 db  24h ; $<br>dseg:0013 unk_10013       db  0Dh                 ; DATA XREF: start+52↓o<br>dseg:0014                 db  0Ah<br>dseg:0015                 db  59h ; Y<br>dseg:0016                 db  65h ; e<br>dseg:0017                 db  73h ; s<br>dseg:0018                 db  24h ; $<br>dseg:0019 unk_10019       db  76h ; v             ; DATA XREF: start+3D↓o<br>dseg:001A                 db  0Eh<br>dseg:001B                 db  77h ; w<br>dseg:001C                 db  14h<br>dseg:001D                 db  60h ; `<br>dseg:001E                 db    6<br>dseg:001F                 db  7Dh ; &#125;<br>dseg:0020                 db    4<br>dseg:0021                 db  6Bh ; k<br>dseg:0022                 db  1Eh<br>dseg:0023                 db  41h ; A<br>dseg:0024                 db  2Ah ; *<br>dseg:0025                 db  44h ; D<br>dseg:0026                 db  2Bh ; +<br>dseg:0027                 db  5Ch ; \<br>dseg:0028                 db    3<br>dseg:0029                 db  3Bh ; ;<br>dseg:002A                 db  0Bh<br>dseg:002B                 db  33h ; 3<br>dseg:002C                 db    5<br>dseg:002D unk_1002D       db  15h                 ; DATA XREF: start+D↓o<br>dseg:002E byte_1002E      db 0                    ; DATA XREF: start+21↓r<br>dseg:002F unk_1002F       db    0                 ; DATA XREF: start+39↓o<br>dseg:0030                 db    0<br>dseg:0031                 db    0<br>dseg:0032                 db    0<br>dseg:0033                 db    0<br>dseg:0034                 db    0<br>dseg:0035                 db    0<br>dseg:0036                 db    0<br>dseg:0037                 db    0<br>dseg:0038                 db    0<br>dseg:0039                 db    0<br>dseg:003A                 db    0<br>dseg:003B                 db    0<br>dseg:003C                 db    0<br>dseg:003D                 db    0<br>dseg:003E                 db    0<br>dseg:003F                 db    0<br>dseg:0040                 db    0<br>dseg:0041                 db    0<br>dseg:0042                 db    0<br>dseg:0043                 db    0<br>dseg:0044                 db    0<br>dseg:0045                 db    0<br>dseg:0046                 db    0<br>dseg:0047                 db    0<br>dseg:0048                 db    0<br>dseg:0049                 db    0<br>dseg:004A                 db    0<br>dseg:004B                 db    0<br>dseg:004C                 db    0<br>dseg:004D                 db    0<br>dseg:004E                 db    0<br>dseg:004F                 db    0<br>dseg:004F dseg            ends<br>dseg:004F<br>seg001:0000 ; ===========================================================================<br>seg001:0000<br>seg001:0000 ; Segment type: Pure code<br>seg001:0000 seg001          segment byte public &#x27;CODE&#x27; use16<br>seg001:0000                 assume cs:seg001<br>seg001:0000                 assume es:nothing, ss:dseg, ds:nothing, fs:nothing, gs:nothing<br>seg001:0000<br>seg001:0000 ; =============== S U B R O U T I N E =======================================<br>seg001:0000<br>seg001:0000 ; Attributes: noreturn<br>seg001:0000<br>seg001:0000                 public start<br>seg001:0000 start           proc near<br>seg001:0000                 mov     ax, seg dseg<br>seg001:0003                 mov     ds, ax<br>seg001:0005                 assume ds:dseg<br>seg001:0005                 lea     dx, unk_10000<br>seg001:0009                 mov     ah, 9<br>seg001:000B                 int     21h             ; DOS - PRINT STRING<br>seg001:000B                                         ; DS:DX -&gt; string terminated by &quot;$&quot;<br>seg001:000D                 lea     dx, unk_1002D<br>seg001:0011                 mov     ah, 0Ah<br>seg001:0013                 int     21h             ; DOS - BUFFERED KEYBOARD INPUT<br>seg001:0013                                         ; DS:DX -&gt; buffer<br>seg001:0015                 lea     dx, unk_10010<br>seg001:0019                 mov     ah, 9<br>seg001:001B                 int     21h             ; DOS - PRINT STRING<br>seg001:001B                                         ; DS:DX -&gt; string terminated by &quot;$&quot;<br>seg001:001D                 xor     cx, cx<br>seg001:001F                 xor     ax, ax<br>seg001:0021                 mov     cl, byte_1002E<br>seg001:0025                 mov     si, 2Fh ; &#x27;/&#x27;<br>seg001:0028                 mov     al, [si]<br>seg001:002A                 add     si, cx<br>seg001:002C<br>seg001:002C loc_1007C:                              ; CODE XREF: start+37↓j<br>seg001:002C                 sub     si, 1<br>seg001:002F                 xor     [si], al<br>seg001:0031                 mov     al, [si]<br>seg001:0033                 dec     cx<br>seg001:0034                 cmp     cx, 0<br>seg001:0037                 jnz     short loc_1007C<br>seg001:0039                 lea     si, unk_1002F<br>seg001:003D                 lea     di, unk_10019<br>seg001:0041<br>seg001:0041 loc_10091:                              ; CODE XREF: start+50↓j<br>seg001:0041                 mov     al, [si]<br>seg001:0043                 mov     bl, [di]<br>seg001:0045                 add     si, 1<br>seg001:0048                 inc     di<br>seg001:0049                 cmp     al, bl<br>seg001:004B                 jnz     short loc_100AA<br>seg001:004D                 cmp     cx, 0<br>seg001:0050                 jnz     short loc_10091<br>seg001:0052                 lea     dx, unk_10013<br>seg001:0056                 mov     ah, 9<br>seg001:0058                 int     21h             ; DOS - PRINT STRING<br>seg001:0058                                         ; DS:DX -&gt; string terminated by &quot;$&quot;<br>seg001:005A<br>seg001:005A loc_100AA:                              ; CODE XREF: start+4B↑j<br>seg001:005A                 mov     ah, 4Ch<br>seg001:005C                 int     21h             ; DOS - 2+ - QUIT WITH EXIT CODE (EXIT)<br>seg001:005C start           endp                    ; AL = exit code<br>seg001:005C<br>seg001:005C seg001          ends<br>seg001:005C<br>seg001:005C<br>seg001:005C                 end start<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">data = [<span class="hljs-number">0x76</span>,<span class="hljs-number">0xe</span>,<span class="hljs-number">0x77</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0x6</span>,<span class="hljs-number">0x7d</span>,<span class="hljs-number">0x4</span>,<span class="hljs-number">0x6b</span>,<span class="hljs-number">0x1e</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x2a</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x2b</span>,<span class="hljs-number">0x5c</span>,<span class="hljs-number">0x3</span>,<span class="hljs-number">0x3b</span>,<span class="hljs-number">0xb</span>,<span class="hljs-number">0x33</span>,<span class="hljs-number">0x5</span>,<span class="hljs-number">0x15</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data),<span class="hljs-number">0</span>):<br>	<span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(data[i] ^ data[i+<span class="hljs-number">1</span>]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>



<h1 id="砸核桃"><a href="#砸核桃" class="headerlink" title="砸核桃"></a>砸核桃</h1><p>​	新壳，NsPacK3.x，国产壳，北斗，通常是病毒使用的壳。还以为网上能找到现成的脱壳工具，经过只有一个08年的老东西，还用不了了。看WP也是手动脱壳，我也手撕吧。还以为能和获得新工具了，哎，这也是个压缩壳，堆栈平衡同样适用。</p>
<p>​	32位程序，很明显的<code>pushfd</code>、<code>pushad</code>、<code>popfd</code>、<code>popad</code>指令。</p>
<p>​	然后就是最基础的异或加密，直接看脚本。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">xor = <span class="hljs-string">&quot;this_is_not_flag&quot;</span><br>enc = [<span class="hljs-number">0x12</span>,<span class="hljs-number">0x4</span>,<span class="hljs-number">0x8</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x5c</span>,<span class="hljs-number">0x4a</span>,<span class="hljs-number">0x3d</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0xa</span>,<span class="hljs-number">0x10</span>,<span class="hljs-number">0x67</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x41</span>,<span class="hljs-number">0x0</span>,<span class="hljs-number">0x1</span>,<span class="hljs-number">0x46</span>,<span class="hljs-number">0x5a</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x42</span>,<span class="hljs-number">0x6e</span>,<span class="hljs-number">0xc</span>,<span class="hljs-number">0x44</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0xc</span>,<span class="hljs-number">0xd</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0x3e</span>,<span class="hljs-number">0x4b</span>,<span class="hljs-number">0x5f</span>,<span class="hljs-number">0x2</span>,<span class="hljs-number">0x1</span>,<span class="hljs-number">0x4c</span>,<span class="hljs-number">0x5e</span>,<span class="hljs-number">0x5b</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x6e</span>,<span class="hljs-number">0xc</span>,<span class="hljs-number">0x16</span>,<span class="hljs-number">0x68</span>,<span class="hljs-number">0x5b</span>,<span class="hljs-number">0x12</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i] ^ <span class="hljs-built_in">ord</span>(xor[i % <span class="hljs-built_in">len</span>(xor)])), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>





<h1 id="DebugMe（APK）"><a href="#DebugMe（APK）" class="headerlink" title="DebugMe（APK）"></a>DebugMe（APK）</h1><p>​	apk逆向，先放一边。</p>
<p>​	JADX打开，没有可以看的代码，不知道怎么回事，很多乱码。我之前的文件都能显示，工具没有问题，那就是有防护手段了。不会，不想去搜了，直接看WP学习。</p>
<p>​	先找资源下载JEB，付费软件，得破解版。</p>
<p>​	下载好了，使用和JADX差不多，生成的项目文件都是和原文件保存在一起，这一点特别好，不需要我们自己去设置路径了，也不容易C盘爆了。</p>
<p>​	需要修改mainfest中的可调式属性。使用<code>apktool d DebugMe.apk -o out</code>解包，修改好后，使用命令<code>apktool b out -o target_debug.apk</code>重新打包。但是好像没有这么简单。</p>
<p>​	最后成功了，记录一下环境配置的过程。</p>
<p>​	首先，要使用MT管理器直接在模拟器中修改<code>Android.mainfest.xml</code>文件，添加<code>android:debuggable=&quot;true&quot;</code>，修改之后保存文件，然后使用MT自动打包成新的APK。</p>
<p>​	将新的APK通过模拟器的共享文件夹传回到电脑上，使用JEB打开反编译。之后就是开始调试APK了，注意：先要将<code>adb</code>添加到环境变量里面，JEB就是通过adb来找到模拟器设备的。然后使用 <code>adb devices</code>命令查看设备，然后使用命令<code>adb shell am start -D -n com.xyctf.ezapk/.MainActivity</code>启动待调试的进程，其中-n后面是待调试的包名等等。</p>
<p>​	再在JEB中打开调试器，选择好对应的模拟器和进程，就可以成功调试了。正常调试注意加断点再连接程序。</p>
<p><img src="/pictures/XYCTF2024/image-20250603173505598.png" alt="image-20250603173505598"></p>
<p>​	<code>XYCTF&#123;d3bugg3r_15_v3ry_u53ful&#125;</code></p>
<h1 id="舔狗四部曲–简爱"><a href="#舔狗四部曲–简爱" class="headerlink" title="舔狗四部曲–简爱"></a>舔狗四部曲–简爱</h1><p>​	一开始吧，DIE分析是ELF程序，就直接IDA打开。（但实际上是.o文件，使用gcc链接，当然IDA反编译出来代码都差不多）。</p>
<p>​	最后是对src数组和s数组进行比较，但是很奇怪的是，src数据就是没有变化，这里是对s数组加密两次后再使用howtolove函数加密，所以正常的逆向逻辑也应该是三次逆向函数解密。<img src="/pictures/XYCTF2024/image-20250602201458975.png" alt="image-20250602201458975"></p>
<p>​	但是，看WP可以分析知，程序的源码就是对密文和输入的，都进行了加密，然后调用howtolove，然后才比对，比对对象是<code>user_input_int</code>和<code>plaintext_int</code>。而howtolove加密的是<code>loveletter</code>，也就是说比对就是假比对，那一层encipher加密完全没有必要，就相当于在输入字符串和假flag进行明文比对。这个程序中的比对就不是正常的，我们不能按照正常的逻辑取预期我们输入正确flag就会输出正确的提示信息。不难猜出，作者想要告诉我们，howtolove函数才是加密的逻辑。</p>
<p>​	算了，不想多说了，我怀疑源码就是错的版本，怎么能这样验证啊。</p>
<p><img src="/pictures/XYCTF2024/image-20250602201907424.png" alt="image-20250602201907424"></p>
<p><img src="/pictures/XYCTF2024/image-20250602201956024.png" alt="image-20250602201956024"></p>
<p>​	分析半天，一调试就发现，dest是tm指向src的副本，v14是指向和s同样内容的，但是v14是指向s的副本的，后面的s才是真正对s数组进行加密的，所以实际上最后比对就是src数组和howtolove(s)得到的数组。</p>
<p>​	狗日的反编译一点看不出来，看着就是对指针进行操作，指向的就是同一个数组啊，再也不信反编译的伪代码了。</p>
<p>​	当然，后面问AI又想到一些：memcpy函数一般是对两个不同地址的数组进行复制操作，如果v14和s指针相同的话，那处理的就是同一块内存了，那复制还有什么意义呢！这里可能能get到一些异常之处，开始没有这个理解。</p>
<p>​	下面自己写的代码附上。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span> </span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">re_howtolove</span><span class="hljs-params">(<span class="hljs-type">char</span> *a1)</span><br>&#123;<br>    <span class="hljs-type">int</span> v2[<span class="hljs-number">1802</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-comment">//memset(v2, 0, sizeof(v2));</span><br>    v2[<span class="hljs-number">32</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">65</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">66</span>] = <span class="hljs-number">4</span>;<br>    v2[<span class="hljs-number">98</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">99</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">185</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">186</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">187</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">188</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">189</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">190</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">191</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">192</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">193</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">194</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">195</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">196</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">197</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">198</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">199</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">200</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">201</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">202</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">203</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">204</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">205</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">206</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">207</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">208</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">209</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">210</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">211</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">212</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">213</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">214</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">215</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">216</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">217</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">218</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">219</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">220</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">221</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">222</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">223</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">224</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">225</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">226</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">227</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">228</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">229</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">232</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">256</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">257</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">303</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">304</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">305</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">306</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">307</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">308</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">328</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">329</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">330</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">331</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">332</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">333</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">334</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">335</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">336</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">337</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">338</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">339</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">340</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">341</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">342</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">353</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">354</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">430</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">431</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">432</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">523</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">524</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">564</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">565</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">627</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">628</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">629</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">630</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">631</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">632</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">633</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">634</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">635</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">636</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">637</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">638</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">639</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">640</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">641</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">642</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">643</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">644</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">645</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">646</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">647</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">648</span>] = <span class="hljs-number">4</span>;<br>    v2[<span class="hljs-number">649</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">650</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">651</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">652</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">653</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">680</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">687</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">688</span>] = <span class="hljs-number">4</span>;<br>    v2[<span class="hljs-number">698</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">766</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">767</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">818</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">819</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">820</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">827</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">828</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">846</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">847</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">890</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">891</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">892</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">893</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">894</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">895</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">896</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">897</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">898</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">899</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">900</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">901</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">902</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">903</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">904</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">905</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">906</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">907</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">908</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">909</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">910</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">911</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">912</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">913</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">914</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">915</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">916</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">917</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">918</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">919</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">920</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">921</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">922</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">923</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">924</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">925</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">926</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">927</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">928</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">929</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">930</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">931</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">932</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">933</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">934</span>] = <span class="hljs-number">5</span>;<br>    v2[<span class="hljs-number">989</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">994</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">995</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">996</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">997</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">998</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">999</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1000</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1001</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1002</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1003</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1013</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1014</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1015</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1016</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1017</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1018</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1019</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1020</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1021</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1022</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1023</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1024</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1025</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1026</span>] = <span class="hljs-number">1</span>;<br>    v2[<span class="hljs-number">1027</span>] = <span class="hljs-number">2</span>;<br>    v2[<span class="hljs-number">1028</span>] = <span class="hljs-number">3</span>;<br><br>    <span class="hljs-type">int</span> v3 =<span class="hljs-number">1027</span>,v4 =<span class="hljs-number">31</span>;<br>    <br>    <span class="hljs-comment">// for(; v3&gt;=0; --v3)</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     switch(v2[v3])</span><br>    <span class="hljs-comment">//     &#123;</span><br>    <span class="hljs-comment">//         case 0:</span><br>    <span class="hljs-comment">//             --crypted[v4];</span><br>    <span class="hljs-comment">//             break;</span><br>    <span class="hljs-comment">//         case 1:</span><br>    <span class="hljs-comment">//             ++crypted[v4];</span><br>    <span class="hljs-comment">//             break;</span><br>    <span class="hljs-comment">//         case 2:</span><br>    <span class="hljs-comment">//             v4--;</span><br>    <span class="hljs-comment">//             break;</span><br>    <span class="hljs-comment">//         case 4:</span><br>    <span class="hljs-comment">//             crypted[v4] -= crypted[v4+1] + 70 ;		这里就是错误之处，这个错误语句等价于-(crypted[v4+1]+70)，是错误的啊，我们要的实际上是-crypted[v4+1]-70。</span><br>    <span class="hljs-comment">//             break;</span><br>    <span class="hljs-comment">//         case 5:</span><br>    <span class="hljs-comment">//             crypted[v4] += crypted[v4+1] - 70 ;			这里同理。</span><br>    <span class="hljs-comment">//             break;</span><br>    <span class="hljs-comment">//         default:</span><br>    <span class="hljs-comment">//             break;</span><br>    <span class="hljs-comment">//     &#125;</span><br>    <span class="hljs-comment">// &#125;</span><br>    <br>    <span class="hljs-keyword">for</span>(; v3&gt;=<span class="hljs-number">0</span>; --v3)<br>    &#123;<br>        <span class="hljs-keyword">switch</span>(v2[v3])<br>        &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>                --a1[v4];<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>                ++a1[v4];<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>                v4--;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<br>                a1[v4] = a1[v4] - a1[v4+<span class="hljs-number">1</span>] + <span class="hljs-number">70</span> ;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:<br>                a1[v4] = a1[v4] + a1[v4+<span class="hljs-number">1</span>] - <span class="hljs-number">70</span> ;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">default</span>:<br>                <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//无用的tea</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">detea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">uint32_t</span> *k)</span><br>&#123;<br>    <span class="hljs-type">int</span> rounds = <span class="hljs-number">52</span>;<br>    <span class="hljs-type">uint32_t</span> v0 = v[<span class="hljs-number">0</span>];<br>    <span class="hljs-type">uint32_t</span> v1 = v[<span class="hljs-number">1</span>];<br>    <span class="hljs-type">uint32_t</span> delta = <span class="hljs-number">0x9E3779B9</span>;<br>    <span class="hljs-type">uint32_t</span> sum = delta * rounds;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;rounds;i++)<br>    &#123;<br>        v1 -= (((v0 &gt;&gt; <span class="hljs-number">4</span>)^(v0&lt;&lt;<span class="hljs-number">5</span>)) + v0) ^ (k[(sum &gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>] + sum);<br>        sum -= delta;<br>        v0 -= (((v1 &gt;&gt; <span class="hljs-number">4</span>)^(v1&lt;&lt;<span class="hljs-number">5</span>)) + v1) ^ (k[sum &amp; <span class="hljs-number">3</span>] + sum);<br>    &#125;<br>    v[<span class="hljs-number">0</span>] = v0;<br>    v[<span class="hljs-number">1</span>] = v1;<br>&#125;<br><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">char</span> crypted[<span class="hljs-number">32</span>] = <span class="hljs-string">&quot;flag&#123;Love_is_not_one_sided_Love&#125;&quot;</span>;<br>    re_howtolove(crypted);<br>    <span class="hljs-comment">//uint32_t key[4] = &#123;0x12345678,0x9ABCDEF0,0x9AB111F0,0x9A323EF0&#125;;</span><br>    <span class="hljs-comment">//detea((uint32_t *)crypted, key);</span><br>    <span class="hljs-comment">//detea((uint32_t *)crypted, key);</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">32</span>;i++)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,crypted[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>













<h1 id="何须相思煮余年"><a href="#何须相思煮余年" class="headerlink" title="何须相思煮余年"></a>何须相思煮余年</h1><p>​	给了个纯文本，6，看着应该是机器码和密文。结果跪了，32、64位都不行。</p>
<p>​	看WP使用了一个python库，来进行反汇编，是x86-32的。</p>
<p>​	下面是反汇编的代码。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> capstone <span class="hljs-keyword">import</span> *<br><br>code = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">0x55  0x8b  0xec  0x81  0xec  0xa8  0x0  0x0  0x0  0xa1  0x0  0x40  0x41  0x0  0x33  0xc5  0x89  0x45  0xfc  0x68  0x9c  0x0  0x0  0x0  0x6a  0x0  0x8d  0x85  0x60  0xff  0xff  0xff  0x50  0xe8  0x7a  0xc  0x0  0x0  0x83  0xc4  0xc  0xc7  0x85  0x58  0xff  0xff  0xff  0x27  0x0  0x0  0x0  0xc7  0x85  0x5c  0xff  0xff  0xff  0x0  0x0  0x0  0x0  0xeb  0xf  0x8b  0x8d  0x5c  0xff  0xff  0xff  0x83  0xc1  0x1  0x89  0x8d  0x5c  0xff  0xff  0xff  0x83  0xbd  0x5c  0xff  0xff  0xff  0x27  0xf  0x8d  0xed  0x0  0x0  0x0  0x8b  0x95  0x5c  0xff  0xff  0xff  0x81  0xe2  0x3  0x0  0x0  0x80  0x79  0x5  0x4a  0x83  0xca  0xfc  0x42  0x85  0xd2  0x75  0x25  0x8b  0x85  0x5c  0xff  0xff  0xff  0x8b  0x8c  0x85  0x60  0xff  0xff  0xff  0x3  0x8d  0x5c  0xff  0xff  0xff  0x8b  0x95  0x5c  0xff  0xff  0xff  0x89  0x8c  0x95  0x60  0xff  0xff  0xff  0xe9  0xac  0x0  0x0  0x0  0x8b  0x85  0x5c  0xff  0xff  0xff  0x25  0x3  0x0  0x0  0x80  0x79  0x5  0x48  0x83  0xc8  0xfc  0x40  0x83  0xf8  0x1  0x75  0x22  0x8b  0x8d  0x5c  0xff  0xff  0xff  0x8b  0x94  0x8d  0x60  0xff  0xff  0xff  0x2b  0x95  0x5c  0xff  0xff  0xff  0x8b  0x85  0x5c  0xff  0xff  0xff  0x89  0x94  0x85  0x60  0xff  0xff  0xff  0xeb  0x73  0x8b  0x8d  0x5c  0xff  0xff  0xff  0x81  0xe1  0x3  0x0  0x0  0x80  0x79  0x5  0x49  0x83  0xc9  0xfc  0x41  0x83  0xf9  0x2  0x75  0x23  0x8b  0x95  0x5c  0xff  0xff  0xff  0x8b  0x84  0x95  0x60  0xff  0xff  0xff  0xf  0xaf  0x85  0x5c  0xff  0xff  0xff  0x8b  0x8d  0x5c  0xff  0xff  0xff  0x89  0x84  0x8d  0x60  0xff  0xff  0xff  0xeb  0x38  0x8b  0x95  0x5c  0xff  0xff  0xff  0x81  0xe2  0x3  0x0  0x0  0x80  0x79  0x5  0x4a  0x83  0xca  0xfc  0x42  0x83  0xfa  0x3  0x75  0x20  0x8b  0x85  0x5c  0xff  0xff  0xff  0x8b  0x8c  0x85  0x60  0xff  0xff  0xff  0x33  0x8d  0x5c  0xff  0xff  0xff  0x8b  0x95  0x5c  0xff  0xff  0xff  0x89  0x8c  0x95  0x60  0xff  0xff  0xff  0xe9  0xf7  0xfe  0xff  0xff  0x33  0xc0  0x8b  0x4d  0xfc  0x33  0xcd  0xe8  0x4  0x0  0x0  0x0  0x8b  0xe5  0x5d  0xc3</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br>opcode = []<br>code = code.split()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(code), <span class="hljs-number">1</span>):<br>    opcode.append(<span class="hljs-built_in">int</span>(code[i][<span class="hljs-number">2</span>:], <span class="hljs-number">16</span>))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(opcode[i]), end=<span class="hljs-string">&#x27; &#x27;</span>)<br><br><br>opcode = <span class="hljs-built_in">bytes</span>(opcode)<br><br>BaseAddr = <span class="hljs-number">0</span><br><br>md = Cs(CS_ARCH_X86, CS_MODE_32)<br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> md.disasm(opcode, <span class="hljs-number">0</span>):<br>    addr = x.address + BaseAddr<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(addr)[<span class="hljs-number">2</span>:],x.mnemonic,x.op_str)<br></code></pre></td></tr></table></figure>

<p>​	这个题还是一点难度的，需要擅长汇编代码，或者擅长chatgpt（哈哈）。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs assembly">1 mov ebp, esp<br>3 sub esp, 0xa8<br>9 mov eax, dword ptr [0x414000]<br>e xor eax, ebp<br>10 mov dword ptr [ebp - 4], eax<br>13 push 0x9c<br>18 push 0<br>1a lea eax, [ebp - 0xa0]<br>20 push eax<br>21 call 0xca0<br>26 add esp, 0xc<br>29 mov dword ptr [ebp - 0xa8], 0x27<br>33 mov dword ptr [ebp - 0xa4], 0<br>3d jmp 0x4e<br>3f mov ecx, dword ptr [ebp - 0xa4]<br>45 add ecx, 1<br>48 mov dword ptr [ebp - 0xa4], ecx			;i++<br>4e cmp dword ptr [ebp - 0xa4], 0x27			;i&lt;0x27<br>55 jge 0x148<br>5b mov edx, dword ptr [ebp - 0xa4]<br>61 and edx, 0x80000003						;取符号位和最低2位<br>67 jns 0x6e									;结果非负跳转<br>69 dec edx<br>6a or edx, 0xfffffffc<br>6d inc edx<br>6e test edx, edx					;按位与，但不保存结果，只设置标志位Z<br>70 jne 0x97								;edx!=0跳转<br>72 mov eax, dword ptr [ebp - 0xa4]<br>78 mov ecx, dword ptr [ebp + eax*4 - 0xa0]		;数组取值，设数组是s<br>7f add ecx, dword ptr [ebp - 0xa4]			;s[i]+i<br>85 mov edx, dword ptr [ebp - 0xa4]<br>8b mov dword ptr [ebp + edx*4 - 0xa0], ecx    ;s[i]=s[i]+i<br>92 jmp 0x143<br>97 mov eax, dword ptr [ebp - 0xa4]<br>9d and eax, 0x80000003<br>a2 jns 0xa9							;符号位为0跳转<br>a4 dec eax<br>a5 or eax, 0xfffffffc<br>a8 inc eax<br>a9 cmp eax, 1				<br>ac jne 0xd0<br>ae mov ecx, dword ptr [ebp - 0xa4]<br>b4 mov edx, dword ptr [ebp + ecx*4 - 0xa0]<br>bb sub edx, dword ptr [ebp - 0xa4]			;s[i]-i<br>c1 mov eax, dword ptr [ebp - 0xa4]<br>c7 mov dword ptr [ebp + eax*4 - 0xa0], edx		;s[i]=s[i]-i<br>ce jmp 0x143<br>d0 mov ecx, dword ptr [ebp - 0xa4]<br>d6 and ecx, 0x80000003<br>dc jns 0xe3<br>de dec ecx<br>df or ecx, 0xfffffffc<br>e2 inc ecx<br>e3 cmp ecx, 2<br>e6 jne 0x10b<br>e8 mov edx, dword ptr [ebp - 0xa4]<br>ee mov eax, dword ptr [ebp + edx*4 - 0xa0]<br>f5 imul eax, dword ptr [ebp - 0xa4]		;s[i] * i<br>fc mov ecx, dword ptr [ebp - 0xa4]<br>102 mov dword ptr [ebp + ecx*4 - 0xa0], eax<br>109 jmp 0x143<br>10b mov edx, dword ptr [ebp - 0xa4]<br>111 and edx, 0x80000003<br>117 jns 0x11e<br>119 dec edx<br>11a or edx, 0xfffffffc<br>11d inc edx<br>11e cmp edx, 3<br>121 jne 0x143<br>123 mov eax, dword ptr [ebp - 0xa4]<br>129 mov ecx, dword ptr [ebp + eax*4 - 0xa0]<br>130 xor ecx, dword ptr [ebp - 0xa4]			;s[i] ^ i<br>136 mov edx, dword ptr [ebp - 0xa4]<br>13c mov dword ptr [ebp + edx*4 - 0xa0], ecx<br>143 jmp 0x3f<br>148 xor eax, eax<br>14a mov ecx, dword ptr [ebp - 4]<br>14d xor ecx, ebp<br>14f call 0x158<br>154 mov esp, ebp<br>156 pop ebp<br>157 ret <br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc = [<span class="hljs-number">88</span>,<span class="hljs-number">88</span>,<span class="hljs-number">134</span>,<span class="hljs-number">87</span>,<span class="hljs-number">74</span>,<span class="hljs-number">118</span>,<span class="hljs-number">318</span>,<span class="hljs-number">101</span>,<span class="hljs-number">59</span>,<span class="hljs-number">92</span>,<span class="hljs-number">480</span>,<span class="hljs-number">60</span>,<span class="hljs-number">65</span>,<span class="hljs-number">41</span>,<span class="hljs-number">770</span>,<span class="hljs-number">110</span>,<span class="hljs-number">73</span>,<span class="hljs-number">31</span>,<span class="hljs-number">918</span>,<span class="hljs-number">39</span>,<span class="hljs-number">120</span>,<span class="hljs-number">27</span>,<span class="hljs-number">1188</span>,<span class="hljs-number">47</span>,<span class="hljs-number">77</span>,<span class="hljs-number">24</span>,<span class="hljs-number">1352</span>,<span class="hljs-number">44</span>,<span class="hljs-number">81</span>,<span class="hljs-number">23</span>,<span class="hljs-number">1680</span>,<span class="hljs-number">46</span>,<span class="hljs-number">85</span>,<span class="hljs-number">15</span>,<span class="hljs-number">1870</span>,<span class="hljs-number">66</span>,<span class="hljs-number">91</span>,<span class="hljs-number">16</span>,<span class="hljs-number">4750</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">4</span> == <span class="hljs-number">0</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i]-i), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">4</span> == <span class="hljs-number">1</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i]+i), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">4</span> == <span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i]//i), end=<span class="hljs-string">&#x27;&#x27;</span>)			<span class="hljs-comment">#需要是整除，向下取整</span><br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">4</span> == <span class="hljs-number">3</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i]^i), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <span class="hljs-keyword">continue</span><br></code></pre></td></tr></table></figure>





<h1 id="ez-enc"><a href="#ez-enc" class="headerlink" title="ez_enc"></a>ez_enc</h1><p>​	</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc = [<span class="hljs-number">0x27</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0xb</span>,<span class="hljs-number">0x50</span>,<span class="hljs-number">0x3</span>,<span class="hljs-number">0xc8</span>,<span class="hljs-number">0xc</span>,<span class="hljs-number">0x1f</span>,<span class="hljs-number">0x17</span>,<span class="hljs-number">0x36</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0xcb</span>,<span class="hljs-number">0x2d</span>,<span class="hljs-number">0xe9</span>,<span class="hljs-number">0x32</span>,<span class="hljs-number">0xe</span>,<span class="hljs-number">0x11</span>,<span class="hljs-number">0x26</span>,<span class="hljs-number">0x2</span>,<span class="hljs-number">0xc</span>,<span class="hljs-number">0x7</span>,<span class="hljs-number">0xfc</span>,<span class="hljs-number">0x27</span>,<span class="hljs-number">0x3d</span>,<span class="hljs-number">0x2d</span>,<span class="hljs-number">0xed</span>,<span class="hljs-number">0x35</span>,<span class="hljs-number">0x59</span>,<span class="hljs-number">0xeb</span>,<span class="hljs-number">0x3c</span>,<span class="hljs-number">0x3e</span>,<span class="hljs-number">0xe4</span>,<span class="hljs-number">0x7d</span>]<br><br>key = <span class="hljs-string">&quot;IMouto&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)-<span class="hljs-number">2</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>    enc[i] = enc[i] ^ <span class="hljs-built_in">ord</span>(key[i%<span class="hljs-number">6</span>])<br>    enc[i] = enc[i] - enc[i+<span class="hljs-number">1</span>]<br>	<br>    <span class="hljs-comment">#用上一个字符求出来的tmp必满足在0到20之间的限制</span><br>    tmp = enc[i-<span class="hljs-number">1</span>] ^ <span class="hljs-built_in">ord</span>(key[(i-<span class="hljs-number">1</span>)%<span class="hljs-number">6</span>])<br>    tmp = tmp - enc[i]<br>    enc[i] += tmp // <span class="hljs-number">20</span> * <span class="hljs-number">20</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;f&quot;</span>, end=<span class="hljs-string">&quot;&quot;</span>)		<span class="hljs-comment">#第一个就不用算了</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(enc)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i]), end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure>





<h1 id="baby-unity"><a href="#baby-unity" class="headerlink" title="baby unity"></a>baby unity</h1><p>​	游戏是unity做的输入验证文本框？哈，这么搞是吧，小游戏都不给玩，不会逆，直接学WP。</p>
<p>​	GameAssembly.dll和baby unity.exe都被upx压缩了一下，师傅说单纯为了减少附件的大小，哈，还得先去壳。</p>
<p>​	先使用Il2CppDumper.exe恢复符号信息，先选.dll文件，再选.bat文件。然后使用IDA打开DLL文件，使用python脚本ida_with_struct_py3.py加载刚刚得到的script.json和il2cpp.h文件。</p>
<p>​	再使用dnSpy去查看Assembly-CSharp.dll文件，看其中可疑的类名、方法名，但是里面是没办法看源码的，所以要回到IDA中查看反编译的源码，由于恢复了符号信息，所以我们使用IDA直接搜索函数名就行了。</p>
<p><img src="/pictures/XYCTF2024/image-20250605150220575.png" alt="image-20250605150220575"></p>
<p><img src="/pictures/XYCTF2024/image-20250605150236561.png" alt="image-20250605150236561"></p>
<p>​	看到IDA，我们换个主题颜色，之前的有点看腻了。看到明显的base64和异或0xF，比较奇怪的是密文居然是在注释里，难不成这个8字节保存的是一个指针，指向其他文件中的字符串，这里能看到是因为恢复了符号信息，这里自动把字符串取出放在这里了？</p>
<p>​	之后赛博厨子解密就好。</p>
<p><img src="/pictures/XYCTF2024/image-20250605151110999.png" alt="image-20250605151110999"></p>
<p><img src="/pictures/XYCTF2024/image-20250605151155177.png" alt="image-20250605151155177"></p>
<h1 id="ez-unity（未做，环境不行）"><a href="#ez-unity（未做，环境不行）" class="headerlink" title="ez unity（未做，环境不行）"></a>ez unity（未做，环境不行）</h1><p>​	这种il2cpp的unity逆向完全没有接触过，现在都是实行WP学习大法，配环境就花了好长时间，下面记录一下我踩的坑。</p>
<p>​	首先将能够生成hook.js脚本的方法，先通过pip下载好frida和frida-tools工具，然后通过<code>npm i frida-il2cpp-bridge</code>命令下载下来框架，然后配置package.json文件，具体内容根据需要配置（当然去抄），<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44292683/article/details/132125663">详细的教程</a>文章就是这个，就是其中的方法2。</p>
<p>​	在一切准备就绪后，我执行第一个注入命令就报错了，我反复更换文件，更换frida环境到16.2.1和17.1.0，也重下了题目附件，在虚拟机CTFOS和本机上都试过了，但是都是报出同样一个错误，我完全不理解是为什么。</p>
<p><img src="/pictures/XYCTF2024/image-20250606202411829.png" alt="image-20250606202411829"></p>
<p>​	后面使用教程的第一种方法编译frida-il2cpp-bridge项目后，也是没能解决问题。</p>
<p><img src="/pictures/XYCTF2024/image-20250606204030666.png" alt="image-20250606204030666"></p>
<p>​	</p>
<h1 id="ezmath"><a href="#ezmath" class="headerlink" title="ezmath"></a>ezmath</h1><p>​	python逆向，一个二次多项式求解问题，学习z3求解器。解包出来，是以这种形式来表示乘积的：<code>sum( (lambda .0: [ flag[23] for _ in .0 ])(range(flag[23])) )</code>。</p>
<p>​	强行使用z3破解，耗时很长，我等了十几分钟都没结果，不知道还要算多久，直接看WP，有一个很巧妙的思路，因为这个二次多项式&#x3D;0，而且式子中每个二次项的系数都是1，我们知道(x_i - ord(flag[i]))**2 &#x3D; 0，那么所有的这些式子展开就会得到该题的的式子，也就是说，附件中给出的二次多项式就是将二次平方项展开的结果。这样就有一个规律了，所有的一次项系数除以2就是对应的常数值（对应flag的ASCII码值）。</p>
<p>​	应该说这是一个数学推导技巧，在数学题中也会使用的技巧。初中生都会，大学生想不到一点。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> re<br><span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">flag = (lambda .0: [ ord(i) for i in .0 ])(input(&#x27;flag:&#x27;))</span><br><span class="hljs-string">if len(flag) == 32 and (((((((((((((((((((((sum((lambda .0: [ flag[23] for _ in .0 ])(range(flag[23]))) + sum((lambda .0: [ flag[12] for _ in .0 ])(range(flag[12]))) + sum((lambda .0: [ flag[1] for _ in .0 ])(range(flag[1]))) - sum((lambda .0: [ flag[24] for _ in .0 ])(range(222)))) + sum((lambda .0: [ flag[22] for _ in .0 ])(range(flag[22]))) + sum((lambda .0: [ flag[31] for _ in .0 ])(range(flag[31]))) + sum((lambda .0: [ flag[26] for _ in .0 ])(range(flag[26]))) - sum((lambda .0: [ flag[9] for _ in .0 ])(range(178))) - sum((lambda .0: [ flag[29] for _ in .0 ])(range(232)))) + sum((lambda .0: [ flag[17] for _ in .0 ])(range(flag[17]))) - sum((lambda .0: [ flag[23] for _ in .0 ])(range(150))) - sum((lambda .0: [ flag[6] for _ in .0 ])(range(226))) - sum((lambda .0: [ flag[7] for _ in .0 ])(range(110)))) + sum((lambda .0: [ flag[19] for _ in .0 ])(range(flag[19]))) + sum((lambda .0: [ flag[2] for _ in .0 ])(range(flag[2]))) - sum((lambda .0: [ flag[0] for _ in .0 ])(range(176)))) + sum((lambda .0: [ flag[10] for _ in .0 ])(range(flag[10]))) - sum((lambda .0: [ flag[12] for _ in .0 ])(range(198)))) + sum((lambda .0: [ flag[24] for _ in .0 ])(range(flag[24]))) + sum((lambda .0: [ flag[9] for _ in .0 ])(range(flag[9]))) - sum((lambda .0: [ flag[3] for _ in .0 ])(range(168)))) + sum((lambda .0: [ flag[8] for _ in .0 ])(range(flag[8]))) - sum((lambda .0: [ flag[2] for _ in .0 ])(range(134)))) + sum((lambda .0: [ flag[14] for _ in .0 ])(range(flag[14]))) - sum((lambda .0: [ flag[13] for _ in .0 ])(range(170)))) + sum((lambda .0: [ flag[4] for _ in .0 ])(range(flag[4]))) - sum((lambda .0: [ flag[10] for _ in .0 ])(range(142)))) + sum((lambda .0: [ flag[27] for _ in .0 ])(range(flag[27]))) + sum((lambda .0: [ flag[15] for _ in .0 ])(range(flag[15]))) - sum((lambda .0: [ flag[15] for _ in .0 ])(range(224)))) + sum((lambda .0: [ flag[16] for _ in .0 ])(range(flag[16]))) - sum((lambda .0: [ flag[11] for _ in .0 ])(range(230))) - sum((lambda .0: [ flag[1] for _ in .0 ])(range(178)))) + sum((lambda .0: [ flag[28] for _ in .0 ])(range(flag[28]))) - sum((lambda .0: [ flag[5] for _ in .0 ])(range(246))) - sum((lambda .0: [ flag[17] for _ in .0 ])(range(168)))) + sum((lambda .0: [ flag[30] for _ in .0 ])(range(flag[30]))) - sum((lambda .0: [ flag[21] for _ in .0 ])(range(220))) - sum((lambda .0: [ flag[22] for _ in .0 ])(range(212))) - sum((lambda .0: [ flag[16] for _ in .0 ])(range(232)))) + sum((lambda .0: [ flag[25] for _ in .0 ])(range(flag[25]))) - sum((lambda .0: [ flag[4] for _ in .0 ])(range(140))) - sum((lambda .0: [ flag[31] for _ in .0 ])(range(250))) - sum((lambda .0: [ flag[28] for _ in .0 ])(range(150)))) + sum((lambda .0: [ flag[11] for _ in .0 ])(range(flag[11]))) + sum((lambda .0: [ flag[13] for _ in .0 ])(range(flag[13]))) - sum((lambda .0: [ flag[14] for _ in .0 ])(range(234)))) + sum((lambda .0: [ flag[7] for _ in .0 ])(range(flag[7]))) - sum((lambda .0: [ flag[8] for _ in .0 ])(range(174)))) + sum((lambda .0: [ flag[3] for _ in .0 ])(range(flag[3]))) - sum((lambda .0: [ flag[25] for _ in .0 ])(range(242)))) + sum((lambda .0: [ flag[29] for _ in .0 ])(range(flag[29]))) + sum((lambda .0: [ flag[5] for _ in .0 ])(range(flag[5]))) - sum((lambda .0: [ flag[30] for _ in .0 ])(range(142))) - sum((lambda .0: [ flag[26] for _ in .0 ])(range(170))) - sum((lambda .0: [ flag[19] for _ in .0 ])(range(176)))) + sum((lambda .0: [ flag[0] for _ in .0 ])(range(flag[0]))) - sum((lambda .0: [ flag[27] for _ in .0 ])(range(168)))) + sum((lambda .0: [ flag[20] for _ in .0 ])(range(flag[20]))) - sum((lambda .0: [ flag[20] for _ in .0 ])(range(212)))) + sum((lambda .0: [ flag[21] for _ in .0 ])(range(flag[21]))) + sum((lambda .0: [ flag[6] for _ in .0 ])(range(flag[6]))) + sum((lambda .0: [ flag[18] for _ in .0 ])(range(flag[18]))) - sum((lambda .0: [ flag[18] for _ in .0 ])(range(178)))) + 297412 == 0:</span><br><span class="hljs-string">    print(&#x27;yes&#x27;)</span><br><span class="hljs-string">    return None</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-comment">#正则表达式中，]不需要转义啊。</span><br>pattern = <span class="hljs-string">r&quot;sum\(\(lambda .0: \[ flag\[(\d+)] for _ in .0 ]\)\(range\((\d+)\)\)\)&quot;</span><br><br>matches = re.findall(pattern, <span class="hljs-built_in">str</span>)<br><br>flag = [<span class="hljs-number">0</span>] * <span class="hljs-number">32</span><br><br><span class="hljs-keyword">for</span> <span class="hljs-keyword">match</span> <span class="hljs-keyword">in</span> matches:<br>    flag[<span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>[<span class="hljs-number">0</span>])] = <span class="hljs-built_in">int</span>(<span class="hljs-keyword">match</span>[<span class="hljs-number">1</span>])//<span class="hljs-number">2</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>







<h1 id="舔狗四部曲–相逢已是上上签"><a href="#舔狗四部曲–相逢已是上上签" class="headerlink" title="舔狗四部曲–相逢已是上上签"></a>舔狗四部曲–相逢已是上上签</h1><p>​	又是8086+DOS系列，IDA直接打开还不行。算了，乱七八糟的，直接看WP。</p>
<p>​	有标志位被修改了，如下图，正常情况下，上面的红框应该是下面的PE头的地址，这里被改了，要改回0x100，也就是0001。之后就能IDA正常识别了。</p>
<p><img src="/pictures/XYCTF2024/image-20250601115228908.png" alt="image-20250601115228908"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#z3破解key</span><br><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># 定义变量，假设是整数</span><br>byte = [Int(<span class="hljs-string">f&#x27;byte_<span class="hljs-subst">&#123;i&#125;</span>&#x27;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>)]<br><br>s = Solver()<br><br><span class="hljs-comment"># 变量范围假设：比如字节可打印字符范围(32~126)，或者0~255</span><br><span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> byte:<br>    s.add(b &gt;= <span class="hljs-number">32</span>, b &lt;= <span class="hljs-number">126</span>)<br><br><span class="hljs-comment"># 添加方程</span><br>s.add(<br>    <span class="hljs-number">532</span> * byte[<span class="hljs-number">5</span>] + <span class="hljs-number">829</span> * byte[<span class="hljs-number">4</span>] + <span class="hljs-number">258</span> * byte[<span class="hljs-number">3</span>] + <span class="hljs-number">811</span> * byte[<span class="hljs-number">2</span>] + <span class="hljs-number">997</span> * byte[<span class="hljs-number">1</span>] + <span class="hljs-number">593</span> * byte[<span class="hljs-number">0</span>] == <span class="hljs-number">292512</span>,<br>    <span class="hljs-number">576</span> * byte[<span class="hljs-number">5</span>] + <span class="hljs-number">695</span> * byte[<span class="hljs-number">4</span>] + <span class="hljs-number">602</span> * byte[<span class="hljs-number">3</span>] + <span class="hljs-number">328</span> * byte[<span class="hljs-number">2</span>] + <span class="hljs-number">686</span> * byte[<span class="hljs-number">1</span>] + <span class="hljs-number">605</span> * byte[<span class="hljs-number">0</span>] == <span class="hljs-number">254496</span>,<br>    <span class="hljs-number">580</span> * byte[<span class="hljs-number">5</span>] + <span class="hljs-number">448</span> * byte[<span class="hljs-number">4</span>] + <span class="hljs-number">756</span> * byte[<span class="hljs-number">3</span>] + <span class="hljs-number">449</span> * byte[<span class="hljs-number">2</span>] + <span class="hljs-number">512</span> * byte[<span class="hljs-number">1</span>] + <span class="hljs-number">373</span> * byte[<span class="hljs-number">0</span>] == <span class="hljs-number">222479</span>,<br>    <span class="hljs-number">597</span> * byte[<span class="hljs-number">5</span>] + <span class="hljs-number">855</span> * byte[<span class="hljs-number">4</span>] + <span class="hljs-number">971</span> * byte[<span class="hljs-number">3</span>] + <span class="hljs-number">422</span> * byte[<span class="hljs-number">2</span>] + <span class="hljs-number">635</span> * byte[<span class="hljs-number">1</span>] + <span class="hljs-number">560</span> * byte[<span class="hljs-number">0</span>] == <span class="hljs-number">295184</span>,<br>    <span class="hljs-number">524</span> * byte[<span class="hljs-number">5</span>] + <span class="hljs-number">324</span> * byte[<span class="hljs-number">4</span>] + <span class="hljs-number">925</span> * byte[<span class="hljs-number">3</span>] + <span class="hljs-number">388</span> * byte[<span class="hljs-number">2</span>] + <span class="hljs-number">507</span> * byte[<span class="hljs-number">1</span>] + <span class="hljs-number">717</span> * byte[<span class="hljs-number">0</span>] == <span class="hljs-number">251887</span>,<br>    <span class="hljs-number">414</span> * byte[<span class="hljs-number">5</span>] + <span class="hljs-number">495</span> * byte[<span class="hljs-number">4</span>] + <span class="hljs-number">518</span> * byte[<span class="hljs-number">3</span>] + <span class="hljs-number">884</span> * byte[<span class="hljs-number">2</span>] + <span class="hljs-number">368</span> * byte[<span class="hljs-number">1</span>] + <span class="hljs-number">312</span> * byte[<span class="hljs-number">0</span>] == <span class="hljs-number">211260</span><br>)<br><br><span class="hljs-keyword">if</span> s.check() == sat:<br>    model = s.model()<br>    solution = [model[b].as_long() <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> byte]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">6</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(solution[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No solution found.&quot;</span>)<br><span class="hljs-comment">#XYCTF!</span><br></code></pre></td></tr></table></figure>

<p>​	这个币题有怪东西，脚本绝对有怪东西。今天就让我碰上了，真tm晦气。。</p>
<p>​	下面是我照着WP改了一点能跑的脚本。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//xxtea解密</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;stdint.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> DELTA 0x9E3779B9</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MX (((z ^ key[e ^ (p &amp; 5)]) + (y ^ sum)) ^ (((z <span class="hljs-string">&lt;&lt; 4) ^(y &gt;</span>&gt; 3)) + ((y <span class="hljs-string">&lt;&lt; 2) ^ (z &gt;</span>&gt; 5))))</span><br><br><span class="hljs-type">void</span> <span class="hljs-title function_">dexxtea</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> *v, <span class="hljs-type">int</span> n, <span class="hljs-type">char</span> *key)</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> e = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint32_t</span> rounds = <span class="hljs-number">6</span> + <span class="hljs-number">52</span> / n;<br>    <span class="hljs-type">uint32_t</span> sum = DELTA * rounds;<br>    <span class="hljs-type">uint32_t</span> y = <span class="hljs-number">0</span>, z = <span class="hljs-number">0</span>;<br>    <span class="hljs-type">uint32_t</span> p;<br>    <span class="hljs-keyword">do</span>&#123;<br>        e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">5</span>;<br>        <span class="hljs-keyword">for</span>(p=n<span class="hljs-number">-1</span>; p&gt;<span class="hljs-number">0</span>; p--)<br>        &#123;<br>            y = v[(p+<span class="hljs-number">1</span>)%n];     <span class="hljs-comment">//保存加密位的后一位</span><br>            z = v[(p<span class="hljs-number">-1</span>)%n];         <span class="hljs-comment">//保存加密位的前一位</span><br>            v[p] -= MX;<br>        &#125;<br>        y = v[(p+<span class="hljs-number">1</span>)%n];     <span class="hljs-comment">//保存加密位的后一位</span><br>        z = v[(p<span class="hljs-number">-1</span>)%n];         <span class="hljs-comment">//保存加密位的前一位</span><br>        v[p] -= MX;<br>        sum -= DELTA;<br>    &#125;<span class="hljs-keyword">while</span>(--rounds);<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> enc[<span class="hljs-number">8</span>] = &#123;<span class="hljs-number">0x66697271</span>,<span class="hljs-number">0x896E2285</span>,<span class="hljs-number">0xC5188C1B</span>,<span class="hljs-number">0x72BCFD03</span>,<span class="hljs-number">0x538011CA</span>,<span class="hljs-number">0x4DA146AC</span>,<span class="hljs-number">0x86630D6B</span>,<span class="hljs-number">0xF89797F0</span>&#125;;<br>    <span class="hljs-type">char</span> *key = <span class="hljs-string">&quot;XYCTF!&quot;</span>;<br>    dexxtea(enc, <span class="hljs-number">8</span>, key);<br>    <span class="hljs-type">char</span> *flag = (<span class="hljs-type">char</span>*)enc;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i &lt; <span class="hljs-number">32</span>;i++)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,flag[i]);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>​	第一个问题，看这个循环体的内容，上面能跑，下面就是错的。差别就在于p&#x3D;0的情况，是放在循环体内部，还是放在循环体外部了。结果详细信息分析，我得到一种可能解释：因为p是无符号32位整数，永远大于等于0，所以下面的情况应该是无限循环，在编译器优化的情况后，这个地方应该被识别出是无限循环，直接中断程序了，在for循环里面插入printf根本不输出啊。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-keyword">do</span>&#123;<br>        e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">5</span>;<br>        <span class="hljs-keyword">for</span>(p=n<span class="hljs-number">-1</span>; p&gt;<span class="hljs-number">0</span>; p--)<br>        &#123;<br>            y = v[(p+<span class="hljs-number">1</span>)%n];     <span class="hljs-comment">//保存加密位的后一位</span><br>            z = v[(p<span class="hljs-number">-1</span>)%n];         <span class="hljs-comment">//保存加密位的前一位</span><br>            v[p] -= MX;<br>        &#125;<br>        y = v[(p+<span class="hljs-number">1</span>)%n];     <span class="hljs-comment">//保存加密位的后一位</span><br>        z = v[(p<span class="hljs-number">-1</span>)%n];         <span class="hljs-comment">//保存加密位的前一位</span><br>        v[p] -= MX;<br>        sum -= DELTA;<br>&#125;<span class="hljs-keyword">while</span>(--rounds);<br>    <br>    <br><span class="hljs-keyword">do</span>&#123;<br>        e = (sum &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">5</span>;<br>        <span class="hljs-keyword">for</span>(p=n<span class="hljs-number">-1</span>; p&gt;=<span class="hljs-number">0</span>; p--)<br>        &#123;<br>            y = v[(p+<span class="hljs-number">1</span>)%n];     <span class="hljs-comment">//保存加密位的后一位</span><br>            z = v[(p<span class="hljs-number">-1</span>)%n];         <span class="hljs-comment">//保存加密位的前一位</span><br>            v[p] -= MX;<br>        &#125;<br>        sum -= DELTA;<br>&#125;<span class="hljs-keyword">while</span>(--rounds);<br></code></pre></td></tr></table></figure>

<p>​	第二个问题来了，按照第一个能跑的版本，我将p的类型改为int型，为什么就又不行了？</p>
<p>​	第二个问题也有了答案：看到这个参数z的代码<code>z = v[(p-1)%n];</code> 。无论p是有符号32位整数，还是无符号，<code>p-1（p=0）</code>在机器内的表示都是<code>FFFFFFFF</code>，通过格式化字符<code>%x</code>输出都是这样的。而分别通过<code>%d %u</code>输出，却是<code>-1</code>和<code>4294967295</code>。再看，<code>(p-1)%8</code>在通过<code>%08x</code>输出的时候却分别是<code>ffffffff</code> <code>00000007</code>，也就是说在有符号数中<code>-1%8=-1</code>。无符号数<code>FFFFFFFF</code>（<code>4294967295</code>）模8是等于7的。所以会导致z的取值时的索引值不一样。</p>
<p>​	</p>
<p>​	综上，总结出无符号数当索引值，要特殊处理等于0的情况；有符号数的模运算中，负数模正数还是负数。</p>
<h1 id="Trustme（APK）"><a href="#Trustme（APK）" class="headerlink" title="Trustme（APK）"></a>Trustme（APK）</h1><p>​	又是apk，放一边。还是学习WP。</p>
<p>​	这个倒是挺正常，可以使用JADX打开分析。MainActivity中有假的判断，对其进行解密出来得到用户名。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4</span>(<span class="hljs-params">data: <span class="hljs-built_in">bytes</span>, key: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    out = []<br><br>    <span class="hljs-comment"># KSA: Key Scheduling Algorithm</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % <span class="hljs-built_in">len</span>(key)]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br><br>    <span class="hljs-comment"># PRGA: Pseudo-Random Generation Algorithm</span><br>    i = j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> data:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        out.append(char ^ S[(S[i] + S[j]) % <span class="hljs-number">256</span>])<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(out)<br><br><span class="hljs-comment"># 输入密文（十六进制）和密钥</span><br>cipher_hex = <span class="hljs-string">&quot;5a3c46e0228b444decc7651c8a7ca93ba4cb35a46f7eb589bef4&quot;</span><br>cipher_bytes = <span class="hljs-built_in">bytes</span>.fromhex(cipher_hex)<br>key = <span class="hljs-string">b&quot;XYCTF&quot;</span><br><br><span class="hljs-comment"># 解密</span><br>plaintext_bytes = rc4(cipher_bytes, key)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;原文密码是:&quot;</span>, plaintext_bytes.decode())<br><span class="hljs-comment">#原文密码是: The Real username is admin</span><br></code></pre></td></tr></table></figure>

<p>​	但是没有其他信息了，我们翻看到Proxy类，看到其中创建了一个新的shell.apk，是对class.dex中的数据进行提取操作的。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> struct<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">data: <span class="hljs-built_in">bytes</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    <span class="hljs-comment"># 对每个字节异或 0xFF</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(b ^ <span class="hljs-number">0xFF</span> <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> data)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">split_payload_from_dex</span>(<span class="hljs-params">bArr: <span class="hljs-built_in">bytes</span>, apkFileName: <span class="hljs-built_in">str</span></span>):<br>    <span class="hljs-comment"># 取 dex 末尾4个字节，读取payload长度（int，4字节）</span><br>    readInt = struct.unpack(<span class="hljs-string">&quot;&gt;I&quot;</span>, bArr[-<span class="hljs-number">4</span>:])[<span class="hljs-number">0</span>]  <span class="hljs-comment"># 大端，跟Java默认DataInputStream.readInt一样</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Payload length: <span class="hljs-subst">&#123;readInt&#125;</span>&quot;</span>)<br><br>    <span class="hljs-comment"># 取出payload数据</span><br>    payload_encrypted = bArr[-<span class="hljs-number">4</span> - readInt : -<span class="hljs-number">4</span>]<br><br>    <span class="hljs-comment"># 解密</span><br>    payload_decrypted = decrypt(payload_encrypted)<br><br>    <span class="hljs-comment"># 写入解密后的 APK 文件</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(apkFileName, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        f.write(payload_decrypted)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Decrypted payload saved to <span class="hljs-subst">&#123;apkFileName&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># 示例调用</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-comment"># 假设 dex.bin 是你整个 dex 文件</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;F:\StudyFiles\CTF\Review_CTF\XYCTF2024\RE\Trustme\classes.dex&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>        dex_bytes = f.read()<br><br>    split_payload_from_dex(dex_bytes, <span class="hljs-string">&quot;shell.apk&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>​	得到shell.apk后，看到了密文比对的逻辑，就是使用sql语句验证用户名和密码是否正确。但是，apk解压后得到的&#x2F;assets&#x2F;mydb.db文件是无法正常读取的，仔细读源码，看到MoveSQLiteUtil类中有创建db文件的方法，是对mydb.db文件异或0xff解密得到的。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;F:\StudyFiles\CTF\Review_CTF\XYCTF2024\RE\Trustme\assets\mydb.db&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    data = f.read()<br>    new_data = <span class="hljs-built_in">bytearray</span>(data)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>        new_data[i] = data[i] ^ <span class="hljs-number">0xff</span><br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;F:\StudyFiles\CTF\Review_CTF\XYCTF2024\RE\Trustme\assets\mydb_decrypted.db&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f2:<br>        f2.write(new_data)<br></code></pre></td></tr></table></figure>

<p>​	打开解密文件，就看到了flag。</p>
<p>​	这题还有SQL注入漏洞，密码为<code>&#39; or 1=1 --</code>就能得到flag。</p>
<h1 id="馒头"><a href="#馒头" class="headerlink" title="馒头"></a>馒头</h1><p>​	无壳，IDA打开，代码很清晰，考察的是<code>哈夫曼树</code>数据结构，好久之前学的数据结构了，现在都忘了，重新温习一下。看不懂啊，真的难。这题就认真分析一遍，完整写思路，当作是学习新知识了。</p>
<p>​	通过学习，知道了IDA中通过<code>add type</code>自定义结构体，然后通过<code>Y</code>键修改反编译的函数参数类型为自定义的结构体指针，这样IDA就能自动识别了。</p>
<p>​	先看结构初始化函数，这里哈夫曼树是通过<code>数组</code>保存的啊，而a1就是这个指向这个数组的指针，这个数组中的每个元素都是一个结构体，这里并不是指针数组，而是结构体数组。<code>(*a1)[i]</code>就是第i个节点，而其index就是其在原字符串中的下标。</p>
<p><img src="/pictures/XYCTF2024/image-20250603135741772.png" alt="image-20250603135741772"></p>
<p>​	看到create函数是构建哈夫曼树的。</p>
<p><img src="/pictures/XYCTF2024/image-20250603140500857.png" alt="image-20250603140500857"></p>
<p>​	看到check函数，这里很巧妙的对左叶子节点进行了值和下标的比对，而对右叶子节点只进行了下标的比对，这样就不必把所有flag的字符值全保存在变量中，显的太简单。同时也可以标注字符在flag中的位置。</p>
<p><img src="/pictures/XYCTF2024/image-20250603140650890.png" alt="image-20250603140650890"></p>
<p>​	理清逻辑后，我开始是手动解密，就像是下面这样，在手动操作的过程中我找到了规律。</p>
<p>​	就是可打印字符的数字在32到126之间，那么从1到24的数字一定是表示下标的，并且由于哈夫曼树是满二叉树，即除叶子节点外的其他节点都有两个孩子节点。</p>
<p>​	我举个例子，假设A有两个子节点，且都是叶子节点，左右孩子分别为B、C。那么扫描到A的时候，根据程序就会判断一下B的权值（字符值），然后递归进入到B节点，这时候又会比较一次下标值，然后从叶子节点B返回，接着到右叶子节点C，继续比较下标，然后返回到A的兄弟节点去比对。</p>
<p>​	所以我们就可以根据循环数组的值，检测到下标，就可以利用前几位的权值计算出原字符串中该下标对于的ASCII码值是多少。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">data = [<span class="hljs-number">2270</span>, <span class="hljs-number">917</span>, <span class="hljs-number">446</span>, <span class="hljs-number">217</span>, <span class="hljs-number">106</span>, <span class="hljs-number">51</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>, <span class="hljs-number">17</span>, <span class="hljs-number">229</span>, <span class="hljs-number">114</span>, <span class="hljs-number">16</span>, <span class="hljs-number">11</span>, <span class="hljs-number">471</span>, <span class="hljs-number">233</span>, <span class="hljs-number">116</span>, <span class="hljs-number">14</span>, <span class="hljs-number">13</span>, <span class="hljs-number">238</span>, <span class="hljs-number">118</span>, <span class="hljs-number">12</span>, <span class="hljs-number">7</span>, <span class="hljs-number">1353</span>, <span class="hljs-number">557</span>, <span class="hljs-number">248</span>, <span class="hljs-number">123</span>, <span class="hljs-number">6</span>, <span class="hljs-number">24</span>, <span class="hljs-number">309</span>, <span class="hljs-number">137</span>, <span class="hljs-number">67</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">172</span>, <span class="hljs-number">84</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">796</span>, <span class="hljs-number">383</span>, <span class="hljs-number">186</span>, <span class="hljs-number">89</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">197</span>, <span class="hljs-number">97</span>, <span class="hljs-number">48</span>, <span class="hljs-number">23</span>, <span class="hljs-number">10</span>, <span class="hljs-number">21</span>, <span class="hljs-number">413</span>, <span class="hljs-number">203</span>, <span class="hljs-number">101</span>, <span class="hljs-number">22</span>, <span class="hljs-number">9</span>, <span class="hljs-number">210</span>, <span class="hljs-number">104</span>, <span class="hljs-number">19</span>, <span class="hljs-number">18</span>]<br><br>flag = [<span class="hljs-number">0</span>] * <span class="hljs-number">25</span><br>flag[<span class="hljs-number">20</span>] = <span class="hljs-number">51</span><br>flag[<span class="hljs-number">15</span>] = <span class="hljs-number">106</span> -<span class="hljs-number">51</span><br>flag[<span class="hljs-number">17</span>] = <span class="hljs-number">217</span> - <span class="hljs-number">106</span><br>flag[<span class="hljs-number">16</span>] = <span class="hljs-number">114</span><br>flag[<span class="hljs-number">11</span>] = <span class="hljs-number">229</span> - <span class="hljs-number">114</span><br>flag[<span class="hljs-number">14</span>] = <span class="hljs-number">116</span><br>flag[<span class="hljs-number">13</span>] = <span class="hljs-number">233</span> - <span class="hljs-number">116</span><br>flag[<span class="hljs-number">12</span>] = <span class="hljs-number">118</span><br>flag[<span class="hljs-number">7</span>] = <span class="hljs-number">238</span> - <span class="hljs-number">118</span><br>flag[<span class="hljs-number">6</span>] = <span class="hljs-number">123</span><br>flag[<span class="hljs-number">24</span>] = <span class="hljs-number">248</span> - <span class="hljs-number">123</span><br>flag[<span class="hljs-number">3</span>] = <span class="hljs-number">67</span><br>flag[<span class="hljs-number">5</span>] = <span class="hljs-number">137</span> - <span class="hljs-number">67</span><br>flag[<span class="hljs-number">4</span>] = <span class="hljs-number">84</span><br>flag[<span class="hljs-number">1</span>] = <span class="hljs-number">172</span> - <span class="hljs-number">84</span><br>flag[<span class="hljs-number">2</span>] = <span class="hljs-number">89</span><br>flag[<span class="hljs-number">8</span>] = <span class="hljs-number">186</span> - <span class="hljs-number">89</span><br>flag[<span class="hljs-number">23</span>] = <span class="hljs-number">48</span><br>flag[<span class="hljs-number">10</span>] = <span class="hljs-number">97</span> - <span class="hljs-number">48</span><br>flag[<span class="hljs-number">21</span>] = <span class="hljs-number">197</span> - <span class="hljs-number">97</span><br>flag[<span class="hljs-number">22</span>] = <span class="hljs-number">101</span><br>flag[<span class="hljs-number">9</span>] = <span class="hljs-number">203</span> - <span class="hljs-number">101</span><br>flag[<span class="hljs-number">19</span>] = <span class="hljs-number">104</span><br>flag[<span class="hljs-number">18</span>] = <span class="hljs-number">210</span> - <span class="hljs-number">104</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">25</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>​	下面是自动处理的脚本。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">data = [<span class="hljs-number">2270</span>, <span class="hljs-number">917</span>, <span class="hljs-number">446</span>, <span class="hljs-number">217</span>, <span class="hljs-number">106</span>, <span class="hljs-number">51</span>, <span class="hljs-number">20</span>, <span class="hljs-number">15</span>, <span class="hljs-number">17</span>, <span class="hljs-number">229</span>, <span class="hljs-number">114</span>, <span class="hljs-number">16</span>, <span class="hljs-number">11</span>, <span class="hljs-number">471</span>, <span class="hljs-number">233</span>, <span class="hljs-number">116</span>, <span class="hljs-number">14</span>, <span class="hljs-number">13</span>, <span class="hljs-number">238</span>, <span class="hljs-number">118</span>, <span class="hljs-number">12</span>, <span class="hljs-number">7</span>, <span class="hljs-number">1353</span>, <span class="hljs-number">557</span>, <span class="hljs-number">248</span>, <span class="hljs-number">123</span>, <span class="hljs-number">6</span>, <span class="hljs-number">24</span>, <span class="hljs-number">309</span>, <span class="hljs-number">137</span>, <span class="hljs-number">67</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">172</span>, <span class="hljs-number">84</span>, <span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-number">796</span>, <span class="hljs-number">383</span>, <span class="hljs-number">186</span>, <span class="hljs-number">89</span>, <span class="hljs-number">2</span>, <span class="hljs-number">8</span>, <span class="hljs-number">197</span>, <span class="hljs-number">97</span>, <span class="hljs-number">48</span>, <span class="hljs-number">23</span>, <span class="hljs-number">10</span>, <span class="hljs-number">21</span>, <span class="hljs-number">413</span>, <span class="hljs-number">203</span>, <span class="hljs-number">101</span>, <span class="hljs-number">22</span>, <span class="hljs-number">9</span>, <span class="hljs-number">210</span>, <span class="hljs-number">104</span>, <span class="hljs-number">19</span>, <span class="hljs-number">18</span>]<br>flag = [<span class="hljs-number">0</span>] * <span class="hljs-number">25</span><br>i = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(data):<br>    <span class="hljs-keyword">if</span> data[i] &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> data[i] &lt; <span class="hljs-number">25</span>:<br>        n = <span class="hljs-number">1</span><br>        tmp = i<br>        <span class="hljs-keyword">while</span> i &lt; <span class="hljs-built_in">len</span>(data) <span class="hljs-keyword">and</span> data[i] &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> data[i] &lt; <span class="hljs-number">25</span>:<br>            <span class="hljs-keyword">if</span> n == <span class="hljs-number">1</span>:<br>                flag[data[i]] = data[tmp-n]<br>            <span class="hljs-keyword">else</span>:<br>                flag[data[i]] = data[tmp-n] - data[tmp-n+<span class="hljs-number">1</span>]<br>            i += <span class="hljs-number">1</span><br>            n += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        i += <span class="hljs-number">1</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">25</span>):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(flag[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>

















<h1 id="What’s-this"><a href="#What’s-this" class="headerlink" title="What’s this"></a>What’s this</h1><p>​	新东西，第一次碰见，文件头是<code>1B 4C 75 61 51</code>。节约时间，学习WP。</p>
<p>​	Chatgpt的解释是：<code>1B 4C 75 61 51</code> 是一个 <strong>Lua字节码文件（编译后的Lua文件）的文件头</strong>，即不是普通的 <code>.lua</code> 源代码文件，而是已经编译成Lua虚拟机可执行的二进制文件。所以我们要反编译，看源代码。</p>
<p>​	WP中给出了在线工具，我们上网站反编译好了。也是有幸接触到了一下LUA脚本，这是游戏开发非常流行的语言。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br>flag = <span class="hljs-string">&quot;==AeuFEcwxGPuJ0PBNzbC16ctFnPB5DPzI0bwx6bu9GQ2F1XOR1U&quot;</span><br>flag = flag.replace(<span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;W&quot;</span>)<br>flag = flag.replace(<span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;H&quot;</span>)<br>flag = flag.replace(<span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;g&quot;</span>)<br>flag = flag[::-<span class="hljs-number">1</span>]<br>flag = base64.b64decode(flag).decode()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>    tmp = <span class="hljs-built_in">ord</span>(flag[i]) - <span class="hljs-number">3</span><br>    tmp = (tmp ^ <span class="hljs-number">8</span>) % <span class="hljs-number">256</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(tmp), end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure>





<h1 id="ez-rand"><a href="#ez-rand" class="headerlink" title="ez_rand"></a>ez_rand</h1><p>​	又是垃圾题，思路很简单，爆破就行了，对应好参数类型。</p>
<p>​	sb的WP中，直接rand()%255，无语了。tm的，我又一直爆破不出来，明明是照着变量类型抄的。连算式都是照着抄的。</p>
<p>​	麻痹的，改了一下异或值的计算就好了，还忘了之前错的是什么样子的了，现在怎么改都是对的。真的是玄学，错误消失了，完全找不到之前错的是什么样子的了。</p>
<p>​	无语逆天了，再也不想碰这个煞笔C语言了。</p>
<p><img src="/pictures/XYCTF2024/image-20250601171908123.png" alt="image-20250601171908123"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><code class="hljs c++"><span class="hljs-comment">//别人的脚本</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;iostream&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;cstring&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;algorithm&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;cstdio&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;cstdlib&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;ctime&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> cipher[<span class="hljs-number">50</span>] = &#123;<span class="hljs-number">0x5D</span>, <span class="hljs-number">0x0C</span>, <span class="hljs-number">0x6C</span>, <span class="hljs-number">0xEA</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xFC</span>, <span class="hljs-number">0x34</span>,<span class="hljs-number">0xB2</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x6E</span>, <span class="hljs-number">0xFB</span>, <span class="hljs-number">0xB4</span>, <span class="hljs-number">0xE8</span>, <span class="hljs-number">0xF2</span>, <span class="hljs-number">0xA9</span>, <span class="hljs-number">0x91</span>,<span class="hljs-number">0x12</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xDB</span>, <span class="hljs-number">0x8E</span>, <span class="hljs-number">0xE9</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4D</span>&#125;;<br><span class="hljs-type">int</span> v7;<br><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">cmp</span><span class="hljs-params">(<span class="hljs-type">char</span> s[])</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-keyword">if</span>(<span class="hljs-built_in">strstr</span>(s,<span class="hljs-string">&quot;XYCTF&quot;</span>)||<span class="hljs-built_in">strstr</span>(s,<span class="hljs-string">&quot;flag&quot;</span>))<br>	&#123;<br>		<span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>	&#125;<br>	<span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><span class="hljs-type">char</span> ans[<span class="hljs-number">50</span>];<br><span class="hljs-type">int</span> _round=<span class="hljs-number">-5</span>;<br><span class="hljs-function"><span class="hljs-type">signed</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-keyword">for</span>(<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v4=<span class="hljs-number">0</span>;v4&lt;<span class="hljs-number">65536</span>;v4++)<br>	&#123;<br>		<span class="hljs-built_in">srand</span>(v4);<br>		<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">29</span>;i++)<br>		&#123;<br>			v7=<span class="hljs-built_in">rand</span>();<br>			<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> <span class="hljs-type">long</span> temp=((<span class="hljs-number">2155905153</span>*<span class="hljs-number">1LL</span>*v7)&gt;&gt;<span class="hljs-number">32</span>);<br>			<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> num=v7+(<span class="hljs-type">int</span>)((temp&amp;<span class="hljs-number">0x80000000</span>)!=<span class="hljs-number">0</span>)+((<span class="hljs-type">int</span>)temp&gt;&gt;<span class="hljs-number">7</span>);<br>			ans[i]=num^cipher[i];<br>		&#125;<br>		<span class="hljs-keyword">if</span>(<span class="hljs-built_in">cmp</span>(ans))<br>		&#123;<br>			_round=v4;<br>			<span class="hljs-keyword">break</span>;<br>		&#125;<br>	&#125;<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s %d&quot;</span>,ans,_round);<br>	<span class="hljs-comment">//XYCTF&#123;R@nd_1s_S0_S0_S0_easy!&#125; 21308</span><br>&#125;<br></code></pre></td></tr></table></figure>





<h1 id="舔狗四部曲–记忆的时光机"><a href="#舔狗四部曲–记忆的时光机" class="headerlink" title="舔狗四部曲–记忆的时光机"></a>舔狗四部曲–记忆的时光机</h1><p>​	ok，高级的反编译，类似花指令一样的反编译方式。方法为先把要跳转的地址保存到寄存器上，然后通过寄存器跳转；或者搞个<code>endbr64</code>指令，影响反编译。</p>
<p>​	直接学习WP。说是可以通过跳转表，修复反编译，但是没演示具体操作，对小白太不友好了。其他人也都是看汇编或者动调的，那就干吧，动调看看。</p>
<p>​	首先一个cmp，长度检验，0x30，48位。然后每一位加密后和密文比对，48个字符全部相同就是成功。</p>
<p>​	enc函数，首先有个xor变化值（i+6，i从0开始的），再xor固定值0x66，再减6，然后xor密文的对应位。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc = [<span class="hljs-number">105</span>, <span class="hljs-number">88</span>, <span class="hljs-number">97</span>, <span class="hljs-number">99</span>, <span class="hljs-number">103</span>, <span class="hljs-number">76</span>, <span class="hljs-number">77</span>, <span class="hljs-number">50</span>, <span class="hljs-number">152</span>, <span class="hljs-number">32</span>, <span class="hljs-number">77</span>, <span class="hljs-number">81</span>, <span class="hljs-number">123</span>, <span class="hljs-number">37</span>, <span class="hljs-number">117</span>, <span class="hljs-number">81</span>, <span class="hljs-number">163</span>, <span class="hljs-number">88</span>, <span class="hljs-number">96</span>, <span class="hljs-number">114</span>, <span class="hljs-number">66</span>, <span class="hljs-number">98</span>, <span class="hljs-number">103</span>, <span class="hljs-number">102</span>, <span class="hljs-number">55</span>, <span class="hljs-number">108</span>, <span class="hljs-number">48</span>, <span class="hljs-number">70</span>, <span class="hljs-number">102</span>, <span class="hljs-number">79</span>, <span class="hljs-number">93</span>, <span class="hljs-number">3</span>, <span class="hljs-number">93</span>, <span class="hljs-number">164</span>, <span class="hljs-number">102</span>, <span class="hljs-number">1</span>, <span class="hljs-number">67</span>, <span class="hljs-number">104</span>, <span class="hljs-number">125</span>, <span class="hljs-number">124</span>, <span class="hljs-number">85</span>, <span class="hljs-number">79</span>, <span class="hljs-number">122</span>, <span class="hljs-number">63</span>, <span class="hljs-number">108</span>, <span class="hljs-number">18</span>, <span class="hljs-number">33</span>, <span class="hljs-number">9</span>]<br>key = <span class="hljs-string">&quot;i_have_get_shell_but_where_is_you_my_dear_baby!!&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    tmp = (enc[i] ^ <span class="hljs-built_in">ord</span>(key[i])) % <span class="hljs-number">256</span><br>    tmp = (tmp + <span class="hljs-number">6</span>) % <span class="hljs-number">256</span><br>    tmp = (tmp ^ <span class="hljs-number">0x66</span>) % <span class="hljs-number">256</span><br>    tmp = (tmp ^ (i+<span class="hljs-number">6</span>)) % <span class="hljs-number">256</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(tmp), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>​	这题会动调其实很简单，只是反编译做做样子，有点吓人罢了。</p>
<h1 id="ez-cube"><a href="#ez-cube" class="headerlink" title="ez_cube"></a>ez_cube</h1><p>​	IDA打开，真是个做魔方的题，还得有点空间想象力才行。初始状态如下。</p>
<p>​	WP给出的在线网站，没办法做到限制旋转，就无法按照题目中的方式解出。可以使用python写一个求解脚本，只使用四种目标旋转，限制步数，BFS就是很可行的。</p>
<p>​	但是我不想在这样一个非专业逆向的题目耗这么多时间，所以直接过了。附上别人的脚本。</p>
<p><img src="/pictures/XYCTF2024/image-20250601205219843.png" alt="image-20250601205219843"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> tqdm<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">f</span>(<span class="hljs-params">x</span>):<br>	A=[<span class="hljs-string">&quot;R&quot;</span>]*<span class="hljs-number">9</span><br>	B=[<span class="hljs-string">&quot;B&quot;</span>]*<span class="hljs-number">9</span><br>	C=[<span class="hljs-string">&quot;G&quot;</span>]*<span class="hljs-number">9</span><br>	D=[<span class="hljs-string">&quot;O&quot;</span>]*<span class="hljs-number">9</span><br>	E=[<span class="hljs-string">&quot;Y&quot;</span>]*<span class="hljs-number">9</span><br>	F=[<span class="hljs-string">&quot;W&quot;</span>]*<span class="hljs-number">9</span><br>	B[<span class="hljs-number">1</span>]=<span class="hljs-string">&#x27;R&#x27;</span><br>	A[<span class="hljs-number">1</span>]=<span class="hljs-string">&#x27;G&#x27;</span><br>	C[<span class="hljs-number">1</span>]=<span class="hljs-string">&#x27;B&#x27;</span><br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x:<br>		<span class="hljs-keyword">if</span> i==<span class="hljs-string">&#x27;R&#x27;</span>:<br>		v0 = A[<span class="hljs-number">2</span>]<br>		v1 = A[<span class="hljs-number">5</span>]<br>		v2 = A[<span class="hljs-number">8</span>]<br>		A[<span class="hljs-number">2</span>] = F[<span class="hljs-number">2</span>]<br>		A[<span class="hljs-number">5</span>] = F[<span class="hljs-number">5</span>]<br>		A[<span class="hljs-number">8</span>] = F[<span class="hljs-number">8</span>]<br>		F[<span class="hljs-number">2</span>] = D[<span class="hljs-number">6</span>]<br>		F[<span class="hljs-number">5</span>] = D[<span class="hljs-number">3</span>]<br>		F[<span class="hljs-number">8</span>] = D[<span class="hljs-number">0</span>]<br>		D[<span class="hljs-number">0</span>] = E[<span class="hljs-number">8</span>]<br>		D[<span class="hljs-number">3</span>] = E[<span class="hljs-number">5</span>]<br>		D[<span class="hljs-number">6</span>] = E[<span class="hljs-number">2</span>]<br>		E[<span class="hljs-number">2</span>] = v0<br>		E[<span class="hljs-number">5</span>] = v1<br>		E[<span class="hljs-number">8</span>] = v2<br>		v3 = C[<span class="hljs-number">1</span>]<br>		C[<span class="hljs-number">1</span>] = C[<span class="hljs-number">3</span>]<br>		C[<span class="hljs-number">3</span>] = C[<span class="hljs-number">7</span>]<br>		C[<span class="hljs-number">7</span>] = C[<span class="hljs-number">5</span>]<br>		C[<span class="hljs-number">5</span>] = v3<br>		v4 = C[<span class="hljs-number">0</span>]<br>		C[<span class="hljs-number">0</span>] = C[<span class="hljs-number">6</span>]<br>		C[<span class="hljs-number">6</span>] = C[<span class="hljs-number">8</span>]<br>		C[<span class="hljs-number">8</span>] = C[<span class="hljs-number">2</span>]<br>		C[<span class="hljs-number">2</span>] = v4<br>	<span class="hljs-keyword">if</span> i==<span class="hljs-string">&#x27;U&#x27;</span>:<br>		v0 = A[<span class="hljs-number">0</span>]<br>		v1 = A[<span class="hljs-number">1</span>]<br>		v2 = A[<span class="hljs-number">2</span>]<br>		A[<span class="hljs-number">0</span>] = C[<span class="hljs-number">0</span>]<br>		A[<span class="hljs-number">1</span>] = C[<span class="hljs-number">1</span>]<br>		A[<span class="hljs-number">2</span>] = C[<span class="hljs-number">2</span>]<br>		C[<span class="hljs-number">0</span>] = D[<span class="hljs-number">0</span>]<br>		C[<span class="hljs-number">1</span>] = D[<span class="hljs-number">1</span>]<br>		C[<span class="hljs-number">2</span>] = D[<span class="hljs-number">2</span>]<br>		D[<span class="hljs-number">0</span>] = B[<span class="hljs-number">0</span>]<br>		D[<span class="hljs-number">1</span>] = B[<span class="hljs-number">1</span>]<br>		D[<span class="hljs-number">2</span>] = B[<span class="hljs-number">2</span>]<br>		B[<span class="hljs-number">0</span>] = v0<br>		B[<span class="hljs-number">1</span>] = v1<br>		B[<span class="hljs-number">2</span>] = v2<br>		v3 = E[<span class="hljs-number">1</span>]<br>		E[<span class="hljs-number">1</span>] = E[<span class="hljs-number">3</span>]<br>		E[<span class="hljs-number">3</span>] = E[<span class="hljs-number">7</span>]<br>		E[<span class="hljs-number">7</span>] = E[<span class="hljs-number">5</span>]<br>		E[<span class="hljs-number">5</span>] = v3<br>		v4 = E[<span class="hljs-number">0</span>]<br>		E[<span class="hljs-number">0</span>] = E[<span class="hljs-number">6</span>]<br>		E[<span class="hljs-number">6</span>] = E[<span class="hljs-number">8</span>]<br>		E[<span class="hljs-number">8</span>] = E[<span class="hljs-number">2</span>]<br>		E[<span class="hljs-number">2</span>] = v4<br>	<span class="hljs-keyword">if</span> i==<span class="hljs-string">&#x27;r&#x27;</span>:<br>		v0 = A[<span class="hljs-number">2</span>]<br>		v1 = A[<span class="hljs-number">5</span>]<br>		v2 = A[<span class="hljs-number">8</span>]<br>		A[<span class="hljs-number">2</span>] = E[<span class="hljs-number">2</span>]<br>		A[<span class="hljs-number">5</span>] = E[<span class="hljs-number">5</span>]<br>		A[<span class="hljs-number">8</span>] = E[<span class="hljs-number">8</span>]<br>		E[<span class="hljs-number">2</span>] = D[<span class="hljs-number">6</span>]<br>		E[<span class="hljs-number">5</span>] = D[<span class="hljs-number">3</span>]<br>		E[<span class="hljs-number">8</span>] = D[<span class="hljs-number">0</span>]<br>		D[<span class="hljs-number">0</span>] = F[<span class="hljs-number">8</span>]<br>		D[<span class="hljs-number">3</span>] = F[<span class="hljs-number">5</span>]<br>		D[<span class="hljs-number">6</span>] = F[<span class="hljs-number">2</span>]<br>		F[<span class="hljs-number">2</span>] = v0<br>		F[<span class="hljs-number">5</span>] = v1<br>		F[<span class="hljs-number">8</span>] = v2<br>		v3 = C[<span class="hljs-number">1</span>]<br>		C[<span class="hljs-number">1</span>] = C[<span class="hljs-number">5</span>]<br>		C[<span class="hljs-number">5</span>] = C[<span class="hljs-number">7</span>]<br>		C[<span class="hljs-number">7</span>] = C[<span class="hljs-number">3</span>]<br>		C[<span class="hljs-number">3</span>] = v3<br>		v4 = C[<span class="hljs-number">0</span>]<br>		C[<span class="hljs-number">0</span>] = C[<span class="hljs-number">2</span>]<br>		C[<span class="hljs-number">2</span>] = C[<span class="hljs-number">8</span>]<br>		C[<span class="hljs-number">8</span>] = C[<span class="hljs-number">6</span>]<br>		C[<span class="hljs-number">6</span>] = v4<br>	<span class="hljs-keyword">if</span> i==<span class="hljs-string">&#x27;u&#x27;</span>:<br>		v0 = A[<span class="hljs-number">0</span>]<br>		v1 = A[<span class="hljs-number">1</span>]<br>		v2 = A[<span class="hljs-number">2</span>]<br>		A[<span class="hljs-number">0</span>] = B[<span class="hljs-number">0</span>]<br>		A[<span class="hljs-number">1</span>] = B[<span class="hljs-number">1</span>]<br>		A[<span class="hljs-number">2</span>] = B[<span class="hljs-number">2</span>]<br>		B[<span class="hljs-number">0</span>] = D[<span class="hljs-number">0</span>]<br>		B[<span class="hljs-number">1</span>] = D[<span class="hljs-number">1</span>]<br>		B[<span class="hljs-number">2</span>] = D[<span class="hljs-number">2</span>]<br>		D[<span class="hljs-number">0</span>] = C[<span class="hljs-number">0</span>]<br>		D[<span class="hljs-number">1</span>] = C[<span class="hljs-number">1</span>]<br>		D[<span class="hljs-number">2</span>] = C[<span class="hljs-number">2</span>]<br>		C[<span class="hljs-number">0</span>] = v0<br>		C[<span class="hljs-number">1</span>] = v1<br>		C[<span class="hljs-number">2</span>] = v2<br>		v3 = E[<span class="hljs-number">1</span>]<br>		E[<span class="hljs-number">1</span>] = E[<span class="hljs-number">5</span>]<br>		E[<span class="hljs-number">5</span>] = E[<span class="hljs-number">7</span>]<br>		E[<span class="hljs-number">7</span>] = E[<span class="hljs-number">3</span>]<br>		E[<span class="hljs-number">3</span>] = v3<br>		v4 = E[<span class="hljs-number">0</span>]<br>		E[<span class="hljs-number">0</span>] = E[<span class="hljs-number">2</span>]<br>		E[<span class="hljs-number">2</span>] = E[<span class="hljs-number">8</span>]<br>		E[<span class="hljs-number">8</span>] = E[<span class="hljs-number">6</span>]<br>		E[<span class="hljs-number">6</span>] = v4<br>	<span class="hljs-keyword">if</span> A==[<span class="hljs-string">&quot;R&quot;</span>]*<span class="hljs-number">9</span> <span class="hljs-keyword">and</span> B==[<span class="hljs-string">&quot;B&quot;</span>]*<span class="hljs-number">9</span> <span class="hljs-keyword">and</span> C==[<span class="hljs-string">&quot;G&quot;</span>]*<span class="hljs-number">9</span> <span class="hljs-keyword">and</span> D==[<span class="hljs-string">&quot;O&quot;</span>]*<span class="hljs-number">9</span> <span class="hljs-keyword">and</span> E==[<span class="hljs-string">&quot;Y&quot;</span>]*<span class="hljs-number">9</span> <span class="hljs-keyword">and</span> F==[<span class="hljs-string">&quot;W&quot;</span>]*<span class="hljs-number">9</span>:<br>		<span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br>	<span class="hljs-keyword">else</span>:<br>		<span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br><br>    <br>flag=[]<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">13</span>):<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm.tqdm(<span class="hljs-built_in">list</span>(product(<span class="hljs-string">&#x27;RUru&#x27;</span>,repeat=j))):<br>		x=<span class="hljs-string">&#x27;&#x27;</span>.join(i)<br>		<span class="hljs-keyword">if</span> f(x):<br>			flag.append(x)<br>[<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;flag&#123;%s&#125;&quot;</span>%x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> flag]<br></code></pre></td></tr></table></figure>





<h1 id="今夕是何年"><a href="#今夕是何年" class="headerlink" title="今夕是何年"></a>今夕是何年</h1><p>​	IDA打开，哇，都反编译不了，第一次碰见这种，查壳还没有壳，又是RUST语言写的。</p>
<p>​	学习WP，原来这是LoongArch架构的ELF二进制文件，我们需要一个LoongArch架构的环境来运行这个程序。</p>
<p>​	按照WP的命令在kali上面下载好了qemu-user，命令为<code>sudo apt install qemu-user</code>。然后就可以直接运行main程序了。为什么这么便捷啊？</p>
<blockquote>
<p>背后的机制：<code>binfmt_misc</code></p>
<ul>
<li>Linux 有个内核功能叫做 <strong><code>binfmt_misc</code></strong>，它能让系统识别不同格式的可执行文件。</li>
<li>当你运行一个非本机架构的可执行文件时，内核通过 <code>binfmt_misc</code> 找到对应的解释器（比如 <code>qemu-arm</code>），自动调用它来运行程序。</li>
<li>这样你就感觉“直接运行，不用额外命令”，其实是系统帮你自动转发了。</li>
</ul>
</blockquote>
<p>​	幸好有教程，不然我去网上找又得花大把时间，错误率还高，各种环境问题。</p>
<h1 id="Findme"><a href="#Findme" class="headerlink" title="Findme"></a>Findme</h1><p>​	给了三个二进制文件，不知道是什么东西，DIE也查不出来。新东西，还是直接看WP。6，原来是有隐藏的，我还以为这几个文件是一样的东西，结果一看，文件<code>Doraemon1</code> <code>Doraemon2</code>确实比较迷，但是<code>Doraemon4</code>就是exe文件文件啊， 文件头就能看出来，还去掉了后缀名。</p>
<p>​	先看exe程序，先是一个RC4类的KSA，初始化S盒并用密钥打乱，密钥为：<code>Find_Doraemon</code>。</p>
<p><img src="/pictures/XYCTF2024/image-20250602111610021.png" alt="image-20250602111610021"></p>
<p>​	然后是PRGA，伪随机数流加密。对Doraemon3文件读取字符，异或加密后写入Doraemon1文件，并且跟着若干个随机数。</p>
<p><img src="/pictures/XYCTF2024/image-20250602111920780.png" alt="image-20250602111920780"></p>
<p>​	所以我们对Doraemon1文件进行读取逆向处理就行，先造出S盒，然后再次异或即可，并且使用S盒中的数进行伪随机生成，去掉中间的若干字符后，到达下一个加密字符，直至文件读取完。</p>
<p>​	我现在写代码的能力有点差，经常有遗忘的点，改起来花很多时间。还得练。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span>  </span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br>FILE *fp = <span class="hljs-literal">NULL</span>;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">KSA</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> *S, <span class="hljs-type">uint8_t</span> *K)</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> i;<br>    <span class="hljs-type">int</span> j = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span>( i=<span class="hljs-number">0</span>; i&lt;<span class="hljs-number">512</span>;i++)<br>    &#123;<br>        S[i] = -(<span class="hljs-type">char</span>)i;<br>    &#125;<br>    i = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">while</span>(i&lt;<span class="hljs-number">512</span>)<br>    &#123;<br>        j = (K[i%<span class="hljs-number">13</span>] + S[i] + j) % <span class="hljs-number">512</span>;<br>        <span class="hljs-type">uint8_t</span> temp = S[i];<br>        S[i] = S[j];<br>        S[j] = temp;<br>        i++;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">PRGA</span><span class="hljs-params">(<span class="hljs-type">uint8_t</span> *S)</span><br>&#123;<br>    <span class="hljs-type">int</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">0</span>, v8=<span class="hljs-number">0</span> , v9 = <span class="hljs-number">0</span> ;<br>    <span class="hljs-type">uint8_t</span> temp, k;<br>    <span class="hljs-type">uint8_t</span> b;<br>    fp = fopen(<span class="hljs-string">&quot;F:\\StudyFiles\\CTF\\Review_CTF\\XYCTF2024\\RE\\Findme\\Doraemon1&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>);<br>    FILE *stream = fopen(<span class="hljs-string">&quot;./Doraemon3&quot;</span>,<span class="hljs-string">&quot;wb&quot;</span>);<br>    <span class="hljs-keyword">if</span> (fp == <span class="hljs-literal">NULL</span>) &#123;<br>        perror(<span class="hljs-string">&quot;Error opening file&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    &#125;<br>    <span class="hljs-keyword">if</span>(stream == <span class="hljs-literal">NULL</span>) &#123;<br>        perror(<span class="hljs-string">&quot;Error opening file&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>);<br>    &#125;<br>    <span class="hljs-keyword">while</span>(!feof(fp))<br>    &#123;<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">512</span>;<br>        j = (S[i] + j) % <span class="hljs-number">512</span>;<br>        temp = S[i];<br>        S[i] = S[j];<br>        S[j] = temp;<br>        k = S[(<span class="hljs-type">uint8_t</span>)((S[i] + S[j]) % <span class="hljs-number">512</span>)];<br>        b = fgetc(fp);<br>        fputc(b^k, stream);<br>        srand(S[v8 %<span class="hljs-number">512</span>]);<br>        v9 = rand() % <span class="hljs-number">4</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> t=<span class="hljs-number">0</span>; t&lt;v9; t++)<br>        &#123;<br>            rand();<br>            fgetc(fp);<br>        &#125;<br>        v8++;<br>    &#125;<br>&#125;<br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">char</span> *key = <span class="hljs-string">&quot;Find_Doraemon&quot;</span>;<br>    <span class="hljs-type">uint8_t</span> S[<span class="hljs-number">512</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br><br>    KSA(S, (<span class="hljs-type">uint8_t</span> *)key);<br>    PRGA(S);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>​	得到3文件后，查看源码，是对2文件进行解密，但是要输入密钥。哈哈，完啦，没有直接的提示，又是脑洞，我没想到。看了WP才知道是<code>Doraemon</code>，看来我做题太多了，都有点迟钝了。</p>
<p>​	得到的解密文件是一个gif图片，打开就得到了flag。</p>
<h1 id="舔狗四部曲–我的白月光"><a href="#舔狗四部曲–我的白月光" class="headerlink" title="舔狗四部曲–我的白月光"></a>舔狗四部曲–我的白月光</h1><p>​	这个我真找不到了，动调和时光机一样的逻辑，一样的flag。但肯定不是这样的，但也没有debug检测，直接运行程序也是那样子的啊。有点迷了。</p>
<p>​	看WP吧，草，原来是平台附件错了……。新的附件是chall.exe。</p>
<p>​	运行程序得到第一段flag：<code>flag&#123;L0v3_</code>。</p>
<p>​	这题C++写的，反编译有点不好看，主要是难以找到入手点，还是学习WP吧，增长经验。</p>
<p>​	通过在提示信息前下断点，捕获到断点前面一直在操作的内存数据，提取出来得到这样的字符串，就有了第二段flag。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">data = [<span class="hljs-number">112</span>, <span class="hljs-number">108</span>, <span class="hljs-number">101</span>, <span class="hljs-number">97</span>, <span class="hljs-number">115</span>, <span class="hljs-number">101</span>, <span class="hljs-number">32</span>, <span class="hljs-number">100</span>, <span class="hljs-number">111</span>, <span class="hljs-number">32</span>, <span class="hljs-number">110</span>, <span class="hljs-number">111</span>, <span class="hljs-number">116</span>, <span class="hljs-number">32</span>, <span class="hljs-number">116</span>, <span class="hljs-number">114</span>, <span class="hljs-number">121</span>, <span class="hljs-number">32</span>, <span class="hljs-number">116</span>, <span class="hljs-number">111</span>, <span class="hljs-number">32</span>, <span class="hljs-number">102</span>, <span class="hljs-number">105</span>, <span class="hljs-number">110</span>, <span class="hljs-number">100</span>, <span class="hljs-number">32</span>, <span class="hljs-number">104</span>, <span class="hljs-number">101</span>, <span class="hljs-number">114</span>, <span class="hljs-number">32</span>, <span class="hljs-number">115</span>, <span class="hljs-number">104</span>, <span class="hljs-number">101</span>, <span class="hljs-number">32</span>, <span class="hljs-number">100</span>, <span class="hljs-number">111</span>, <span class="hljs-number">32</span>, <span class="hljs-number">110</span>, <span class="hljs-number">111</span>, <span class="hljs-number">116</span>, <span class="hljs-number">32</span>, <span class="hljs-number">98</span>, <span class="hljs-number">101</span>, <span class="hljs-number">108</span>, <span class="hljs-number">111</span>, <span class="hljs-number">110</span>, <span class="hljs-number">103</span>, <span class="hljs-number">32</span>, <span class="hljs-number">116</span>, <span class="hljs-number">111</span>, <span class="hljs-number">32</span>, <span class="hljs-number">97</span>, <span class="hljs-number">103</span>, <span class="hljs-number">111</span>, <span class="hljs-number">32</span>, <span class="hljs-number">109</span>, <span class="hljs-number">101</span>, <span class="hljs-number">109</span>, <span class="hljs-number">111</span>, <span class="hljs-number">114</span>, <span class="hljs-number">105</span>, <span class="hljs-number">101</span>, <span class="hljs-number">115</span>, <span class="hljs-number">32</span>, <span class="hljs-number">105</span>, <span class="hljs-number">32</span>, <span class="hljs-number">119</span>, <span class="hljs-number">105</span>, <span class="hljs-number">108</span>, <span class="hljs-number">108</span>, <span class="hljs-number">32</span>, <span class="hljs-number">103</span>, <span class="hljs-number">105</span>, <span class="hljs-number">118</span>, <span class="hljs-number">101</span>, <span class="hljs-number">32</span>, <span class="hljs-number">121</span>, <span class="hljs-number">111</span>, <span class="hljs-number">117</span>, <span class="hljs-number">32</span>, <span class="hljs-number">115</span>, <span class="hljs-number">111</span>, <span class="hljs-number">109</span>, <span class="hljs-number">101</span>, <span class="hljs-number">32</span>, <span class="hljs-number">102</span>, <span class="hljs-number">108</span>, <span class="hljs-number">97</span>, <span class="hljs-number">103</span>, <span class="hljs-number">115</span>, <span class="hljs-number">58</span>, <span class="hljs-number">105</span>, <span class="hljs-number">56</span>, <span class="hljs-number">95</span>, <span class="hljs-number">97</span>, <span class="hljs-number">95</span>, <span class="hljs-number">107</span>, <span class="hljs-number">51</span>, <span class="hljs-number">121</span>, <span class="hljs-number">95</span>, <span class="hljs-number">97</span>, <span class="hljs-number">110</span>, <span class="hljs-number">100</span>, <span class="hljs-number">32</span>, <span class="hljs-number">110</span>, <span class="hljs-number">111</span>, <span class="hljs-number">119</span>, <span class="hljs-number">32</span>, <span class="hljs-number">103</span>, <span class="hljs-number">111</span>, <span class="hljs-number">32</span>, <span class="hljs-number">98</span>, <span class="hljs-number">97</span>, <span class="hljs-number">99</span>, <span class="hljs-number">107</span>, <span class="hljs-number">32</span>, <span class="hljs-number">112</span>, <span class="hljs-number">108</span>, <span class="hljs-number">101</span>, <span class="hljs-number">97</span>, <span class="hljs-number">115</span>, <span class="hljs-number">101</span>, <span class="hljs-number">33</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(data[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p><code>please do not try to find her she do not belong to ago memories i will give you some flags:i8_a_k3y_and now go back please!</code></p>
<p>​	程序这个地方原本是Hook掉了Message函数，导致我们一直在循环看弹窗。要把这里nop掉。</p>
<p><img src="/pictures/XYCTF2024/image-20250602165959876.png" alt="image-20250602165959876"></p>
<p><img src="/pictures/XYCTF2024/image-20250602170024249.png" alt="image-20250602170024249"></p>
<p>​	然后调试的时候，这里v24很大，导致我们循环半天，要手动改标志位跳出。</p>
<p><img src="/pictures/XYCTF2024/image-20250602170144586.png" alt="image-20250602170144586"></p>
<p>​	再看下面1290函数是加密部分，加密数据是程序写好的（当然是错的），所以没有用户输入的地方。下面就是字符串比对，然后弹出提示信息。所以可以猜出这个就是密文，我们要对加密算法逆向。<img src="/pictures/XYCTF2024/image-20250602170236930.png" alt="image-20250602170236930"></p>
<p>​	加密函数里面有一个自定义的base64（反编译根本看不出来啊，只能靠看汇编和动态调试看），其算法是对于三位一组的ABC，其密文分别是base[A&amp;0x3f]、base[((B&amp;0xf)&lt;&lt;2)|(A&gt;&gt;6)&amp;3]、base[(B&gt;&gt;4)&amp;0xf | (C&amp;3)&lt;&lt;4]、base[(C&gt;&gt;2)0x3f]。</p>
<blockquote>
<p>​	相当于对原字符ABC，其都有八位。加密时是：</p>
<p>第一位对应：A[6] A[5] A[4] A[3] A[2] A[1]</p>
<p>第二位对应：B[4] B[3] B[2] B[1] A[8] A[7]</p>
<p>第三位对应：C[2] C[1] B[8] B[7] B[6] B[5]</p>
<p>第四位对应：C[8] C[7] C[6] C[5] C[4] C[3]</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_custom_base64</span>(<span class="hljs-params">data: <span class="hljs-built_in">str</span>, base: <span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span></span>) -&gt; <span class="hljs-built_in">bytes</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    自定义 Base64 解码函数，返回解码后的字节串。</span><br><span class="hljs-string"></span><br><span class="hljs-string">    规则对应：</span><br><span class="hljs-string">    - 输入4个字符一组，映射到3个字节ABC</span><br><span class="hljs-string">    - 解码算法根据你给出的对应关系逆向实现</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    decoded_bytes = <span class="hljs-built_in">bytearray</span>()<br>    base_index = &#123;ch: i <span class="hljs-keyword">for</span> i, ch <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(base)&#125;<br><br>    length = <span class="hljs-built_in">len</span>(data)<br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i &lt; length:<br>        <span class="hljs-comment"># 取4个字符，填充为&#x27;=&#x27;后面补0</span><br>        chunk = data[i:i+<span class="hljs-number">4</span>]<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(chunk) &lt; <span class="hljs-number">4</span>:<br>            chunk += <span class="hljs-string">&#x27;=&#x27;</span> * (<span class="hljs-number">4</span> - <span class="hljs-built_in">len</span>(chunk))<br><br>        vals = []<br>        <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> chunk:<br>            <span class="hljs-keyword">if</span> ch == <span class="hljs-string">&#x27;=&#x27;</span>:<br>                vals.append(<span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">else</span>:<br>                vals.append(base_index[ch])<br><br>        <span class="hljs-comment"># 根据编码规则，逆推 ABC 三字节：</span><br>        <span class="hljs-comment"># 设编码字符对应的6位数分别是v0,v1,v2,v3</span><br>        v0, v1, v2, v3 = vals<br><br>        <span class="hljs-comment"># 解码公式（反推你给出的编码方式）：</span><br>        A = (v0 &amp; <span class="hljs-number">0x3F</span>) | ((v1 &amp; <span class="hljs-number">0x03</span>) &lt;&lt; <span class="hljs-number">6</span>)<br>        B = ((v1 &gt;&gt; <span class="hljs-number">2</span>) &amp; <span class="hljs-number">0x0F</span>) | ((v2 &amp; <span class="hljs-number">0x0F</span>) &lt;&lt; <span class="hljs-number">4</span>)<br>        C = ((v2 &gt;&gt; <span class="hljs-number">4</span>) &amp; <span class="hljs-number">0x03</span>) | ((v3 &amp; <span class="hljs-number">0x3F</span>) &lt;&lt; <span class="hljs-number">2</span>)<br><br>        decoded_bytes.append(A)<br>        <span class="hljs-keyword">if</span> chunk[<span class="hljs-number">2</span>] != <span class="hljs-string">&#x27;=&#x27;</span>:<br>            decoded_bytes.append(B)<br>        <span class="hljs-keyword">if</span> chunk[<span class="hljs-number">3</span>] != <span class="hljs-string">&#x27;=&#x27;</span>:<br>            decoded_bytes.append(C)<br><br>        i += <span class="hljs-number">4</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(decoded_bytes)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decode_custom_base64_to_str</span>(<span class="hljs-params">data: <span class="hljs-built_in">str</span>, base: <span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span></span>) -&gt; <span class="hljs-built_in">str</span>:<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    调用自定义解码函数，将结果转换为字符串。</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    decoded_bytes = decode_custom_base64(data, base)<br>    <span class="hljs-keyword">return</span> decoded_bytes.decode(encoding, errors=<span class="hljs-string">&#x27;ignore&#x27;</span>)<br><br><br><span class="hljs-comment"># 示例</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    custom_base = <span class="hljs-string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span><br>    encoded = <span class="hljs-string">&quot;1YmNkZTN2QmNmdjM3kTNmZTZ2UzN2YTN3ITNmZzN2YWNmZDN2YmNlZTN1YmN2YTO2UmNxYzY2M2N5UjZ3QjN4YTM2UmNidTO2Y2N1UjZ3gjN5YTM2Y2N3YTM2UmN3cDN2YmNlZzN3gzN1YTN3QG=&quot;</span>  <br>    decoded = decode_custom_base64_to_str(encoded, custom_base)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(decoded), <span class="hljs-number">2</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(decoded[i:i+<span class="hljs-number">2</span>], <span class="hljs-number">16</span>)), end=<span class="hljs-string">&#x27;&#x27;</span>)<br>        <br>   <span class="hljs-comment">#_memory_never_go_done_finally_thankyou_xiaowangtongxue&#125;</span><br></code></pre></td></tr></table></figure>

<p>合在一起就是flag{L0v3_i8_a_k3y_and_memory_never_go_done_finally_thankyou_xiaowangtongxue}</p>
<p>​	最后动调看一看故事最后的结局，看一看作者最后的感悟。</p>
<p><img src="/pictures/XYCTF2024/image-20250602170833655.png" alt="image-20250602170833655"></p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">zhike w</div><div class="post-copyright__author_desc">Welcome to bugmak's blog!!!</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://bumak.github.io/2025/06/29/XYCTF2024/XYCTF2024/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://bumak.github.io/2025/06/29/XYCTF2024/XYCTF2024/')">XYCTF2024</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://bumak.github.io/2025/06/29/XYCTF2024/XYCTF2024/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=XYCTF2024&amp;url=http://bumak.github.io/2025/06/29/XYCTF2024/XYCTF2024/&amp;pic=https://w.wallhaven.cc/full/l3/wallhaven-l3lq12.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E5%A4%8D%E7%8E%B0WP/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>复现WP<span class="tagsPageCount">5</span></a><a class="post-meta__box__tags" href="/tags/Reverse/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Reverse<span class="tagsPageCount">6</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://images.pexels.com/photos/3082313/pexels-photo-3082313.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/06/29/XYCTF2025/%E5%88%9D%E8%AF%86Unicorn/"><img class="prev-cover" src="https://img.freepik.com/free-photo/programming-background-with-person-working-with-codes-computer_23-2150010125.jpg" onerror="onerror=null;src='/img/404.gif'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">初识Unicorn</div></div></a></div><div class="next-post pull-right"><a href="/2025/06/29/DSBCTF2024/DSBCTF/"><img class="next-cover" src="https://p.ananas.chaoxing.com/star3/400_0cQ80/43e305b7862e440ade282e538f09c159.webp" onerror="onerror=null;src='/img/404.gif'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">DSBCTF2024</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2025/06/05/ISCTF2024/RE/" title="ISCTF2024"><img class="cover" src="https://images.unsplash.com/photo-1470770841072-f978cf4d019e?auto=format&fit=crop&w=800&q=80" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-06-05</div><div class="title">ISCTF2024</div></div></a></div><div><a href="/2025/06/29/DSBCTF2024/DSBCTF/" title="DSBCTF2024"><img class="cover" src="https://p.ananas.chaoxing.com/star3/400_0cQ80/43e305b7862e440ade282e538f09c159.webp" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-06-29</div><div class="title">DSBCTF2024</div></div></a></div><div><a href="/2025/07/04/XYCTF2025/XYCTF2025RE/" title="XYCTF2025"><img class="cover" src="https://images.pexels.com/photos/3082313/pexels-photo-3082313.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-07-04</div><div class="title">XYCTF2025</div></div></a></div><div><a href="/2025/06/04/BaseCTF/BaseCTF2024_RE/" title="BaseCTF2024"><img class="cover" src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=800&q=80" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-06-04</div><div class="title">BaseCTF2024</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description">这是一个专注网络安全与编程的博客，记录我的学习和生活</div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%81%AA%E6%98%8E%E7%9A%84%E4%BF%A1%E4%BD%BF"><span class="toc-number">1.</span> <span class="toc-text">聪明的信使</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#easy-language"><span class="toc-number">2.</span> <span class="toc-text">easy language</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%96%B5%E5%96%B5%E5%96%B5%E7%9A%84flag%E7%A2%8E%E4%BA%86%E4%B8%80%E5%9C%B0"><span class="toc-number">3.</span> <span class="toc-text">喵喵喵的flag碎了一地</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%99%E9%98%BF%E5%A7%A8%E5%80%92%E4%B8%80%E6%9D%AF%E5%8D%A1%E5%B8%83%E5%A5%87%E8%AF%BA"><span class="toc-number">4.</span> <span class="toc-text">给阿姨倒一杯卡布奇诺</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%A0%E6%98%AF%E7%9C%9F%E7%9A%84%E5%A4%A7%E5%AD%A6%E7%94%9F%E5%90%97%EF%BC%9F"><span class="toc-number">5.</span> <span class="toc-text">你是真的大学生吗？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A0%B8%E6%A0%B8%E6%A1%83"><span class="toc-number">6.</span> <span class="toc-text">砸核桃</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DebugMe%EF%BC%88APK%EF%BC%89"><span class="toc-number">7.</span> <span class="toc-text">DebugMe（APK）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2%E2%80%93%E7%AE%80%E7%88%B1"><span class="toc-number">8.</span> <span class="toc-text">舔狗四部曲–简爱</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%95%E9%A1%BB%E7%9B%B8%E6%80%9D%E7%85%AE%E4%BD%99%E5%B9%B4"><span class="toc-number">9.</span> <span class="toc-text">何须相思煮余年</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ez-enc"><span class="toc-number">10.</span> <span class="toc-text">ez_enc</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#baby-unity"><span class="toc-number">11.</span> <span class="toc-text">baby unity</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ez-unity%EF%BC%88%E6%9C%AA%E5%81%9A%EF%BC%8C%E7%8E%AF%E5%A2%83%E4%B8%8D%E8%A1%8C%EF%BC%89"><span class="toc-number">12.</span> <span class="toc-text">ez unity（未做，环境不行）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ezmath"><span class="toc-number">13.</span> <span class="toc-text">ezmath</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2%E2%80%93%E7%9B%B8%E9%80%A2%E5%B7%B2%E6%98%AF%E4%B8%8A%E4%B8%8A%E7%AD%BE"><span class="toc-number">14.</span> <span class="toc-text">舔狗四部曲–相逢已是上上签</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Trustme%EF%BC%88APK%EF%BC%89"><span class="toc-number">15.</span> <span class="toc-text">Trustme（APK）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A6%92%E5%A4%B4"><span class="toc-number">16.</span> <span class="toc-text">馒头</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#What%E2%80%99s-this"><span class="toc-number">17.</span> <span class="toc-text">What’s this</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ez-rand"><span class="toc-number">18.</span> <span class="toc-text">ez_rand</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2%E2%80%93%E8%AE%B0%E5%BF%86%E7%9A%84%E6%97%B6%E5%85%89%E6%9C%BA"><span class="toc-number">19.</span> <span class="toc-text">舔狗四部曲–记忆的时光机</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ez-cube"><span class="toc-number">20.</span> <span class="toc-text">ez_cube</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%8A%E5%A4%95%E6%98%AF%E4%BD%95%E5%B9%B4"><span class="toc-number">21.</span> <span class="toc-text">今夕是何年</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Findme"><span class="toc-number">22.</span> <span class="toc-text">Findme</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%88%94%E7%8B%97%E5%9B%9B%E9%83%A8%E6%9B%B2%E2%80%93%E6%88%91%E7%9A%84%E7%99%BD%E6%9C%88%E5%85%89"><span class="toc-number">23.</span> <span class="toc-text">舔狗四部曲–我的白月光</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/07/04/XYCTF2025/XYCTF2025RE/" title="XYCTF2025"><img src="https://images.pexels.com/photos/3082313/pexels-photo-3082313.jpeg" onerror="this.onerror=null;this.src='/img/404.gif'" alt="XYCTF2025"/></a><div class="content"><a class="title" href="/2025/07/04/XYCTF2025/XYCTF2025RE/" title="XYCTF2025">XYCTF2025</a><time datetime="2025-07-04T12:25:01.428Z" title="Created 2025-07-04 20:25:01">2025-07-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/29/DSBCTF2024/DSBCTF/" title="DSBCTF2024"><img src="https://p.ananas.chaoxing.com/star3/400_0cQ80/43e305b7862e440ade282e538f09c159.webp" onerror="this.onerror=null;this.src='/img/404.gif'" alt="DSBCTF2024"/></a><div class="content"><a class="title" href="/2025/06/29/DSBCTF2024/DSBCTF/" title="DSBCTF2024">DSBCTF2024</a><time datetime="2025-06-29T08:50:00.000Z" title="Created 2025-06-29 16:50:00">2025-06-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/29/XYCTF2024/XYCTF2024/" title="XYCTF2024"><img src="https://w.wallhaven.cc/full/l3/wallhaven-l3lq12.png" onerror="this.onerror=null;this.src='/img/404.gif'" alt="XYCTF2024"/></a><div class="content"><a class="title" href="/2025/06/29/XYCTF2024/XYCTF2024/" title="XYCTF2024">XYCTF2024</a><time datetime="2025-06-29T02:25:00.000Z" title="Created 2025-06-29 10:25:00">2025-06-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/29/XYCTF2025/%E5%88%9D%E8%AF%86Unicorn/" title="初识Unicorn"><img src="https://img.freepik.com/free-photo/programming-background-with-person-working-with-codes-computer_23-2150010125.jpg" onerror="this.onerror=null;this.src='/img/404.gif'" alt="初识Unicorn"/></a><div class="content"><a class="title" href="/2025/06/29/XYCTF2025/%E5%88%9D%E8%AF%86Unicorn/" title="初识Unicorn">初识Unicorn</a><time datetime="2025-06-29T02:13:21.120Z" title="Created 2025-06-29 10:13:21">2025-06-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/25/OpenGL%E5%AD%A6%E4%B9%A0/OpenGL%E5%AD%A6%E4%B9%A0/" title="OpenGL初学习"><img src="https://w.wallhaven.cc/full/9m/wallhaven-9mdy88.jpg" onerror="this.onerror=null;this.src='/img/404.gif'" alt="OpenGL初学习"/></a><div class="content"><a class="title" href="/2025/06/25/OpenGL%E5%AD%A6%E4%B9%A0/OpenGL%E5%AD%A6%E4%B9%A0/" title="OpenGL初学习">OpenGL初学习</a><time datetime="2025-06-25T08:15:47.399Z" title="Created 2025-06-25 16:15:47">2025-06-25</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="workboard"><img class="workSituationImg boardsign" src="https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-上班摸鱼中.svg" alt="距离月入25k也就还差一个大佬带我~" title="距离月入25k也就还差一个大佬带我~"/><div id="runtimeTextTip"></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2025 By <a class="footer-bar-link" href="/" title="zhike w" target="_blank">zhike w</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/styles/github-dark.css"/><script src="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/lib/highlight.min.js"></script><script>document.addEventListener('DOMContentLoaded', function () {
  document.querySelectorAll('pre code').forEach((block) => {
    hljs.highlightElement(block);
  });
});</script></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">Articles</div><div class="length-num">11</div></a><a href="/tags/" title="tag"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/categories/" title="category"><div class="headline">Categories</div><div class="length-num">3</div></a></div><span class="sidebar-menu-item-title">Function</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="Display Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>Display Mode</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><!--生成导航菜单的 Pug 代码片段--><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> 朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=1708664797&amp;server=tencent"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> 相册集</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/OpenGL/" style="font-size: 0.88rem;">OpenGL<sup>1</sup></a><a href="/tags/Reverse/" style="font-size: 0.88rem;">Reverse<sup>6</sup></a><a href="/tags/%E5%A4%8D%E7%8E%B0WP/" style="font-size: 0.88rem;">复现WP<sup>5</sup></a><a href="/tags/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">安卓开发学习<sup>4</sup></a><a href="/tags/%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">技术学习<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"></div><div id="rightside-config-show"><button id="readmode" type="button" title="Read Mode"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="go-up" type="button" title="Back To Top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("06/21/2025 10:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 zhike w 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("06/21/2025 10:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-下班啦.svg";
        img.title = "下班了就该开开心心的玩耍，嘿嘿~";
        img.alt = "下班了就该开开心心的玩耍，嘿嘿~";
      }

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script async data-pjax src="/js/anzhiyu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://npm.elemecdn.com/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>