<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>极客大挑战2024—Part1 | bugmak_blog</title><meta name="keywords" content="Reverse"><meta name="author" content="zhike w"><meta name="copyright" content="zhike w"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="极客大挑战2024—Part1"><meta name="application-name" content="极客大挑战2024—Part1"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="极客大挑战2024—Part1"><meta property="og:url" content="http://bumak.github.io/2025/07/07/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024%E2%80%94Part1/WP1/index.html"><meta property="og:site_name" content="bugmak_blog"><meta property="og:description" content="Hello_re​	UPX壳，修改了大写标志位，010Editor打开文件修改SYC0为UPX0即可成功使用工具脱壳。然后打开程序，很明显的密钥+下标异或加密，但是正常解密后分析密钥应该是运行时修改过了，所以动调看一下真正的密钥。 ​	因为有模8的操作，我们确定新密钥的前8位为所需。   data"><meta property="og:locale" content="en"><meta property="og:image" content="https://w.wallhaven.cc/full/l3/wallhaven-l3mlop.png"><meta property="article:author" content="zhike w"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://w.wallhaven.cc/full/l3/wallhaven-l3mlop.png"><meta name="description" content="Hello_re​	UPX壳，修改了大写标志位，010Editor打开文件修改SYC0为UPX0即可成功使用工具脱壳。然后打开程序，很明显的密钥+下标异或加密，但是正常解密后分析密钥应该是运行时修改过了，所以动调看一下真正的密钥。 ​	因为有模8的操作，我们确定新密钥的前8位为所需。   data"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://bumak.github.io/2025/07/07/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024%E2%80%94Part1/WP1/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: 'https://comments-theta-seven.vercel.app/',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🔍 分享与热心帮助","🔨 设计开发一条龙","🏃 脚踏实地行动派"]},
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"Author: zhike w","link":"Link: ","source":"Source: bugmak_blog","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.","copySuccess":"Copy success, copy and reprint please mark the address of this article"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'bugmak_blog',
  title: '极客大挑战2024—Part1',
  postAI: '',
  pageFillDescription: 'Hello_re, 先来一道签到题, 也许你也听jay, 让我康康你的调试, 我勒个z3啊, ezzzz, CPP_flower, 🧠 IDA 函数分析原理概述, 1. 控制流分析（Control Flow Analysis）, 2. 栈指针追踪（ESP Tracking x2F SP Analysis）, 3. 可达性判断（Code Reachability）, DH爱喝茶, 好像是python？, 奇怪的RC4, 玩就行了, 长颈鹿喜欢吃彩虹, AES!, blasting_master, ez_hook, 致我的星星, LinkedListModular壳修改了大写标志位打开文件修改为即可成功使用工具脱壳然后打开程序很明显的密钥下标异或加密但是正常解密后分析密钥应该是运行时修改过了所以动调看一下真正的密钥因为有模的操作我们确定新密钥的前位为所需原来是我的识别错误字符串识别有问题逆序过来就是正确的先来一道签到题给了一个后缀文件这是用汇编语言编写的源代码文件这是考察汇编基础了很显然奇数位异或偶数位减取第组乘以等于真正下标取字符数组操作更新取后一位字符每两位一组也许你也听源代码的文本变量名混淆过和在混淆不过我们又配上神奇的插件能够自动识别当然也可以自己使用编辑器的寻找替换功能换成易懂的代码直接写代码后面有一些无用的字节访问不存在去找的仓库看到另一个项目的文件打开后会有音乐哦一点点翻发现密文和关键字那就赛博厨子一把梭哈让我康康你的调试打开先异或再在函数加密其中开头的函数是的利用生成盒后面是利用盒生成密钥流标准密钥为字符串唯一需要注意的就是反编译的容易大小端错误逆序一下然后赛博厨子一把梭我勒个啊打开看到函数是对第一次输入的约束代码很清楚直接写脚本看到函数里面的函数每位一组从开始第组左移位看到函数考察求解求解解为无解解为最后解函数附件链接没了太久远了年底开的复习平台现在已经无了就看看别人的吧好像是题很纯的加密代码如下初始化值等于反向迭代打开还看不到主逻辑通过字符串搜索到指令部分但是无法反编译往上面翻一点点就会发现有个的花指令去了之后还有慢慢去吧看到一个新见的花指令形式分析一下处调用函数将返回地址压栈当前指向是并且压栈也就是在执行完后是指向而指向的是返回地址所以返回地址被修改到了中间全部可以掉或者把改为然后掉中间的部分不如全这是一段内存初始化以前直接忽视过去了没搞清楚表示内存块起始地址表示内存块大小单位是表示初始化值不会了啊栈一直平不了反编译也不行如下代码处后面我问为什么还没有到函数未就放弃分析了函数分析原理概述在分析函数自动识别跟踪反汇编恢复栈变量等时主要依赖三个核心机制控制流分析从入口地址开始沿着追踪所有可能执行的指令路径构建控制流图用于识别函数边界代码块调用关系栈指针追踪会模拟或在下的变化它跟踪所有栈相关指令等用于判断局部变量偏移参数传递返回地址位置可达性判断如果某段指令既没有跳转到它也不跳转出去可能判定它是孤立代码比如大量或字节无法反汇编成合法指令就不把它算进函数虽然没有完全理解但是我想到可能是之前的花指令没改完的时候分析异常后就不分析了就是这里无法分析下去了最后我检查了一遍没花指令了重新在函数头按键再按键最后按就又可以反编译了函数有点复杂各种乱七八糟的东西静态看不太懂反编译还是有点太难了不太能看这个时候我都建议去看汇编语句不见得会比这个困难开始动调设断点也是很讲究学问的像这种复杂的东西而且已知函数的地方我们就不能从头开始一点点看得多次调试先从的前一步开始看凭借动调时看变量的值来确定加密与否里面存储我们加密的是变量而前一步中和有关是两个值异或来的我们就看这两个异或值是多少一看就知道这就是一个异或加密其中一个是我们输入的字符串另一个是一个固定的改变输入确认这是固定的所以前面一堆都是系统代码或者是无关紧要的代码另外花指令真得看这个文章爱喝茶根据函数找到函数然后反编译不了往上看到花指令无敌了这个花指令会将设置为并且设置标志为指令会执行按位与运算但是不影响结果只改变标志位由于是所以保持所以不会跳转会跳转开始掉吧然后就可以反编译函数了碰到一个新函数在字符串中找到第一个包含中任意字符的位置然后返回这个位置的索引值如果没找到就返回的长度函数是一个标准加密每次加密前对处理反汇编工具自动生成的伪代码中使用的一个宏函数用来表示对一个位整数进行循环左移操作其中需要注意的是的指令容易被反编译为不知道为什么用减号就不对好像是文本文件以格式打开看到字节码的反汇编结果我刚好没学过乘此机会好好补一下推荐文章原创死磕字节码手工还原源码软件逆向看雪安全社区安全招聘逆向五字节码解读博客园索引访问索引访问调用后栈顶就会是返回的迭代器对象从栈中弹出迭代器对象并准备开始迭代从迭代器中取出下一个值并将值推送到栈顶如果取到的值是合法的它会继续执行循环体否则跳转到将栈顶的值就是获取到的当前值存储到局部变量中执行一元取反操作取栈顶变量复制一份再压入栈顶元素变两份当前栈顶的三个元素旋转一下例如当前变成这样做是为了适配后面的判断语句梭哈还原的代码如下它也有错误垃圾东西尝试自己对照看汇编指令修改加密函数类似带偏移加密函数字符与异或取反变换这种运算未注册版搞不定主逻辑同样修改过解密脚本加密后的为奇怪的打包的程序解包后得到密文和加密逻辑直接解包还会反编译不完全怎么回事没遇到过啊手动反汇编读汇编来补充这个自动添加的注释真的是漏洞百出没几个对的和都没能解析出来原来是的版本我是一点解不出来读取文件因为我不确定魔术头包含多少位实践证明是使用模块反汇编字节码容易理解错的指令指令执行时栈顶是那么就是指令不知道指令是绝对地址跳转指令是相对地址基址是下一条指令地址函数声明将栈顶两个元素复制一份放到栈顶就地栈异或减少内存占用异常发生时跳转到加载常量这个常量指向一个内联的列表推导式创建一个函数对象准备将其应用由于这个函数是列表推导式所以它将对进行迭代并返回一个列表结束当前代码块通常用于语句块啥也不是跳转到绝对位置可以大概看出来函数是是前后异或其中数据自取再看看的代码解包时函数没能成功解析出来和还是半对烦分析一下原先的了一下综合分析得到的如下简化了一些异常处理以及格式转换最后的解密代码如下开始还把的前后异或给解错了应该从后往前解还是没有理解的清清楚楚啊玩就行了逆向玩黄金矿工小游戏全屏还缩小不了修改得分通关后就提示有什么东西遗漏了我怎么知道然后打开文件我以敏锐的直觉看到开头的这是程序的文件头根本不是逆向无壳程序直接拖入函数是类凯撒密码数字也移位了偏移量函数使用异或加密里面调用了函数这个函数反编译不太好看其参数为指针格式化字符字符数据先猜测一下别想着都搞清楚其中有不少底层代码该清楚很麻烦的啊慢慢积累就好了猜测就是进行一下格式转换直接写脚本试试长颈鹿喜欢吃彩虹运行一下还挺好看打开看到函数使用变量进行跳转还没碰到过这是什么混淆方式吧其实一点点看也可以分析出程序运行流程但是先学习一下的方法有一个说是平坦化使用插件去除原来我之前安过啊这个插件下载教程可以去看这个文章我的切换到了版本的系统中的自行下载的然后通过命令安装好依赖使用起来就是先打开插件选择去平坦化的点击就算启动了之后回到函数在汇编界面按重新反编译一次这时候插件就会起作用可以看到情况大不一样效果很成功这个函数平坦化之后还是挺难看的一个变量挪动了好多位置主要就看到一个异或操作其中一个确定应该是输入的字符串另一个贼难跟踪当然在异或处下断点动调汇编指令处应该是能看出来这两个值是什么的但是我已经看过别人的了人家直接猜的看看动调的方法吧首先看到加密函数处可以直接拿到是可以确定的地址可以选择下内存断点看到异或处一个是我的输入另一个数多看两轮就知道是逆序的了规律也简单大胆猜测小心取值最后看到比较处取出加密输入和密文我们其实可以通过输入特定的来确定每位的异或值是多少这样也能解密有点累人真的是做题做久了一点兴趣都没了现在边做边记录做了两整天了早上起来开做晚上结束回去睡觉开始很有激情不觉得累做到这种攻坚的地方就没精力了缓几天再做吧无他考察算法的理解对我来说都无所谓反正是新知识没学过不会可以看另一篇文章专门学了半天的边理解边敲代码最后还搞定一些小的细节错误终于大功告成但是那是密码学的知识我们做题还得识别验证是不是标准的具体看看代码的实现进入函数输入后验证长度是否是位字节然后使用函数加密下面的那个不知道干嘛应该是的后一段应该是反编译有问题看汇编就很清楚了传入参数第一个是密钥第二个是密钥长度第五个是输入长度会检查是否是的倍数的可以清楚的看到是将分成了两次加密第二次传入的地址都加上了偏移然后看到函数里面是在做扩展轮密钥先将初始字节密钥换成个位字后面的就很清晰了就不一点点解析了是在是有点懒了是在取的字节复制到中看汇编也能看出来是指向的最后的解密代码如下实际只用到前个对输入的进行盒置换是一个个字节元素的列表以一维形式访问返回值是变换后的二维列表是一个个字节元素的列表以一维形式访问左移右移这个计算是有数学意义的不是简单的乘法运算原理可自行了解域的定义对上一轮最后字节先循环左移一位再置换轮常数异或从而计算出当前新一轮最前字节无壳位程序打开看到函数先是等待输入然后循环最后比较我是调试了一遍变量名变成了这个样子先看循环的逻辑进入函数其中有个全局变量初始值为函数每运行一次加存储输入字符串中的个连续字符其起始地址由变量决定很明显看出来每运行一次这个函数就会往后个字符比如输入是那么第一次就是取第二次就是函数里面的代码比较陌生还是问才知道这是使用库计算值的函数再下面就是次循环处理得到的值了逻辑很清楚只需要注意是字节数组那这个函数就很清楚了每次截取个字符计算值进行加密然后存储到内存空间中去存储的就是值个数退回到函数循环结束条件是和的值有关的其非即可停止循环查看内存空间看到该变量在尾部因为每次写入的是个字节长度即所以只有当写入个值后才会溢出到这个地方使得循环退出那我们也能得知到的长度就是个字符长度接下来的比较就没什么好说的了取出密文解密后进行爆破即可根据题目名称和提示也能猜到这题就是考爆破的代码如下无壳位打开看到一个简单的反调试直接把改为然后看到函数调试分析其输出的变量应该是对进行顺序打乱的这个简单通过测试输入得到输出就可以固定映射方式然后准备调试函数的时候发现根本没进去怎么回事原来在函数的结尾对内存中的函数进行了修改在函数头加了个跳转相对跳转跳到了函数头表示将要操作的内存区域大小修改内存保护改变内存区域所指向的字节的保护属性表示将内存区域设为可写这样就可以修改内存构造指令是的操作码后一行是在算地址偏移是因为程序写入跳转指令已经占据了字节修改内存内容先写字节再写字节恢复内存保护而函数很明显看出来是异或所以解密脚本如下调试提取的值得到其实也可以看看函数的置换逻辑首先外循环是轮是步长先后是简称是从下标开始到结束依次赋值的就是其下标算了细究起来发现前面的函数对也进行了打乱是进行第二次打乱了有点复杂不想看啊不想调了就这样吧找了一个别人的脚本包括顺序还原的随便看看吧的长度初始化为长度为的空字符串列表计数器用于跟踪读取的位置已知的值致我的星星好玩好玩不玩包后悔的强烈建议多做一会这样就能少后悔一点最好自己做出来逆向第一次做看到没有使用很难的东西基础语法会点就能看懂了还是解析一下函数是点击后更新界面的函数然后被设置为处理键盘输入的响应函数我们可以看到其比较值后会调用函数这是输出成功后提示信息的函数所以我们的目标就是搞定这个的字符串是什么但是爆破是不成功的直接爆的也是狠人只有继续看剩下的代码也没有什么提示了从行开始其实就是多余的代码当然没有必要肯定是不会放这段代码的反正我是没自己做出了中间有脑洞没风暴成功最后我是这样告诉自己的很明显行到行是在做迷宫的初始化这我都明白为什么告诉了行列是结果只有个字符还得自己补这是我的第一个犹豫点我也做过补了的尝试继续往后看第到行是纯提示选手自己计算出和的坐标但是有两个和我脑残了这没能和后面联系起来我的问题短时间刷题刷多了是这样的使用还出了个错之前脑残下了个包不知道干嘛的删也没删干净污染了环境处理又浪费我的时间声明整数变量创建求解器添加方程组检查可解性无解考脑洞吗我咋感觉这个文件里面的逻辑都有问题啊执行起来根本通关不了从行到结尾都是在做走迷宫的部分了但是代码逻辑就是有问题你会发现坐标根本没有更新选手要从错误的代码中猜出出题人正确的思路在函数中会直接进入死循环输入正确的答案控制台调用也会进入死循环这就不是让我玩的是让我看的这也就算了从明显的错误中猜到正确的思路像我这种小白都能看出错误难道出题人看不出来吗这里不算什么我也能看出来要跑两次实际上第一次做这种题被他这个错误代码逻辑给吓住了我都想举报题错了很难有继续思考的想法了很想找验证我的举报是正确的无所谓我其实还在尝试两个迷宫就两个迷宫输两次就输两次但是最完蛋的是迷宫的提示信息我没转过弯来忘记了第行对应的是数组中第行第列对应的是数组中的第列导致我迷宫复现错误这种东西一时半会真反应不过来也可能是前面也就脑子过载了我就不想浪费时间了就直接看了挺遗憾的没自己独立做出了少了一份感动以上是我的思维过程和一些吐槽下面是完美做法先补充完到字节补然后求解出和的坐标编写脚本得到迷宫字符串我喜欢通过输出迷宫得到迷宫后自己能够手写出来路径第一个是第二个迷宫是合在一起就得到了应该输入的字符串为可以通过计算一下值验证一下实际上是要在网页中按下这些字符然后才能跳转到正确提示页面这题就应该放在密码板块后面单独出一篇文章吧公司职员发现关键数据被加密了请帮忙解密出来注意和为输入的长度的字符串的值并包裹提交该题需要一些逆向基础实现的程序内含链表库相关可与队友联合解题也可学习些二进制基础对以后有益还是无壳打开查看进到函数分析分析很简单看出来是把位分成个位块形成链表结构函数没见过问下是库中的一个函数用于初始化默认的伪随机数生成器状态对象这个函数是的一部分而是一个用于高精度整数浮点数和有理数运算的数学库函数原型初始化后你可以使用这个状态对象来生成伪随机整数例如通过或函数生成长度为的随机大整数用于查找一个给定数的下一个素数用于执行大整数减去一个无符号长整数的操作函数原型实行大整数的乘法运算参数是计算两个大整数的最大公约数用于计算两个大整数的整除前提是被除数能够被除数整除即没有余数否则会报错计算模逆元参数为其中是模数函数获取类型大整数的低位无符号整数部分返回一个值如果大整数超出的范围只返回低位部分截断高位用于初始化一个大整数变量并用字符串来设置它的值用于计算大整数的模幂运算标准接口原型用于将的多精度整数类型转换为字符串使用示例定义一个随机数生成器的状态对象定义一个多精度整数变量用于存储我们要作为种子的值这里是初始化随机数生成器使用默认算法通常是线性同余生成器设置种子初始化为整数并赋值为设置随机数生成器的种子为即生成一个最大为的随机数定义并初始化一个多精度整数用于存放生成的随机数使用中的随机状态生成一个随机大整数满足即小于清理内存是用来把格式化的数据写入字符串字符数组中而不是直接输出到屏幕是用于将格式化的数据写入指定的文件流密码哎呀难办哦数学课数学课会不了一点加密算法都认不出来直接看吧',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-07-08 13:34:48',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><script src="/static/js/index_media.js"></script><link rel="stylesheet" href="/static/css/index_media.css"><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/rss.xml" title="bugmak_blog" type="application/atom+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><!-- 优先级控制逻辑（独立作用域）--><!-- 路径处理（保留原有逻辑）--><!-- 首页专用路径（网页3）--><header class="post-bg" id="page-header"><!--导航栏（nav）的实现--><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">bugmak_blog</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><!--生成导航菜单的 Pug 代码片段--><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://ik.imagekit.io/gi6gzzr31s/wechat_code.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://ik.imagekit.io/gi6gzzr31s/wechat_code.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://ik.imagekit.io/gi6gzzr31s/alipay.jpg" target="_blank"><img class="post-qr-code-img" alt="alipay" src="https://ik.imagekit.io/gi6gzzr31s/alipay.jpg"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> Newest Comments</span></div><div class="aside-list"><span>loading...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/OpenGL/" style="font-size: 1.05rem;">OpenGL<sup>1</sup></a><a href="/tags/Reverse/" style="font-size: 1.05rem;">Reverse<sup>8</sup></a><a href="/tags/Windows/" style="font-size: 1.05rem;">Windows<sup>1</sup></a><a href="/tags/crypto/" style="font-size: 1.05rem;">crypto<sup>1</sup></a><a href="/tags/%E5%A4%8D%E7%8E%B0WP/" style="font-size: 1.05rem;">复现WP<sup>5</sup></a><a href="/tags/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">安卓开发学习<sup>4</sup></a><a href="/tags/%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">技术学习<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>Archives</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/07/"><span class="card-archive-list-date">July 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/06/"><span class="card-archive-list-date">June 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">10</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/" itemprop="url">CTF</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Reverse/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Reverse</span></a></span></div></div><h1 class="post-title" itemprop="name headline">极客大挑战2024—Part1</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-07-07T13:05:50.000Z" title="Created 2025-07-07 21:05:50">2025-07-07</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-07-08T05:34:48.094Z" title="Updated 2025-07-08 13:34:48">2025-07-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="极客大挑战2024—Part1"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">Post View:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为天门"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>天门</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://w.wallhaven.cc/full/l3/wallhaven-l3mlop.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://bumak.github.io/2025/07/07/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024%E2%80%94Part1/WP1/"><header><a class="post-meta-categories" href="/categories/CTF/" itemprop="url">CTF</a><a href="/tags/Reverse/" tabindex="-1" itemprop="url">Reverse</a><h1 id="CrawlerTitle" itemprop="name headline">极客大挑战2024—Part1</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">zhike w</span><time itemprop="dateCreated datePublished" datetime="2025-07-07T13:05:50.000Z" title="Created 2025-07-07 21:05:50">2025-07-07</time><time itemprop="dateCreated datePublished" datetime="2025-07-08T05:34:48.094Z" title="Updated 2025-07-08 13:34:48">2025-07-08</time></header><h1 id="Hello-re"><a href="#Hello-re" class="headerlink" title="Hello_re"></a>Hello_re</h1><p>​	UPX壳，修改了大写标志位，010Editor打开文件修改<code>SYC0</code>为<code>UPX0</code>即可成功使用工具脱壳。然后打开程序，很明显的密钥+下标异或加密，但是正常解密后分析密钥应该是运行时修改过了，所以动调看一下真正的密钥。</p>
<p>​	因为有模8的操作，我们确定新密钥的前8位为所需。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250701150024569.png" alt="image-20250701150024569">

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">data = [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">52</span>,<span class="hljs-number">3</span>,<span class="hljs-number">96</span>,<span class="hljs-number">47</span>,<span class="hljs-number">28</span>,<span class="hljs-number">107</span>,<span class="hljs-number">15</span>,<span class="hljs-number">9</span>,<span class="hljs-number">24</span>,<span class="hljs-number">45</span>,<span class="hljs-number">62</span>,<span class="hljs-number">60</span>,<span class="hljs-number">2</span>,<span class="hljs-number">17</span>,<span class="hljs-number">123</span>,<span class="hljs-number">39</span>,<span class="hljs-number">58</span>,<span class="hljs-number">41</span>,<span class="hljs-number">48</span>,<span class="hljs-number">96</span>,<span class="hljs-number">26</span>,<span class="hljs-number">8</span>,<span class="hljs-number">52</span>,<span class="hljs-number">63</span>,<span class="hljs-number">100</span>,<span class="hljs-number">33</span>,<span class="hljs-number">106</span>,<span class="hljs-number">122</span>,<span class="hljs-number">48</span>]<br>key = [<span class="hljs-number">83</span>, <span class="hljs-number">89</span>, <span class="hljs-number">67</span>, <span class="hljs-number">76</span>, <span class="hljs-number">79</span>, <span class="hljs-number">86</span>, <span class="hljs-number">69</span>, <span class="hljs-number">82</span>]<br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>    flag += <span class="hljs-built_in">chr</span>(data[i] ^ i ^ key[i%<span class="hljs-number">8</span>])<br><span class="hljs-built_in">print</span>(flag) <br><span class="hljs-comment">#SYC&#123;H3lI0_@_new_R3vers3_Ctf3r!!&#125;</span><br></code></pre></td></tr></table></figure>

<p>​	666，原来是我的IDA识别错误（字符串识别有问题），逆序过来就是正确的KEY。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250701151252865.png" alt="image-20250701151252865">









<h1 id="先来一道签到题"><a href="#先来一道签到题" class="headerlink" title="先来一道签到题"></a>先来一道签到题</h1><p>​	给了一个<code>.s</code>后缀文件，这是用汇编语言编写的源代码文件，这是考察汇编基础了！</p>
<p>​	很显然，奇数位异或7，偶数位减5。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs assembly">.L3:<br>    movl    -84(%rbp), %eax          ;取第i组<br>    movl    %eax, %ecx               <br>    shl     %ecx                     ;乘以2等于真正下标<br>    movzbl  (%rdi,%rcx), %eax        ;取字符，数组操作<br>    xorb    $7, %al                  <br>    movb    %al, (%rdi,%rcx)          ;更新<br>    movzbl  1(%rdi,%rcx), %eax        ;取后一位字符<br>    subb    $5, %al                    <br>    movb    %al, 1(%rdi,%rcx)       <br>    addl    $1, -84(%rbp)<br>.L2:<br>    movl    -84(%rbp), %eax<br>    imull   $2, %eax                  ;每两位一组<br>    cmpl    $36, %eax                 <br>    jl      .L3<br></code></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">data = <span class="hljs-string">&quot;TTDv^jrZu`Gg6tXfi+pZojpZSjXmbqbmt.&amp;x&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>    tmp = <span class="hljs-built_in">ord</span>(data[i])<br>    <span class="hljs-keyword">if</span> i % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br>        tmp = tmp ^ <span class="hljs-number">7</span>;<br>    <span class="hljs-keyword">else</span>:<br>        tmp = tmp + <span class="hljs-number">5</span>;<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(tmp), end=<span class="hljs-string">&quot;&quot;</span>)<br></code></pre></td></tr></table></figure>



<h1 id="也许你也听jay"><a href="#也许你也听jay" class="headerlink" title="也许你也听jay"></a>也许你也听jay</h1><p>​	源代码的txt文本，变量名混淆过，0、o和O在混淆，不过我们又<strong>sublime</strong>配上神奇的插件<strong>Word Highlight</strong>，能够自动识别，当然也可以自己使用编辑器的<strong>寻找替换</strong>功能，换成易懂的代码。</p>
<p>​	直接写代码。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">ENC_URL = [<span class="hljs-number">0x96</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xd4</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(ENC_URL)):<br>    ENC_URL[i] -= <span class="hljs-number">0x5D</span> - i<br>    ENC_URL[i] += <span class="hljs-number">47</span> + i + <span class="hljs-number">1</span><br>    ENC_URL[i] ^= i + <span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(ENC_URL[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#https://am1re-sudo.github.io/Coisni ，后面有一些无用的字节</span><br></code></pre></td></tr></table></figure>

<p>​	访问不存在，去找<strong>am1re-sudo</strong>的仓库，看到另一个项目**<a target="_blank" rel="noopener" href="https://github.com/Am1re-sudo/Coisni.github.io">Coisni.github.io</a><strong>的</strong>index.html**文件，打开后会有音乐哦。一点点翻，发现密文、KEY和RC4关键字，那就赛博厨子一把梭哈。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250701155638301.png" alt="image-20250701155638301">





<h1 id="让我康康你的调试"><a href="#让我康康你的调试" class="headerlink" title="让我康康你的调试"></a>让我康康你的调试</h1><p>​	IDA打开，先异或0x14，再在<strong>sub_14A6</strong>函数加密，其中开头的<strong>sub_11C9</strong>函数是RC4的KSA（利用Key生成S盒），后面是PRGA（利用S盒生成密钥流）。标准RC4，密钥为字符串<strong>syclover</strong>，唯一需要注意的就是，IDA反编译的容易大小端错误，逆序一下。</p>
<p>​	然后赛博厨子一把梭。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250701161018271.png" alt="image-20250701161018271">

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">DATA1 = <span class="hljs-string">&quot;A67A02C9047D5B94&quot;</span><br>DATA2 = <span class="hljs-string">&quot;7EF9680DBC980739&quot;</span><br>DATA3 = <span class="hljs-string">&quot;7104F81698BFBD08&quot;</span><br>DATA4 = <span class="hljs-string">&quot;61DB8498B686155F&quot;</span><br>enc = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(DATA1)-<span class="hljs-number">2</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>):<br>    enc += DATA1[i:i+<span class="hljs-number">2</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(DATA2)-<span class="hljs-number">2</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>):<br>    enc += DATA2[i:i+<span class="hljs-number">2</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(DATA3)-<span class="hljs-number">2</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>):<br>    enc += DATA3[i:i+<span class="hljs-number">2</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(DATA4)-<span class="hljs-number">2</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">2</span>):<br>    enc += DATA4[i:i+<span class="hljs-number">2</span>]<br><span class="hljs-built_in">print</span>(enc+<span class="hljs-string">&quot;6D&quot;</span>)<br></code></pre></td></tr></table></figure>



<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250701161059584.png" alt="image-20250701161059584">





<h1 id="我勒个z3啊"><a href="#我勒个z3啊" class="headerlink" title="我勒个z3啊"></a>我勒个z3啊</h1><p>​	IDA打开，看到<strong>sub_401B7B</strong>函数，是对第一次输入的约束，代码很清楚，直接写脚本。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">str2 = [<span class="hljs-number">42</span>, <span class="hljs-number">14</span>, <span class="hljs-number">14</span>, <span class="hljs-number">20</span>, <span class="hljs-number">63</span>, <span class="hljs-number">63</span>, <span class="hljs-number">63</span>, <span class="hljs-number">38</span>, <span class="hljs-number">17</span>, <span class="hljs-number">10</span>, <span class="hljs-number">21</span>, <span class="hljs-number">21</span>, <span class="hljs-number">14</span>, <span class="hljs-number">23</span>, <span class="hljs-number">16</span>, <span class="hljs-number">14</span>]<br>a0123456789abcd = <span class="hljs-string">&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ?_&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(str2)):<br>    <span class="hljs-built_in">print</span>(a0123456789abcd[str2[i]], end=<span class="hljs-string">&quot;&quot;</span>)	<span class="hljs-comment">#Geek___Challenge</span><br></code></pre></td></tr></table></figure>

<p>​	看到<strong>sub_401AAC</strong>函数，里面的<strong>sub_4019EB</strong>函数，每4位一组，从0开始，第i组左移（i+1）位。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_4019EB</span><span class="hljs-params">(<span class="hljs-type">char</span> *Myflag2)</span><br>&#123;<br>  __int64 result; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">char</span> v2; <span class="hljs-comment">// [rsp+3h] [rbp-Dh]</span><br>  <span class="hljs-type">int</span> k; <span class="hljs-comment">// [rsp+4h] [rbp-Ch]</span><br>  <span class="hljs-type">int</span> j; <span class="hljs-comment">// [rsp+8h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+Ch] [rbp-4h]</span><br><br>  <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">7</span>; ++i )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( j = <span class="hljs-number">0</span>; ; ++j )<br>    &#123;<br>      result = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>)j;<br>      <span class="hljs-keyword">if</span> ( j &gt;= i )<br>        <span class="hljs-keyword">break</span>;<br>      v2 = Myflag2[<span class="hljs-number">4</span> * i];<br>      <span class="hljs-keyword">for</span> ( k = <span class="hljs-number">0</span>; k &lt;= <span class="hljs-number">2</span>; ++k )<br>        Myflag2[<span class="hljs-number">4</span> * i + k] = Myflag2[<span class="hljs-number">4</span> * i + <span class="hljs-number">1</span> + k];<br>      Myflag2[<span class="hljs-number">4</span> * i + <span class="hljs-number">3</span>] = v2;<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>



<p>​	看到函数<strong>sub_40179A</strong>，考察Z3求解。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250701162542314.png" alt="image-20250701162542314">

<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">dword_4040A0 = [<span class="hljs-number">411</span>, <span class="hljs-number">275</span>, <span class="hljs-number">393</span>, <span class="hljs-number">457</span>, <span class="hljs-number">592</span>, <span class="hljs-number">1334</span>, <span class="hljs-number">1246</span>, <span class="hljs-number">444</span>, <span class="hljs-number">1051</span>, <span class="hljs-number">1828</span>, <span class="hljs-number">1744</span>, <span class="hljs-number">1185</span>, <span class="hljs-number">1605</span>, <span class="hljs-number">1141</span>, <span class="hljs-number">1226</span>, <span class="hljs-number">1676</span>, <span class="hljs-number">997</span>, <span class="hljs-number">455</span>, <span class="hljs-number">829</span>, <span class="hljs-number">1463</span>, <span class="hljs-number">653</span>, <span class="hljs-number">580</span>, <span class="hljs-number">782</span>, <span class="hljs-number">657</span>, <span class="hljs-number">625</span>, <span class="hljs-number">769</span>, <span class="hljs-number">1119</span>, <span class="hljs-number">1135</span>, <span class="hljs-number">1303</span>, <span class="hljs-number">1054</span>, <span class="hljs-number">1062</span>, <span class="hljs-number">1205</span>]<br><br><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br>En_flag = [Int(<span class="hljs-string">f&quot;En_flag<span class="hljs-subst">&#123;i&#125;</span>&quot;</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>)]<br><br>constraints = [And(En_flag[i] &gt;= <span class="hljs-number">0</span>, En_flag[i] &lt;= <span class="hljs-number">255</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>)]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">32</span>, <span class="hljs-number">4</span>):<br>    constraints.append(<br>        En_flag[i] + <span class="hljs-number">8</span> * En_flag[i + <span class="hljs-number">1</span>] + <span class="hljs-number">6</span> * En_flag[i + <span class="hljs-number">2</span>] + En_flag[i + <span class="hljs-number">3</span>] == dword_4040A0[i]<br>    )<br>    constraints.append(<br>        En_flag[i + <span class="hljs-number">1</span>] + <span class="hljs-number">8</span> * En_flag[i + <span class="hljs-number">2</span>] + <span class="hljs-number">6</span> * En_flag[i + <span class="hljs-number">3</span>] + En_flag[i] == dword_4040A0[i + <span class="hljs-number">1</span>]<br>    )<br>    constraints.append(<br>        En_flag[i + <span class="hljs-number">2</span>] + <span class="hljs-number">8</span> * En_flag[i + <span class="hljs-number">3</span>] + <span class="hljs-number">6</span> * En_flag[i] + En_flag[i + <span class="hljs-number">1</span>] == dword_4040A0[i + <span class="hljs-number">2</span>]<br>    )<br>    constraints.append(<br>        En_flag[i + <span class="hljs-number">3</span>] + <span class="hljs-number">8</span> * En_flag[i] + <span class="hljs-number">6</span> * En_flag[i + <span class="hljs-number">1</span>] + En_flag[i + <span class="hljs-number">2</span>] == dword_4040A0[i + <span class="hljs-number">3</span>]<br>    )<br><br>solver = Solver()<br>solver.add(constraints)<br><br><span class="hljs-comment"># 求解</span><br><span class="hljs-keyword">if</span> solver.check() == sat:<br>    model = solver.model()<br>    result = [model.evaluate(En_flag[i]).as_long() <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>)]<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;解为:&quot;</span>, result)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;无解&quot;</span>)<br>    <br>    <br><span class="hljs-comment">#解为: [23, 40, 7, 26, 29, 3, 69, 125, 111, 9, 125, 118, 99, 126, 74, 54, 112, 89, 28, 5, 25, 63, 9, 70, 111, 26, 43, 48, 58, 102, 60, 69]</span><br></code></pre></td></tr></table></figure>



<p>最后解<strong>sub_401AAC</strong>函数。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">Myflag2 = [<span class="hljs-number">23</span>, <span class="hljs-number">40</span>, <span class="hljs-number">7</span>, <span class="hljs-number">26</span>, <span class="hljs-number">29</span>, <span class="hljs-number">3</span>, <span class="hljs-number">69</span>, <span class="hljs-number">125</span>, <span class="hljs-number">111</span>, <span class="hljs-number">9</span>, <span class="hljs-number">125</span>, <span class="hljs-number">118</span>, <span class="hljs-number">99</span>, <span class="hljs-number">126</span>, <span class="hljs-number">74</span>, <span class="hljs-number">54</span>, <span class="hljs-number">112</span>, <span class="hljs-number">89</span>, <span class="hljs-number">28</span>, <span class="hljs-number">5</span>, <span class="hljs-number">25</span>, <span class="hljs-number">63</span>, <span class="hljs-number">9</span>, <span class="hljs-number">70</span>, <span class="hljs-number">111</span>, <span class="hljs-number">26</span>, <span class="hljs-number">43</span>, <span class="hljs-number">48</span>, <span class="hljs-number">58</span>, <span class="hljs-number">102</span>, <span class="hljs-number">60</span>, <span class="hljs-number">69</span>]<br>Myflag1 = <span class="hljs-string">&quot;Geek___Challenge&quot;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Myflag2)-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>):<br>    Myflag2[i] ^= <span class="hljs-built_in">ord</span>(Myflag1[(<span class="hljs-number">47</span> - i) % <span class="hljs-number">16</span>]) ^ i<br>    Myflag2[i] ^= Myflag2[(i-<span class="hljs-number">1</span>)%<span class="hljs-built_in">len</span>(Myflag2)]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(Myflag2), <span class="hljs-number">4</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i//<span class="hljs-number">4</span>):<br>        Myflag2[i], Myflag2[i + <span class="hljs-number">1</span>], Myflag2[i + <span class="hljs-number">2</span>], Myflag2[i + <span class="hljs-number">3</span>] = Myflag2[i + <span class="hljs-number">3</span>], Myflag2[i], Myflag2[i + <span class="hljs-number">1</span>], \<br>        Myflag2[i + <span class="hljs-number">2</span>]<br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(Myflag2)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(Myflag2[i]), end=<span class="hljs-string">&quot;&quot;</span>)	<span class="hljs-comment">#SYC&#123;Wow!!_Y0u_4r3_9o0d_At_r3$!!&#125;</span><br></code></pre></td></tr></table></figure>



<h1 id="ezzzz"><a href="#ezzzz" class="headerlink" title="ezzzz"></a>ezzzz</h1><p>​	附件链接没了，太久远了，2024年底开的复习平台，现在已经无了。就看看别人的WP吧，好像是apk题，很纯的tea加密，java代码如下。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.beans.*;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Main</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">int</span>[] enc=&#123;<span class="hljs-number">0xf1f186b2</span>, <span class="hljs-number">0x5a96c782</span>,<br>                <span class="hljs-number">0xe6c63a0b</span>, <span class="hljs-number">0x70b61b5c</span>,<br>                <span class="hljs-number">0xed6bf848</span>, <span class="hljs-number">0x89700d6b</span>,<br>                <span class="hljs-number">0x9381b5c</span>, <span class="hljs-number">0xcb2f24fa</span>,<br>                <span class="hljs-number">0xb1c79e79</span>, <span class="hljs-number">0x6d822d9c</span>,<br>                <span class="hljs-number">0xdcc55f76</span>, <span class="hljs-number">0xf780e75</span>,<br>                <span class="hljs-number">0xd65c4af</span>, <span class="hljs-number">0xb89084a9</span>,<br>                <span class="hljs-number">0xe978c382</span>, <span class="hljs-number">0x7a8dd810</span>,<br>                <span class="hljs-number">0x91f28df3</span>, <span class="hljs-number">0xa84dbaca</span>,<br>                <span class="hljs-number">0xb4d75f75</span>, <span class="hljs-number">0xf19af8e5</span>,<br>                <span class="hljs-number">0xb90f80fc</span>, <span class="hljs-number">0xfc10a5c3</span>,<br>                <span class="hljs-number">0xd20679fb</span>, <span class="hljs-number">0x2bc734c8</span>,<br>                <span class="hljs-number">0xccb31c92</span>, <span class="hljs-number">0x1ac52ad3</span>,<br>                <span class="hljs-number">0xe7f922b7</span>, <span class="hljs-number">0x2e24d923</span>,<br>                <span class="hljs-number">0xfb4ce9f5</span>, <span class="hljs-number">0x3548a9e5</span>,<br>                <span class="hljs-number">0x71ebc25a</span>, <span class="hljs-number">0xdf38862e</span>,<br>                <span class="hljs-number">0x10059186</span>, <span class="hljs-number">0x32750946</span>,<br>                <span class="hljs-number">0x3dd4d54c</span>, <span class="hljs-number">0x905abc36</span>,<br>                <span class="hljs-number">0xc26d5312</span>, <span class="hljs-number">0xd2cd42c0</span>,<br>                <span class="hljs-number">0x772d99e5</span>, <span class="hljs-number">0xcd4c466</span>,<br>                <span class="hljs-number">0x5c3178d6</span>, <span class="hljs-number">0x3a7ffe71</span>,<br>                <span class="hljs-number">0xada251c0</span>, <span class="hljs-number">0x70568d5a</span>,<br>                <span class="hljs-number">0x5798c292</span>, <span class="hljs-number">0x1ec0f7fc</span>,<br>                <span class="hljs-number">0x3ae9d841</span>, <span class="hljs-number">0x84607629</span>,<br>                <span class="hljs-number">0x30ca6a2d</span>, <span class="hljs-number">0xccef51d2</span>,<br>                <span class="hljs-number">0xa1a80854</span>, <span class="hljs-number">0x91b0f82d</span>,<br>                <span class="hljs-number">0x686ca347</span>, <span class="hljs-number">0x74c52d0f</span>,<br>                <span class="hljs-number">0xf26449f</span>, <span class="hljs-number">0xc28d362c</span>,<br>                <span class="hljs-number">0x86f3311b</span>, <span class="hljs-number">0x8adc4fb1</span>,<br>                <span class="hljs-number">0xa4497e34</span>, <span class="hljs-number">0xe0f0915d</span>&#125;;<br>        <span class="hljs-type">int</span>[] data = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">2</span>];<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">60</span>;j+=<span class="hljs-number">2</span>)<br>        &#123;<br>            data[<span class="hljs-number">0</span>]=enc[j];<br>            data[<span class="hljs-number">1</span>]=enc[j+<span class="hljs-number">1</span>];<br>            <span class="hljs-type">int</span>[] res=Enc.encrypt(data);<br>            System.out.print((<span class="hljs-type">char</span>)res[<span class="hljs-number">0</span>]);<br>            System.out.print((<span class="hljs-type">char</span>)res[<span class="hljs-number">1</span>]);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Enc</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">DELTA</span> <span class="hljs-operator">=</span> -<span class="hljs-number">1640531527</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">int</span>[] encrypt(<span class="hljs-type">int</span>[] iArr) &#123;<br><br>        <span class="hljs-type">int</span>[] iArr2 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">4</span>];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i2</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i2 &lt; <span class="hljs-number">4</span>; i2++) &#123;<br>            iArr2[i2] = <span class="hljs-string">&quot;GEEK&quot;</span>.charAt(i2);<br>        &#125;<br>        <span class="hljs-type">int</span>[] iArr3=iArr;<br>        decrypt(iArr3, iArr2);<br><br>        <span class="hljs-keyword">return</span> iArr3;<br><br>    &#125;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">decrypt</span><span class="hljs-params">(<span class="hljs-type">int</span>[] iArr, <span class="hljs-type">int</span>[] iArr2)</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> iArr[<span class="hljs-number">0</span>];<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i2</span> <span class="hljs-operator">=</span> iArr[<span class="hljs-number">1</span>];<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i3</span> <span class="hljs-operator">=</span> -<span class="hljs-number">957401312</span>; <span class="hljs-comment">// 初始化值，等于 32 * -1640531527</span><br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i4</span> <span class="hljs-operator">=</span> <span class="hljs-number">31</span>; i4 &gt;= <span class="hljs-number">0</span>; i4--) &#123; <span class="hljs-comment">// 反向迭代</span><br>            i2 -= ((((i &lt;&lt; <span class="hljs-number">4</span>) ^ (i &gt;&gt; <span class="hljs-number">5</span>)) + i) ^ (iArr2[(i3 &gt;&gt;&gt; <span class="hljs-number">11</span>) &amp; <span class="hljs-number">3</span>] + i3)) ^ (i3 + i4);<br>            i3 += <span class="hljs-number">1640531527</span>;<br>            i -= ((((i2 &lt;&lt; <span class="hljs-number">4</span>) ^ (i2 &gt;&gt; <span class="hljs-number">5</span>)) + i2) ^ (iArr2[i3 &amp; <span class="hljs-number">3</span>] + i3)) ^ (i3 + i4);<br>        &#125;<br><br>        iArr[<span class="hljs-number">0</span>] = i;<br>        iArr[<span class="hljs-number">1</span>] = i2;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>





<h1 id="CPP-flower"><a href="#CPP-flower" class="headerlink" title="CPP_flower"></a>CPP_flower</h1><p>​	IDA打开，还看不到主逻辑。通过字符串搜索到指令部分，但是无法反编译，往上面翻一点点就会发现有个<code>jnz+jz</code>的花指令，去了之后还有，慢慢去吧。</p>
<p>​	看到一个新见的花指令形式，分析一下，<strong>A39D9C</strong>处调用函数，将返回地址<strong>A39DA1</strong>压栈，当前ESP指向。<strong>push ebp</strong>是<strong>ESP-4</strong>，并且EBP压栈，也就是在<strong>A39DA7</strong>执行完后，<code>[esp]</code>是指向EBP，而<code>[esp+4]</code>指向的是返回地址。所以返回地址被修改到了<strong>A39DB3</strong>，中间全部可以<strong>nop</strong>掉，或者把<strong>call</strong>改为<strong>jmp</strong>，然后nop掉中间的部分（不如全nop）。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs assembly">.text:00A39D9C                 call    sub_A39DA6<br>.text:00A39DA1                 call    near ptr 4B4BA82h<br>.text:00A39DA1 sub_A39D10      endp ; sp-analysis failed<br>.text:00A39DA1<br>.text:00A39DA6<br>.text:00A39DA6 ; =============== S U B R O U T I N E =======================================<br>.text:00A39DA6<br>.text:00A39DA6 ; Attributes: bp-based frame<br>.text:00A39DA6<br>.text:00A39DA6 sub_A39DA6      proc near               ; CODE XREF: sub_A39D10+8C↑p<br>.text:00A39DA6                 push    ebp<br>.text:00A39DA7                 mov     ebp, esp<br>.text:00A39DA9                 db      36h					<br>.text:00A39DA9                 add     dword ptr [esp+4], 12h<br>.text:00A39DAF                 mov     esp, ebp<br>.text:00A39DB1                 pop     ebp<br>.text:00A39DB2                 retn<br>.text:00A39DB2 sub_A39DA6      endp<br>.text:00A39DB2<br>.text:00A39DB3 ; ---------------------------------------------------------------------------<br>.text:00A39DB3                 mov     esi, esp<br></code></pre></td></tr></table></figure>

<p>​	这是一段内存初始化，以前直接忽视过去了，没搞清楚。<code>edi</code>表示内存块起始地址，<code>ecx</code>表示内存块大小，单位是<code>dword</code>，<code>eax</code>表示初始化值。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs assembly">							lea     edi, [ebp+var_164]<br>.text:00A39D30                 mov     ecx, 56h<br>.text:00A39D35                 mov     eax, 0CCCCCCCCh<br>.text:00A39D3A                 rep stosd<br></code></pre></td></tr></table></figure>

<p>​	不会了啊，栈一直平不了，反编译也不行，如下代码处。后面我问<strong>ChatGpt</strong>，为什么还没有到函数未，IDA就放弃分析了？</p>
<blockquote>
<h2 id="🧠-IDA-函数分析原理概述"><a href="#🧠-IDA-函数分析原理概述" class="headerlink" title="🧠 IDA 函数分析原理概述"></a>🧠 IDA 函数分析原理概述</h2><p>IDA 在分析函数（自动识别、跟踪、反汇编、恢复栈变量等）时，主要依赖三个核心机制：</p>
<h3 id="1-控制流分析（Control-Flow-Analysis）"><a href="#1-控制流分析（Control-Flow-Analysis）" class="headerlink" title="1. 控制流分析（Control Flow Analysis）"></a>1. <strong>控制流分析（Control Flow Analysis）</strong></h3><ul>
<li>从入口地址开始，沿着 <code>call/jmp/ret</code> 追踪所有可能执行的指令路径</li>
<li>构建控制流图（CFG），用于识别函数边界、代码块、调用关系</li>
</ul>
<h3 id="2-栈指针追踪（ESP-Tracking-SP-Analysis）"><a href="#2-栈指针追踪（ESP-Tracking-SP-Analysis）" class="headerlink" title="2. 栈指针追踪（ESP Tracking &#x2F; SP Analysis）"></a>2. <strong>栈指针追踪（ESP Tracking &#x2F; SP Analysis）</strong></h3><ul>
<li>IDA 会模拟 <code>esp</code>（或在 x64 下 <code>rsp</code>）的变化</li>
<li>它跟踪所有栈相关指令：<code>push/pop</code>, <code>sub/add esp</code>, <code>call</code>, <code>ret</code> 等</li>
<li>用于判断局部变量偏移、参数传递、返回地址位置</li>
</ul>
<h3 id="3-可达性判断（Code-Reachability）"><a href="#3-可达性判断（Code-Reachability）" class="headerlink" title="3. 可达性判断（Code Reachability）"></a>3. <strong>可达性判断（Code Reachability）</strong></h3><ul>
<li>如果某段指令既没有跳转到它，也不跳转出去，IDA可能判定它是“孤立代码”</li>
<li>比如大量 <code>nop</code>，或字节无法反汇编成合法指令，IDA就不把它算进函数</li>
</ul>
</blockquote>
<p>​	虽然没有完全理解，但是我想到，可能是之前的花指令没改完的时候IDA分析异常后，就不分析了。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs assembly">							call    sub_A314B0<br>.text:00A39D98                 mov     byte ptr [ebp+var_4], 1<br>.text:00A39D98 sub_A39D10      endp ; sp-analysis failed				;就是这里无法分析下去了。<br>.text:00A39D98<br>.text:00A39D9C                 nop<br>.text:00A39D9D                 nop<br>.text:00A39D9E                 nop<br>.text:00A39D9F                 nop<br>.text:00A39DA0                 nop<br>.text:00A39DA1                 nop<br>.text:00A39DA2                 nop<br>.text:00A39DA3                 nop<br>.text:00A39DA4                 nop<br>.text:00A39DA5                 nop<br>.text:00A39DA6                 nop<br>.text:00A39DA7                 nop<br>.text:00A39DA8                 nop<br>.text:00A39DA9                 nop<br>.text:00A39DAA                 nop<br>.text:00A39DAB                 nop<br>.text:00A39DAC                 nop<br>.text:00A39DAD                 nop<br>.text:00A39DAE                 nop<br>.text:00A39DAF                 nop<br>.text:00A39DB0                 nop<br>.text:00A39DB1                 nop<br>.text:00A39DB2                 nop<br>.text:00A39DB3                 mov     esi, esp<br></code></pre></td></tr></table></figure>

<p>​	最后我检查了一遍没花指令了，重新在<strong>sub_A39D10</strong>函数头按<strong>U</strong>键，再按<strong>C</strong>键，最后按<strong>P</strong>、<strong>F5</strong>就又可以反编译了。</p>
<p>​	函数有点复杂，各种乱七八糟的东西，静态看不太懂。IDA反编译C++还是有点太难了，不太能看，这个时候我都建议去看汇编语句，不见得会比这个困难！</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">int</span> v3; <span class="hljs-comment">// eax</span><br>  __int64 Myflag; <span class="hljs-comment">// rax</span><br>  _DWORD *v5; <span class="hljs-comment">// esi</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// [esp-8h] [ebp-23Ch]</span><br>  _DWORD v9[<span class="hljs-number">41</span>]; <span class="hljs-comment">// [esp+2Ch] [ebp-208h] BYREF</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [esp+104h] [ebp-130h]</span><br>  _DWORD Buf2[<span class="hljs-number">52</span>]; <span class="hljs-comment">// [esp+110h] [ebp-124h] BYREF</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+1E0h] [ebp-54h]</span><br>  _BYTE v13[<span class="hljs-number">36</span>]; <span class="hljs-comment">// [esp+1ECh] [ebp-48h] BYREF</span><br>  _BYTE v14[<span class="hljs-number">20</span>]; <span class="hljs-comment">// [esp+210h] [ebp-24h] BYREF</span><br>  <span class="hljs-type">int</span> v15; <span class="hljs-comment">// [esp+230h] [ebp-4h]</span><br>  <span class="hljs-type">int</span> savedregs; <span class="hljs-comment">// [esp+234h] [ebp+0h] BYREF</span><br><br>  sub_A31127(<span class="hljs-number">0x10u</span>);<br>  sub_A311C2(v14);<br>  v15 = <span class="hljs-number">0</span>;<br>  srand(<span class="hljs-number">0x7DE9u</span>);<br>  sub_A31519();<br>  sub_A314B0(v13);<br>  LOBYTE(v15) = <span class="hljs-number">1</span>;<br>  v3 = sub_A3138E(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>, <span class="hljs-string">&quot;give your input:&quot;</span>);<br>  <span class="hljs-built_in">std</span>::ostream::operator&lt;&lt;(v3, sub_A31073);<br>  sub_A31519();<br>  Myflag = sub_A313F7(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cin</span>, (<span class="hljs-type">int</span>)v13);<br>  <span class="hljs-keyword">if</span> ( sub_A3181B(v13, HIDWORD(Myflag)) == dword_A46004 )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; dword_A46004; ++i )<br>    &#123;<br>      rand();<br>      v9[<span class="hljs-number">0</span>] = sub_A31519() % <span class="hljs-number">255</span>;<br>      sub_A312E4(v9);<br>    &#125;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt; dword_A46004; ++i )<br>    &#123;<br>      v5 = (_DWORD *)sub_A3128A(i);<br>      v10 = *v5 ^ *(<span class="hljs-type">char</span> *)sub_A31113(i);<br>      Buf2[i] = v10;<br>    &#125;<br>    <span class="hljs-keyword">if</span> ( !j_memcmp(&amp;unk_A42C30, Buf2, <span class="hljs-number">4</span> * dword_A46004) )<br>      v6 = sub_A3138E(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>, <span class="hljs-string">&quot;you get it&quot;</span>);<br>    <span class="hljs-keyword">else</span><br>      v6 = sub_A3138E(<span class="hljs-built_in">std</span>::<span class="hljs-built_in">cout</span>, <span class="hljs-string">&quot;Wrong&quot;</span>);<br>    <span class="hljs-built_in">std</span>::ostream::operator&lt;&lt;(v6, sub_A31073);<br>    sub_A31519();<br>    LOBYTE(v15) = <span class="hljs-number">0</span>;<br>    sub_A31438(v13);<br>    v15 = <span class="hljs-number">-1</span>;<br>    sub_A31726(v14);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    v9[<span class="hljs-number">3</span>] = <span class="hljs-number">0</span>;<br>    LOBYTE(v15) = <span class="hljs-number">0</span>;<br>    sub_A31438(v13);<br>    v15 = <span class="hljs-number">-1</span>;<br>    sub_A31726(v14);<br>  &#125;<br>  sub_A31456(&amp;savedregs, &amp;dword_A3A008, <span class="hljs-number">0</span>);<br>  <span class="hljs-keyword">return</span> v8;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>​	开始动调，设断点也是很讲究学问的！像这种复杂的东西，而且已知<strong>check</strong>函数的地方，我们就不能从头开始一点点看，得多次调试，先从<strong>check</strong>的前一步开始看，凭借<strong>IDA</strong>动调时看变量的值来确定加密与否。</p>
<p>​	<code>memcmp</code>里面存储我们加密flag的是<strong>Buf2</strong>变量，而前一步中<strong>Buf2</strong>和<strong>v10</strong>有关，<strong>v10</strong>是两个值异或来的，我们就看这两个异或值是多少。一看就知道，这就是一个异或加密，其中一个是我们输入的flag字符串，另一个是一个固定的key（改变输入确认这是固定的）。所以前面一堆都是系统代码，或者是无关紧要的代码。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">key1 = [<span class="hljs-number">109</span>, <span class="hljs-number">193</span>, <span class="hljs-number">168</span>, <span class="hljs-number">93</span>, <span class="hljs-number">124</span>, <span class="hljs-number">190</span>, <span class="hljs-number">80</span>, <span class="hljs-number">186</span>, <span class="hljs-number">229</span>, <span class="hljs-number">136</span>, <span class="hljs-number">81</span>, <span class="hljs-number">199</span>, <span class="hljs-number">251</span>, <span class="hljs-number">176</span>, <span class="hljs-number">24</span>, <span class="hljs-number">43</span>, <span class="hljs-number">217</span>, <span class="hljs-number">148</span>, <span class="hljs-number">82</span>, <span class="hljs-number">66</span>, <span class="hljs-number">89</span>, <span class="hljs-number">245</span>, <span class="hljs-number">248</span>, <span class="hljs-number">167</span>, <span class="hljs-number">231</span>, <span class="hljs-number">34</span>, <span class="hljs-number">173</span>, <span class="hljs-number">31</span>, <span class="hljs-number">134</span>, <span class="hljs-number">245</span>, <span class="hljs-number">249</span>, <span class="hljs-number">101</span>, <span class="hljs-number">38</span>, <span class="hljs-number">88</span>, <span class="hljs-number">52</span>, <span class="hljs-number">155</span>, <span class="hljs-number">69</span>, <span class="hljs-number">123</span>, <span class="hljs-number">134</span>, <span class="hljs-number">180</span>, <span class="hljs-number">101</span>, <span class="hljs-number">253</span>, <span class="hljs-number">104</span>, <span class="hljs-number">39</span>, <span class="hljs-number">82</span>, <span class="hljs-number">50</span>, <span class="hljs-number">129</span>, <span class="hljs-number">80</span>, <span class="hljs-number">196</span>, <span class="hljs-number">184</span>]<br>enc = [<span class="hljs-number">62</span>, <span class="hljs-number">152</span>, <span class="hljs-number">235</span>, <span class="hljs-number">38</span>, <span class="hljs-number">37</span>, <span class="hljs-number">142</span>, <span class="hljs-number">37</span>, <span class="hljs-number">229</span>, <span class="hljs-number">134</span>, <span class="hljs-number">200</span>, <span class="hljs-number">63</span>, <span class="hljs-number">152</span>, <span class="hljs-number">200</span>, <span class="hljs-number">222</span>, <span class="hljs-number">82</span>, <span class="hljs-number">68</span>, <span class="hljs-number">160</span>, <span class="hljs-number">203</span>, <span class="hljs-number">43</span>, <span class="hljs-number">42</span>, <span class="hljs-number">60</span>, <span class="hljs-number">170</span>, <span class="hljs-number">190</span>, <span class="hljs-number">203</span>, <span class="hljs-number">136</span>, <span class="hljs-number">85</span>, <span class="hljs-number">158</span>, <span class="hljs-number">109</span>, <span class="hljs-number">217</span>, <span class="hljs-number">148</span>, <span class="hljs-number">151</span>, <span class="hljs-number">28</span>, <span class="hljs-number">82</span>, <span class="hljs-number">49</span>, <span class="hljs-number">89</span>, <span class="hljs-number">254</span>, <span class="hljs-number">26</span>, <span class="hljs-number">26</span>, <span class="hljs-number">232</span>, <span class="hljs-number">208</span>, <span class="hljs-number">58</span>, <span class="hljs-number">156</span>, <span class="hljs-number">6</span>, <span class="hljs-number">94</span>, <span class="hljs-number">37</span>, <span class="hljs-number">90</span>, <span class="hljs-number">228</span>, <span class="hljs-number">34</span>, <span class="hljs-number">161</span>, <span class="hljs-number">197</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(enc[i] ^ key1[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)	<span class="hljs-comment">#SYC&#123;Y0u_c@n_3nJoy_yhe_Flow3r_anytime_and_anywhere&#125;</span><br></code></pre></td></tr></table></figure>

<p>​	另外，<a target="_blank" rel="noopener" href="https://bbs.kanxue.com/thread-279604.htm">花指令真得看这个文章</a>。</p>
<h1 id="DH爱喝茶"><a href="#DH爱喝茶" class="headerlink" title="DH爱喝茶"></a>DH爱喝茶</h1><p>​	根据enc函数找到main函数，然后反编译不了，往上看到花指令，无敌了。</p>
<p>​	这个花指令，<code>xor</code>会将<strong>ebx</strong>设置为0，并且设置ZF标志为1；<code>test</code>指令会执行按位与运算，<code>ebx&amp;ebx</code>，但是不影响结果，只改变标志位，由于ebx是0，所以ZF保持1。所以<code>jnz</code>不会跳转，<code>jz</code>会跳转。<code>jnz</code>开始<code>nop</code>掉吧，然后就可以反编译main函数了。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs assembly">.text:00001399                 xor     ebx, ebx<br>.text:0000139B                 test    ebx, ebx<br>.text:0000139D                 jnz     short near ptr LABEL7<br>.text:0000139F                 jz      short LABEL8<br>.text:0000139F ; ---------------------------------------------------------------------------<br>.text:000013A1 LABEL7          db 0C7h                 ; CODE XREF: .text:0000139D↑j<br>.text:000013A2 ; ---------------------------------------------------------------------------<br>.text:000013A2<br>.text:000013A2 LABEL8:                                 ; CODE XREF: .text:0000139F↑j<br>.text:000013A2                 pop     ebx<br></code></pre></td></tr></table></figure>

<p>​	碰到一个新函数，<code>size_t strcspn(const char *str1, const char *str2);</code>，在字符串<strong>str1</strong>中找到第一个包含<strong>str2</strong>中任意字符的位置，然后返回这个位置的索引值；如果没找到，就返回<strong>str1</strong>的长度。</p>
<p>​	enc函数是一个标准tea加密，每次加密前，对key处理， <code>Key[i] = __ROL4__(Key[i], 6);</code>， <strong>ROL4I</strong>DA Pro（反汇编工具）自动生成的伪C代码中使用的一个宏函数，用来表示<strong>对一个32位整数进行循环左移（rotate left）操作</strong>。</p>
<p>​	其中需要注意的是，<code>+0x98765432</code>的指令容易被IDA反编译为<code>-0x6789ABCD</code>，不知道为什么，用减号就不对。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdint.h&gt;</span></span><br><br><span class="hljs-type">uint32_t</span> <span class="hljs-title function_">rol32</span><span class="hljs-params">(<span class="hljs-type">uint32_t</span> value, <span class="hljs-type">int</span> shift)</span><br>&#123;<br>    <span class="hljs-keyword">return</span> (value &lt;&lt; shift) | (value &gt;&gt; (<span class="hljs-number">32</span> - shift));<br>&#125;<br><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>    <span class="hljs-type">uint32_t</span> enc[] = &#123;<span class="hljs-number">0x1F85A965</span>,<span class="hljs-number">0xEEC063EC</span>,<span class="hljs-number">0x5BF1D0B6</span>,<span class="hljs-number">0xF2FDE7B0</span>,<span class="hljs-number">0xAA38809A</span>,<span class="hljs-number">0x670772E9</span>,<span class="hljs-number">0x360D24B9</span>,<span class="hljs-number">0xE98C688C</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> key[] = &#123;<span class="hljs-number">0x56789ABC</span>,<span class="hljs-number">0x6789ABCD</span>,<span class="hljs-number">0x789ABCDE</span>,<span class="hljs-number">0x89ABCDEF</span>&#125;;<br>    <span class="hljs-type">uint32_t</span> v0,v1;<br>    <span class="hljs-type">int</span> sum,delta;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)<br>    &#123;<br>        key[i] = rol32(key[i],<span class="hljs-number">6</span>);<br>        v0 = enc[i*<span class="hljs-number">2</span>];<br>        v1 = enc[i*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>];<br>        delta = (<span class="hljs-type">uint8_t</span>)(key[<span class="hljs-number">0</span>]^key[<span class="hljs-number">1</span>]) + <span class="hljs-number">0x98765432</span>;<br>        sum = delta * <span class="hljs-number">32</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> j=<span class="hljs-number">0</span>;j&lt;<span class="hljs-number">32</span>;j++)<br>        &#123;<br>            v1 -= (v0 + sum) ^ ((v0 &lt;&lt; <span class="hljs-number">4</span>) + key[<span class="hljs-number">2</span>]) ^ ((v0 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">3</span>]);<br>            v0 -= (v1 + sum) ^ ((v1 &lt;&lt; <span class="hljs-number">4</span>) + key[<span class="hljs-number">0</span>]) ^ ((v1 &gt;&gt; <span class="hljs-number">5</span>) + key[<span class="hljs-number">1</span>]);<br>            sum -= delta;<br>        &#125;<br>        enc[i*<span class="hljs-number">2</span>] = v0;<br>        enc[i*<span class="hljs-number">2</span>+<span class="hljs-number">1</span>] = v1;<br>    &#125;<br>    <br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">32</span>;i++)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>, *((<span class="hljs-type">char</span>*)enc + i));	<span class="hljs-comment">//SYC&#123;DH_likes_flower_and_tea!!!!&#125;</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>





<h1 id="好像是python？"><a href="#好像是python？" class="headerlink" title="好像是python？"></a>好像是python？</h1><p>​	文本文件，以txt格式打开，看到python字节码的反汇编结果，我刚好没学过，乘此机会好好补一下。</p>
<p>​	推荐文章：[<a target="_blank" rel="noopener" href="https://bbs.kanxue.com/thread-246683.htm">原创]死磕python字节码-手工还原python源码-软件逆向-看雪-安全社区|安全招聘|kanxue.com</a>、<a target="_blank" rel="noopener" href="https://www.cnblogs.com/blili/p/11804690.html#3.6%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97">Python逆向（五）—— Python字节码解读 - Blili - 博客园</a>。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs assembly">  1           0 LOAD_CONST               0 (&#x27;SYC&#123;MD5(input)&#125;&#x27;)<br>              2 STORE_NAME               0 (flag)                               ;flag = &#x27;SYC&#123;MD5(input)&#125;&#x27;<br><br>  2           4 LOAD_NAME                1 (print)<br>              6 LOAD_CONST               1 (&#x27;Please input0:&#x27;)                   <br>              8 CALL_FUNCTION            1                                      ;print(&#x27;Please input0:&#x27;)<br>             10 POP_TOP<br><br>  3          12 LOAD_CONST               2 (&#x27;&#x27;)<br>             14 STORE_NAME               2 (input0)<br><br>  6          16 LOAD_CONST               3 (&lt;code object test2 at 0x00000245D4F44B30, file &quot;program.py&quot;, line 6&gt;)<br>             18 LOAD_CONST               4 (&#x27;test2&#x27;)<br>             20 MAKE_FUNCTION            0<br>             22 STORE_NAME               3 (test2)<br><br> 14          24 LOAD_CONST               5 (&lt;code object test at 0x00000245D4F44BE0, file &quot;program.py&quot;, line 14&gt;)<br>             26 LOAD_CONST               6 (&#x27;test&#x27;)<br>             28 MAKE_FUNCTION            0<br>             30 STORE_NAME               4 (test)<br><br> 28          32 LOAD_CONST               7 (13)<br>             34 STORE_NAME               5 (a)                              ;a=13<br><br> 29          36 LOAD_CONST               8 (14)<br>             38 STORE_NAME               6 (b)                              ;b=14<br><br> 30          40 LOAD_NAME                5 (a)<br>             42 LOAD_NAME                6 (b)<br>             44 LOAD_NAME                5 (a)<br>             46 BINARY_ADD <br>             48 BINARY_XOR<br>             50 STORE_NAME               7 (c)                              ;c=(a+b)^a<br><br> 31          52 LOAD_NAME                6 (b)<br>             54 LOAD_CONST               9 (100)        <br>             56 BINARY_MULTIPLY<br>             58 STORE_NAME               8 (d)                              ;d=b*100<br><br> 32          60 LOAD_NAME                5 (a)<br>             62 LOAD_NAME                6 (b)<br>             64 BINARY_XOR<br>             66 STORE_NAME               9 (e)                              ;e=a^b<br><br> 33          68 LOAD_NAME                8 (d)<br>             70 LOAD_NAME                7 (c)<br>             72 LOAD_CONST              10 (4)<br>             74 BINARY_MULTIPLY<br>             76 BINARY_SUBTRACT<br>             78 LOAD_NAME                9 (e)              <br>             80 BINARY_ADD<br>             82 LOAD_CONST              11 (1)<br>             84 BINARY_SUBTRACT<br>             86 STORE_NAME              10 (m)                               ;m=(d-(c*4))+e-1<br><br> 35          88 LOAD_NAME               10 (m)<br>             90 LOAD_CONST              12 (26)<br>             92 BINARY_MODULO<br>             94 STORE_NAME              11 (r)<br><br> 37          96 LOAD_NAME                4 (test)<br>             98 LOAD_NAME                2 (input0)<br>            100 LOAD_NAME               11 (r)<br>            102 CALL_FUNCTION            2<br>            104 STORE_NAME              12 (cipher1)<br><br> 38         106 LOAD_NAME                3 (test2)<br>            108 LOAD_NAME               12 (cipher1)<br>            110 CALL_FUNCTION            1<br>            112 STORE_NAME              13 (cipher2)<br><br> 39         114 LOAD_CONST              13 (-1)<br>            116 LOAD_CONST              14 (-36)<br>            118 LOAD_CONST              12 (26)<br>            120 LOAD_CONST              15 (-5)<br>            122 LOAD_CONST               8 (14)<br>            124 LOAD_CONST              16 (41)<br>            126 LOAD_CONST              17 (6)<br>            128 LOAD_CONST              18 (-9)<br>            130 LOAD_CONST              19 (60)<br>            132 LOAD_CONST              20 (29)<br>            134 LOAD_CONST              21 (-28)<br>            136 LOAD_CONST              22 (17)<br>            138 LOAD_CONST              23 (21)<br>            140 LOAD_CONST              24 (7)<br>            142 LOAD_CONST              25 (35)<br>            144 LOAD_CONST              26 (38)<br>            146 LOAD_CONST              12 (26)<br>            148 LOAD_CONST              27 (48)<br>            150 BUILD_LIST              18<br>            152 STORE_NAME              14 (num)<br><br> 40         154 LOAD_NAME               15 (range)<br>            156 LOAD_CONST              28 (18)<br>            158 CALL_FUNCTION            1<br>            160 GET_ITER<br>        &gt;&gt;  162 FOR_ITER                38 (to 202)<br>            164 STORE_NAME              16 (i)<br><br> 41         166 LOAD_NAME               13 (cipher2)<br>            168 LOAD_NAME               16 (i)<br>            170 BINARY_SUBSCR                                   ;索引访问<br>            172 LOAD_NAME               14 (num)<br>            174 LOAD_NAME               16 (i)<br>            176 BINARY_SUBSCR                                   ;索引访问<br>            178 COMPARE_OP               3 (!=)<br>            180 POP_JUMP_IF_FALSE      192<br><br> 42         182 LOAD_NAME                1 (print)<br>            184 LOAD_CONST              29 (&#x27;wrong!&#x27;)<br>            186 CALL_FUNCTION            1<br>            188 POP_TOP<br>            190 JUMP_ABSOLUTE          162<br><br> 44     &gt;&gt;  192 LOAD_NAME                1 (print)<br>            194 LOAD_CONST              30 (&#x27;Rrrright!&#x27;)<br>            196 CALL_FUNCTION            1<br>            198 POP_TOP<br>            200 JUMP_ABSOLUTE          162<br>        &gt;&gt;  202 LOAD_CONST              31 (None)<br>            204 RETURN_VALUE<br><br>Disassembly of &lt;code object test2 at 0x00000245D4F44B30, file &quot;program.py&quot;, line 6&gt;:<br>  7           0 LOAD_CONST               1 (&#x27;SYC&#x27;)<br>              2 STORE_FAST               1 (key)<br><br>  8           4 LOAD_CONST               2 (18)<br>              6 STORE_FAST               2 (length)<br><br>  9           8 BUILD_LIST               0<br>             10 STORE_FAST               3 (cipher)<br><br> 10          12 LOAD_GLOBAL              0 (range)<br>             14 LOAD_FAST                2 (length)<br>             16 CALL_FUNCTION            1                  ;调用后，栈顶就会是 range(length) 返回的迭代器对象<br>             18 GET_ITER                                    ;从栈中弹出迭代器对象，并准备开始迭代<br>        &gt;&gt;   20 FOR_ITER                48 (to 70)          ;从迭代器中取出下一个值，并将值推送到栈顶,如果取到的值是合法的，它会继续执行循环体,否则跳转到70<br>             22 STORE_FAST               4 (i)              ;将栈顶的值（就是 FOR_ITER 获取到的当前值）存储到局部变量 i 中<br><br> 11          24 LOAD_FAST                3 (cipher)<br>             26 LOAD_METHOD              1 (append)<br>             28 LOAD_GLOBAL              2 (ord)<br>             30 LOAD_FAST                0 (s2)<br>             32 LOAD_FAST                4 (i)<br>             34 BINARY_SUBSCR<br>             36 CALL_FUNCTION            1              ;ord(s2[i])<br>             38 LOAD_FAST                4 (i)<br>             40 BINARY_XOR                              ;ord(s2[i]) ^ i<br>             42 LOAD_GLOBAL              2 (ord)<br>             44 LOAD_FAST                1 (key)<br>             46 LOAD_FAST                4 (i)<br>             48 LOAD_CONST               3 (3)          <br>             50 BINARY_MODULO<br>             52 BINARY_SUBSCR<br>             54 CALL_FUNCTION            1              ;ord(key[i%3])<br>             56 UNARY_INVERT                            ;执行一元取反（bitwise NOT）操作，~ord(key[i%3])<br>             58 LOAD_CONST               4 (1)<br>             60 BINARY_ADD                              ;~ord(key[i%3])+1<br>             62 BINARY_ADD                              ;ord(s2[i]) ^ i + (~ord(key[i%3])+1)<br>             64 CALL_METHOD              1<br>             66 POP_TOP<br>             68 JUMP_ABSOLUTE           20<br><br> 12     &gt;&gt;   70 LOAD_FAST                3 (cipher)<br>             72 RETURN_VALUE<br><br>Disassembly of &lt;code object test at 0x00000245D4F44BE0, file &quot;program.py&quot;, line 14&gt;:<br> 15           0 BUILD_LIST               0<br>              2 STORE_FAST               2 (result)                            ;result=[]<br><br> 16           4 LOAD_FAST                0 (s)<br>              6 GET_ITER<br>        &gt;&gt;    8 FOR_ITER               218 (to 228) <br>             10 STORE_FAST               3 (i)                                  ;for i in s:<br><br> 17          12 LOAD_CONST               1 (&#x27;A&#x27;)<br>             14 LOAD_FAST                3 (i)<br>             16 DUP_TOP                                                 ;取栈顶变量复制一份再压入，栈顶元素变两份<br>             18 ROT_THREE                                               ;当前栈顶的三个元素旋转一下，例如当前[&#x27;A&#x27;,i,i]变成[i,&#x27;A&#x27;,i]，这样做是为了适配后面的判断语句<br>             20 COMPARE_OP               1 (&lt;=)                                ;     i &gt;= &#x27;A&#x27;<br>             22 POP_JUMP_IF_FALSE       32<br>             24 LOAD_CONST               2 (&#x27;Z&#x27;) <br>             26 COMPARE_OP               1 (&lt;=)                                    ; i &lt;= &#x27;Z&#x27;<br>             28 POP_JUMP_IF_FALSE       80<br>             30 JUMP_FORWARD             4 (to 36)<br>        &gt;&gt;   32 POP_TOP<br>             34 JUMP_FORWARD            44 (to 80)<br><br> 18     &gt;&gt;   36 LOAD_FAST                2 (result)<br>             38 LOAD_METHOD              0 (append)<br>             40 LOAD_GLOBAL              1 (chr)<br>             42 LOAD_GLOBAL              2 (ord)<br>             44 LOAD_FAST                3 (i)<br>             46 CALL_FUNCTION            1<br>             48 LOAD_GLOBAL              2 (ord)<br>             50 LOAD_CONST               1 (&#x27;A&#x27;)<br>             52 CALL_FUNCTION            1<br>             54 BINARY_SUBTRACT<br>             56 LOAD_FAST                1 (R)<br>             58 BINARY_ADD<br>             60 LOAD_CONST               3 (26)<br>             62 BINARY_MODULO<br>             64 LOAD_GLOBAL              2 (ord)<br>             66 LOAD_CONST               1 (&#x27;A&#x27;)<br>             68 CALL_FUNCTION            1<br>             70 BINARY_ADD<br>             72 CALL_FUNCTION            1<br>             74 CALL_METHOD              1<br>             76 POP_TOP<br>             78 JUMP_ABSOLUTE            8<br><br> 19     &gt;&gt;   80 LOAD_CONST               4 (&#x27;a&#x27;)<br>             82 LOAD_FAST                3 (i)<br>             84 DUP_TOP<br>             86 ROT_THREE<br>             88 COMPARE_OP               1 (&lt;=)<br>             90 POP_JUMP_IF_FALSE      100<br>             92 LOAD_CONST               5 (&#x27;z&#x27;)<br>             94 COMPARE_OP               1 (&lt;=)<br>             96 POP_JUMP_IF_FALSE      148<br>             98 JUMP_FORWARD             4 (to 104)<br>        &gt;&gt;  100 POP_TOP<br>            102 JUMP_FORWARD            44 (to 148)<br><br> 20     &gt;&gt;  104 LOAD_FAST                2 (result)<br>            106 LOAD_METHOD              0 (append)<br>            108 LOAD_GLOBAL              1 (chr)<br>            110 LOAD_GLOBAL              2 (ord)<br>            112 LOAD_FAST                3 (i)<br>            114 CALL_FUNCTION            1<br>            116 LOAD_GLOBAL              2 (ord)<br>            118 LOAD_CONST               4 (&#x27;a&#x27;)<br>            120 CALL_FUNCTION            1<br>            122 BINARY_SUBTRACT<br>            124 LOAD_FAST                1 (R)<br>            126 BINARY_ADD<br>            128 LOAD_CONST               3 (26)<br>            130 BINARY_MODULO<br>            132 LOAD_GLOBAL              2 (ord)<br>            134 LOAD_CONST               4 (&#x27;a&#x27;)<br>            136 CALL_FUNCTION            1<br>            138 BINARY_ADD<br>            140 CALL_FUNCTION            1<br>            142 CALL_METHOD              1<br>            144 POP_TOP<br>            146 JUMP_ABSOLUTE            8<br><br> 21     &gt;&gt;  148 LOAD_CONST               6 (&#x27;0&#x27;)<br>            150 LOAD_FAST                3 (i)<br>            152 DUP_TOP<br>            154 ROT_THREE<br>            156 COMPARE_OP               1 (&lt;=)<br>            158 POP_JUMP_IF_FALSE      168<br>            160 LOAD_CONST               7 (&#x27;9&#x27;)<br>            162 COMPARE_OP               1 (&lt;=)<br>            164 POP_JUMP_IF_FALSE      216<br>            166 JUMP_FORWARD             4 (to 172)<br>        &gt;&gt;  168 POP_TOP<br>            170 JUMP_FORWARD            44 (to 216)<br><br> 22     &gt;&gt;  172 LOAD_FAST                2 (result)<br>            174 LOAD_METHOD              0 (append)<br>            176 LOAD_GLOBAL              1 (chr)<br>            178 LOAD_GLOBAL              2 (ord)<br>            180 LOAD_FAST                3 (i)<br>            182 CALL_FUNCTION            1<br>            184 LOAD_GLOBAL              2 (ord)<br>            186 LOAD_CONST               6 (&#x27;0&#x27;)<br>            188 CALL_FUNCTION            1<br>            190 BINARY_SUBTRACT<br>            192 LOAD_FAST                1 (R)<br>            194 BINARY_ADD<br>            196 LOAD_CONST               8 (10)<br>            198 BINARY_MODULO<br>            200 LOAD_GLOBAL              2 (ord)<br>            202 LOAD_CONST               6 (&#x27;0&#x27;)<br>            204 CALL_FUNCTION            1<br>            206 BINARY_ADD<br>            208 CALL_FUNCTION            1<br>            210 CALL_METHOD              1<br>            212 POP_TOP<br>            214 JUMP_ABSOLUTE            8<br><br> 24     &gt;&gt;  216 LOAD_FAST                2 (result)<br>            218 LOAD_METHOD              0 (append)<br>            220 LOAD_FAST                3 (i)<br>            222 CALL_METHOD              1<br>            224 POP_TOP<br>            226 JUMP_ABSOLUTE            8<br><br> 25     &gt;&gt;  228 LOAD_CONST               9 (&#x27;&#x27;)<br>            230 LOAD_METHOD              3 (join)<br>            232 LOAD_FAST                2 (result)<br>            234 CALL_METHOD              1<br>            236 RETURN_VALUE<br><br></code></pre></td></tr></table></figure>

<p>​	<strong>chatgpt</strong>梭哈还原的代码如下，md它也有错误，垃圾东西！尝试自己对照看汇编指令修改。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">flag = <span class="hljs-string">&#x27;SYC&#123;MD5(input)&#125;&#x27;</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Please input0:&#x27;</span>)<br>input0 = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-comment"># 加密函数1：类似 Caesar Cipher 带偏移</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">s, R</span>):<br>    result = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> s:<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;A&#x27;</span> &lt;= i &lt;= <span class="hljs-string">&#x27;Z&#x27;</span>:<br>            result.append(<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>) + R) % <span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)))<br>        <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;a&#x27;</span> &lt;= i &lt;= <span class="hljs-string">&#x27;z&#x27;</span>:<br>            result.append(<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>) + R) % <span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>)))<br>        <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;0&#x27;</span> &lt;= i &lt;= <span class="hljs-string">&#x27;9&#x27;</span>:<br>            result.append(<span class="hljs-built_in">chr</span>((<span class="hljs-built_in">ord</span>(i) - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;0&#x27;</span>) + R) % <span class="hljs-number">10</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;0&#x27;</span>)))<br>        <span class="hljs-keyword">else</span>:<br>            result.append(i)<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;&#x27;</span>.join(result)<br><br><span class="hljs-comment"># 加密函数2：字符与 key 异或 + 取反变换</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">test2</span>(<span class="hljs-params">s2</span>):<br>    key = <span class="hljs-string">&#x27;SYC&#x27;</span><br>    length = <span class="hljs-number">18</span><br>    cipher = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length):<br>        c = <span class="hljs-built_in">ord</span>(s2[i]) ^ i + (~<span class="hljs-built_in">ord</span>(key[i % <span class="hljs-number">3</span>]) + <span class="hljs-number">1</span>)		<span class="hljs-comment">#这种运算chatgpt未注册版搞不定。</span><br>        cipher.append(c)<br>    <span class="hljs-keyword">return</span> cipher<br><br><span class="hljs-comment"># 主逻辑</span><br>a = <span class="hljs-number">13</span><br>b = <span class="hljs-number">14</span><br>c = (a+b)^a 	<span class="hljs-comment">#同样修改过。</span><br>d = b * <span class="hljs-number">100</span><br>e = a ^ b<br>m = d - c * <span class="hljs-number">4</span> + e - <span class="hljs-number">1</span><br>r = m % <span class="hljs-number">26</span>    <span class="hljs-comment">#r=14</span><br><br>cipher1 = test(input0, r)<br>cipher2 = test2(cipher1)<br><br>num = [<br>    -<span class="hljs-number">1</span>, -<span class="hljs-number">36</span>, <span class="hljs-number">26</span>, -<span class="hljs-number">5</span>, <span class="hljs-number">14</span>, <span class="hljs-number">41</span>, <span class="hljs-number">6</span>, -<span class="hljs-number">9</span>, <span class="hljs-number">60</span>, <span class="hljs-number">29</span>,<br>    -<span class="hljs-number">28</span>, <span class="hljs-number">17</span>, <span class="hljs-number">21</span>, <span class="hljs-number">7</span>, <span class="hljs-number">35</span>, <span class="hljs-number">38</span>, <span class="hljs-number">26</span>, <span class="hljs-number">48</span><br>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">18</span>):<br>    <span class="hljs-keyword">if</span> cipher2[i] != num[i]:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;wrong!&#x27;</span>)<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Rrrright!&#x27;</span>)<br><br></code></pre></td></tr></table></figure>

<p>​	解密脚本，md5加密后的flag为<strong>SYC{ed798fdd74e5c382b9c7fcca88500aca}</strong>。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">num = [<br>    -<span class="hljs-number">1</span>, -<span class="hljs-number">36</span>, <span class="hljs-number">26</span>, -<span class="hljs-number">5</span>, <span class="hljs-number">14</span>, <span class="hljs-number">41</span>, <span class="hljs-number">6</span>, -<span class="hljs-number">9</span>, <span class="hljs-number">60</span>, <span class="hljs-number">29</span>,<br>    -<span class="hljs-number">28</span>, <span class="hljs-number">17</span>, <span class="hljs-number">21</span>, <span class="hljs-number">7</span>, <span class="hljs-number">35</span>, <span class="hljs-number">38</span>, <span class="hljs-number">26</span>, <span class="hljs-number">48</span><br>]<br>key = <span class="hljs-string">&#x27;SYC&#x27;</span><br>rol = <span class="hljs-number">14</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(num)):<br>    num[i] = (num[i] - (~<span class="hljs-built_in">ord</span>(key[i%<span class="hljs-number">3</span>]) + <span class="hljs-number">1</span>)) ^ i<br>    A = <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)<br>    Z = <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;Z&#x27;</span>)<br>    a = <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>)<br>    z = <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;z&#x27;</span>)<br>    <span class="hljs-keyword">if</span> A &lt;= num[i] &lt;= Z:<br>        num[i] = (num[i] - A - rol) % <span class="hljs-number">26</span> + A<br>    <span class="hljs-keyword">elif</span> a &lt;= num[i] &lt;= z:<br>        num[i] = (num[i] - a - rol) % <span class="hljs-number">26</span> + a<br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;0&#x27;</span>) &lt;= num[i] &lt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;9&#x27;</span>):<br>        num[i] = (num[i] - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;0&#x27;</span>) - rol) % <span class="hljs-number">10</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;0&#x27;</span>)<br><br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(num[i]), end=<span class="hljs-string">&#x27;&#x27;</span>)  <span class="hljs-comment">#D0_You_Iik3_python</span><br></code></pre></td></tr></table></figure>

<p>​	</p>
<h1 id="奇怪的RC4"><a href="#奇怪的RC4" class="headerlink" title="奇怪的RC4"></a>奇怪的RC4</h1><p>​	<strong>PyInstaller</strong>打包的exe程序，<strong>pydumpck</strong>解包后得到密文和加密逻辑，直接解包还会反编译不完全，怎么回事，没遇到过啊。</p>
<p>​	手动反汇编，读汇编来补充！这个自动添加的**()注释**真的是漏洞百出，没几个对的。xor1和xor2都没能解析出来。（<strong>原来是3.8的版本，我是一点解不出来</strong>）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> dis<br><span class="hljs-keyword">import</span> marshal<br><span class="hljs-comment"># 读取 .pyc 文件</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">50</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">r&quot;easy_xor_and_rc4.pyc&quot;</span>,<br>              <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">try</span>:<br>            f.read(i)			<span class="hljs-comment">#因为我不确定魔术头包含多少位，实践证明是0</span><br>            code = marshal.load(f)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ok : &quot;</span>, i)<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Error&quot;</span>)<br><br><span class="hljs-comment"># 使用 dis 模块反汇编字节码</span><br>dis.dis(code)<br></code></pre></td></tr></table></figure>

<blockquote>
<p>容易理解错的指令：<strong>STORE_SUBSCR</strong>指令执行时栈顶是**[b[1],a,i]<strong>，那么就是</strong>a[i]&#x3D;b[1]**。</p>
<p><strong>FOR_ITER</strong>指令不知道。</p>
<p><strong>JUMP_ABSOLUTE</strong>指令是绝对地址跳转。</p>
<p><strong>JUMP_FORWARD</strong>指令是相对地址，基址是下一条指令地址。</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs assembly">  2           0 LOAD_CONST               0 (0)<br>              2 LOAD_CONST               1 ((&#x27;*&#x27;,))<br>              4 IMPORT_NAME              0 (Rc4)<br>              6 IMPORT_STAR <br><br> 15           8 LOAD_CONST               2 (&lt;code object xor1 at 0x0000023C79386EF0, file &quot;easy_xor_and_rc4.py&quot;, line 2&gt;)<br>             10 LOAD_CONST               3 (&#x27;xor1&#x27;)<br>             12 MAKE_FUNCTION            0<br>             14 STORE_NAME               1 (xor1) 			;函数声明，xor1<br><br> 24          16 LOAD_CONST               4 (&lt;code object xor2 at 0x0000023C79387050, file &quot;easy_xor_and_rc4.py&quot;, line 15&gt;)<br>             18 LOAD_CONST               5 (&#x27;xor2&#x27;)<br>             20 MAKE_FUNCTION            0<br>             22 STORE_NAME               2 (xor2)<br><br> 30          24 LOAD_CONST               6 (&lt;code object enc at 0x0000023C79387100, file &quot;easy_xor_and_rc4.py&quot;, line 24&gt;)<br>             26 LOAD_CONST               7 (&#x27;enc&#x27;)<br>             28 MAKE_FUNCTION            0<br>             30 STORE_NAME               3 (enc)<br><br> 31          32 LOAD_NAME                4 (input)<br>             34 LOAD_CONST               8 (&#x27;please give your input:&#x27;)<br>             36 CALL_FUNCTION            1<br>             38 STORE_NAME               5 (plaintext) 		;plaintext=input(&quot;...&quot;)<br><br> 32          40 LOAD_CONST               9 (&#x27;SYCFOREVER&#x27;)<br>             42 STORE_NAME               6 (key) 			;key=&#x27;...&#x27;<br><br> 33          44 LOAD_NAME                7 (list)<br>             46 LOAD_NAME                8 (range)<br>             48 LOAD_NAME                9 (len)<br>             50 LOAD_NAME                5 (plaintext)<br>             52 CALL_FUNCTION            1<br>             54 CALL_FUNCTION            1<br>             56 CALL_FUNCTION            1<br>             58 STORE_NAME              10 (xor_list) 			;xor_list = list[range(len(plaintext))]<br><br> 34          60 LOAD_CONST              10 (158)<br>             62 LOAD_CONST              11 (31)<br>             64 LOAD_CONST              12 (205)<br>             66 LOAD_CONST              13 (434)<br>             68 LOAD_CONST              14 (354)<br>             70 LOAD_CONST              15 (15)<br>             72 LOAD_CONST              16 (383)<br>             74 LOAD_CONST              17 (298)<br>             76 LOAD_CONST              18 (304)<br>             78 LOAD_CONST              19 (351)<br>             80 LOAD_CONST              20 (465)<br>             82 LOAD_CONST              21 (312)<br>             84 LOAD_CONST              22 (261)<br>             86 LOAD_CONST              23 (442)<br>             88 LOAD_CONST              24 (397)<br>             90 LOAD_CONST              25 (474)<br>             92 LOAD_CONST              26 (310)<br>             94 LOAD_CONST              24 (397)<br>             96 LOAD_CONST              11 (31)<br>             98 LOAD_CONST              27 (21)<br>            100 LOAD_CONST              28 (78)<br>            102 LOAD_CONST              29 (67)<br>            104 LOAD_CONST              30 (47)<br>            106 LOAD_CONST              31 (133)<br>            108 LOAD_CONST              32 (168)<br>            110 LOAD_CONST              33 (48)<br>            112 LOAD_CONST              34 (153)<br>            114 LOAD_CONST              35 (99)<br>            116 LOAD_CONST              36 (103)<br>            118 LOAD_CONST              37 (204)<br>            120 LOAD_CONST              38 (137)<br>            122 LOAD_CONST              39 (29)<br>            124 LOAD_CONST              40 (22)<br>            126 LOAD_CONST              41 (13)<br>            128 LOAD_CONST              42 (228)<br>            130 LOAD_CONST              43 (3)<br>            132 LOAD_CONST              44 (136)<br>            134 LOAD_CONST              45 (141)<br>            136 LOAD_CONST              46 (248)<br>            138 LOAD_CONST              47 (124)<br>            140 LOAD_CONST              48 (26)<br>            142 LOAD_CONST              48 (26)<br>            144 LOAD_CONST              49 (65)<br>            146 LOAD_CONST              50 (200)<br>            148 LOAD_CONST              51 (7)<br>            150 BUILD_LIST              45<br>            152 STORE_NAME              11 (cipher) 		;cipher=[...]<br><br> 35         154 LOAD_NAME                3 (enc)<br>            156 LOAD_NAME                5 (plaintext)<br>            158 LOAD_NAME                6 (key)<br>            160 LOAD_NAME               10 (xor_list)<br>            162 CALL_FUNCTION            3 						;enc(plaintext,key,xor_list)<br>            164 STORE_NAME               5 (plaintext)<br><br> 36         166 LOAD_NAME                8 (range)<br>            168 LOAD_NAME                9 (len)<br>            170 LOAD_NAME               11 (cipher)<br>            172 CALL_FUNCTION            1<br>            174 CALL_FUNCTION            1 						<br>            176 GET_ITER<br>            178 FOR_ITER                36 (to 252)<br>            180 STORE_NAME              12 (i)						;for i in range(len(cipher))<br><br> 37         182 LOAD_NAME               11 (cipher)<br>            184 LOAD_NAME               12 (i)<br>            186 BINARY_SUBSCR<br>            188 LOAD_NAME                5 (plaintext)<br>            190 LOAD_NAME               12 (i)<br>            192 BINARY_SUBSCR<br>            194 COMPARE_OP               3 (!=) 				;cipher[i]!=plaintext[i]<br>            196 POP_JUMP_IF_FALSE      178 (to 356)<br><br> 38         198 LOAD_NAME               13 (print)<br>            200 LOAD_CONST              52 (&#x27;Wrong&#x27;)<br>            202 CALL_FUNCTION            1<br>            204 POP_TOP<br><br> 39         206 LOAD_NAME               14 (exit)<br>            208 LOAD_CONST              53 (1)<br>            210 CALL_FUNCTION            1<br>            212 POP_TOP<br>            214 JUMP_ABSOLUTE          178 (to 356)<br>            216 LOAD_NAME               13 (print)<br>            218 LOAD_CONST              54 (&#x27;You know the flag!!&#x27;)<br>            220 CALL_FUNCTION            1<br>            222 POP_TOP<br>            224 LOAD_CONST              55 (None)<br>            226 RETURN_VALUE<br><br>Disassembly of &lt;code object xor1 at 0x0000023C79386EF0, file &quot;easy_xor_and_rc4.py&quot;, line 2&gt;:<br>  4           0 SETUP_FINALLY           18 (to 38)<br><br>  5           2 LOAD_CONST               1 (&lt;code object &lt;listcomp&gt; at 0x0000023C79386550, file &quot;easy_xor_and_rc4.py&quot;, line 4&gt;)<br>              4 LOAD_CONST               2 (&#x27;xor1.&lt;locals&gt;.&lt;listcomp&gt;&#x27;)<br>              6 MAKE_FUNCTION            0<br>              8 LOAD_FAST                1 (xor_list)<br>             10 GET_ITER<br>             12 CALL_FUNCTION            1<br>             14 STORE_FAST               1 (xor_list)<br>             16 POP_BLOCK<br>             18 JUMP_FORWARD            12 (to 44)<br><br>  6          20 POP_TOP<br>             22 POP_TOP<br>             24 POP_TOP<br><br>  7          26 POP_EXCEPT<br>             28 JUMP_FORWARD             2 (to 34)<br>             30 &lt;88&gt;<br><br>  8          32 SETUP_FINALLY           18 (to 70)<br><br>  9     &gt;&gt;   34 LOAD_CONST               3 (&lt;code object &lt;listcomp&gt; at 0x0000023C79386E40, file &quot;easy_xor_and_rc4.py&quot;, line 8&gt;)<br>             36 LOAD_CONST               2 (&#x27;xor1.&lt;locals&gt;.&lt;listcomp&gt;&#x27;)<br>        &gt;&gt;   38 MAKE_FUNCTION            0<br>             40 LOAD_FAST                0 (plaintext)<br>             42 GET_ITER<br>        &gt;&gt;   44 CALL_FUNCTION            1<br>             46 STORE_FAST               0 (plaintext)<br>             48 POP_BLOCK<br>             50 JUMP_FORWARD            12 (to 76)<br><br> 10          52 POP_TOP<br>             54 POP_TOP<br>             56 POP_TOP<br><br> 11          58 POP_EXCEPT<br>             60 JUMP_FORWARD             2 (to 66)<br>             62 &lt;88&gt;<br><br> 12          64 LOAD_GLOBAL              0 (range)<br>        &gt;&gt;   66 LOAD_GLOBAL              1 (len)<br>             68 LOAD_FAST                0 (plaintext)<br>        &gt;&gt;   70 CALL_FUNCTION            1<br>             72 CALL_FUNCTION            1<br>             74 GET_ITER<br>        &gt;&gt;   76 FOR_ITER                24 (to 126)<br>             78 STORE_FAST               2 (i)<br><br> 13          80 LOAD_FAST                0 (plaintext)<br>             82 LOAD_FAST                2 (i)<br>             84 DUP_TOP_TWO									;将栈顶两个元素复制一份放到栈顶<br>             86 BINARY_SUBSCR<br>             88 LOAD_FAST                1 (xor_list)<br>             90 LOAD_FAST                2 (i)<br>             92 BINARY_SUBSCR<br>             94 INPLACE_XOR 								;就地（栈）异或，减少内存占用<br>             96 ROT_THREE<br>             98 STORE_SUBSCR 								;plaintext[i]^=xor_list[i]<br>            100 JUMP_ABSOLUTE           76 (to 152)<br>            102 LOAD_FAST                0 (plaintext)<br>            104 RETURN_VALUE<br><br>Disassembly of &lt;code object &lt;listcomp&gt; at 0x0000023C79386550, file &quot;easy_xor_and_rc4.py&quot;, line 4&gt;:<br>  4           0 BUILD_LIST               0<br>              2 LOAD_FAST                0 (.0)<br>              4 FOR_ITER                12 (to 30)<br>              6 STORE_FAST               1 (i)<br>        &gt;&gt;    8 LOAD_GLOBAL              0 (ord)<br>             10 LOAD_FAST                1 (i)<br>             12 CALL_FUNCTION            1<br>             14 LIST_APPEND              2<br>             16 JUMP_ABSOLUTE            4 (to 8)<br>             18 RETURN_VALUE<br><br>Disassembly of &lt;code object &lt;listcomp&gt; at 0x0000023C79386E40, file &quot;easy_xor_and_rc4.py&quot;, line 8&gt;:<br>  8           0 BUILD_LIST               0<br>              2 LOAD_FAST                0 (.0)<br>              4 FOR_ITER                12 (to 30)<br>              6 STORE_FAST               1 (i)<br>        &gt;&gt;    8 LOAD_GLOBAL              0 (ord)<br>             10 LOAD_FAST                1 (i)<br>             12 CALL_FUNCTION            1<br>             14 LIST_APPEND              2<br>             16 JUMP_ABSOLUTE            4 (to 8)<br>             18 RETURN_VALUE<br><br>Disassembly of &lt;code object xor2 at 0x0000023C79387050, file &quot;easy_xor_and_rc4.py&quot;, line 15&gt;:<br> 17           0 SETUP_FINALLY           18 (to 38)    	;异常发生时跳转到38<br><br> 18           2 LOAD_CONST               1 (&lt;code object &lt;listcomp&gt; at 0x0000023C79386FA0, file &quot;easy_xor_and_rc4.py&quot;, line 17&gt;) 			;加载常量 1，这个常量指向一个内联的列表推导式<br>              4 LOAD_CONST               2 (&#x27;xor2.&lt;locals&gt;.&lt;listcomp&gt;&#x27;)<br>              6 MAKE_FUNCTION            0 							;创建一个函数对象，准备将其应用<br>              8 LOAD_FAST                0 (plaintext)<br>             10 GET_ITER<br>             12 CALL_FUNCTION            1 				;由于这个函数是列表推导式，所以它将对 plaintext 进行迭代，并返回一个列表。<br>             14 STORE_FAST               0 (plaintext)<br>             16 POP_BLOCK 								;结束当前代码块（通常用于 try、with 语句块）<br>             18 JUMP_FORWARD            12 (to 44)<br><br> 19          20 POP_TOP<br>             22 POP_TOP<br>             24 POP_TOP<br><br> 20          26 POP_EXCEPT<br>             28 JUMP_FORWARD             2 (to 34)<br>             30 &lt;88&gt;<br><br> 21          32 LOAD_GLOBAL              0 (range)<br>        &gt;&gt;   34 LOAD_GLOBAL              1 (len)<br>             36 LOAD_FAST                0 (plaintext)<br>        &gt;&gt;   38 CALL_FUNCTION            1<br>             40 LOAD_CONST               3 (1)<br>             42 BINARY_SUBTRACT<br>        &gt;&gt;   44 CALL_FUNCTION            1 								;range(len(plaintext)-1)<br>             46 GET_ITER<br>             48 FOR_ITER                32 (to 114) 					;32啥也不是！<br>             50 STORE_FAST               1 (i) 							;for i in range(...)<br><br> 22          52 LOAD_FAST                0 (plaintext)<br>             54 LOAD_FAST                1 (i)<br>             56 BINARY_SUBSCR<br>             58 LOAD_FAST                0 (plaintext)<br>             60 LOAD_FAST                1 (i)<br>             62 LOAD_CONST               3 (1)<br>             64 BINARY_ADD<br>             66 BINARY_SUBSCR<br>             68 BINARY_XOR 											;plaintext[i]^plaintext[i+1]<br>             70 LOAD_FAST                0 (plaintext)<br>             72 LOAD_FAST                1 (i)<br>             74 LOAD_CONST               3 (1)<br>             76 BINARY_ADD<br>             78 STORE_SUBSCR 										;plaintext[i+1]=...<br>             80 JUMP_ABSOLUTE           48 (to 96) 					;跳转到绝对位置48<br>             82 LOAD_FAST                0 (plaintext)<br>             84 RETURN_VALUE<br><br>Disassembly of &lt;code object &lt;listcomp&gt; at 0x0000023C79386FA0, file &quot;easy_xor_and_rc4.py&quot;, line 17&gt;:<br> 17           0 BUILD_LIST               0<br>              2 LOAD_FAST                0 (.0)<br>              4 FOR_ITER                12 (to 30)<br>              6 STORE_FAST               1 (i)<br>        &gt;&gt;    8 LOAD_GLOBAL              0 (ord)<br>             10 LOAD_FAST                1 (i)<br>             12 CALL_FUNCTION            1<br>             14 LIST_APPEND              2<br>             16 JUMP_ABSOLUTE            4 (to 8)<br>             18 RETURN_VALUE<br><br>Disassembly of &lt;code object enc at 0x0000023C79387100, file &quot;easy_xor_and_rc4.py&quot;, line 24&gt;:<br> 26           0 LOAD_GLOBAL              0 (rc4)<br>              2 LOAD_FAST                0 (plaintext)<br>              4 LOAD_FAST                1 (key)<br>              6 CALL_FUNCTION            2<br>              8 STORE_FAST               0 (plaintext) 			;plaintext=rc4(plaintext,key)<br><br> 27          10 LOAD_GLOBAL              1 (xor1)<br>             12 LOAD_FAST                0 (plaintext)<br>             14 LOAD_FAST                2 (xor_list)<br>             16 CALL_FUNCTION            2<br>             18 STORE_FAST               0 (plaintext) 			;plaintext=xor1(plaintext,xor_list)<br><br> 28          20 LOAD_GLOBAL              2 (xor2)<br>             22 LOAD_FAST                0 (plaintext)<br>             24 CALL_FUNCTION            1<br>             26 STORE_FAST               0 (plaintext)      	;plaintext=xor2(plaintext)<br>             28 LOAD_FAST                0 (plaintext)<br>             30 RETURN_VALUE<br><br>Process finished with exit code 0<br><br></code></pre></td></tr></table></figure>

<p>​	可以大概看出来，<code>xor1</code>函数是<code>plaintext[i]^xor_list[i]</code>，<code>xor2</code>是前后异或，其中数据自取。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor2</span>(<span class="hljs-params">plain</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(plain)-<span class="hljs-number">1</span>):<br>        plain[i+<span class="hljs-number">1</span>]^=plain[i]<br>    <span class="hljs-keyword">return</span> plain<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor1</span>(<span class="hljs-params">plain,xor_list</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(plain)):<br>        plain[i] ^= i				<span class="hljs-comment">#xor_list[i]=i</span><br>  	<span class="hljs-keyword">return</span> plain<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">enc</span>(<span class="hljs-params">plain,key,xor_list</span>):<br>    enc(plain,key)<br>    xor1(plain,xor_list)<br>    xor2(plain)<br>    <span class="hljs-keyword">return</span> plain<br></code></pre></td></tr></table></figure>

<p>​	再看看RC4的代码，解包时，RC4函数没能成功解析出来，KSA和PRGA还是半对，烦！</p>
<p>​	分析一下。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs assembly">  9           0 LOAD_CONST               0 (&lt;code object KSA at 0x000001C022376550, file &quot;Rc4.py&quot;, line 1&gt;)<br>              2 LOAD_CONST               1 (&#x27;KSA&#x27;)<br>              4 MAKE_FUNCTION            0<br>              6 STORE_NAME               0 (KSA)<br><br> 19           8 LOAD_CONST               2 (&lt;code object PRGA at 0x000001C022376E40, file &quot;Rc4.py&quot;, line 9&gt;)<br>             10 LOAD_CONST               3 (&#x27;PRGA&#x27;)<br>             12 MAKE_FUNCTION            0<br>             14 STORE_NAME               1 (PRGA)<br>             16 LOAD_CONST               4 (&lt;code object rc4 at 0x000001C022377100, file &quot;Rc4.py&quot;, line 19&gt;)<br>             18 LOAD_CONST               5 (&#x27;rc4&#x27;)<br>             20 MAKE_FUNCTION            0<br>             22 STORE_NAME               2 (rc4)<br>             24 LOAD_CONST               6 (None)<br>             26 RETURN_VALUE<br><br>Disassembly of &lt;code object KSA at 0x000001C022376550, file &quot;Rc4.py&quot;, line 1&gt;:<br>  3           0 LOAD_CONST               1 (0)<br>              2 STORE_FAST               1 (j)<br><br>  4           4 LOAD_GLOBAL              0 (list)<br>              6 LOAD_GLOBAL              1 (range)<br>              8 LOAD_CONST               2 (256)<br>             10 CALL_FUNCTION            1<br>             12 CALL_FUNCTION            1<br>             14 STORE_FAST               2 (S)<br><br>  5          16 LOAD_GLOBAL              2 (len)<br>             18 LOAD_FAST                0 (key)<br>             20 CALL_FUNCTION            1<br>             22 STORE_FAST               3 (key_length)<br><br>  6          24 LOAD_GLOBAL              1 (range)<br>             26 LOAD_CONST               2 (256)<br>             28 CALL_FUNCTION            1<br>             30 GET_ITER<br>             32 FOR_ITER                58 (to 150)<br>             34 STORE_FAST               4 (i)<br><br>  7          36 LOAD_FAST                1 (j)<br>             38 LOAD_FAST                2 (S)<br>             40 LOAD_FAST                4 (i)<br>             42 BINARY_SUBSCR<br>             44 BINARY_ADD<br>             46 LOAD_FAST                0 (key)<br>             48 LOAD_FAST                4 (i)<br>             50 LOAD_FAST                3 (key_length)<br>             52 BINARY_MODULO<br>             54 BINARY_SUBSCR<br>             56 BINARY_ADD<br>             58 LOAD_CONST               2 (256)<br>             60 BINARY_MODULO<br>             62 STORE_FAST               1 (j)<br><br>  8     &gt;&gt;   64 LOAD_FAST                2 (S)<br>             66 LOAD_FAST                1 (j)<br>             68 BINARY_SUBSCR<br>             70 LOAD_FAST                2 (S)<br>             72 LOAD_FAST                4 (i)<br>             74 BINARY_SUBSCR<br>             76 ROT_TWO<br>             78 LOAD_FAST                2 (S)<br>             80 LOAD_FAST                4 (i)<br>             82 STORE_SUBSCR<br>             84 LOAD_FAST                2 (S)<br>             86 LOAD_FAST                1 (j)<br>             88 STORE_SUBSCR<br>             90 JUMP_ABSOLUTE           32 (to 64)<br>             92 LOAD_FAST                2 (S)<br>             94 RETURN_VALUE<br><br>Disassembly of &lt;code object PRGA at 0x000001C022376E40, file &quot;Rc4.py&quot;, line 9&gt;:<br> 11           0 LOAD_CONST               1 (0)<br>              2 STORE_FAST               1 (i)<br><br> 13           4 LOAD_CONST               1 (0)<br>              6 STORE_FAST               2 (j)<br><br> 14           8 LOAD_FAST                1 (i)<br>             10 LOAD_CONST               2 (1)<br>             12 BINARY_ADD<br>             14 LOAD_CONST               3 (256)<br>        &gt;&gt;   16 BINARY_MODULO<br>             18 STORE_FAST               1 (i)<br><br> 15          20 LOAD_FAST                2 (j)<br>             22 LOAD_FAST                0 (S)<br>             24 LOAD_FAST                1 (i)<br>             26 BINARY_SUBSCR<br>             28 BINARY_ADD<br>             30 LOAD_CONST               3 (256)<br>             32 BINARY_MODULO<br>             34 STORE_FAST               2 (j)<br><br> 16          36 LOAD_FAST                0 (S)<br>             38 LOAD_FAST                2 (j)<br>             40 BINARY_SUBSCR<br>             42 LOAD_FAST                0 (S)<br>             44 LOAD_FAST                1 (i)<br>             46 BINARY_SUBSCR<br>             48 ROT_TWO 							;[s[i],s[j]]<br>             50 LOAD_FAST                0 (S)<br>             52 LOAD_FAST                1 (i)<br>             54 STORE_SUBSCR 						;s[i]=s[j]<br>             56 LOAD_FAST                0 (S)<br>             58 LOAD_FAST                2 (j)<br>             60 STORE_SUBSCR 						;s[j]=t=s[i](原先的s[i])，swap了一下<br><br> 17          62 LOAD_FAST                0 (S)<br>             64 LOAD_FAST                1 (i)<br>             66 BINARY_SUBSCR<br>             68 LOAD_FAST                0 (S)<br>             70 LOAD_FAST                2 (j)<br>             72 BINARY_SUBSCR 					;[s[i],s[j]]<br>             74 BINARY_ADD<br>             76 LOAD_CONST               3 (256)<br>             78 BINARY_MODULO<br>             80 STORE_FAST               3 (k) 			;k=s[i]+s[j]<br>             82 LOAD_FAST                3 (k)<br>             84 YIELD_VALUE<br>             86 POP_TOP<br>             88 JUMP_ABSOLUTE            8 (to 16)<br>             90 LOAD_CONST               0 (None)<br>             92 RETURN_VALUE<br><br>Disassembly of &lt;code object rc4 at 0x000001C022377100, file &quot;Rc4.py&quot;, line 19&gt;:<br> 21           0 SETUP_FINALLY           18 (to 38)<br><br> 22           2 LOAD_CONST               1 (&lt;code object &lt;listcomp&gt; at 0x000001C022376FA0, file &quot;Rc4.py&quot;, line 21&gt;)<br>              4 LOAD_CONST               2 (&#x27;rc4.&lt;locals&gt;.&lt;listcomp&gt;&#x27;)<br>              6 MAKE_FUNCTION            0<br>              8 LOAD_FAST                1 (key)<br>             10 GET_ITER<br>             12 CALL_FUNCTION            1<br>             14 STORE_FAST               1 (key)<br>             16 POP_BLOCK<br>             18 JUMP_FORWARD            12 (to 44)<br><br> 23          20 POP_TOP<br>             22 POP_TOP<br>             24 POP_TOP<br><br> 24          26 POP_EXCEPT<br>             28 JUMP_FORWARD             2 (to 34)<br>             30 &lt;88&gt;<br><br> 25          32 SETUP_FINALLY           18 (to 70)<br><br> 26     &gt;&gt;   34 LOAD_CONST               3 (&lt;code object &lt;listcomp&gt; at 0x000001C022377050, file &quot;Rc4.py&quot;, line 25&gt;)<br>             36 LOAD_CONST               2 (&#x27;rc4.&lt;locals&gt;.&lt;listcomp&gt;&#x27;)<br>        &gt;&gt;   38 MAKE_FUNCTION            0<br>             40 LOAD_FAST                0 (plaintext)<br>             42 GET_ITER<br>        &gt;&gt;   44 CALL_FUNCTION            1<br>             46 STORE_FAST               0 (plaintext)<br>             48 POP_BLOCK<br>             50 JUMP_FORWARD            12 (to 76)<br><br> 27          52 POP_TOP<br>             54 POP_TOP<br>             56 POP_TOP<br><br> 28          58 POP_EXCEPT<br>             60 JUMP_FORWARD             2 (to 66)<br>             62 &lt;88&gt;<br><br> 29          64 LOAD_GLOBAL              0 (range)<br>        &gt;&gt;   66 LOAD_GLOBAL              1 (len)<br>             68 LOAD_FAST                0 (plaintext)<br>        &gt;&gt;   70 CALL_FUNCTION            1<br>             72 CALL_FUNCTION            1<br>             74 GET_ITER<br>        &gt;&gt;   76 FOR_ITER                20 (to 118)<br>             78 STORE_FAST               2 (i)<br><br> 30          80 LOAD_FAST                0 (plaintext)<br>             82 LOAD_FAST                2 (i)<br>             84 DUP_TOP_TWO<br>             86 BINARY_SUBSCR<br>             88 LOAD_FAST                2 (i)<br>             90 INPLACE_ADD 							;plaintext[i]+i<br>             92 ROT_THREE<br>             94 STORE_SUBSCR 							;plaintext[i] = plaintext[i]+i<br>             96 JUMP_ABSOLUTE           76 (to 152)<br><br> 31          98 LOAD_GLOBAL              2 (KSA)<br>            100 LOAD_FAST                1 (key)<br>            102 CALL_FUNCTION            1<br>            104 STORE_FAST               3 (S) 					;S=KSA(key)<br><br> 32         106 LOAD_GLOBAL              3 (PRGA)<br>            108 LOAD_FAST                3 (S)<br>            110 CALL_FUNCTION            1<br>            112 STORE_FAST               4 (xor_value) 				;xor_vlaue=PRGA(S)<br><br> 33         114 LOAD_GLOBAL              0 (range)<br>            116 LOAD_GLOBAL              1 (len)<br>        &gt;&gt;  118 LOAD_FAST                0 (plaintext)<br>            120 CALL_FUNCTION            1<br>            122 CALL_FUNCTION            1<br>            124 GET_ITER<br>            126 FOR_ITER                32 (to 192)<br>            128 STORE_FAST               2 (i) 					;for i in range(len(plaintext)):<br><br> 34         130 LOAD_FAST                0 (plaintext)<br>            132 LOAD_FAST                2 (i)<br>            134 DUP_TOP_TWO<br>            136 BINARY_SUBSCR<br>            138 LOAD_GLOBAL              4 (int)<br>            140 LOAD_GLOBAL              5 (next)<br>            142 LOAD_FAST                4 (xor_value)<br>            144 CALL_FUNCTION            1<br>            146 CALL_FUNCTION            1 						;int(next(xor_value))<br>            148 LOAD_CONST               4 (6)<br>            150 BINARY_ADD 										;...+6<br>        &gt;&gt;  152 INPLACE_XOR 									;plaintext[i]^...<br>            154 ROT_THREE<br>            156 STORE_SUBSCR 									;plaintext[i]=...<br>            158 JUMP_ABSOLUTE          126 (to 252)<br>            160 LOAD_FAST                0 (plaintext)<br>            162 RETURN_VALUE<br><br>Disassembly of &lt;code object &lt;listcomp&gt; at 0x000001C022376FA0, file &quot;Rc4.py&quot;, line 21&gt;:<br> 21           0 BUILD_LIST               0<br>              2 LOAD_FAST                0 (.0)<br>              4 FOR_ITER                12 (to 30)<br>              6 STORE_FAST               1 (i)<br>        &gt;&gt;    8 LOAD_GLOBAL              0 (ord)<br>             10 LOAD_FAST                1 (i)<br>             12 CALL_FUNCTION            1<br>             14 LIST_APPEND              2<br>             16 JUMP_ABSOLUTE            4 (to 8)<br>             18 RETURN_VALUE<br><br>Disassembly of &lt;code object &lt;listcomp&gt; at 0x000001C022377050, file &quot;Rc4.py&quot;, line 25&gt;:<br> 25           0 BUILD_LIST               0<br>              2 LOAD_FAST                0 (.0)<br>              4 FOR_ITER                12 (to 30)<br>              6 STORE_FAST               1 (i)<br>        &gt;&gt;    8 LOAD_GLOBAL              0 (ord)<br>             10 LOAD_FAST                1 (i)<br>             12 CALL_FUNCTION            1<br>             14 LIST_APPEND              2<br>             16 JUMP_ABSOLUTE            4 (to 8)<br>             18 RETURN_VALUE<br><br>Process finished with exit code 0<br></code></pre></td></tr></table></figure>

<p>​	综合分析得到的rc4.py如下，简化了一些异常处理以及格式转换。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">KSA</span>(<span class="hljs-params">key</span>):<br>    j = <span class="hljs-number">0</span><br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    key_length = <span class="hljs-built_in">len</span>(key)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % key_length]) % <span class="hljs-number">256</span><br>        S[i],S[j] = S[j],S[i]<br>        <span class="hljs-keyword">return</span> S<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">PRGA</span>(<span class="hljs-params">S</span>):<br>    i = <span class="hljs-number">0</span><br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>    	j = (j + S[i]) % <span class="hljs-number">256</span><br>    	S[i],S[j] = S[j],S[i]<br>    	k = (S[i] + S[j]) % <span class="hljs-number">256</span><br>    	<span class="hljs-keyword">yield</span> k<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">RC4</span>(<span class="hljs-params">plain, key</span>):<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(plain)):<br>        plain_text[i] += i<br>    S = KSA(key)<br>    cipher_text = []<br>    prga = PRGA(S)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(plain_text)):<br>        cipher_text.append(plain_text[i] ^ (<span class="hljs-built_in">int</span>(<span class="hljs-built_in">next</span>(prga))+<span class="hljs-number">6</span>))<br>    <span class="hljs-keyword">return</span> cipher_text<br></code></pre></td></tr></table></figure>



<p>​	最后的解密代码如下，开始还把xor2的前后异或给解错了，应该从后往前解，还是没有理解的清清楚楚啊！</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">cipher = [<span class="hljs-number">158</span>, <span class="hljs-number">31</span>, <span class="hljs-number">205</span>, <span class="hljs-number">434</span>, <span class="hljs-number">354</span>, <span class="hljs-number">15</span>, <span class="hljs-number">383</span>, <span class="hljs-number">298</span>, <span class="hljs-number">304</span>, <span class="hljs-number">351</span>, <span class="hljs-number">465</span>, <span class="hljs-number">312</span>, <span class="hljs-number">261</span>, <span class="hljs-number">442</span>,<span class="hljs-number">397</span>, <span class="hljs-number">474</span>, <span class="hljs-number">310</span>, <span class="hljs-number">397</span>, <span class="hljs-number">31</span>, <span class="hljs-number">21</span>, <span class="hljs-number">78</span>, <span class="hljs-number">67</span>, <span class="hljs-number">47</span>, <span class="hljs-number">133</span>, <span class="hljs-number">168</span>, <span class="hljs-number">48</span>, <span class="hljs-number">153</span>, <span class="hljs-number">99</span>, <span class="hljs-number">103</span>, <span class="hljs-number">204</span>, <span class="hljs-number">137</span>, <span class="hljs-number">29</span>, <span class="hljs-number">22</span>, <span class="hljs-number">13</span>, <span class="hljs-number">228</span>, <span class="hljs-number">3</span>, <span class="hljs-number">136</span>, <span class="hljs-number">141</span>, <span class="hljs-number">248</span>, <span class="hljs-number">124</span>, <span class="hljs-number">26</span>, <span class="hljs-number">26</span>, <span class="hljs-number">65</span>, <span class="hljs-number">200</span>, <span class="hljs-number">7</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(cipher)-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">1</span>):<br>    cipher[i] ^= cipher[i-<span class="hljs-number">1</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(cipher)):<br>    cipher[i] ^= i<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">KSA</span>(<span class="hljs-params">key</span>):<br>    j = <span class="hljs-number">0</span><br>    S = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    key_length = <span class="hljs-built_in">len</span>(key)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + S[i] + key[i % key_length]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>    <span class="hljs-keyword">return</span> S<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">PRGA</span>(<span class="hljs-params">S</span>):<br>    i = <span class="hljs-number">0</span><br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + S[i]) % <span class="hljs-number">256</span><br>        S[i], S[j] = S[j], S[i]<br>        K = (S[i] + S[j]) % <span class="hljs-number">256</span><br>        <span class="hljs-keyword">yield</span> K<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">deRC4</span>(<span class="hljs-params">plain, key</span>):<br>    S = KSA(key)<br>    prga = PRGA(S)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(plain)):<br>        plain[i] ^= (<span class="hljs-built_in">int</span>(<span class="hljs-built_in">next</span>(prga))+<span class="hljs-number">6</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(plain)):<br>        plain[i] -= i<br>    <span class="hljs-keyword">return</span> plain<br><br>key = <span class="hljs-string">&quot;SYCFOREVER&quot;</span><br>key = [<span class="hljs-built_in">ord</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> key]<br>plain_text = deRC4(cipher, key)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;</span>.join([<span class="hljs-built_in">chr</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> plain_text]))		<span class="hljs-comment">#SYC&#123;Bel1eve_thAt_you_a3e_Unique_@nd_tHe_beSt&#125;</span><br></code></pre></td></tr></table></figure>



<h1 id="玩就行了"><a href="#玩就行了" class="headerlink" title="玩就行了"></a>玩就行了</h1><p>​	Unity逆向，玩黄金矿工小游戏，全屏还缩小不了。CE修改得分，通关后就提示“有什么东西遗漏了！”。我怎么知道。</p>
<p>​	然后打开<strong>Data.txt</strong>文件，我以敏锐的直觉看到开头的<strong>4D5A</strong>，这是exe程序的文件头，根本不是unity逆向！</p>
<p>​	无壳程序，直接拖入IDA。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __fastcall <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">char</span> Key[<span class="hljs-number">117</span>]; <span class="hljs-comment">// [rsp+2Bh] [rbp-55h] BYREF</span><br>  <span class="hljs-type">char</span> Myflag[<span class="hljs-number">108</span>]; <span class="hljs-comment">// [rsp+A0h] [rbp+20h] BYREF</span><br>  <span class="hljs-type">int</span> flag_len; <span class="hljs-comment">// [rsp+10Ch] [rbp+8Ch]</span><br><br>  sub_14000181E(argc, argv, envp);<br>  <span class="hljs-built_in">strcpy</span>(Key, <span class="hljs-string">&quot;GEEK&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;WOW~~Niceeeee to see you here!!!\n&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Welcome to GEEK Challenge!!!!!\n&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Please input your answer~\n&quot;</span>);<br>  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, Myflag);<br>  flag_len = <span class="hljs-built_in">strlen</span>(Myflag);<br>  sub_14000144B(Myflag, <span class="hljs-number">20LL</span>);<br>  sub_140001596(Myflag, Key);<br>  sub_14000161C(Myflag, &amp;Key[<span class="hljs-number">5</span>]);<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strcmp</span>(&amp;Key[<span class="hljs-number">5</span>], <span class="hljs-string">&quot;0A161230300C2D0A2B303D2428233005242C2D26182206233E097F133A&quot;</span>) )<br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;G00D!!!&quot;</span>);<br>  <span class="hljs-keyword">else</span><br>    <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Try again.&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;\nPress any key to continue...&quot;</span>);<br>  getchar();<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>​	<strong>sub_14000144B</strong>函数是类凯撒密码，数字也移位了，偏移量20。</p>
<p>​	<strong>sub_140001596</strong>函数使用key异或加密。</p>
<p>​	<strong>sub_14000161C</strong>里面调用了<strong>sub_140001408</strong>函数，这个函数IDA反编译不太好看，其参数为buffer指针、格式化字符、字符数据。先猜测一下，别想着都搞清楚，其中有不少底层代码，该清楚很麻烦的啊，慢慢积累就好了。猜测就是进行一下格式转换，直接写脚本试试。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">data = <span class="hljs-string">&quot;0A161230300C2D0A2B303D2428233005242C2D26182206233E097F133A&quot;</span><br>key = <span class="hljs-string">&quot;GEEK&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(data), <span class="hljs-number">2</span>):<br>    tmp = <span class="hljs-built_in">int</span>(data[i:i+<span class="hljs-number">2</span>], <span class="hljs-number">16</span>)<br>    tmp ^= <span class="hljs-built_in">ord</span>(key[(i // <span class="hljs-number">2</span>) % <span class="hljs-number">4</span>])<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;0&#x27;</span>) &lt;= tmp &lt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;9&#x27;</span>):<br>        tmp = (tmp - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;0&#x27;</span>) - <span class="hljs-number">20</span>) % <span class="hljs-number">10</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;0&#x27;</span>)<br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>) &lt;= tmp &lt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;Z&#x27;</span>):<br>        tmp = (tmp - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>) - <span class="hljs-number">20</span>) % <span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;A&#x27;</span>)<br>    <span class="hljs-keyword">elif</span> <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>) &lt;= tmp &lt;= <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;z&#x27;</span>):<br>        tmp = (tmp - <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>) - <span class="hljs-number">20</span>) % <span class="hljs-number">26</span> + <span class="hljs-built_in">ord</span>(<span class="hljs-string">&#x27;a&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>(tmp),end=<span class="hljs-string">&#x27;&#x27;</span>) 		<span class="hljs-comment">#SYC&#123;cOnGraduulaTions_mIneR:D&#125;</span><br></code></pre></td></tr></table></figure>



<h1 id="长颈鹿喜欢吃彩虹"><a href="#长颈鹿喜欢吃彩虹" class="headerlink" title="长颈鹿喜欢吃彩虹"></a>长颈鹿喜欢吃彩虹</h1><p>​	运行一下，还挺好看。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250703124214319.png" alt="image-20250703124214319">

<p>​	IDA打开，看到main函数，使用变量<strong>v6</strong>进行跳转，还没碰到过，这是什么混淆方式吧。其实一点点看，也可以分析出程序运行流程，但是先学习一下WP的方法，有一个说是<strong>平坦化</strong>，使用<strong>b810插件</strong>去除。（原来我之前安过啊）</p>
<p>​	这个插件下载教程可以去看<a target="_blank" rel="noopener" href="https://lkliki.github.io/2023/09/28/ida%E6%8F%92%E4%BB%B6-d810%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8/">这个文章</a>，我的IDA切换到了3.11.0版本的python（系统中的，自行下载的），然后通过<code>py -3.11.0 -m pip install xxx</code>命令安装好依赖，使用起来就是先打开插件，选择<strong>unflattening ollvm</strong>去平坦化的，点击start就算启动了。之后回到main函数，在汇编界面，按<strong>U</strong>、<strong>C</strong>、<strong>P</strong>、<strong>F5</strong>重新反编译一次，这时候插件就会起作用。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250703134023131.png" alt="image-20250703134023131">

<p>​	可以看到，情况大不一样，效果很成功。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250703134312775.png" alt="image-20250703134312775">

<p>​	这个encrypt函数平坦化之后还是挺难看的，一个变量挪动了好多位置，主要就看到一个异或操作，其中一个确定应该是输入的flag字符串，另一个贼难跟踪。当然，在异或处下断点动调（汇编指令处）应该是能看出来这两个值是什么的，但是我已经看过别人的WP了，人家直接猜的。</p>
<p>​	看看动调的方法吧，首先看到加密函数处，可以直接拿到Key是<strong>BOb0m0oN</strong>，可以确定Buffer的地址，可以选择下内存断点。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250703152243098.png" alt="image-20250703152243098">

<p>​	看到异或处，一个是我的输入，另一个数<strong>ecx</strong>多看两轮就知道是逆序的Key了，规律也简单，大胆猜测，小心取值。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250703152641983.png" alt="image-20250703152641983">

<p>​	最后看到比较处，取出加密输入和密文，我们其实可以通过输入特定的flag来确定每位的异或值是多少，这样也能解密。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250703152840984.png" alt="image-20250703152840984">

<p>​	有点累人，真的是做题做久了，一点兴趣都没了。现在边做边记录，做了两整天了，早上起来开做，晚上结束回去睡觉，开始很有激情，不觉得累，做到这种攻坚的地方，就没精力了，缓几天再做吧。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc = [<span class="hljs-number">29</span>, <span class="hljs-number">54</span>, <span class="hljs-number">115</span>, <span class="hljs-number">22</span>, <span class="hljs-number">73</span>, <span class="hljs-number">45</span>, <span class="hljs-number">26</span>, <span class="hljs-number">29</span>, <span class="hljs-number">41</span>, <span class="hljs-number">6</span>, <span class="hljs-number">66</span>, <span class="hljs-number">44</span>, <span class="hljs-number">118</span>, <span class="hljs-number">7</span>, <span class="hljs-number">16</span>, <span class="hljs-number">14</span>, <span class="hljs-number">126</span>, <span class="hljs-number">57</span>, <span class="hljs-number">85</span>, <span class="hljs-number">50</span>, <span class="hljs-number">117</span>, <span class="hljs-number">3</span>, <span class="hljs-number">27</span>, <span class="hljs-number">29</span>, <span class="hljs-number">25</span>, <span class="hljs-number">95</span>, <span class="hljs-number">82</span>, <span class="hljs-number">35</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">29</span>, <span class="hljs-number">63</span>]<br>key = [<span class="hljs-number">0x42</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0x4e</span>]<br>result = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">chr</span>((enc[i] ^ key[::-<span class="hljs-number">1</span>][i % <span class="hljs-built_in">len</span>(key)]) &amp; <span class="hljs-number">0xff</span>), end=<span class="hljs-string">&#x27;&#x27;</span>)<br><span class="hljs-comment">#SYC&#123;yOU_girAFe_L0Ve_EaT_W0bN1aR&#125;</span><br></code></pre></td></tr></table></figure>





<h1 id="AES"><a href="#AES" class="headerlink" title="AES!"></a>AES!</h1><p>​	无他，考察AES算法的理解。对我来说都无所谓，反正是新知识，没学过！不会可以看另一篇文章AES。</p>
<p>​	专门学了半天的AES，边理解边敲代码，最后还debug，搞定一些小的细节错误，终于大功告成！但是，那是密码学的知识，我们做题还得识别验证是不是标准的AES，具体看看代码的实现。</p>
<p>​	进入函数，输入flag后，验证长度是否是32位字节，然后使用<strong>1C99</strong>函数加密，<del>下面的那个不知道干嘛</del>，v7应该是flag的后一段，应该是反编译有问题，看汇编就很清楚了。传入参数，第一个是密钥，第二个是密钥长度，第五个是输入长度，会检查是否是16的倍数的。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250705164812604.png" alt="image-20250705164812604">

<p>​	可以清楚的看到，是将flag分成了两次加密，第二次传入的地址都加上了偏移0x10。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250705165554915.png" alt="image-20250705165554915">

<p>​	然后看到<strong>sub_7FF60A701408</strong>函数，里面是在做扩展轮密钥，先将初始16字节密钥换成4个32位字。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250705172649254.png" alt="image-20250705172649254">

<p>​	后面的就很清晰了，就不一点点解析了，是在是有点懒了。<strong>sub_7FF60A7016DC</strong>是在取input的16字节复制到v7中，看汇编也能看出来<strong>v12</strong>是指向<strong>v9</strong>的。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250705173038449.png" alt="image-20250705173038449">

<p>​	最后的解密代码如下。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">AES</span>:<br>    MIX_C = [[<span class="hljs-number">0x2</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x1</span>], [<span class="hljs-number">0x1</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>], [<span class="hljs-number">0x1</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x2</span>, <span class="hljs-number">0x3</span>], [<span class="hljs-number">0x3</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x1</span>, <span class="hljs-number">0x2</span>]]<br>    MIX_C_INV = [[<span class="hljs-number">0xe</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0xd</span>, <span class="hljs-number">0x9</span>], [<span class="hljs-number">0x9</span>, <span class="hljs-number">0xe</span>, <span class="hljs-number">0xb</span>, <span class="hljs-number">0xd</span>], [<span class="hljs-number">0xd</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xe</span>, <span class="hljs-number">0xb</span>], [<span class="hljs-number">0xb</span>, <span class="hljs-number">0xd</span>, <span class="hljs-number">0x9</span>, <span class="hljs-number">0xe</span>]]<br>    RCON= [<span class="hljs-number">0x01</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x36</span> ,<span class="hljs-number">0x6c</span>, <span class="hljs-number">0xd8</span>, <span class="hljs-number">0xab</span>, <span class="hljs-number">0x4d</span>]  <span class="hljs-comment"># 实际只用到前10个</span><br>    S_BOX = [[<span class="hljs-number">124</span>, <span class="hljs-number">202</span>, <span class="hljs-number">123</span>, <span class="hljs-number">119</span>, <span class="hljs-number">242</span>, <span class="hljs-number">107</span>, <span class="hljs-number">111</span>, <span class="hljs-number">197</span>, <span class="hljs-number">48</span>, <span class="hljs-number">1</span>, <span class="hljs-number">103</span>, <span class="hljs-number">43</span>, <span class="hljs-number">254</span>, <span class="hljs-number">215</span>, <span class="hljs-number">71</span>, <span class="hljs-number">171</span>],<br>             [<span class="hljs-number">118</span>, <span class="hljs-number">99</span>, <span class="hljs-number">130</span>, <span class="hljs-number">201</span>, <span class="hljs-number">125</span>, <span class="hljs-number">250</span>, <span class="hljs-number">89</span>, <span class="hljs-number">240</span>, <span class="hljs-number">173</span>, <span class="hljs-number">212</span>, <span class="hljs-number">162</span>, <span class="hljs-number">175</span>, <span class="hljs-number">156</span>, <span class="hljs-number">164</span>, <span class="hljs-number">114</span>, <span class="hljs-number">192</span>],<br>             [<span class="hljs-number">183</span>, <span class="hljs-number">253</span>, <span class="hljs-number">147</span>, <span class="hljs-number">38</span>, <span class="hljs-number">54</span>, <span class="hljs-number">63</span>, <span class="hljs-number">247</span>, <span class="hljs-number">204</span>, <span class="hljs-number">52</span>, <span class="hljs-number">165</span>, <span class="hljs-number">229</span>, <span class="hljs-number">241</span>, <span class="hljs-number">113</span>, <span class="hljs-number">216</span>, <span class="hljs-number">49</span>, <span class="hljs-number">21</span>],<br>             [<span class="hljs-number">4</span>, <span class="hljs-number">199</span>, <span class="hljs-number">35</span>, <span class="hljs-number">195</span>, <span class="hljs-number">24</span>, <span class="hljs-number">150</span>, <span class="hljs-number">5</span>, <span class="hljs-number">154</span>, <span class="hljs-number">7</span>, <span class="hljs-number">18</span>, <span class="hljs-number">128</span>, <span class="hljs-number">226</span>, <span class="hljs-number">235</span>, <span class="hljs-number">39</span>, <span class="hljs-number">178</span>, <span class="hljs-number">117</span>],<br>             [<span class="hljs-number">9</span>, <span class="hljs-number">131</span>, <span class="hljs-number">44</span>, <span class="hljs-number">26</span>, <span class="hljs-number">27</span>, <span class="hljs-number">110</span>, <span class="hljs-number">90</span>, <span class="hljs-number">160</span>, <span class="hljs-number">82</span>, <span class="hljs-number">59</span>, <span class="hljs-number">214</span>, <span class="hljs-number">179</span>, <span class="hljs-number">41</span>, <span class="hljs-number">227</span>, <span class="hljs-number">47</span>, <span class="hljs-number">132</span>],<br>             [<span class="hljs-number">83</span>, <span class="hljs-number">209</span>, <span class="hljs-number">0</span>, <span class="hljs-number">237</span>, <span class="hljs-number">32</span>, <span class="hljs-number">252</span>, <span class="hljs-number">177</span>, <span class="hljs-number">91</span>, <span class="hljs-number">106</span>, <span class="hljs-number">203</span>, <span class="hljs-number">190</span>, <span class="hljs-number">57</span>, <span class="hljs-number">74</span>, <span class="hljs-number">76</span>, <span class="hljs-number">88</span>, <span class="hljs-number">207</span>],<br>             [<span class="hljs-number">208</span>, <span class="hljs-number">239</span>, <span class="hljs-number">170</span>, <span class="hljs-number">251</span>, <span class="hljs-number">67</span>, <span class="hljs-number">77</span>, <span class="hljs-number">51</span>, <span class="hljs-number">133</span>, <span class="hljs-number">69</span>, <span class="hljs-number">249</span>, <span class="hljs-number">2</span>, <span class="hljs-number">127</span>, <span class="hljs-number">80</span>, <span class="hljs-number">60</span>, <span class="hljs-number">159</span>, <span class="hljs-number">168</span>],<br>             [<span class="hljs-number">81</span>, <span class="hljs-number">163</span>, <span class="hljs-number">64</span>, <span class="hljs-number">143</span>, <span class="hljs-number">146</span>, <span class="hljs-number">157</span>, <span class="hljs-number">56</span>, <span class="hljs-number">245</span>, <span class="hljs-number">188</span>, <span class="hljs-number">182</span>, <span class="hljs-number">218</span>, <span class="hljs-number">33</span>, <span class="hljs-number">16</span>, <span class="hljs-number">255</span>, <span class="hljs-number">243</span>, <span class="hljs-number">210</span>],<br>             [<span class="hljs-number">151</span>, <span class="hljs-number">205</span>, <span class="hljs-number">12</span>, <span class="hljs-number">19</span>, <span class="hljs-number">236</span>, <span class="hljs-number">95</span>, <span class="hljs-number">68</span>, <span class="hljs-number">23</span>, <span class="hljs-number">196</span>, <span class="hljs-number">167</span>, <span class="hljs-number">126</span>, <span class="hljs-number">61</span>, <span class="hljs-number">100</span>, <span class="hljs-number">93</span>, <span class="hljs-number">25</span>, <span class="hljs-number">115</span>],<br>             [<span class="hljs-number">96</span>, <span class="hljs-number">129</span>, <span class="hljs-number">79</span>, <span class="hljs-number">220</span>, <span class="hljs-number">34</span>, <span class="hljs-number">42</span>, <span class="hljs-number">144</span>, <span class="hljs-number">136</span>, <span class="hljs-number">70</span>, <span class="hljs-number">238</span>, <span class="hljs-number">184</span>, <span class="hljs-number">20</span>, <span class="hljs-number">222</span>, <span class="hljs-number">94</span>, <span class="hljs-number">11</span>, <span class="hljs-number">219</span>],<br>             [<span class="hljs-number">224</span>, <span class="hljs-number">50</span>, <span class="hljs-number">58</span>, <span class="hljs-number">10</span>, <span class="hljs-number">73</span>, <span class="hljs-number">6</span>, <span class="hljs-number">36</span>, <span class="hljs-number">92</span>, <span class="hljs-number">194</span>, <span class="hljs-number">211</span>, <span class="hljs-number">172</span>, <span class="hljs-number">98</span>, <span class="hljs-number">145</span>, <span class="hljs-number">149</span>, <span class="hljs-number">228</span>, <span class="hljs-number">121</span>],<br>             [<span class="hljs-number">231</span>, <span class="hljs-number">200</span>, <span class="hljs-number">55</span>, <span class="hljs-number">109</span>, <span class="hljs-number">141</span>, <span class="hljs-number">213</span>, <span class="hljs-number">78</span>, <span class="hljs-number">169</span>, <span class="hljs-number">108</span>, <span class="hljs-number">86</span>, <span class="hljs-number">244</span>, <span class="hljs-number">234</span>, <span class="hljs-number">101</span>, <span class="hljs-number">122</span>, <span class="hljs-number">174</span>, <span class="hljs-number">8</span>],<br>             [<span class="hljs-number">186</span>, <span class="hljs-number">120</span>, <span class="hljs-number">37</span>, <span class="hljs-number">46</span>, <span class="hljs-number">28</span>, <span class="hljs-number">166</span>, <span class="hljs-number">180</span>, <span class="hljs-number">198</span>, <span class="hljs-number">232</span>, <span class="hljs-number">221</span>, <span class="hljs-number">116</span>, <span class="hljs-number">31</span>, <span class="hljs-number">75</span>, <span class="hljs-number">189</span>, <span class="hljs-number">139</span>, <span class="hljs-number">138</span>],<br>             [<span class="hljs-number">112</span>, <span class="hljs-number">62</span>, <span class="hljs-number">181</span>, <span class="hljs-number">102</span>, <span class="hljs-number">72</span>, <span class="hljs-number">3</span>, <span class="hljs-number">246</span>, <span class="hljs-number">14</span>, <span class="hljs-number">97</span>, <span class="hljs-number">53</span>, <span class="hljs-number">87</span>, <span class="hljs-number">185</span>, <span class="hljs-number">134</span>, <span class="hljs-number">193</span>, <span class="hljs-number">29</span>, <span class="hljs-number">158</span>],<br>             [<span class="hljs-number">225</span>, <span class="hljs-number">248</span>, <span class="hljs-number">152</span>, <span class="hljs-number">17</span>, <span class="hljs-number">105</span>, <span class="hljs-number">217</span>, <span class="hljs-number">142</span>, <span class="hljs-number">148</span>, <span class="hljs-number">155</span>, <span class="hljs-number">30</span>, <span class="hljs-number">233</span>, <span class="hljs-number">206</span>, <span class="hljs-number">85</span>, <span class="hljs-number">40</span>, <span class="hljs-number">223</span>, <span class="hljs-number">140</span>],<br>             [<span class="hljs-number">161</span>, <span class="hljs-number">137</span>, <span class="hljs-number">13</span>, <span class="hljs-number">191</span>, <span class="hljs-number">230</span>, <span class="hljs-number">66</span>, <span class="hljs-number">104</span>, <span class="hljs-number">65</span>, <span class="hljs-number">153</span>, <span class="hljs-number">45</span>, <span class="hljs-number">15</span>, <span class="hljs-number">176</span>, <span class="hljs-number">84</span>, <span class="hljs-number">187</span>, <span class="hljs-number">22</span>, <span class="hljs-number">135</span>]]<br><br>    S_BOX_INV = [[<span class="hljs-number">82</span>, <span class="hljs-number">9</span>, <span class="hljs-number">106</span>, <span class="hljs-number">213</span>, <span class="hljs-number">48</span>, <span class="hljs-number">54</span>, <span class="hljs-number">165</span>, <span class="hljs-number">56</span>, <span class="hljs-number">191</span>, <span class="hljs-number">64</span>, <span class="hljs-number">163</span>, <span class="hljs-number">158</span>, <span class="hljs-number">130</span>, <span class="hljs-number">242</span>, <span class="hljs-number">215</span>, <span class="hljs-number">250</span>],<br>              [<span class="hljs-number">124</span>, <span class="hljs-number">227</span>, <span class="hljs-number">57</span>, <span class="hljs-number">131</span>, <span class="hljs-number">155</span>, <span class="hljs-number">47</span>, <span class="hljs-number">254</span>, <span class="hljs-number">135</span>, <span class="hljs-number">52</span>, <span class="hljs-number">142</span>, <span class="hljs-number">67</span>, <span class="hljs-number">68</span>, <span class="hljs-number">196</span>, <span class="hljs-number">222</span>, <span class="hljs-number">233</span>, <span class="hljs-number">203</span>],<br>              [<span class="hljs-number">84</span>, <span class="hljs-number">123</span>, <span class="hljs-number">148</span>, <span class="hljs-number">50</span>, <span class="hljs-number">166</span>, <span class="hljs-number">194</span>, <span class="hljs-number">35</span>, <span class="hljs-number">61</span>, <span class="hljs-number">237</span>, <span class="hljs-number">76</span>, <span class="hljs-number">149</span>, <span class="hljs-number">11</span>, <span class="hljs-number">66</span>, <span class="hljs-number">249</span>, <span class="hljs-number">195</span>, <span class="hljs-number">78</span>],<br>              [<span class="hljs-number">8</span>, <span class="hljs-number">46</span>, <span class="hljs-number">161</span>, <span class="hljs-number">102</span>, <span class="hljs-number">40</span>, <span class="hljs-number">217</span>, <span class="hljs-number">36</span>, <span class="hljs-number">178</span>, <span class="hljs-number">118</span>, <span class="hljs-number">91</span>, <span class="hljs-number">162</span>, <span class="hljs-number">73</span>, <span class="hljs-number">109</span>, <span class="hljs-number">139</span>, <span class="hljs-number">209</span>, <span class="hljs-number">37</span>],<br>              [<span class="hljs-number">114</span>, <span class="hljs-number">247</span>, <span class="hljs-number">245</span>, <span class="hljs-number">100</span>, <span class="hljs-number">134</span>, <span class="hljs-number">104</span>, <span class="hljs-number">152</span>, <span class="hljs-number">14</span>, <span class="hljs-number">212</span>, <span class="hljs-number">164</span>, <span class="hljs-number">92</span>, <span class="hljs-number">204</span>, <span class="hljs-number">93</span>, <span class="hljs-number">101</span>, <span class="hljs-number">182</span>, <span class="hljs-number">146</span>],<br>              [<span class="hljs-number">108</span>, <span class="hljs-number">112</span>, <span class="hljs-number">72</span>, <span class="hljs-number">80</span>, <span class="hljs-number">252</span>, <span class="hljs-number">236</span>, <span class="hljs-number">185</span>, <span class="hljs-number">218</span>, <span class="hljs-number">94</span>, <span class="hljs-number">22</span>, <span class="hljs-number">70</span>, <span class="hljs-number">87</span>, <span class="hljs-number">167</span>, <span class="hljs-number">141</span>, <span class="hljs-number">157</span>, <span class="hljs-number">133</span>],<br>              [<span class="hljs-number">144</span>, <span class="hljs-number">216</span>, <span class="hljs-number">171</span>, <span class="hljs-number">17</span>, <span class="hljs-number">140</span>, <span class="hljs-number">188</span>, <span class="hljs-number">211</span>, <span class="hljs-number">10</span>, <span class="hljs-number">246</span>, <span class="hljs-number">228</span>, <span class="hljs-number">88</span>, <span class="hljs-number">5</span>, <span class="hljs-number">184</span>, <span class="hljs-number">179</span>, <span class="hljs-number">69</span>, <span class="hljs-number">6</span>],<br>              [<span class="hljs-number">208</span>, <span class="hljs-number">44</span>, <span class="hljs-number">30</span>, <span class="hljs-number">143</span>, <span class="hljs-number">202</span>, <span class="hljs-number">63</span>, <span class="hljs-number">16</span>, <span class="hljs-number">3</span>, <span class="hljs-number">193</span>, <span class="hljs-number">175</span>, <span class="hljs-number">189</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">20</span>, <span class="hljs-number">138</span>, <span class="hljs-number">107</span>],<br>              [<span class="hljs-number">58</span>, <span class="hljs-number">145</span>, <span class="hljs-number">18</span>, <span class="hljs-number">65</span>, <span class="hljs-number">79</span>, <span class="hljs-number">103</span>, <span class="hljs-number">220</span>, <span class="hljs-number">255</span>, <span class="hljs-number">151</span>, <span class="hljs-number">241</span>, <span class="hljs-number">207</span>, <span class="hljs-number">206</span>, <span class="hljs-number">239</span>, <span class="hljs-number">180</span>, <span class="hljs-number">230</span>, <span class="hljs-number">115</span>],<br>              [<span class="hljs-number">150</span>, <span class="hljs-number">172</span>, <span class="hljs-number">116</span>, <span class="hljs-number">34</span>, <span class="hljs-number">231</span>, <span class="hljs-number">173</span>, <span class="hljs-number">53</span>, <span class="hljs-number">128</span>, <span class="hljs-number">226</span>, <span class="hljs-number">248</span>, <span class="hljs-number">55</span>, <span class="hljs-number">232</span>, <span class="hljs-number">28</span>, <span class="hljs-number">117</span>, <span class="hljs-number">223</span>, <span class="hljs-number">110</span>],<br>              [<span class="hljs-number">71</span>, <span class="hljs-number">240</span>, <span class="hljs-number">26</span>, <span class="hljs-number">113</span>, <span class="hljs-number">29</span>, <span class="hljs-number">41</span>, <span class="hljs-number">197</span>, <span class="hljs-number">137</span>, <span class="hljs-number">111</span>, <span class="hljs-number">183</span>, <span class="hljs-number">98</span>, <span class="hljs-number">15</span>, <span class="hljs-number">170</span>, <span class="hljs-number">24</span>, <span class="hljs-number">190</span>, <span class="hljs-number">27</span>],<br>              [<span class="hljs-number">251</span>, <span class="hljs-number">86</span>, <span class="hljs-number">62</span>, <span class="hljs-number">75</span>, <span class="hljs-number">198</span>, <span class="hljs-number">210</span>, <span class="hljs-number">121</span>, <span class="hljs-number">32</span>, <span class="hljs-number">154</span>, <span class="hljs-number">219</span>, <span class="hljs-number">192</span>, <span class="hljs-number">253</span>, <span class="hljs-number">120</span>, <span class="hljs-number">205</span>, <span class="hljs-number">90</span>, <span class="hljs-number">243</span>],<br>              [<span class="hljs-number">31</span>, <span class="hljs-number">221</span>, <span class="hljs-number">168</span>, <span class="hljs-number">51</span>, <span class="hljs-number">136</span>, <span class="hljs-number">7</span>, <span class="hljs-number">199</span>, <span class="hljs-number">49</span>, <span class="hljs-number">177</span>, <span class="hljs-number">19</span>, <span class="hljs-number">1</span>, <span class="hljs-number">89</span>, <span class="hljs-number">39</span>, <span class="hljs-number">129</span>, <span class="hljs-number">235</span>, <span class="hljs-number">95</span>],<br>              [<span class="hljs-number">96</span>, <span class="hljs-number">81</span>, <span class="hljs-number">127</span>, <span class="hljs-number">169</span>, <span class="hljs-number">25</span>, <span class="hljs-number">181</span>, <span class="hljs-number">74</span>, <span class="hljs-number">13</span>, <span class="hljs-number">45</span>, <span class="hljs-number">229</span>, <span class="hljs-number">122</span>, <span class="hljs-number">159</span>, <span class="hljs-number">147</span>, <span class="hljs-number">201</span>, <span class="hljs-number">156</span>, <span class="hljs-number">238</span>],<br>              [<span class="hljs-number">160</span>, <span class="hljs-number">224</span>, <span class="hljs-number">59</span>, <span class="hljs-number">77</span>, <span class="hljs-number">174</span>, <span class="hljs-number">42</span>, <span class="hljs-number">244</span>, <span class="hljs-number">176</span>, <span class="hljs-number">200</span>, <span class="hljs-number">234</span>, <span class="hljs-number">187</span>, <span class="hljs-number">60</span>, <span class="hljs-number">132</span>, <span class="hljs-number">83</span>, <span class="hljs-number">153</span>, <span class="hljs-number">97</span>],<br>              [<span class="hljs-number">23</span>, <span class="hljs-number">43</span>, <span class="hljs-number">4</span>, <span class="hljs-number">126</span>, <span class="hljs-number">186</span>, <span class="hljs-number">119</span>, <span class="hljs-number">214</span>, <span class="hljs-number">38</span>, <span class="hljs-number">225</span>, <span class="hljs-number">105</span>, <span class="hljs-number">21</span>, <span class="hljs-number">99</span>, <span class="hljs-number">85</span>, <span class="hljs-number">33</span>, <span class="hljs-number">12</span>, <span class="hljs-number">125</span>]]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">SubBytes</span>(<span class="hljs-params">self, state, inv=<span class="hljs-literal">False</span></span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        对输入的state进行S盒置换。</span><br><span class="hljs-string">        state是一个16个字节元素的列表，以一维形式访问</span><br><span class="hljs-string">        返回值是变换后的二维列表</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        <span class="hljs-keyword">for</span> i,v <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(state):<br>            <span class="hljs-keyword">if</span> inv == <span class="hljs-literal">False</span>:<br>                state[i] = <span class="hljs-variable language_">self</span>.S_BOX[v&gt;&gt;<span class="hljs-number">4</span>][v&amp;<span class="hljs-number">0xf</span>]<br>            <span class="hljs-keyword">else</span>:<br>                state[i] = <span class="hljs-variable language_">self</span>.S_BOX_INV[v&gt;&gt;<span class="hljs-number">4</span>][v&amp;<span class="hljs-number">0xf</span>]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">ShiftRows</span>(<span class="hljs-params">self, state, inv=<span class="hljs-literal">False</span></span>):<br>        <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        state是一个16个字节元素的列表，以一维形式访问</span><br><span class="hljs-string">        &quot;&quot;&quot;</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            <span class="hljs-keyword">if</span> inv == <span class="hljs-literal">False</span>:<br>                state[i::<span class="hljs-number">4</span>] = state[i::<span class="hljs-number">4</span>][i:] + state[i::<span class="hljs-number">4</span>][:i] <span class="hljs-comment"># 左移</span><br>            <span class="hljs-keyword">else</span>:<br>                state[i::<span class="hljs-number">4</span>] = state[i::<span class="hljs-number">4</span>][-i:] + state[i::<span class="hljs-number">4</span>][:-i]   <span class="hljs-comment"># 右移</span><br><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">MixColumns</span>(<span class="hljs-params">self, state, inv=<span class="hljs-literal">False</span></span>):<br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">GFmul_by_2</span>(<span class="hljs-params">n</span>):<br>            <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">            这个计算是有数学意义的，不是简单的乘法运算，原理可自行了解GF域的定义。</span><br><span class="hljs-string">            :param n:</span><br><span class="hljs-string">            :return:</span><br><span class="hljs-string">            &quot;&quot;&quot;</span><br>            s = (n &lt;&lt; <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xff</span><br>            <span class="hljs-keyword">if</span> n &amp; <span class="hljs-number">128</span>:<br>                s ^= <span class="hljs-number">0x1b</span><br>            <span class="hljs-keyword">return</span> s<br><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">GFmul_by_3</span>(<span class="hljs-params">n</span>):<br>            <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">            :param n:</span><br><span class="hljs-string">            :return:</span><br><span class="hljs-string">            &quot;&quot;&quot;</span><br>            <span class="hljs-keyword">return</span> n ^ GFmul_by_2(n)<br><br>        <span class="hljs-keyword">def</span> <span class="hljs-title function_">mix_column</span>(<span class="hljs-params">c</span>):<br>            <span class="hljs-keyword">return</span> [<br>                GFmul_by_2(c[<span class="hljs-number">0</span>]) ^ GFmul_by_3(c[<span class="hljs-number">1</span>]) ^ c[<span class="hljs-number">2</span>] ^ c[<span class="hljs-number">3</span>],<br>                GFmul_by_2(c[<span class="hljs-number">1</span>]) ^ GFmul_by_3(c[<span class="hljs-number">2</span>]) ^ c[<span class="hljs-number">3</span>] ^ c[<span class="hljs-number">0</span>],<br>                GFmul_by_2(c[<span class="hljs-number">2</span>]) ^ GFmul_by_3(c[<span class="hljs-number">3</span>]) ^ c[<span class="hljs-number">0</span>] ^ c[<span class="hljs-number">1</span>],<br>                GFmul_by_2(c[<span class="hljs-number">3</span>]) ^ GFmul_by_3(c[<span class="hljs-number">0</span>]) ^ c[<span class="hljs-number">1</span>] ^ c[<span class="hljs-number">2</span>]<br>            ]<br><br>        <span class="hljs-keyword">if</span> inv == <span class="hljs-literal">False</span>:<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>, <span class="hljs-number">4</span>):<br>                state[i:i + <span class="hljs-number">4</span>] = mix_column(state[i:i + <span class="hljs-number">4</span>])<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-number">16</span>, <span class="hljs-number">4</span>):<br>                <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>                    state[i:i + <span class="hljs-number">4</span>] = mix_column(state[i:i + <span class="hljs-number">4</span>])<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">AddRoundKey</span>(<span class="hljs-params">self, state, key</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            state[i] ^= key[i]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">key_expansion</span>(<span class="hljs-params">self, key</span>):<br>        key = <span class="hljs-built_in">bytearray</span>(key)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span> * <span class="hljs-number">4</span>):<br>            r = key[-<span class="hljs-number">4</span>:]<br>            r = <span class="hljs-built_in">bytearray</span>(r)<br>            <span class="hljs-keyword">if</span> i % <span class="hljs-number">4</span> == <span class="hljs-number">0</span>:  <span class="hljs-comment"># 对上一轮最后4字节，先循环左移一位，再S-box置换、轮常数异或，从而计算出当前新一轮最前4字节</span><br>                <span class="hljs-keyword">for</span> j, v <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(r[<span class="hljs-number">1</span>:] + r[:<span class="hljs-number">1</span>]):<br>                    r[j] = <span class="hljs-variable language_">self</span>.S_BOX[v &gt;&gt; <span class="hljs-number">4</span>][v &amp; <span class="hljs-number">0xf</span>] ^ (<span class="hljs-variable language_">self</span>.RCON[i // <span class="hljs-number">4</span>] <span class="hljs-keyword">if</span> j == <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-number">0</span>)<br><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>                key.append(key[-<span class="hljs-number">16</span>] ^ r[j])<br><br>        <span class="hljs-keyword">return</span> key<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">self, b, expanded_key</span>):<br>        <span class="hljs-variable language_">self</span>.AddRoundKey(b, expanded_key)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>):<br>            <span class="hljs-variable language_">self</span>.SubBytes(b)<br>            <span class="hljs-variable language_">self</span>.ShiftRows(b)<br>            <span class="hljs-variable language_">self</span>.MixColumns(b)<br>            <span class="hljs-variable language_">self</span>.AddRoundKey(b, expanded_key[i*<span class="hljs-number">16</span>:])<br><br>        <span class="hljs-variable language_">self</span>.SubBytes(b)<br>        <span class="hljs-variable language_">self</span>.ShiftRows(b)<br>        <span class="hljs-variable language_">self</span>.AddRoundKey(b, expanded_key[-<span class="hljs-number">16</span>:])<br>        <span class="hljs-keyword">return</span> b<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">self, b, expanded_key</span>):<br>        <span class="hljs-variable language_">self</span>.AddRoundKey(b, expanded_key[-<span class="hljs-number">16</span>:])<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>):<br>            <span class="hljs-variable language_">self</span>.ShiftRows(b, inv=<span class="hljs-literal">True</span>)<br>            <span class="hljs-variable language_">self</span>.SubBytes(b, inv=<span class="hljs-literal">True</span>)<br>            <span class="hljs-variable language_">self</span>.AddRoundKey(b, expanded_key[i*<span class="hljs-number">16</span>:])<br>            <span class="hljs-variable language_">self</span>.MixColumns(b, inv=<span class="hljs-literal">True</span>)<br><br>        <span class="hljs-variable language_">self</span>.ShiftRows(b, inv=<span class="hljs-literal">True</span>)<br>        <span class="hljs-variable language_">self</span>.SubBytes(b, inv=<span class="hljs-literal">True</span>)<br>        <span class="hljs-variable language_">self</span>.AddRoundKey(b, expanded_key)<br>        <span class="hljs-keyword">return</span> b<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">aes_ecb</span>(<span class="hljs-params">self,<span class="hljs-built_in">type</span>, key, msg</span>):<br>        expanded_key = <span class="hljs-variable language_">self</span>.key_expansion(key)<br>        b = <span class="hljs-built_in">bytearray</span>(msg)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> == <span class="hljs-number">0</span>:<br>            b = <span class="hljs-built_in">bytearray</span>(msg+<span class="hljs-string">b&#x27;\x00&#x27;</span>*(<span class="hljs-number">16</span> - <span class="hljs-built_in">len</span>(msg)%<span class="hljs-number">16</span>))<br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(b), <span class="hljs-number">16</span>):<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> == <span class="hljs-number">0</span>:<br>                b[i:i+<span class="hljs-number">16</span>] = <span class="hljs-variable language_">self</span>.encrypt(b[i:i+<span class="hljs-number">16</span>], expanded_key)<br>            <span class="hljs-keyword">else</span>:<br>                b[i:i+<span class="hljs-number">16</span>] = <span class="hljs-variable language_">self</span>.decrypt(b[i:i+<span class="hljs-number">16</span>], expanded_key)<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(b)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    key = <span class="hljs-string">b&#x27;SYCLOVERSYCLOVER&#x27;</span><br>    aes = AES()<br>    dec = aes.aes_ecb(<span class="hljs-number">1</span>, <span class="hljs-built_in">bytearray</span>(key), <span class="hljs-string">b&#x27;\x99\xe8\xb8\x01\xc8\x82\x51\x93\x12\xee\x89\x64\xe7\xef\x63\x8d\x51\xdf\x5d\x78\x39\xaa\x39\x62\xa0\xb4\x50\x30\x47\x30\x21\x06&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Decrypted:&#x27;</span>, dec)	<span class="hljs-comment">#SYC&#123;B3l1eue_Th@t_y0u__l3aRn_Aes&#125;</span><br></code></pre></td></tr></table></figure>

<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250705173544896.png" alt="image-20250705173544896">











<h1 id="blasting-master"><a href="#blasting-master" class="headerlink" title="blasting_master"></a>blasting_master</h1><p>​		无壳64位程序，IDA打开看到main函数，先是等待输入，然后循环，最后比较。我是调试了一遍，变量名变成了这个样子。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250706172043004.png" alt="image-20250706172043004">

<p>​	先看循环的逻辑，进入<strong>sub_555555555464</strong>函数，其中有个全局变量<strong>dword_555555558040</strong>，初始值为0，函数每运行一次加1，<strong>v4</strong>存储输入字符串中的4个连续字符，其起始地址由<strong>8040</strong>变量决定。很明显看出来，每运行一次这个函数，就会往后1个字符。比如输入是<strong>SYC{AAA}</strong>，那么第一次就是取<strong>SYC{</strong>，第二次就是<strong>YC{A</strong>。</p>
<p>​	<strong>sub_5555555553E2</strong>函数里面的代码比较陌生，还是问AI才知道这是使用OpenSSL库计算MD5值的函数。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">__int64 __fastcall <span class="hljs-title function_">sub_5555555553E2</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *a1, __int64 a2)</span><br>&#123;<br>  __int64 v2; <span class="hljs-comment">// rax</span><br>  <span class="hljs-type">size_t</span> v3; <span class="hljs-comment">// rax</span><br>  __int64 v5; <span class="hljs-comment">// [rsp+18h] [rbp-8h]</span><br><br>  v5 = EVP_MD_CTX_new();<br>  v2 = EVP_md5();<br>  EVP_DigestInit_ex(v5, v2, <span class="hljs-number">0LL</span>);<br>  v3 = <span class="hljs-built_in">strlen</span>(a1);<br>  EVP_DigestUpdate(v5, a1, v3);<br>  EVP_DigestFinal_ex(v5, a2, <span class="hljs-number">0LL</span>);<br>  <span class="hljs-keyword">return</span> EVP_MD_CTX_free(v5);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>​	再下面就是16次循环处理得到的MD5值了，逻辑很清楚，只需要注意<strong>s2</strong>是字节数组。那这个函数就很清楚了，每次截取4个字符，计算MD5值，进行加密，然后存储到内存空间s2中去，<strong>dword_555555558040</strong>存储的就是MD5值个数。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250706172211561.png" alt="image-20250706172211561">

<p>​	退回到main函数，循环结束条件是和<strong>byte_5555555582DE</strong>的值有关的，其非0即可停止循环。查看内存空间看到，该变量在s2尾部，因为每次写入的MD5是16个字节长度，即0x10，所以只有当写入<code>(0x82E0-0x8060)/0x10=28</code>个MD5值后，s2才会溢出到这个地方，使得循环退出。那我们也能得知到flag的长度就是3+28&#x3D;31个字符长度。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250706173208026.png" alt="image-20250706173208026">

<p>​	接下来的比较就没什么好说的了。取出MD5密文，解密后进行爆破即可。根据题目名称和提示也能猜到这题就是考爆破的，代码如下。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br>en_md5 = <span class="hljs-string">&quot;b250a0bc3a7f546d96070f719a72eba5a0b571a46ab8bafae431c3715429a759202b1321bd675f8d653a0227084f929cb57cdf6934b8822df6ca7a659863dc512a34974ff8bc231f38a8a62fa90d644cac2ff9f52db191a8d576d92dc6ac2e6932d5641dc13cecf52c90edf4178b554ce46c3bb3da29c07b39df9273fcc9c2a86811222b643f129b95732a05d33f2e33f185ed077b868f622d7903ac80cef5b2a00cf7e1c50e6327d16523ea5a1c020b32ba1fe5c722a56677ea5be464ab8b60b6df00dcf76d93ec2f2f680750e0d11a3fc64e2ec6bbae0840d85b11b5dc15357f63493e5b9c0dfc0db680b72b00ef3c0c2feb864457749e5f1f8ba1c901f1d8f49282956f85d215221ff09fd1ab51399ab6c4dafb388de68c57195e94da57ccf0b90a4a1782fcc54f4b5aa5f4e53efa3a0af4b48e7f25847590cd3587ebc3ce812b86c9167e85682df1db8e7415cf955107885e1be937c95bba61eb9f7be48910f06ecd7571ad09745849a3f533837522951be33c48055cada86bfd41ebafc60228c65ecf36ae50ce93f270889d3f4a9f86e76764b002960cab9feb4b034492de6cf4ce324f4f38e25259ca954a11d830a27bd53ae611da3a4a3361396526d278bcedbda58b2b874c95472502ba833ddce46aad67dd22b1bd2b7c53113cd923063d20ba28c82d8951576382a0c8a8de2961c15351b0bc3704eec9358aa8a266ba6f24b63f62416d1046cb061239d90ef9dc19a765b8c040bef6999aaf0216374da5754c424b1af052da38f36ba91adcfa80b060b1fd737b78d9628326bf163371796f112fe9a7bb4646d68ff6217efc6812866bfc51c9707a74bc8f6e0b86426f5cfdf74e2771fe37e6c86247fcd56cba5cd9295a73aec38ff0469532422dd0&quot;</span><br>flag = <span class="hljs-string">&quot;SYC&#123;&quot;</span><br>de_md5 = []<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(en_md5)//<span class="hljs-number">32</span>):<br>    tp_str = en_md5[i*<span class="hljs-number">32</span>:i*<span class="hljs-number">32</span>+<span class="hljs-number">32</span>]<br>    t = [<span class="hljs-built_in">int</span>(tp_str[j:j+<span class="hljs-number">2</span>], <span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(tp_str), <span class="hljs-number">2</span>)]<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        t[j] = t[j] - (j % <span class="hljs-number">15</span>) * <span class="hljs-number">82</span><br>        t[j] = t[j] % <span class="hljs-number">256</span><br>        <span class="hljs-keyword">while</span> (t[j] % <span class="hljs-number">7</span> != <span class="hljs-number">0</span>):<br>            t[j] += <span class="hljs-number">256</span><br>        t[j] //= <span class="hljs-number">7</span><br>        t[j] ^= (j + <span class="hljs-number">42</span>)<br>    md5_str = <span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-built_in">hex</span>(t[j])[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">2</span>) <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>))<br>    de_md5.append(md5_str)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(de_md5)):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">127</span>):<br>        test_str = flag[-<span class="hljs-number">3</span>:] + <span class="hljs-built_in">chr</span>(j)<br>        test_md5 = hashlib.md5(test_str.encode()).hexdigest()<br>        <span class="hljs-keyword">if</span> test_md5 == de_md5[i]:<br>            flag += <span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-keyword">break</span><br><br><span class="hljs-built_in">print</span>(flag)	<span class="hljs-comment">#SYC&#123;W0w!y0u_@re_th3_BeSt_blasting_Exp3rt!!&#125;</span><br></code></pre></td></tr></table></figure>



<h1 id="ez-hook"><a href="#ez-hook" class="headerlink" title="ez_hook"></a>ez_hook</h1><p>​	无壳64位，打开看到一个简单的反调试，直接把<strong>jz</strong>（74）改为<strong>jmp</strong>（EB）。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250706185725865.png" alt="image-20250706185725865">

<p>​	然后看到<strong>sub_4016E4</strong>函数，调试分析其输出的<strong>v6</strong>变量，应该是对flag进行顺序打乱的，这个简单，通过测试输入，得到输出就可以固定“映射方式”。</p>
<p>​	然后准备调试<strong>sub_4017E0</strong>函数的时候，发现根本没进去，怎么回事！原来在4016E4函数的结尾对内存中的函数进行了修改，在<strong>sub_4017E0</strong>函数头加了个jmp跳转，相对跳转（E9），跳到了<strong>sub_4018B4</strong>函数头。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250706190048229.png" alt="image-20250706190048229">

<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c">BOOL __fastcall <span class="hljs-title function_">sub_401911</span><span class="hljs-params">(_BYTE *a1, <span class="hljs-type">int</span> a2)</span><br>&#123;<br>  __int64 v3; <span class="hljs-comment">// [rsp+2Bh] [rbp-15h]</span><br>  DWORD flOldProtect; <span class="hljs-comment">// [rsp+34h] [rbp-Ch] BYREF</span><br>  SIZE_T dwSize; <span class="hljs-comment">// [rsp+38h] [rbp-8h]</span><br><br>  dwSize = <span class="hljs-number">5LL</span>;		<span class="hljs-comment">//表示将要操作的内存区域大小</span><br>    <br>    <span class="hljs-comment">//修改内存保护，改变内存区域 a1 所指向的 5 字节的保护属性，0x40u表示将内存区域设为可写（PAGE_EXECUTE_READWRITE），这样就可以修改内存。</span><br>  VirtualProtect(a1, <span class="hljs-number">5uLL</span>, <span class="hljs-number">0x40u</span>, &amp;flOldProtect);<br>    <br>    <span class="hljs-comment">//构造指令，E9是jmp的操作码，后一行是在算地址偏移，-5是因为程序写入跳转指令已经占据了5字节。</span><br>  LOBYTE(v3) = <span class="hljs-number">0xE9</span>;<br>  *(_DWORD *)((<span class="hljs-type">char</span> *)&amp;v3 + <span class="hljs-number">1</span>) = a2 - (_DWORD)a1 - <span class="hljs-number">5</span>;<br>    <br>    <span class="hljs-comment">//修改内存内容，先写4字节，再写1字节。</span><br>  *(_DWORD *)a1 = v3;<br>  a1[<span class="hljs-number">4</span>] = BYTE4(v3);<br>    <br>    <span class="hljs-comment">//恢复内存保护。</span><br>  <span class="hljs-keyword">return</span> VirtualProtect(a1, dwSize, flOldProtect, &amp;flOldProtect);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>​	而<strong>sub_4018B4</strong>函数很明显看出来是异或7，所以解密脚本如下。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">enc = <span class="hljs-string">&quot;zoXpih^lhX6soX7lr~DTHtGpX|&quot;</span><br><span class="hljs-built_in">input</span> = <span class="hljs-string">&quot;SYC&#123;abcdefghijklmnopqrstu&#125;&quot;</span><br>encst = <span class="hljs-string">&quot;&#125;rnjfbYusqomkigecaCStplhd&#123;&quot;</span>		<span class="hljs-comment">#调试提取v6的值得到</span><br>enflag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>    enflag += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(enc[i]) ^ <span class="hljs-number">7</span>)<br>flag = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enflag)):<br>    flag += enflag[encst.index(<span class="hljs-built_in">input</span>[i])]<br><span class="hljs-built_in">print</span>(flag)								<span class="hljs-comment">#SYC&#123;you_kn0w_wh@t_1s_hoOk&#125;</span><br></code></pre></td></tr></table></figure>

<p>​	其实也可以看看<strong>sub_4016E4</strong>函数的置换逻辑，首先外循环是3轮，<strong>v7</strong>是步长，先后是4、2、0。<strong>Enflag</strong>（简称e）是从下标0开始，到结束依次赋值的，<strong>v12</strong>就是其下标。</p>
<p>​	算了，细究起来发现前面的<strong>sub_40167D</strong>函数对flag也进行了打乱，4016E4是进行第二次打乱了。有点复杂，不想看啊，不想调了，就这样吧！</p>
<p>​	找了一个别人的脚本，包括顺序还原的，随便看看吧。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">c=<span class="hljs-string">&#x27;zoXpih^lhX6soX7lr~DTHtGpX|&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">reverse_flag</span>(<span class="hljs-params">a3, a2</span>):<br>    v8 = <span class="hljs-built_in">len</span>(a3)  <span class="hljs-comment"># a3 的长度</span><br>    a1 = [<span class="hljs-string">&#x27;&#x27;</span>] * v8  <span class="hljs-comment"># 初始化 a1 为长度为 v8 的空字符串列表</span><br>    v12 = <span class="hljs-number">0</span>  <span class="hljs-comment"># 计数器，用于跟踪读取 a3 的位置</span><br> 	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(a2):<br>        v9 = i<br>        v7 = <span class="hljs-number">2</span> * (a2 - i - <span class="hljs-number">1</span>)<br>        j = <span class="hljs-number">2</span> * i<br>        <span class="hljs-keyword">while</span> v9 &lt; v8:<br>            <span class="hljs-keyword">if</span> v7:<br>                a1[v9] = a3[v12]<br>                v12 += <span class="hljs-number">1</span><br>            v10 = v7 + v9<br>            <span class="hljs-keyword">if</span> v10 &gt;= v8:<br>                <span class="hljs-keyword">break</span><br>            <span class="hljs-keyword">if</span> j:<br>                a1[v10] = a3[v12]<br>                v12 += <span class="hljs-number">1</span><br>            v9 = j + v10<br>    <span class="hljs-keyword">return</span> a1<br>a2 = <span class="hljs-number">3</span>  <span class="hljs-comment"># 已知的 a2 值</span><br>a3=[<span class="hljs-number">0</span>]*<span class="hljs-built_in">len</span>(c)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(c)):<br>    a3[i]=<span class="hljs-built_in">ord</span>(c[i]) ^ <span class="hljs-number">7</span><br>reversed_flag = reverse_flag(a3, a2)<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> reversed_flag:<br>    flag+=<span class="hljs-built_in">chr</span>(a)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Reversed flag:&quot;</span>, flag[::-<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure>



<h1 id="致我的星星"><a href="#致我的星星" class="headerlink" title="致我的星星"></a>致我的星星</h1><p>​	<strong>好玩好玩！！！不玩包后悔的！！！强烈建议多做一会，这样就能少后悔一点。最好自己做出来</strong></p>
<p>​	<strong>js</strong>逆向，第一次做，看到<strong>index.js</strong>，没有使用很难的东西，基础语法会点就能看懂了。还是解析一下。</p>
<p>​	<strong>funclick</strong>函数是点击后更新界面的函数，然后<strong>fl</strong>被设置为处理键盘输入的响应函数，我们可以看到其比较MD5值后会调用<strong>typewrite</strong>函数，这是输出成功后提示信息的函数。所以我们的目标就是搞定这个MD5的字符串是什么。但是MD5爆破是不成功的（直接爆的也是狠人），只有继续看剩下的代码也没有什么提示了。</p>
<p>​	从197行开始，其实就是“多余”的代码，当然，没有必要肯定是不会放这段代码的（<strong>反正我是没自己做出了，中间有脑洞没风暴成功！最后我是这样告诉自己的。</strong>）很明显，221行到274行是在做迷宫的初始化，<del>这我都明白</del>，为什么告诉了行列是10*20，结果data只有180个字符，还得自己补？这是我的第一个犹豫点，我也做过补了的尝试，继续往后看。</p>
<p>​	第259到274行是纯提示选手自己计算出S和Y的坐标，但是有两个S和Y，我脑残了，这没能和后面联系起来，我的问题，短时间刷题刷多了是这样的。</p>
<p>​	md，使用z3-solver还出了个错，之前脑残下了个z3包（不知道干嘛的），删也没删干净，污染了python环境，处理又浪费我的时间。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment">#声明整数变量</span><br>a1, a2, a3, a4, a5, a6, a7, a8 = Ints(<span class="hljs-string">&#x27;a1 a2 a3 a4 a5 a6 a7 a8&#x27;</span>)<br><br><span class="hljs-comment"># 创建求解器</span><br>s = Solver()<br><br><span class="hljs-comment"># 添加方程组</span><br>s.add(<span class="hljs-number">43654</span>*a1 - <span class="hljs-number">57003</span>*a2 -<span class="hljs-number">3158</span>*a3 + <span class="hljs-number">30120</span>*a4 -<span class="hljs-number">58621</span>*a5 -<span class="hljs-number">41947</span>*a6 +<span class="hljs-number">122237</span>*a7 +<span class="hljs-number">129534</span>*a8 == <span class="hljs-number">2594143</span>)<br>s.add(-<span class="hljs-number">48022</span>*a1 + <span class="hljs-number">18308</span>*a2 + <span class="hljs-number">52478</span>*a3 + <span class="hljs-number">69397</span>*a4  +<span class="hljs-number">49696</span>*a5 + <span class="hljs-number">12288</span>*a6 -<span class="hljs-number">40437</span>*a7 -<span class="hljs-number">23154</span>*a8 == <span class="hljs-number">651137</span>)<br>s.add(<span class="hljs-number">124109</span>*a1  +<span class="hljs-number">58952</span>*a2 + <span class="hljs-number">16645</span>*a3 -<span class="hljs-number">17531</span>*a4 + <span class="hljs-number">53139</span>*a5  +<span class="hljs-number">49937</span>*a6  + <span class="hljs-number">3282</span>*a7   +<span class="hljs-number">7656</span>*a8 == <span class="hljs-number">2071815</span>)<br>s.add(<span class="hljs-number">108286</span>*a1 + <span class="hljs-number">118886</span>*a2 +<span class="hljs-number">116876</span>*a3   +<span class="hljs-number">2281</span>*a4 -<span class="hljs-number">64590</span>*a5  -<span class="hljs-number">3021</span>*a6 + <span class="hljs-number">13386</span>*a7 -<span class="hljs-number">56070</span>*a8 == <span class="hljs-number">703</span>)<br>s.add(<span class="hljs-number">105983</span>*a1 + <span class="hljs-number">8794</span>*a2 + <span class="hljs-number">31851</span>*a3 -<span class="hljs-number">35052</span>*a4  -<span class="hljs-number">7880</span>*a5  + <span class="hljs-number">2183</span>*a6 + <span class="hljs-number">47575</span>*a7 +<span class="hljs-number">107236</span>*a8 == <span class="hljs-number">2511919</span>)<br>s.add(-<span class="hljs-number">38005</span>*a1 -<span class="hljs-number">6833</span>*a2 +<span class="hljs-number">107897</span>*a3 +<span class="hljs-number">119771</span>*a4 +<span class="hljs-number">124322</span>*a5 + <span class="hljs-number">13335</span>*a6+ <span class="hljs-number">121590</span>*a7 -<span class="hljs-number">17434</span>*a8 == <span class="hljs-number">4816084</span>)<br>s.add(<span class="hljs-number">60696</span>*a1 +<span class="hljs-number">95253</span>*a2 +<span class="hljs-number">101581</span>*a3 + <span class="hljs-number">93822</span>*a4 +<span class="hljs-number">112989</span>*a5  +<span class="hljs-number">65643</span>*a6  +<span class="hljs-number">45639</span>*a7 + <span class="hljs-number">26705</span>*a8 == <span class="hljs-number">5330538</span>)<br>s.add(<span class="hljs-number">49019</span>*a1 +<span class="hljs-number">72343</span>*a2 -<span class="hljs-number">21814</span>*a3  +<span class="hljs-number">85020</span>*a4 -<span class="hljs-number">62332</span>*a5  +<span class="hljs-number">99828</span>*a6  +  <span class="hljs-number">587</span>*a7 -<span class="hljs-number">65119</span>*a8 ==  <span class="hljs-number">505173</span>)<br><br><span class="hljs-comment"># 检查可解性</span><br><span class="hljs-keyword">if</span> s.check() == sat:<br>    model = s.model()<br>    <span class="hljs-keyword">for</span> v <span class="hljs-keyword">in</span> [a1, a2, a3, a4, a5, a6, a7, a8]:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;v&#125;</span> = <span class="hljs-subst">&#123;model[v]&#125;</span>&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;无解&quot;</span>)<br>    <br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">a1 = 3</span><br><span class="hljs-string">a2 = 4</span><br><span class="hljs-string">a3 = 6</span><br><span class="hljs-string">a4 = 8</span><br><span class="hljs-string">a5 = 13</span><br><span class="hljs-string">a6 = 13</span><br><span class="hljs-string">a7 = 15</span><br><span class="hljs-string">a8 = 15</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure>

<p>​	考脑洞吗？？？😅😅😅<del>我咋感觉这个index.js文件里面的逻辑都有问题啊，执行起来根本通关不了。</del></p>
<p>​	从277行到结尾都是在做走迷宫的部分了，但是代码逻辑就是有问题，你会发现xy坐标根本没有更新。选手要从错误的代码中，猜出出题人正确的思路！</p>
<p>​	在<strong>findtheway</strong>函数中会直接进入死循环，输入正确的答案，<strong>findtheway</strong>控制台调用也会进入死循环，这就不是让我玩的，是让我看的！</p>
<p>​	这也就算了，从明显的错误中猜到正确的思路，像我这种小白都能看出错误，难道出题人看不出来吗？<del>这里不算什么，我也能看出来要跑两次。</del>实际上，第一次做这种题，被他这个错误代码逻辑给吓住了，我都想举报题错了，很难有继续思考的想法了，很想找WP验证我的“举报”是正确的！</p>
<p>​	无所谓，我其实还在尝试，两个迷宫就两个迷宫，输两次就输两次。但是<strong>最完蛋的是</strong>迷宫的提示信息我没转过弯来，忘记了<strong>第i行对应的是数组中第(i-1)行，第i列对应的是数组中的第(i-1)列</strong>，导致我迷宫复现错误，这种东西一时半会真反应不过来，也可能是前面也就脑子过载了，我就不想浪费时间了，就直接看WP了。</p>
<p>​	挺遗憾的，没自己独立做出了，少了一份感动……</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250706215042186.png" alt="image-20250706215042186">

<p>​	以上是我的思维过程和一些吐槽，下面是完美做法。</p>
<p>​	先补充完data到200字节，补“#”。然后求解出S和Y的坐标，编写<strong>js</strong>脚本得到迷宫字符串，我喜欢通过python输出迷宫。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> data = [<br>    <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>,<br>    <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>,<br>    <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>,<br>    <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>,<br>    <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>,<br>    <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>,<br>    <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>,<br>    <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>,<br>    <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>,<br>    <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span>, <span class="hljs-string">&#x27;#&#x27;</span><br>];<br><br><span class="hljs-keyword">let</span> coordinates = [<br>    [<span class="hljs-number">1</span>, <span class="hljs-number">11</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">12</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">13</span>], [<span class="hljs-number">1</span>, <span class="hljs-number">14</span>],<br>    [<span class="hljs-number">2</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">4</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">11</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">12</span>], [<span class="hljs-number">2</span>, <span class="hljs-number">14</span>],<br>    [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>], [<span class="hljs-number">3</span>, <span class="hljs-number">14</span>],<br>    [<span class="hljs-number">5</span>, <span class="hljs-number">7</span>], [<span class="hljs-number">5</span>, <span class="hljs-number">8</span>], [<span class="hljs-number">5</span>, <span class="hljs-number">12</span>], [<span class="hljs-number">5</span>, <span class="hljs-number">14</span>], [<span class="hljs-number">5</span>, <span class="hljs-number">15</span>], [<span class="hljs-number">5</span>, <span class="hljs-number">18</span>],<br>    [<span class="hljs-number">6</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">6</span>, <span class="hljs-number">2</span>], [<span class="hljs-number">6</span>, <span class="hljs-number">4</span>], [<span class="hljs-number">6</span>, <span class="hljs-number">5</span>], [<span class="hljs-number">6</span>, <span class="hljs-number">7</span>], [<span class="hljs-number">6</span>, <span class="hljs-number">8</span>], [<span class="hljs-number">6</span>, <span class="hljs-number">11</span>], [<span class="hljs-number">6</span>, <span class="hljs-number">15</span>],<br>    [<span class="hljs-number">7</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">7</span>, <span class="hljs-number">5</span>], [<span class="hljs-number">7</span>, <span class="hljs-number">11</span>], [<span class="hljs-number">7</span>, <span class="hljs-number">12</span>], [<span class="hljs-number">7</span>, <span class="hljs-number">13</span>], [<span class="hljs-number">7</span>, <span class="hljs-number">14</span>], [<span class="hljs-number">7</span>, <span class="hljs-number">15</span>], [<span class="hljs-number">7</span>, <span class="hljs-number">16</span>],<br>    [<span class="hljs-number">8</span>, <span class="hljs-number">1</span>], [<span class="hljs-number">8</span>, <span class="hljs-number">12</span>], [<span class="hljs-number">8</span>, <span class="hljs-number">13</span>], [<span class="hljs-number">8</span>, <span class="hljs-number">15</span>], [<span class="hljs-number">8</span>, <span class="hljs-number">18</span>],<br>    [<span class="hljs-number">9</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">9</span>, <span class="hljs-number">4</span>], [<span class="hljs-number">9</span>, <span class="hljs-number">6</span>], [<span class="hljs-number">9</span>, <span class="hljs-number">7</span>], [<span class="hljs-number">9</span>, <span class="hljs-number">8</span>]<br>];<br><br><span class="hljs-keyword">let</span> cols = <span class="hljs-number">20</span>;<br><span class="hljs-keyword">let</span> rows = <span class="hljs-number">10</span>;<br><br>coordinates.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">[row, col]</span>) =&gt;</span> &#123;<br>   <br>    <span class="hljs-keyword">const</span> index = row * cols + col;<br>    <br>    <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span> &amp;&amp; index &lt; data.<span class="hljs-property">length</span>) &#123;<br>        data[index] = <span class="hljs-string">&#x27;*&#x27;</span>;<br>    &#125;<br>&#125;);<br><br>data[<span class="hljs-number">2</span>*cols + <span class="hljs-number">12</span>] = <span class="hljs-string">&#x27;S&#x27;</span>;<br>data[<span class="hljs-number">7</span>*cols + <span class="hljs-number">12</span>] = <span class="hljs-string">&#x27;S&#x27;</span>;<br>data[<span class="hljs-number">3</span>*cols + <span class="hljs-number">14</span>] = <span class="hljs-string">&#x27;Y&#x27;</span>;<br>data[<span class="hljs-number">5</span>*cols + <span class="hljs-number">14</span>] = <span class="hljs-string">&#x27;Y&#x27;</span>;<br><br><span class="hljs-keyword">let</span> map = data.<span class="hljs-title function_">slice</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(map.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;&#x27;</span>));<br></code></pre></td></tr></table></figure>

<p>​	得到迷宫后自己能够手写出来路径，第一个是STTAAARRRR，第二个迷宫是AAATTTTS，合在一起就得到了应该输入的input字符串<strong>STTAAARRRRAAATTTTS</strong>，flag为<strong>SYC{STTAAARRRRAAATTTTS}</strong>。</p>
<p>​	可以通过计算一下MD5值验证一下，实际上是要在网页中按下这些字符，然后才能跳转到正确提示页面。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250706215937333.png" alt="image-20250706215937333">







<h1 id="LinkedListModular"><a href="#LinkedListModular" class="headerlink" title="LinkedListModular"></a>LinkedListModular</h1><p>​		这题就应该放在密码板块，后面单独出一篇文章吧。</p>
<blockquote>
<p>​	公司职员发现关键数据被加密了，请帮忙解密出来，注意e和phi。flag为输入的256长度的hex字符串的md5值，并包裹flag{}提交。该题需要一些逆向基础(C实现的程序，内含链表、gmp库相关)，可与队友联合解题，也可学习些二进制基础，对以后有益。</p>
</blockquote>
<p>​	还是无壳，打开IDA查看，进到<strong>check</strong>函数分析。</p>
<p>​	<strong>saveinp</strong>分析很简单看出来，是把256位分成4个64位块，形成链表结构。</p>
<p>​	<strong>__gmp_randinit_default</strong>函数没见过，问下AI。</p>
<hr>
<blockquote>
<p><code>__gmp_randinit_default</code> 是 GNU MP（GMP）库中的一个函数，用于<strong>初始化默认的伪随机数生成器（PRNG）状态对象</strong>。这个函数是 GMP 的一部分，而 GMP 是一个用于高精度整数、浮点数和有理数运算的 C&#x2F;C++ 数学库。</p>
<p>函数原型：void __gmp_randinit_default(gmp_randstate_t state);</p>
<p>初始化后，你可以使用这个状态对象来生成伪随机 GMP 整数，例如通过 <code>mpz_urandomb</code> 或 <code>mpz_urandomm</code>。</p>
</blockquote>
<p>​	<strong>__gmpz_urandomb</strong>函数生成长度为n的随机大整数。</p>
<p>​	<strong>__gmpz_nextprime</strong>用于查找一个给定数的下一个素数。</p>
<p>​	<strong>__gmpz_sub_ui</strong>用于执行大整数减去一个无符号长整数的操作，函数原型：<code>void __gmpz_sub_ui(mpz_ptr result, mpz_srcptr op1, unsigned long int op2);</code>。</p>
<p>​	<strong>__gmpz_mul</strong>实行大整数的乘法运算，参数1是result。</p>
<p>​	<strong>__gmpz_gcd</strong>计算两个大整数的最大公约数。</p>
<p>​	<strong>__gmpz_divexact</strong>用于计算两个大整数的整除，前提是被除数能够被除数整除（即没有余数），否则会报错。</p>
<p>​	<strong>__gmpz_invert</strong>计算模逆元，参数为result、op1、op2，其中op2是模数。</p>
<p>​	<strong>__gmpz_get_ui</strong>函数获取 <code>mpz_t</code> 类型大整数的低位无符号整数部分，返回一个 <code>unsigned long</code> 值。如果大整数超出 <code>unsigned long</code> 的范围，只返回低位部分（截断高位）。</p>
<p>​	<strong>__gmpz_init_set_str</strong>用于初始化一个大整数变量并用字符串来设置它的值。</p>
<p>​	<strong>__gmpz_powm</strong>用于计算大整数的<strong>模幂运算</strong>，标准接口原型：<code>void mpz_powm(mpz_t result, const mpz_t base, const mpz_t exp, const mpz_t mod);</code>。</p>
<p>​	<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250707102347257.png" alt="image-20250707102347257"></p>
<p>​	<strong>__gmpz_get_str</strong>用于将 GMP 的多精度整数（<code>mpz_t</code> 类型）转换为字符串。</p>
<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.gif&quot;" data-lazy-src="/pictures/af78d0f39e337f6562dcfb2001f2d726/image-20250707102512708.png" alt="image-20250707102512708">

<p>​	</p>
<figure class="highlight c"><table><tr><td class="code"><pre><code class="hljs c"><span class="hljs-comment">//使用示例</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;gmp.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">gmp_randstate_t</span> state;	<span class="hljs-comment">//定义一个 GMP 随机数生成器的“状态对象”</span><br>    <span class="hljs-type">mpz_t</span> rand_num;			<span class="hljs-comment">//定义一个 GMP 多精度整数变量 rand_num，用于存储我们要作为种子的值（这里是 123456）。</span><br><br>    <span class="hljs-comment">// 初始化随机数生成器 state，使用 GMP 默认算法（通常是线性同余生成器 LCG）。</span><br>    __gmp_randinit_default(state);	<br><br>    <span class="hljs-comment">// 设置种子</span><br>    mpz_init_set_ui(rand_num, <span class="hljs-number">123456</span>);	<span class="hljs-comment">//初始化 rand_num 为 GMP 整数，并赋值为 123456</span><br>    gmp_randseed(state, rand_num);	<span class="hljs-comment">//设置随机数生成器 state 的种子为 rand_num（即 123456）。</span><br><br>    <span class="hljs-comment">// 生成一个最大为 100 的随机数</span><br>    <span class="hljs-type">mpz_t</span> result;<br>    mpz_init(result);	<span class="hljs-comment">//定义并初始化一个 GMP 多精度整数 result，用于存放生成的随机数。</span><br>    mpz_urandomm(result, state, rand_num);  <span class="hljs-comment">//使用 state 中的随机状态生成一个随机大整数 result，满足 0 &lt;= result &lt; rand_num（即小于 123456）</span><br><br>    gmp_printf(<span class="hljs-string">&quot;Random number: %Zd\n&quot;</span>, result);<br><br>    <span class="hljs-comment">// 清理内存</span><br>    mpz_clear(result);<br>    mpz_clear(rand_num);<br>    gmp_randclear(state);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>​	<strong>sprintf</strong>是用来把格式化的数据写入字符串（字符数组）中，而不是直接输出到屏幕。</p>
<p>​	<strong>fprintf</strong>是用于将格式化的数据写入指定的文件流。</p>
<hr>
<p>​	WC，密码！哎呀，难办哦。数学课，数学课！</p>
<p>​	会不了一点，加密算法都认不出来，直接看WP吧。</p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">zhike w</div><div class="post-copyright__author_desc">Welcome to bugmak's blog!!!</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://bumak.github.io/2025/07/07/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024%E2%80%94Part1/WP1/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://bumak.github.io/2025/07/07/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024%E2%80%94Part1/WP1/')">极客大挑战2024—Part1</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://ik.imagekit.io/gi6gzzr31s/wechat_code.png" target="_blank"><img class="post-qr-code-img" src="https://ik.imagekit.io/gi6gzzr31s/wechat_code.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://ik.imagekit.io/gi6gzzr31s/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="https://ik.imagekit.io/gi6gzzr31s/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://bumak.github.io/2025/07/07/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024%E2%80%94Part1/WP1/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=极客大挑战2024—Part1&amp;url=http://bumak.github.io/2025/07/07/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024%E2%80%94Part1/WP1/&amp;pic=https://w.wallhaven.cc/full/l3/wallhaven-l3mlop.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Reverse/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Reverse<span class="tagsPageCount">8</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://w.wallhaven.cc/full/l3/wallhaven-l3mlop.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2025/07/07/%E5%88%9D%E8%AF%86SEH/SEH/"><img class="prev-cover" src="https://w.wallhaven.cc/full/nk/wallhaven-nkpxq4.jpg" onerror="onerror=null;src='/img/404.gif'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">初识SEH</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2025/06/05/ISCTF2024/RE/" title="ISCTF2024"><img class="cover" src="https://images.unsplash.com/photo-1470770841072-f978cf4d019e?auto=format&fit=crop&w=800&q=80" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-06-05</div><div class="title">ISCTF2024</div></div></a></div><div><a href="/2025/06/04/BaseCTF/BaseCTF2024_RE/" title="BaseCTF2024"><img class="cover" src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=800&q=80" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-06-04</div><div class="title">BaseCTF2024</div></div></a></div><div><a href="/2025/07/07/%E5%88%9D%E8%AF%86SEH/SEH/" title="初识SEH"><img class="cover" src="https://w.wallhaven.cc/full/nk/wallhaven-nkpxq4.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-07-07</div><div class="title">初识SEH</div></div></a></div><div><a href="/2025/06/29/XYCTF2025/%E5%88%9D%E8%AF%86Unicorn/" title="初识Unicorn"><img class="cover" src="https://img.freepik.com/free-photo/programming-background-with-person-working-with-codes-computer_23-2150010125.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-06-29</div><div class="title">初识Unicorn</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> Comment</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description">这是一个专注网络安全与编程的博客，记录我的学习和生活</div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Hello-re"><span class="toc-number">1.</span> <span class="toc-text">Hello_re</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%88%E6%9D%A5%E4%B8%80%E9%81%93%E7%AD%BE%E5%88%B0%E9%A2%98"><span class="toc-number">2.</span> <span class="toc-text">先来一道签到题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B9%9F%E8%AE%B8%E4%BD%A0%E4%B9%9F%E5%90%ACjay"><span class="toc-number">3.</span> <span class="toc-text">也许你也听jay</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%A9%E6%88%91%E5%BA%B7%E5%BA%B7%E4%BD%A0%E7%9A%84%E8%B0%83%E8%AF%95"><span class="toc-number">4.</span> <span class="toc-text">让我康康你的调试</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%88%91%E5%8B%92%E4%B8%AAz3%E5%95%8A"><span class="toc-number">5.</span> <span class="toc-text">我勒个z3啊</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ezzzz"><span class="toc-number">6.</span> <span class="toc-text">ezzzz</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#CPP-flower"><span class="toc-number">7.</span> <span class="toc-text">CPP_flower</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%A7%A0-IDA-%E5%87%BD%E6%95%B0%E5%88%86%E6%9E%90%E5%8E%9F%E7%90%86%E6%A6%82%E8%BF%B0"><span class="toc-number">7.1.</span> <span class="toc-text">🧠 IDA 函数分析原理概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%8E%A7%E5%88%B6%E6%B5%81%E5%88%86%E6%9E%90%EF%BC%88Control-Flow-Analysis%EF%BC%89"><span class="toc-number">7.1.1.</span> <span class="toc-text">1. 控制流分析（Control Flow Analysis）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%A0%88%E6%8C%87%E9%92%88%E8%BF%BD%E8%B8%AA%EF%BC%88ESP-Tracking-SP-Analysis%EF%BC%89"><span class="toc-number">7.1.2.</span> <span class="toc-text">2. 栈指针追踪（ESP Tracking &#x2F; SP Analysis）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8F%AF%E8%BE%BE%E6%80%A7%E5%88%A4%E6%96%AD%EF%BC%88Code-Reachability%EF%BC%89"><span class="toc-number">7.1.3.</span> <span class="toc-text">3. 可达性判断（Code Reachability）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DH%E7%88%B1%E5%96%9D%E8%8C%B6"><span class="toc-number">8.</span> <span class="toc-text">DH爱喝茶</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A5%BD%E5%83%8F%E6%98%AFpython%EF%BC%9F"><span class="toc-number">9.</span> <span class="toc-text">好像是python？</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A5%87%E6%80%AA%E7%9A%84RC4"><span class="toc-number">10.</span> <span class="toc-text">奇怪的RC4</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%8E%A9%E5%B0%B1%E8%A1%8C%E4%BA%86"><span class="toc-number">11.</span> <span class="toc-text">玩就行了</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%95%BF%E9%A2%88%E9%B9%BF%E5%96%9C%E6%AC%A2%E5%90%83%E5%BD%A9%E8%99%B9"><span class="toc-number">12.</span> <span class="toc-text">长颈鹿喜欢吃彩虹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#AES"><span class="toc-number">13.</span> <span class="toc-text">AES!</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#blasting-master"><span class="toc-number">14.</span> <span class="toc-text">blasting_master</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ez-hook"><span class="toc-number">15.</span> <span class="toc-text">ez_hook</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%B4%E6%88%91%E7%9A%84%E6%98%9F%E6%98%9F"><span class="toc-number">16.</span> <span class="toc-text">致我的星星</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#LinkedListModular"><span class="toc-number">17.</span> <span class="toc-text">LinkedListModular</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/07/07/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024%E2%80%94Part1/WP1/" title="极客大挑战2024—Part1"><img src="https://w.wallhaven.cc/full/l3/wallhaven-l3mlop.png" onerror="this.onerror=null;this.src='/img/404.gif'" alt="极客大挑战2024—Part1"/></a><div class="content"><a class="title" href="/2025/07/07/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024%E2%80%94Part1/WP1/" title="极客大挑战2024—Part1">极客大挑战2024—Part1</a><time datetime="2025-07-07T13:05:50.000Z" title="Created 2025-07-07 21:05:50">2025-07-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/07/%E5%88%9D%E8%AF%86SEH/SEH/" title="初识SEH"><img src="https://w.wallhaven.cc/full/nk/wallhaven-nkpxq4.jpg" onerror="this.onerror=null;this.src='/img/404.gif'" alt="初识SEH"/></a><div class="content"><a class="title" href="/2025/07/07/%E5%88%9D%E8%AF%86SEH/SEH/" title="初识SEH">初识SEH</a><time datetime="2025-07-07T09:34:30.000Z" title="Created 2025-07-07 17:34:30">2025-07-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/06/%E5%88%9D%E8%AF%86AES/AES/" title="初识AES"><img src="https://w.wallhaven.cc/full/yq/wallhaven-yqmelx.jpg" onerror="this.onerror=null;this.src='/img/404.gif'" alt="初识AES"/></a><div class="content"><a class="title" href="/2025/07/06/%E5%88%9D%E8%AF%86AES/AES/" title="初识AES">初识AES</a><time datetime="2025-07-06T02:53:21.000Z" title="Created 2025-07-06 10:53:21">2025-07-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/04/XYCTF2025/XYCTF2025RE/" title="XYCTF2025"><img src="https://images.pexels.com/photos/3082313/pexels-photo-3082313.jpeg" onerror="this.onerror=null;this.src='/img/404.gif'" alt="XYCTF2025"/></a><div class="content"><a class="title" href="/2025/07/04/XYCTF2025/XYCTF2025RE/" title="XYCTF2025">XYCTF2025</a><time datetime="2025-07-04T12:25:01.428Z" title="Created 2025-07-04 20:25:01">2025-07-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/29/DSBCTF2024/DSBCTF/" title="DSBCTF2024"><img src="https://p.ananas.chaoxing.com/star3/400_0cQ80/43e305b7862e440ade282e538f09c159.webp" onerror="this.onerror=null;this.src='/img/404.gif'" alt="DSBCTF2024"/></a><div class="content"><a class="title" href="/2025/06/29/DSBCTF2024/DSBCTF/" title="DSBCTF2024">DSBCTF2024</a><time datetime="2025-06-29T08:50:00.000Z" title="Created 2025-06-29 16:50:00">2025-06-29</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="workboard"><img class="workSituationImg boardsign" src="https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-上班摸鱼中.svg" alt="距离月入25k也就还差一个大佬带我~" title="距离月入25k也就还差一个大佬带我~"/><div id="runtimeTextTip"></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2025 By <a class="footer-bar-link" href="/" title="zhike w" target="_blank">zhike w</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/styles/github-dark.css"/><script src="https://cdn.jsdelivr.net/npm/highlight.js@11.8.0/lib/highlight.min.js"></script><script>document.addEventListener('DOMContentLoaded', function () {
  document.querySelectorAll('pre code').forEach((block) => {
    hljs.highlightElement(block);
  });
});</script></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">Articles</div><div class="length-num">14</div></a><a href="/tags/" title="tag"><div class="headline">Tags</div><div class="length-num">7</div></a><a href="/categories/" title="category"><div class="headline">Categories</div><div class="length-num">3</div></a></div><span class="sidebar-menu-item-title">Function</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="Display Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>Display Mode</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><!--生成导航菜单的 Pug 代码片段--><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/OpenGL/" style="font-size: 0.88rem;">OpenGL<sup>1</sup></a><a href="/tags/Reverse/" style="font-size: 0.88rem;">Reverse<sup>8</sup></a><a href="/tags/Windows/" style="font-size: 0.88rem;">Windows<sup>1</sup></a><a href="/tags/crypto/" style="font-size: 0.88rem;">crypto<sup>1</sup></a><a href="/tags/%E5%A4%8D%E7%8E%B0WP/" style="font-size: 0.88rem;">复现WP<sup>5</sup></a><a href="/tags/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">安卓开发学习<sup>4</sup></a><a href="/tags/%E6%8A%80%E6%9C%AF%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">技术学习<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"></div><div id="rightside-config-show"><button id="readmode" type="button" title="Read Mode"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="go-up" type="button" title="Back To Top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("06/21/2025 10:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 zhike w 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("06/21/2025 10:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-下班啦.svg";
        img.title = "下班了就该开开心心的玩耍，嘿嘿~";
        img.alt = "下班了就该开开心心的玩耍，嘿嘿~";
      }

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://comments-theta-seven.vercel.app/',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.39/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://comments-theta-seven.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[image]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[link]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[code]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://comments-theta-seven.vercel.app/',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "Unable to get the data, please make sure the settings are correct."
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.39/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += 'No Comment'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script async data-pjax src="/js/anzhiyu.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://npm.elemecdn.com/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>